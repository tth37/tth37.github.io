<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>tth37&#39;s Blog</title>
  
  <subtitle>Think twice, code once.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://tth37.cn/"/>
  <updated>2019-09-29T16:02:42.823Z</updated>
  <id>https://tth37.cn/</id>
  
  <author>
    <name>tth37</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>è§£é¢˜æŠ¥å‘Š-NOIP2017æé«˜ç»„åˆèµ›</title>
    <link href="https://tth37.cn/2019/09/29/solution-noip2017pre/"/>
    <id>https://tth37.cn/2019/09/29/solution-noip2017pre/</id>
    <published>2019-09-29T15:23:06.000Z</published>
    <updated>2019-09-29T16:02:42.823Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æœªå®Œå¾…ç»­â€¦â€¦</p></blockquote><a id="more"></a><p><strong>ç¬¬ 1 é¢˜</strong></p><p>ä»ï¼ˆ ï¼‰å¹´å¼€å§‹ï¼ŒNOIP ç«èµ›å°†ä¸å†æ”¯æŒ Pascal è¯­è¨€ã€‚</p><p> A. 2020 B. 2021 C. 2022 D. 2023</p><blockquote><p>é€å‘½é¢˜ã€‚</p></blockquote><p><strong>ç¬¬ 2 é¢˜</strong></p><p>åœ¨ 8 ä½äºŒè¿›åˆ¶è¡¥ç ä¸­ï¼Œ10101011 è¡¨ç¤ºçš„æ•°æ˜¯åè¿›åˆ¶ä¸‹çš„ï¼ˆ ï¼‰ã€‚</p><p> A. 43 B. -85 C. -43 D. -84</p><blockquote><div class="table-container"><table><thead><tr><th></th><th>åŸç </th><th>è¡¥ç </th><th>åç </th></tr></thead><tbody><tr><td>æ­£æ•°</td><td>ç¬¦å·(0)+æ•°å€¼è¡¨ç¤ºæ³•</td><td>åŸç </td><td>åŸç </td></tr><tr><td>è´Ÿæ•°</td><td>ç¬¦å·(1)+æ•°å€¼è¡¨ç¤ºæ³•</td><td>ç¬¦å·ä½ä¹‹å¤–å„ä½å–å</td><td>ç¬¦å·ä½ä¹‹å¤–å„ä½å–åï¼Œæœ€ä½ä½åŠ 1</td></tr></tbody></table></div><script type="math/tex; mode=display">[x]_{è¡¥}=10101011</script><script type="math/tex; mode=display">[x]_{å}=10101010</script><script type="math/tex; mode=display">[x]_{åŸ}=11010101</script><script type="math/tex; mode=display">x=-85</script></blockquote><p><strong>ç¬¬ 3 é¢˜</strong></p><p>åˆ†è¾¨ç‡ä¸º 1600x900ã€16 ä½è‰²çš„ä½å›¾ï¼Œå­˜å‚¨å›¾åƒä¿¡æ¯æ‰€éœ€çš„ç©ºé—´ä¸ºï¼ˆ ï¼‰ã€‚ </p><p>A. 2812.5KB B. 4218.75KB C. 4320KB D. 2880KB</p><blockquote><script type="math/tex; mode=display">8 \ bit= 1\ byte(B)\\1024\ B=1\  KB\\1024\ KB=1\ MB\\1024\ MB=1\ GB</script></blockquote><p><strong>ç¬¬ 4 é¢˜</strong></p><p>2017 å¹´ 10 æœˆ 1 æ—¥æ˜¯æ˜ŸæœŸæ—¥ï¼Œ1949 å¹´ 10 æœˆ 1 æ—¥æ˜¯ï¼ˆ ï¼‰ã€‚ </p><p>A. æ˜ŸæœŸä¸‰ B. æ˜ŸæœŸæ—¥ C. æ˜ŸæœŸå…­ D. æ˜ŸæœŸäºŒ</p><blockquote><p>2017-&gt;2016ï¼šæ˜ŸæœŸæ—¥-&gt;æ˜ŸæœŸå…­</p><p>2016-&gt;2015ï¼šæ˜ŸæœŸå…­-&gt;æ˜ŸæœŸå››</p><p>2015-&gt;2014ï¼šæ˜ŸæœŸå››-&gt;æ˜ŸæœŸä¸‰</p><p>â€¦â€¦</p><p>1950-&gt;1949ï¼šæ˜ŸæœŸæ—¥-&gt;æ˜ŸæœŸå…­</p></blockquote><p><strong>ç¬¬ 5 é¢˜</strong></p><p>è®¾ G æ˜¯æœ‰ n ä¸ªç»“ç‚¹ã€m æ¡è¾¹ï¼ˆn â‰¤ mï¼‰çš„è¿é€šå›¾ï¼Œå¿…é¡»åˆ å» G çš„ï¼ˆ ï¼‰æ¡è¾¹ï¼Œ æ‰èƒ½ä½¿å¾— G å˜æˆä¸€æ£µæ ‘ã€‚ </p><p>A. m â€“ n + 1 B. m - n C. m + n + 1 D. n â€“ m + 1</p><blockquote><p>æ ‘æœ‰ n - 1 æ¡è¾¹</p></blockquote><p><strong>ç¬¬ 6 é¢˜</strong></p><p>è‹¥æŸç®—æ³•çš„è®¡ç®—æ—¶é—´è¡¨ç¤ºä¸ºé€’æ¨å…³ç³»å¼ï¼š<br>T(N) = 2T(N / 2) + N log N<br>T(1) = 1<br>åˆ™è¯¥ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºï¼ˆ ï¼‰ã€‚ </p><p>A. O(N) B. O(NlogN) C. O(Nlog^2N) D. O(N^2)</p><blockquote><p>$T$ å…±æœ‰ $\log N$ æ¬¡é€’å½’è°ƒç”¨ï¼Œæ¯æ¬¡å¤æ‚åº¦ä¸º $O(N\log N)$</p></blockquote><p><strong>ç¬¬ 7 é¢˜</strong></p><p>è¡¨è¾¾å¼ a * (b + c) * d çš„åç¼€å½¢å¼æ˜¯ï¼ˆ ï¼‰ã€‚ </p><p>A. a b c d * + * B. a b c + * d * C. a * b c + * d D. b + c * a * d</p><blockquote><p>æ™®é€šè¡¨è¾¾å¼ä¸ºä¸­åºéå†ï¼Œåç¼€è¡¨è¾¾å¼ä¸ºå¯èƒ½çš„ååºéå†</p></blockquote><p><strong><font color="#dd0000">ç¬¬ 8 é¢˜ </font></strong></p><p>ç”±å››ä¸ªä¸åŒçš„ç‚¹æ„æˆçš„ç®€å•æ— å‘è¿é€šå›¾çš„ä¸ªæ•°æ˜¯ï¼ˆ ï¼‰ã€‚ </p><p>A. 32 B. 35 C. 38 D. 41</p><blockquote><p>ç”±å››ä¸ªç‚¹æ„æˆçš„ç®€å•æ— å‘è¿é€šå›¾ï¼Œå®ƒä»¬ä¹‹é—´åªå¯èƒ½æœ‰ 6 æ¡ä¸åŒçš„è¾¹ã€‚å°†å››ä¸ªç‚¹æŒ‰åºæ’åˆ—ï¼Œè¿™ 6 æ¡è¾¹å¯åˆ†ä¸ºçºµæ¨ªå‘åŠæ–œå‘ä¸¤ç§è¾¹ã€‚</p><ol><li><p>çºµæ¨ªè¾¹æœ‰ 1 æ¡</p><p>è¯¥æƒ…å†µä¸‹ï¼Œæ— å‘å›¾æœ‰ 4 ç§æ‘†æ”¾ä½ç½®ã€‚è¦ä½¿å¾—å›¾è¿é€šï¼Œæ–œå‘è¾¹åªæœ‰ 1 ç§æ‘†æ³•ã€‚</p><p>ans += 4 * 1</p></li><li><p>çºµæ¨ªè¾¹æœ‰ 2 æ¡</p><ul><li><p>ä¸¤çºµ/ä¸¤æ¨ª</p><p>ans += 2 * 3</p></li><li><p>ä¸€çºµä¸€æ¨ª</p><p>ans += 4 * 2</p></li></ul></li><li><p>çºµæ¨ªè¾¹æœ‰ 3 æ¡</p><p>ans += 4 * 4</p></li><li><p>çºµæ¨ªè¾¹æœ‰ 4 æ¡</p><p>ans += 1 * 4</p></li></ol></blockquote><p><strong><font color="#dd0000">ç¬¬ 9 é¢˜</font></strong></p><p>å°† 7 ä¸ªåé¢åˆ†ç»™ 4 ä¸ªä¸åŒçš„ç­çº§ï¼Œå…è®¸æœ‰çš„ç­çº§æ²¡æœ‰åé¢ï¼Œæœ‰ï¼ˆ ï¼‰ç§ä¸ åŒçš„åˆ†é…æ–¹æ¡ˆã€‚ </p><p>A. 60 B. 84 C. 96 D. 120</p><blockquote><p>å¯é‡ç»„åˆã€‚ä¸ä¼š</p></blockquote><p><strong><font color="#dd0000">ç¬¬ 10 é¢˜</font></strong></p><p>è‹¥ f[0] = 0, f[1] = 1, f[n + 1] = (f[n] + f[n - 1]) / 2ï¼Œåˆ™éšç€ i çš„å¢å¤§ï¼Œf[i]å°†æ¥è¿‘äº( )ã€‚ </p><p>A. 1/2 B. 2/3 C. (âˆš5 âˆ’ 1)/2 D. 1</p><blockquote><p>ä¸ä¼š</p></blockquote><p><strong>ç¬¬ 11 é¢˜</strong></p><p>è®¾ A å’Œ B æ˜¯ä¸¤ä¸ªé•¿ä¸º n çš„æœ‰åºæ•°ç»„ï¼Œç°åœ¨éœ€è¦å°† A å’Œ B åˆå¹¶æˆä¸€ä¸ªæ’å¥½åºçš„ æ•°ç»„ï¼Œè¯·é—®ä»»ä½•ä»¥å…ƒç´ æ¯”è¾ƒä½œä¸ºåŸºæœ¬è¿ç®—çš„å½’å¹¶ç®—æ³•æœ€åæƒ…å†µä¸‹è‡³å°‘è¦åš ï¼ˆ ï¼‰æ¬¡æ¯”è¾ƒã€‚ </p><p>A. n^2 B. nlogn C. 2n D. 2n-1</p><blockquote><p>æ„é€  Aã€B åˆ†åˆ«ä¸º [1,3,5,7â€¦] [2,4,6,8,â€¦] æ­¤æ—¶éœ€è¦ 2n-1 æ¬¡æ¯”è¾ƒ</p></blockquote><p><strong>ç¬¬ 12 é¢˜</strong></p><p>åœ¨ nï¼ˆn â‰¥ 3ï¼‰æšç¡¬å¸ä¸­æœ‰ä¸€æšè´¨é‡ä¸åˆæ ¼çš„ç¡¬å¸ï¼ˆè´¨é‡è¿‡è½»æˆ–è´¨é‡è¿‡é‡ï¼‰,å¦‚æœåªæœ‰ä¸€æ¶å¤©å¹³å¯ä»¥ç”¨æ¥ç§°é‡ä¸”ç§°é‡çš„ç¡¬å¸æ•°æ²¡æœ‰é™åˆ¶ï¼Œä¸‹é¢æ˜¯æ‰¾å‡ºè¿™æšä¸åˆæ ¼çš„ç¡¬å¸çš„ç®—æ³•ã€‚è¯·æŠŠ a-c ä¸‰è¡Œä»£ç è¡¥å…¨åˆ°ç®—æ³•ä¸­ã€‚<br>a. A â† X âˆª Y<br>b. A â† Z<br>c. n â† |A| ç®—æ³• Coin(A, n)1. k â† âŒŠn/3âŒ‹   </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">k â† âŒŠn/3âŒ‹</span><br><span class="line">å°† A ä¸­ç¡¬å¸åˆ†æˆ Xï¼ŒYï¼ŒZ ä¸‰ä¸ªé›†åˆï¼Œä½¿å¾—|X| = |Y| = k,|Z| = n - 2k</span><br><span class="line">if W(X) â‰  W(Y)       //W(X), W(Y)åˆ†åˆ«ä¸º X æˆ– Y çš„é‡é‡</span><br><span class="line">then _____</span><br><span class="line">else _____</span><br><span class="line">_____</span><br><span class="line">if n&gt;2 then goto 1</span><br><span class="line">if n=2 then ä»»å– A ä¸­1æšç¡¬å¸ä¸æ‹¿èµ°ç¡¬å¸æ¯”è¾ƒï¼Œè‹¥ä¸ç­‰ï¼Œåˆ™å®ƒä¸åˆæ ¼ï¼› è‹¥ç›¸ç­‰ï¼Œåˆ™ A ä¸­å‰©ä¸‹çš„ç¡¬å¸ä¸åˆæ ¼</span><br><span class="line">if n=1 then A ä¸­ç¡¬å¸ä¸åˆæ ¼</span><br></pre></td></tr></table></figure><p>æ­£ç¡®çš„å¡«ç©ºé¡ºåºæ˜¯ï¼ˆ ï¼‰ã€‚ </p><p>A. b, c, a B. c, b, a C. c, a, b D. a, b, c</p><blockquote><p>è¿˜æ²¡åš~</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æœªå®Œå¾…ç»­â€¦â€¦&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="è§£é¢˜æŠ¥å‘Š" scheme="https://tth37.cn/categories/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-LibreOJ-6032æ°´ç®±</title>
    <link href="https://tth37.cn/2019/09/28/solution-loj-6032/"/>
    <id>https://tth37.cn/2019/09/28/solution-loj-6032/</id>
    <published>2019-09-27T16:04:49.000Z</published>
    <updated>2019-09-27T16:26:34.055Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://loj.ac/problem/6032" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>é¢˜ç›®æ¦‚æ‹¬<strong>é‡é‡‘</strong>å¾é›†ä¸­~</p></blockquote><a id="more"></a><p>æ¯”è¾ƒæ¯’ç˜¤çš„ä¸€é“é¢˜ã€‚</p><p>æ³¨æ„åˆ°æ¯ä¸ªæ¡ä»¶åªæœ‰â€œæœ‰æ°´â€é™åˆ¶å’Œâ€œæ²¡æ°´â€é™åˆ¶ã€‚é—®é¢˜åœ¨äºå¦‚ä½•ç»Ÿè®¡æœ€å¤šèƒ½æ»¡è¶³å¤šå°‘æ¡ä»¶ã€‚å‡å®šæ‰€æœ‰çš„â€œæ²¡æ°´â€æ¡ä»¶éƒ½èƒ½æ»¡è¶³ï¼Œåœ¨ DP ä¸­å¦‚æœåœ¨â€œæ²¡æ°´â€é™åˆ¶çš„æ ¼å­ä¸­å¡«å…¥äº†æ°´ï¼Œåˆ™å¯¹ç­”æ¡ˆçš„è´¡çŒ®å‡ä¸€ï¼›å¦‚æœåœ¨â€œæœ‰æ°´â€é™åˆ¶çš„æ ¼å­ä¸­å¡«å…¥äº†æ°´ï¼Œåˆ™å¯¹ç­”æ¡ˆçš„è´¡çŒ®åŠ ä¸€ã€‚</p><p>æ ¹æ®ä»¥ä¸Šæ–¹æ³•ï¼Œå¯ä»¥å®šä¹‰çŠ¶æ€ï¼š$f[i][j]$ è¡¨ç¤ºåœ¨ä»å·¦å¾€å³ç¬¬ $i$ ä¸ªæ ¼å­ä¸­ï¼Œé«˜åº¦ä¸º $j$ çš„åœ°æ–¹<strong>æœ‰æ°´</strong>æ—¶å¯¹ç­”æ¡ˆäº§ç”Ÿçš„æœ€å¤§è´¡çŒ®ã€‚æ³¨æ„ï¼šæ­¤æ—¶å‡å®šç¬¬ $i$ ä¸ªæ ¼å­çš„å³ä¾§æŒ¡æ¿ä¸ºæ— é™é«˜ã€‚</p><p>æ˜¾ç„¶ï¼Œå¦‚æœ $j$ å°äºç­‰äºå…¶å·¦ä¾§æŒ¡æ¿çš„é«˜åº¦ï¼Œä¸Šä¸€æ ¼çš„æ°´çš„é«˜åº¦å¯ä»¥ä¸º $1-h[i]$ çš„ä»»æ„å€¼ï¼›å¦‚æœ $j$ å¤§äºå…¶å·¦ä¾§æŒ¡æ¿çš„é«˜åº¦ï¼Œé‚£ä¹ˆä¸Šä¸€æ ¼çš„æ°´çš„é«˜åº¦å¿…é¡»åŒæ ·ä¸º $j$ã€‚</p><p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">f[i][j]=\begin{cases}\sum_{k=1}^{j} w[i][k]+\max_{k=1}^{h[i]}\lbrace f[i-1][k]\rbrace,\ j\le h[i]\\\sum_{k-1}^{j} w[i][k]+f[i-1][j],\ j>h[i]\end{cases}</script><p>ä¸éš¾å‘ç°å¯ä»¥ä½¿ç”¨æ»šåŠ¨æ•°ç»„ä¼˜åŒ–ç©ºé—´ï¼›å¹¶ä¸”æ³¨æ„åˆ°ï¼Œæ¯ä¸ªæ–°çš„ $f[i][j]$ è¦ä¹ˆæ˜¯è¢«ä¿®æ”¹æˆæŸä¸ªå€¼ï¼Œè¦ä¹ˆæ˜¯åœ¨åŸæ¥çš„åŸºç¡€ä¸ŠåŠ ä¸Šäº†æŸäº›ä¸œè¥¿ã€‚</p><p>åœ¨æœ¬é¢˜ä¸­ï¼Œæ¯ä¸ªæ ¼å­ä¸­é™åˆ¶æ¡ä»¶çš„åˆ†å¸ƒæ˜¯ç›¸å¯¹<strong>ç¨€ç–</strong>çš„ã€‚é‚£ä¹ˆï¼Œåœ¨åŒä¸€æ ¼å­çš„ä¸åŒé«˜åº¦å¤„ï¼Œåªè¦å…¶å¯¹ç­”æ¡ˆçš„è´¡çŒ®å‰ç¼€å’Œç›¸ç­‰ï¼Œåˆ™å¯ä»¥ä½œä¸ºåŒºé—´è¿›è¡Œå¿«é€Ÿå¤„ç†ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨<strong>çº¿æ®µæ ‘</strong>ç»´æŠ¤ $f[1]-f[L]$ï¼Œå¹¶åœ¨å…¶ä¸­ç”¨æ»šåŠ¨æ•°ç»„çš„æ“ä½œè¿›è¡ŒçŠ¶æ€è½¬ç§»ã€‚è¿™æ£µçº¿æ®µæ ‘éœ€è¦æ”¯æŒåŒºé—´ä¿®æ”¹ï¼ˆæ›¿æ¢ï¼‰ï¼ŒåŒºé—´ä¿®æ”¹ï¼ˆå¢åŠ ï¼‰ï¼ŒåŒºé—´æŸ¥è¯¢æœ€å¤§å€¼ã€‚</p><p>æ³¨æ„éœ€è¦å¯¹é«˜åº¦è¿›è¡Œç¦»æ•£åŒ–å¤„ç†ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson(u) node[u].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson(u) node[u].r</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> val(u) node[u].val</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> tag1(u) node[u].tag1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> tag2(u) node[u].tag2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> id(x) (lower_bound(b + 1, b + L + 1, x) - b)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rid(x) b[x]</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">400005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, val, tag1, tag2;</span><br><span class="line">    <span class="comment">// val: max</span></span><br><span class="line">    <span class="comment">// tag1: replace</span></span><br><span class="line">    <span class="comment">// tag2: add</span></span><br><span class="line">&#125;node[MAXN * <span class="number">3</span>];</span><br><span class="line"><span class="keyword">int</span> cnt;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Limit</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> x, y, k;</span><br><span class="line">&#125;limit[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T, N, M;</span><br><span class="line"><span class="keyword">int</span> R, L;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> b[MAXN], h[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span>&amp; u, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    u = ++cnt;</span><br><span class="line">    tag1(u) = -inf;</span><br><span class="line">    tag2(u) = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    build(lson(u), l, mid);</span><br><span class="line">    build(rson(u), mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (tag1(u) != -inf) &#123;</span><br><span class="line">        val(lson(u)) = val(rson(u)) = tag1(u);</span><br><span class="line">        tag1(lson(u)) = tag1(rson(u)) = tag1(u);</span><br><span class="line">        tag2(lson(u)) = tag2(rson(u)) = <span class="number">0</span>;</span><br><span class="line">        tag1(u) = -inf;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tag2(u) != <span class="number">0</span>) &#123;</span><br><span class="line">        val(lson(u)) += tag2(u);</span><br><span class="line">        val(rson(u)) += tag2(u);</span><br><span class="line">        tag2(lson(u)) += tag2(u);</span><br><span class="line">        tag2(rson(u)) += tag2(u);</span><br><span class="line">        tag2(u) = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    val(u) = max(val(lson(u)), val(rson(u)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">modify_replace</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ql &gt; qr) <span class="keyword">return</span>;</span><br><span class="line">    pushdown(u);</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) &#123;</span><br><span class="line">        val(u) = val;</span><br><span class="line">        tag1(u) = val;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= mid) modify_replace(lson(u), l, mid, ql, qr, val);</span><br><span class="line">    <span class="keyword">if</span> (mid &lt; qr) modify_replace(rson(u), mid + <span class="number">1</span>, r, ql, qr, val);</span><br><span class="line">    pushup(u);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">modify_add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ql &gt; qr) <span class="keyword">return</span>;</span><br><span class="line">    pushdown(u);</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) &#123;</span><br><span class="line">        val(u) += val;</span><br><span class="line">        tag2(u) = val;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= mid) modify_add(lson(u), l, mid, ql, qr, val);</span><br><span class="line">    <span class="keyword">if</span> (mid &lt; qr) modify_add(rson(u), mid + <span class="number">1</span>, r, ql, qr, val);</span><br><span class="line">    pushup(u);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query_max</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr)</span> </span>&#123;</span><br><span class="line">    pushdown(u);</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) &#123;</span><br><span class="line">        <span class="keyword">return</span> val(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, ret = -inf;</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= mid) ret = max(ret, query_max(lson(u), l, mid, ql, qr));</span><br><span class="line">    <span class="keyword">if</span> (mid &lt; qr) ret = max(ret, query_max(rson(u), mid + <span class="number">1</span>, r, ql, qr));</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(Limit a, Limit b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a.x != b.x) <span class="keyword">return</span> a.x &lt; b.x;</span><br><span class="line">    <span class="keyword">if</span> (a.y != b.y) <span class="keyword">return</span> a.y &lt; b.y;</span><br><span class="line">    <span class="keyword">return</span> a.k &lt; b.k;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(node, <span class="number">0</span>, <span class="keyword">sizeof</span>(node));</span><br><span class="line">        cnt = <span class="number">0</span>, L = <span class="number">0</span>, R = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> ans1 = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;N, &amp;M);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;h[i]);</span><br><span class="line">            b[++L] = h[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;limit[i].x, &amp;limit[i].y, &amp;limit[i].k);</span><br><span class="line">            limit[i].y++;</span><br><span class="line">            <span class="keyword">if</span> (limit[i].k == <span class="number">0</span>) limit[i].k = <span class="number">-1</span>, ans1++;</span><br><span class="line">            b[++L] = limit[i].y;</span><br><span class="line">            b[++L] = limit[i].y - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        sort(b + <span class="number">1</span>, b + L + <span class="number">1</span>);</span><br><span class="line">        L = unique(b + <span class="number">1</span>, b + L + <span class="number">1</span>) - b - <span class="number">1</span>;</span><br><span class="line">        h[<span class="number">1</span>] = L;</span><br><span class="line">        build(R, <span class="number">1</span>, L);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; ++i)</span><br><span class="line">            h[i] = id(h[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i)</span><br><span class="line">            limit[i].y = id(limit[i].y);</span><br><span class="line">        sort(limit + <span class="number">1</span>, limit + M + <span class="number">1</span>, cmp);</span><br><span class="line">        <span class="keyword">int</span> cur = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">            <span class="keyword">int</span> height = <span class="number">1</span>, s = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> tmp = query_max(R, <span class="number">1</span>, L, <span class="number">1</span>, h[i]);</span><br><span class="line">            <span class="keyword">while</span> (limit[cur].x == i &amp;&amp; limit[cur].y &lt;= h[i]) &#123;</span><br><span class="line">                <span class="keyword">int</span> w = limit[cur].k;</span><br><span class="line">                <span class="keyword">while</span> (limit[cur].x == limit[cur + <span class="number">1</span>].x &amp;&amp; limit[cur].y == limit[cur + <span class="number">1</span>].y) &#123;</span><br><span class="line">                    w += limit[++cur].k;</span><br><span class="line">                &#125;</span><br><span class="line">                modify_replace(R, <span class="number">1</span>, L, height, id(rid(limit[cur].y) - <span class="number">1</span>), s + tmp);</span><br><span class="line">                height = limit[cur].y;</span><br><span class="line">                s += w;</span><br><span class="line">                cur++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (height &lt;= h[i])</span><br><span class="line">                modify_replace(R, <span class="number">1</span>, L, height, h[i], s + tmp);</span><br><span class="line">            height = h[i] + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (limit[cur].x == i) &#123;</span><br><span class="line">                <span class="keyword">int</span> w = limit[cur].k;</span><br><span class="line">                <span class="keyword">while</span> (limit[cur].x == limit[cur + <span class="number">1</span>].x &amp;&amp; limit[cur].y == limit[cur + <span class="number">1</span>].y) &#123;</span><br><span class="line">                    w += limit[++cur].k;</span><br><span class="line">                &#125;</span><br><span class="line">                modify_add(R, <span class="number">1</span>, L, height, id(rid(limit[cur].y) - <span class="number">1</span>), s);</span><br><span class="line">                height = limit[cur].y;</span><br><span class="line">                s += w;</span><br><span class="line">                cur++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (height &lt;= L)</span><br><span class="line">                modify_add(R, <span class="number">1</span>, L, height, L, s);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans1 + query_max(R, <span class="number">1</span>, L, <span class="number">1</span>, L));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://loj.ac/problem/6032&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¢˜ç›®æ¦‚æ‹¬&lt;strong&gt;é‡é‡‘&lt;/strong&gt;å¾é›†ä¸­~&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="åŠ¨æ€è§„åˆ’" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="çº¿æ®µæ ‘" scheme="https://tth37.cn/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
      <category term="ç¦»æ•£åŒ–" scheme="https://tth37.cn/tags/%E7%A6%BB%E6%95%A3%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p3960åˆ—é˜Ÿ</title>
    <link href="https://tth37.cn/2019/09/24/solution-luogu-p3960/"/>
    <id>https://tth37.cn/2019/09/24/solution-luogu-p3960/</id>
    <published>2019-09-24T15:14:36.000Z</published>
    <updated>2019-09-24T15:37:12.436Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problem/P3960" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>é¢˜ç›®æ¦‚æ‹¬å¾é›†ä¸­~</p></blockquote><a id="more"></a><p>ä¸€é“éå¸¸æœ‰æ„æ€çš„é¢˜ã€‚</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç¥å¥‡çš„æ•°æ®ç»“æ„ï¼Œå®ƒå¯ä»¥åŠ¨æ€åœ°ç»´æŠ¤ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„é˜Ÿåˆ—ï¼Œå…¶åˆå§‹å…ƒç´ ä¸º $1,2,â€¦,n$ ã€‚è¯¥é˜Ÿåˆ—å¯ä»¥æ”¯æŒä¸¤ç§æ“ä½œï¼Œç¬¬ä¸€ç§ä¸ºåˆ é™¤é˜Ÿåˆ—çš„ç¬¬ $k$ é¡¹å…ƒç´ ï¼Œæ‰§è¡Œâ€œå‘å‰çœ‹é½â€æ“ä½œï¼Œå¹¶åœ¨é˜Ÿåˆ—çš„æœ«å°¾è¡¥å…… $n+1$ ï¼ˆä»¥æ­¤ç±»æ¨ï¼‰ã€‚ç¬¬äºŒç§ä¸ºæŸ¥è¯¢é˜Ÿåˆ—çš„ç¬¬ $k$ é¡¹å…ƒç´ çš„æ•°å€¼ã€‚</p><p>æ‹¥æœ‰è¿™æ ·ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œæœ¬é¢˜å°±ç®€å•å¤šäº†ï¼›è§‚å¯Ÿåˆ°â€œå‘å‰çœ‹é½â€å‘½ä»¤åªå¯¹æœ€åä¸€åˆ—äº§ç”Ÿå½±å“ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯ä¸€è¡Œç»´æŠ¤ä¸€ä¸ªåŠ¨æ€é˜Ÿåˆ—ï¼Œæœ€åä¸€åˆ—ç”¨å¦ä¸€ä¸ªåŠ¨æ€é˜Ÿåˆ—å•ç‹¬å¤„ç†ã€‚</p><p>å¦‚æœå‡ºåˆ—çš„åŒå­¦ä½äºæœ€åä¸€åˆ—ï¼Œåˆ™åªéœ€å¯¹æœ€åä¸€åˆ—è¿›è¡Œä¸€æ¬¡åˆ é™¤æ“ä½œå³å¯ï¼›å¦‚æœå‡ºåˆ—çš„åŒå­¦ä¸åœ¨æœ€åä¸€åˆ—ï¼Œåˆ™éœ€è¦å¯¹å‡ºåˆ—åŒå­¦æ‰€åœ¨çš„é‚£ä¸€è¡Œä¸æœ€åä¸€åˆ—åŒæ—¶è¿›è¡Œæ“ä½œã€‚å®ç°ç»†èŠ‚ä¸å†èµ˜è¿°ã€‚</p><p>ç°åœ¨æˆ‘ä»¬æ¥è€ƒè™‘ä¸€ä¸‹å¦‚ä½•å®ç°ç¥å¥‡çš„åŠ¨æ€é˜Ÿåˆ—ã€‚åœ¨æœ¬é¢˜çš„æƒ…å†µä¸­ï¼Œå‡è®¾æ¯ä¸ªåŠ¨æ€é˜Ÿåˆ—æœ€å¤šæœ‰ $Q$ æ¬¡åˆ é™¤æ“ä½œï¼Œé‚£ä¹ˆåŠ¨æ€é˜Ÿåˆ—çš„æ—¶ç©ºå¤æ‚åº¦å¿…é¡»åªä¸ $Q$ ç›¸å…³ï¼Œå¦åˆ™ $O(n^2)$ çš„æ—¶ç©ºå¤æ‚åº¦æ— æ³•æ‰¿å—ã€‚ä¼¼ä¹è¿™é‡Œå¯ä»¥ç”¨å¹³è¡¡æ ‘å®ç°ï¼Œè€Œæˆ‘é‡‡ç”¨äº†è¾ƒä¸ºå¥½å†™çš„<strong>åŠ¨æ€å¼€ç‚¹æƒå€¼çº¿æ®µæ ‘</strong>æ¥ç»´æŠ¤åŠ¨æ€é˜Ÿåˆ—ã€‚</p><p>åˆå§‹çŠ¶æ€ï¼Œæƒå€¼çº¿æ®µæ ‘ä¸‹æ ‡ä¸º $1,2,â€¦,n$ çš„èŠ‚ç‚¹å¤§å°å‡ä¸º $1$ ã€‚å¯¹äºåˆ é™¤æ“ä½œï¼Œæˆ‘ä»¬åªéœ€å°†å¯¹åº”çš„æƒå€¼å¤§å°å‡ä¸€ï¼Œå¹¶åœ¨æƒå€¼ $n+1$ çš„å¤§å°åŠ ä¸€å³å¯ã€‚å¯¹äºæŸ¥è¯¢æ“ä½œï¼Œåªéœ€åœ¨æƒå€¼çº¿æ®µæ ‘ä¸­æŸ¥è¯¢ç¬¬ $k$ å°å…ƒç´ å³ä¸ºå¯¹åº”æ•°å€¼ã€‚å®ç°ç»†èŠ‚åŒæ ·ä¸å†èµ˜è¿°ã€‚</p><p>è®°å¾—å¼€ long long ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson(u) (node[u].l)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson(u) (node[u].r)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sum(u) (node[u].sum)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">300005</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, sum;</span><br><span class="line">&#125;node[MAXN * <span class="number">42</span>];</span><br><span class="line"><span class="keyword">int</span> cnt;</span><br><span class="line"><span class="keyword">int</span> root[MAXN], size[MAXN];</span><br><span class="line"><span class="built_in">vector</span>&lt;ll&gt; ins[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, Q, T;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span>&amp; u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (u == <span class="number">0</span>) u = ++cnt;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        sum(u) += val;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (p &lt;= mid) modify(lson(u), l, mid, p, val);</span><br><span class="line">    <span class="keyword">else</span> modify(rson(u), mid + <span class="number">1</span>, r, p, val);</span><br><span class="line">    sum(u) = sum(lson(u)) + sum(rson(u));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> l;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> lsum = sum(lson(u));</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= T) &#123;</span><br><span class="line">        lsum += (mid &gt; T) ? T - l + <span class="number">1</span> : mid - l + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (k &lt;= lsum) <span class="keyword">return</span> query(lson(u), l, mid, k);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> query(rson(u), mid + <span class="number">1</span>, r, k - lsum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;N, &amp;M, &amp;Q);</span><br><span class="line">    <span class="keyword">int</span> Case = Q;</span><br><span class="line">    <span class="keyword">while</span> (Case--) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        ll ans = <span class="number">0</span>, tmp = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (y == M) &#123;</span><br><span class="line">            T = N;</span><br><span class="line">            ans = query(root[N + <span class="number">1</span>], <span class="number">1</span>, N + Q, x);</span><br><span class="line">            modify(root[N + <span class="number">1</span>], <span class="number">1</span>, N + Q, ans, <span class="number">-1</span>);</span><br><span class="line">            modify(root[N + <span class="number">1</span>], <span class="number">1</span>, N + Q, N + (++size[N + <span class="number">1</span>]), <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (ans &lt;= N) ans = ans * (ll)M;</span><br><span class="line">            <span class="keyword">else</span> ans = ins[N + <span class="number">1</span>][ans - N - <span class="number">1</span>];</span><br><span class="line">            ins[N + <span class="number">1</span>].push_back(ans);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            T = M - <span class="number">1</span>;</span><br><span class="line">            ans = query(root[x], <span class="number">1</span>, M + Q, y);</span><br><span class="line">            modify(root[x], <span class="number">1</span>, M + Q, ans, <span class="number">-1</span>);</span><br><span class="line">            modify(root[x], <span class="number">1</span>, M + Q, M - <span class="number">1</span> + (++size[x]), <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (ans &lt;= M - <span class="number">1</span>) ans += (ll)(x - <span class="number">1</span>) * M;</span><br><span class="line">            <span class="keyword">else</span> ans = ins[x][ans - M];</span><br><span class="line">            T = N;</span><br><span class="line">            tmp = query(root[N + <span class="number">1</span>], <span class="number">1</span>, N + Q, x);</span><br><span class="line">            modify(root[N + <span class="number">1</span>], <span class="number">1</span>, N + Q, tmp, <span class="number">-1</span>);</span><br><span class="line">            modify(root[N + <span class="number">1</span>], <span class="number">1</span>, N + Q, N + (++size[N + <span class="number">1</span>]), <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (tmp &lt;= N) tmp = tmp * (ll)M;</span><br><span class="line">            <span class="keyword">else</span> tmp = ins[N + <span class="number">1</span>][tmp - N - <span class="number">1</span>];</span><br><span class="line">            ins[N + <span class="number">1</span>].push_back(ans);</span><br><span class="line">            ins[x].push_back(tmp);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problem/P3960&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¢˜ç›®æ¦‚æ‹¬å¾é›†ä¸­~&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="ä¸»å¸­æ ‘" scheme="https://tth37.cn/tags/%E4%B8%BB%E5%B8%AD%E6%A0%91/"/>
    
      <category term="çº¿æ®µæ ‘" scheme="https://tth37.cn/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p2680è¿è¾“è®¡åˆ’(Beta)</title>
    <link href="https://tth37.cn/2019/09/20/solution-luogu-p2680/"/>
    <id>https://tth37.cn/2019/09/20/solution-luogu-p2680/</id>
    <published>2019-09-20T13:46:44.000Z</published>
    <updated>2019-09-20T14:14:02.393Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problem/P2680" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>è¯æ˜åŠä¼˜åŒ–æ ‘ä¸Šè·¯å¾„æ±‚äº¤ç®—æ³•å å°†ä¼šåœ¨æ´›è°·åšå®¢ä¸Šå‘å¸ƒ</p></blockquote><a id="more"></a><p>è¿™æ˜¯ä¸€é“æš‘å‡é›†è®­è¢«åŠé€€çš„ç¥ä»™é¢˜ åœ¨ä»Šå¤©çš„ä¿¡æ¯è¯¾ä¸Šå¥‡è¿¹èˆ¬åœ°ä¸€éè¿‡</p><p>æ ¹æ®é¢˜æ„ï¼Œå°†æŸä¸€æ¡è¾¹çš„è¾¹æƒä» $w$ æ”¹ä¸º $0$ï¼Œå³ä¸ºå°†ç»è¿‡è¯¥æ¡è¾¹çš„è·¯å¾„æ€»é•¿åº¦å‡å» $w$ã€‚è€Œæˆ‘ä»¬è¦åšçš„ï¼Œå°±æ˜¯æ”¹é€ æ ‘ä¸Šçš„æŸä¸€æ¡è¾¹ï¼Œä½¿å¾—æœ€é•¿çš„è·¯å¾„é•¿åº¦æœ€çŸ­ã€‚</p><p>é¢˜ç›®ä¹ä¸€çœ‹å¯ä»¥äºŒåˆ†ï¼Œä½†åœ¨è¿™ç¯‡é¢˜è§£ä¸­é‡‡ç”¨è´ªå¿ƒç­–ç•¥ã€‚</p><p>é¦–å…ˆå°†æ‰€æœ‰è·¯å¾„æŒ‰ç…§é•¿åº¦é™åºæ’åºã€‚ä¸éš¾å‘ç°ï¼Œåªæœ‰åœ¨â€œæ”¹é€ â€æ“ä½œèƒ½å¤ŸåŒæ—¶å‡å°å‰ $x$ æ¡è·¯å¾„çš„é•¿åº¦ï¼Œè¯¥æ“ä½œæ‰æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå¦åˆ™ä¸ä¼šå¯¹ç­”æ¡ˆäº§ç”Ÿè´¡çŒ®ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•ä½¿â€œæ”¹é€ â€æ“ä½œåŒæ—¶å‡å°å‰ $x$ æ¡è·¯å¾„çš„é•¿åº¦å‘¢ï¼Ÿæ˜¾ç„¶ï¼Œæ­¤æ—¶é€‰å–çš„è¾¹ä¸€å®šå±äºå‰ $x$ æ¡è·¯å¾„çš„äº¤ã€‚è·¯å¾„çš„äº¤ä¸€å®šä»æ˜¯è·¯å¾„ï¼Œæ ¹æ®è´ªå¿ƒï¼Œåªéœ€åœ¨è·¯å¾„çš„äº¤ä¸Šé€‰å–æœ€å¤§çš„è¾¹æƒï¼Œå°†è¿™æ¡è¾¹çš„è¾¹æƒæ”¹ä¸º $0$ï¼Œç„¶åæ›´æ–°ç­”æ¡ˆå³å¯ã€‚</p><p>ä»…å‰©çš„é—®é¢˜åœ¨äºå¦‚ä½•å¿«é€Ÿæ±‚å‡ºå‰ $x$ æ¡è·¯å¾„çš„äº¤ã€‚è¿™é‡Œä»‹ç»ä¸€ç§ <a href="https://tth37.cn">tth37</a> ç®—æ³•ã€‚ï¼ˆå¼€å§‹å£èƒ¡ï¼‰</p><blockquote><p>å¼•ç†ï¼šè·¯å¾„ $p(u1,v1)$ ä¸ $p(u2,v2)$ å¦‚æœå­˜åœ¨äº¤ï¼Œåˆ™è·¯å¾„çš„äº¤çš„ç«¯ç‚¹ä¸€å®šä¸º $lca(u1,u2),lca(u1,v2),lca(v1,u2),lca(v1,v2)$ ä¸­åŒæ—¶å±äºä¸¤æ¡è·¯å¾„çš„æœ€è¿œç‚¹å¯¹ã€‚</p></blockquote><p>å°šæœªè¯æ˜ã€‚æœªå®Œå¾…ç»­ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problem/P2680&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¯æ˜åŠä¼˜åŒ–æ ‘ä¸Šè·¯å¾„æ±‚äº¤ç®—æ³•å å°†ä¼šåœ¨æ´›è°·åšå®¢ä¸Šå‘å¸ƒ&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="å€å¢" scheme="https://tth37.cn/tags/%E5%80%8D%E5%A2%9E/"/>
    
      <category term="æœ€è¿‘å…¬å…±ç¥–å…ˆ" scheme="https://tth37.cn/tags/%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p1941é£æ‰¬çš„å°é¸Ÿ</title>
    <link href="https://tth37.cn/2019/09/19/solution-luogu-p1941/"/>
    <id>https://tth37.cn/2019/09/19/solution-luogu-p1941/</id>
    <published>2019-09-19T14:57:50.000Z</published>
    <updated>2019-09-19T15:19:00.208Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problem/P1941" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>ç»™å®š $n*m$ çš„æ¸¸æˆç•Œé¢ï¼Œæ±‚æ˜¯å¦å¯ä»¥é€šè¿‡æ“ä½œä½¿å°é¸Ÿé€šè¿‡æ‰€æœ‰ç®¡é“ä»¥åŠæœ€å°‘æ“ä½œæ¬¡æ•°ã€‚</p><p>$n\le 10000,m\le 1000$</p></blockquote><a id="more"></a><p>è¿™ç¯‡åšå®¢ä¸ä¼šåœ¨æ´›è°·å‘è¡¨ï¼Œæ‰€ä»¥å†…å®¹å¯èƒ½æ¯”è¾ƒæ”¾é£è‡ªæˆ‘ã€‚</p><p>ç¥ä»™shiwtå·¨ä½¬æ—©åœ¨å»å¹´çš„è¿™ä¸ªæ—¶å€™å°±å·²ç»åˆ‡æ‰äº†è¿™ä¸ªç¥ä»™é¢˜ã€‚</p><p>è®° $f[i][j]$ è¡¨ç¤ºä»èµ·ç‚¹é£åˆ°åæ ‡ $(i,j)$ æ‰€éœ€çš„æœ€å°æ­¥æ•°ã€‚è€ƒè™‘ $f[i][j]$ çš„è½¬ç§»ã€‚å®ƒè¦ä¹ˆæ˜¯ä» $(i-1,j+Y)$ é‚£é‡Œæ‰ä¸‹æ¥çš„ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä» $(i-1,j-kX)$ é‚£é‡Œå‡ä¸Šæ¥çš„ã€‚</p><p>è€ƒè™‘ä¼˜åŒ–ã€‚ $(i-1,j-kX)$ çš„æšä¸¾è¾ƒä¸ºå•°å—¦ï¼›ä¸éš¾å‘ç°å¦‚æœå°é¸ŸğŸ¦å¯ä»¥é£åˆ° $(i,j-X)$ ï¼Œé‚£ä¹ˆå®ƒå†é£ä¸€ä¸‹ä¸å°±åˆ° $(i,j)$ äº†å—ï¼Ÿ</p><p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">f[i][j]=\min \{f[i-1][j+Y],f[i][j-X]+1,f[i-1][j-X]+1\}</script><p>ä¸å¦¨å†™ä¸ªæ»šåŠ¨æ•°ç»„ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">10005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, K;</span><br><span class="line"><span class="keyword">int</span> X[MAXN], Y[MAXN];</span><br><span class="line"><span class="keyword">int</span> L[MAXN], R[MAXN];</span><br><span class="line"><span class="keyword">int</span> f[<span class="number">2</span>][MAXM * <span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> cnt, minn;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;N, &amp;M, &amp;K);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;X[i], &amp;Y[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> p, l, h;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;p, &amp;l, &amp;h);</span><br><span class="line">        L[p] = l, R[p] = h;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> cur = i &amp; <span class="number">1</span>;</span><br><span class="line">        minn = INF;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= M + X[i]; ++j)</span><br><span class="line">            f[cur][j] = INF;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> j = X[i]; j &lt;= M + X[i]; ++j)</span><br><span class="line">            f[cur][j] = min(f[cur][j], min(f[cur ^ <span class="number">1</span>][j - X[i]] + <span class="number">1</span>, f[cur][j - X[i]] + <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> j = M + <span class="number">1</span>; j &lt;= M + X[i]; ++j)</span><br><span class="line">            f[cur][M] = min(f[cur][M], f[cur][j]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= M - Y[i]; ++j)</span><br><span class="line">            f[cur][j] = min(f[cur][j], f[cur ^ <span class="number">1</span>][j + Y[i]]);</span><br><span class="line">        <span class="keyword">if</span> (L[i] || R[i]) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= L[i]; ++j)</span><br><span class="line">                f[cur][j] = INF;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> j = R[i]; j &lt;= M; ++j)</span><br><span class="line">                f[cur][j] = INF;</span><br><span class="line">        &#125;</span><br><span class="line">        f[cur][<span class="number">0</span>] = INF;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= M; ++j)</span><br><span class="line">            minn = min(minn, f[cur][j]);</span><br><span class="line">        <span class="keyword">if</span> (minn == INF) &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"0"</span>);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d"</span>, cnt);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cnt += L[i] || R[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"1"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, minn);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problem/P1941&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç»™å®š $n*m$ çš„æ¸¸æˆç•Œé¢ï¼Œæ±‚æ˜¯å¦å¯ä»¥é€šè¿‡æ“ä½œä½¿å°é¸Ÿé€šè¿‡æ‰€æœ‰ç®¡é“ä»¥åŠæœ€å°‘æ“ä½œæ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;$n\le 10000,m\le 1000$&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="åŠ¨æ€è§„åˆ’" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p1979åå®¹é“</title>
    <link href="https://tth37.cn/2019/09/18/solution-luogu-p1979/"/>
    <id>https://tth37.cn/2019/09/18/solution-luogu-p1979/</id>
    <published>2019-09-18T14:45:06.000Z</published>
    <updated>2019-09-18T15:30:25.567Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problem/P1979" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>ç»™å®šä¸€ä¸ª $n * m$  çš„æ£‹ç›˜ï¼Œå…± $q$ æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®åœ¨åå®¹é“æ¸¸æˆä¸­å°†ç›®æ ‡å—ç§»åŠ¨åˆ°ç›®æ ‡ä½ç½®çš„æœ€å°‘æ­¥æ•°</p><p>$n,m\le 30, q\le 300$</p></blockquote><a id="more"></a><p>æœ¬é¢˜çš„æ­£è§£æ¯”è¾ƒéš¾æƒ³ï¼Œæ­£å¸¸äººçœ‹åˆ°è¿™é¢˜å¯èƒ½éƒ½ä¼šåœ¨æœç´¢å‰ªæçš„<del>ä¸å½’</del>è·¯ä¸Šè¶Šèµ°è¶Šè¿œã€‚</p><p>å¦‚æœé‡‡ç”¨æœç´¢çš„ç­–ç•¥ï¼Œæ¯æ¬¡éœ€è¦è®°å½•ä¸‹æ£‹ç›˜çš„å®Œæ•´çŠ¶æ€ï¼ŒçŠ¶æ€æ•°é‡å’Œè½¬ç§»æ•°é‡è¿‡äºåºå¤§ï¼Œä»¥è‡´äºæ— æ³•åœ¨è§„å®šæ—¶é—´å†…æ±‚è§£ã€‚</p><p>è§‚å¯Ÿåˆ°æ£‹ç›˜ä¸­çš„ééšœç¢ä½ç½®åªå¯èƒ½æœ‰ç©ºæ ¼ã€æ™®é€šæ£‹å­æˆ–ç›®æ ‡æ£‹å­ä¸‰ç§å¯èƒ½ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€ç¡®å®šç›®æ ‡æ£‹å­å’Œç©ºæ ¼çš„ä½ç½®ï¼Œå°±å¯ä»¥å°†æ•´å¼ æ£‹ç›˜çš„çŠ¶æ€ç¡®å®šä¸‹æ¥ã€‚</p><p>æ˜¾ç„¶ï¼Œå¦‚æœæƒ³è¦æŒªåŠ¨ç›®æ ‡æ£‹å­ï¼Œåˆ™ç›®æ ‡æ£‹å­çš„ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘ä¹‹ä¸€å¿…é¡»ä¸ºç©ºæ ¼ã€‚å¯ä»¥å®šä¹‰çŠ¶æ€ä¸ºä¸‰å…ƒç»„ $(x,y,d)$ ï¼Œè¡¨ç¤ºç›®æ ‡æ£‹å­ä½äº $(x,y)$ ï¼Œå¹¶ä¸”å…¶ $d(0\le d\le 3)$ æ–¹å‘ä¸ºç©ºæ ¼ã€‚</p><p>å‡è®¾ä½äº $(x1,y1)$ çš„ç›®æ ‡æ£‹å­å‘ $d1$ æ–¹å‘ç§»åŠ¨ä¸€ä¸ªå•ä½ååˆ°è¾¾ $(x2,y2)$ ï¼Œä¸éš¾å‘ç°çŠ¶æ€ $(x1,y1,d1)$ å¯ä»¥è½¬ç§»åˆ°çŠ¶æ€ $(x2,y2,d2)$ã€‚è€Œæ­¤æ¬¡è½¬ç§»éœ€è¦çš„ä»£ä»·ï¼Œå³ä¸ºå°†ç©ºæ ¼ä»åŸå§‹ä½ç½®ç§»åŠ¨åˆ° $(x2,y2)$ çš„ $d2$ æ–¹å‘æ‰€éœ€çš„æœ€å°æ­¥æ•°ã€‚è¿™é‡Œå¯ä»¥ç”¨ bfs æ±‚è§£ã€‚ï¼ˆæ³¨æ„éšœç¢æ–¹å—å’Œ $(x2,y2)$ ä½ç½®æ˜¯ä¸å¯ä»¥ç»è¿‡çš„ï¼‰</p><p>å°†æ¯ä¸ªçŠ¶æ€ $(x,y,d)$ æŠ½è±¡ä¸ºèŠ‚ç‚¹ï¼Œå¯ä»¥è½¬ç§»çš„çŠ¶æ€ä¹‹é—´è¿ä¸€æ¡æœ‰å‘è¾¹ï¼Œè¾¹æƒå³ä¸ºè½¬ç§»çš„æœ€å°æ­¥æ•°ã€‚å¯¹äºæ¯æ¬¡è¯¢é—®ï¼Œè®¡ç®—å‡ºæŠ½è±¡åçš„å›¾ä¸­æœ€çŸ­è·¯å¾„å³å¯ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼šï¼ˆç•¥ä¸‘ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> id(x, y, d) ((x - 1) * M + y) + N * M * (d)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> v, w;</span><br><span class="line">    Edge(<span class="keyword">int</span> v, <span class="keyword">int</span> w): v(v), w(w) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;Edge&gt; G[<span class="number">35</span> * <span class="number">35</span> * <span class="number">5</span>];</span><br><span class="line"><span class="keyword">int</span> nx[] = &#123;<span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> ny[] = &#123;<span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> N, M, Q;</span><br><span class="line"><span class="keyword">int</span> h[<span class="number">35</span>][<span class="number">35</span>];</span><br><span class="line"><span class="keyword">int</span> t[<span class="number">35</span>][<span class="number">35</span>];</span><br><span class="line"><span class="keyword">bool</span> vis[<span class="number">35</span>][<span class="number">35</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getdis</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> px, <span class="keyword">int</span> py)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(t, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(t));</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">    <span class="keyword">if</span> (h[x][y] == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">queue</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; q;</span><br><span class="line">    t[x][y] = <span class="number">1</span>, vis[x][y] = <span class="number">1</span>;</span><br><span class="line">    q.push(make_pair(x, y));</span><br><span class="line">    <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">        <span class="keyword">int</span> ux = q.front().first, uy = q.front().second;</span><br><span class="line">q.pop();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> d = <span class="number">0</span>; d &lt;= <span class="number">3</span>; ++d) &#123;</span><br><span class="line"><span class="keyword">int</span> tx = ux + nx[d], ty = uy + ny[d];</span><br><span class="line"><span class="keyword">if</span> (tx &lt; <span class="number">1</span> || tx &gt; N || ty &lt; <span class="number">1</span> || ty &gt; M) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (tx == px &amp;&amp; ty == py) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (h[tx][ty] == <span class="number">0</span> || vis[tx][ty]) <span class="keyword">continue</span>;</span><br><span class="line">t[tx][ty] = t[ux][uy] + <span class="number">1</span>;</span><br><span class="line">q.push(make_pair(tx, ty));</span><br><span class="line">vis[tx][ty] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">G[u].push_back(Edge(v, w));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> v[<span class="number">35</span> * <span class="number">35</span> * <span class="number">5</span>];</span><br><span class="line"><span class="keyword">int</span> d[<span class="number">35</span> * <span class="number">35</span> * <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Dijkstra</span><span class="params">(<span class="keyword">int</span> S)</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span>(v, <span class="number">0</span>, <span class="keyword">sizeof</span>(v));</span><br><span class="line"><span class="built_in">memset</span>(d, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(d));</span><br><span class="line">d[S] = <span class="number">0</span>;</span><br><span class="line">priority_queue&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; q;</span><br><span class="line">q.push(make_pair(<span class="number">0</span>, S));</span><br><span class="line"><span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line"><span class="keyword">int</span> u = q.top().second;</span><br><span class="line">q.pop();</span><br><span class="line"><span class="keyword">if</span> (v[u]) <span class="keyword">continue</span>;</span><br><span class="line">v[u] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">vector</span>&lt;Edge&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line"><span class="keyword">int</span> v = it-&gt;v, w = it-&gt;w;</span><br><span class="line"><span class="keyword">if</span> (d[u] + w &lt; d[v]) &#123;</span><br><span class="line">d[v] = d[u] + w;</span><br><span class="line">q.push(make_pair(-d[v], v));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;N, &amp;M, &amp;Q);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; ++j)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;h[i][j]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">1</span>; x &lt;= N; ++x) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">1</span>; y &lt;= M; ++y) &#123;</span><br><span class="line"><span class="keyword">if</span> (h[x][y] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> d = <span class="number">0</span>; d &lt;= <span class="number">3</span>; ++d) &#123;</span><br><span class="line"><span class="keyword">int</span> tx = x + nx[d], ty = y + ny[d];</span><br><span class="line"><span class="keyword">if</span> (tx &lt; <span class="number">1</span> || tx &gt; N || ty &lt; <span class="number">1</span> || ty &gt; M) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (h[tx][ty] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">getdis(x, y, tx, ty);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> d2 = <span class="number">0</span>; d2 &lt;= <span class="number">3</span>; ++d2) &#123;</span><br><span class="line"><span class="keyword">int</span> tx2 = tx + nx[d2], ty2 = ty + ny[d2];</span><br><span class="line"><span class="keyword">if</span> (tx2 &lt; <span class="number">1</span> || tx2 &gt; N || ty2 &lt; <span class="number">1</span> || ty2 &gt; M) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (t[tx2][ty2] &gt;= INF) <span class="keyword">continue</span>;</span><br><span class="line">AddEdge(id(x, y, d), id(tx, ty, d2), t[tx2][ty2]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (Q--) &#123;</span><br><span class="line"><span class="keyword">int</span> ex, ey, sx, sy, tx, ty;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d%d%d%d"</span>, &amp;ex, &amp;ey, &amp;sx, &amp;sy, &amp;tx, &amp;ty);</span><br><span class="line">        <span class="keyword">if</span> (sx == tx &amp;&amp; sy == ty) &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"0"</span>);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">getdis(ex, ey, sx, sy);</span><br><span class="line"><span class="keyword">int</span> ans = INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> d1 = <span class="number">0</span>; d1 &lt;= <span class="number">3</span>; ++d1) &#123;</span><br><span class="line"><span class="keyword">int</span> fx = sx + nx[d1], fy = sy + ny[d1];</span><br><span class="line"><span class="keyword">if</span> (fx &lt; <span class="number">1</span> || fx &gt; N || fy &lt; <span class="number">1</span> || fy &gt; M) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (t[fx][fy] &gt;= INF) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">int</span> cur = INF;</span><br><span class="line">Dijkstra(id(sx, sy, d1));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> d2 = <span class="number">0</span>; d2 &lt;= <span class="number">3</span>; ++d2)</span><br><span class="line">cur = min(cur, d[id(tx, ty, d2)]);</span><br><span class="line">cur += t[fx][fy] - <span class="number">1</span>;</span><br><span class="line">ans = min(ans, cur);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (ans &gt;= INF) <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problem/P1979&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ª $n * m$  çš„æ£‹ç›˜ï¼Œå…± $q$ æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®åœ¨åå®¹é“æ¸¸æˆä¸­å°†ç›®æ ‡å—ç§»åŠ¨åˆ°ç›®æ ‡ä½ç½®çš„æœ€å°‘æ­¥æ•°&lt;/p&gt;
&lt;p&gt;$n,m\le 30, q\le 300$&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="æœ€çŸ­è·¯" scheme="https://tth37.cn/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p5290æ˜¥èŠ‚åäºŒå“</title>
    <link href="https://tth37.cn/2019/09/12/solution-luogu-p5290/"/>
    <id>https://tth37.cn/2019/09/12/solution-luogu-p5290/</id>
    <published>2019-09-12T15:19:41.000Z</published>
    <updated>2019-09-12T15:46:09.121Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/P5290" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>ç»™å®šä¸€æ£µæœ‰ $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œå°†æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹åˆ†ä¸ºè‹¥å¹²ç»„ï¼Œå…¶ä¸­æ¯ä¸€ç»„ä¸­çš„ä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹ä¸èƒ½å­˜åœ¨ç¥–å…ˆ-åä»£å…³ç³»ï¼Œæ¯ä¸€ç»„çš„æƒå€¼ä¸ºè¯¥ç»„ä¸­æ‰€æœ‰èŠ‚ç‚¹æƒå€¼çš„æœ€å¤§å€¼ï¼Œæ±‚æ‰€æœ‰ç»„çš„æƒå€¼æ€»å’Œæœ€å°å€¼ã€‚</p><p>$1 \le n \le 200000$</p><p>æˆ‘æ„Ÿè°¢æˆ‘è‡ªå·±</p></blockquote><a id="more"></a><p>é¦–å…ˆè€ƒè™‘æ ‘é€€åŒ–ä¸ºé“¾çš„æƒ…å†µã€‚æ ‘æ ¹æœ€å¤šæœ‰ä¸¤æ£µå­æ ‘ï¼Œæ ‘æ ¹éœ€è¦è¢«å•ç‹¬åˆ†ä¸ºä¸€æ®µï¼Œå…¶ä½™æ®µä¸­ä¸èƒ½å‡ºç°åŒä¸€æ£µå­æ ‘å†…çš„ä¸¤ä¸ªç‚¹ã€‚</p><p>è¿™æ—¶æˆ‘ä»¬éœ€è¦å°†å·¦å­æ ‘ä¸­çš„èŠ‚ç‚¹ä¸å³å­æ ‘ä¸­çš„èŠ‚ç‚¹é…å¯¹ã€‚å¯ä»¥è¯æ˜ï¼Œå°†å·¦å­æ ‘ä¸­çš„æœ€å¤§å€¼ä¸å³å­æ ‘ä¸­çš„æœ€å¤§å€¼ã€å·¦å­æ ‘ä¸­çš„æ¬¡å¤§å€¼ä¸å³å­æ ‘ä¸­çš„æ¬¡å¤§å€¼ä»¥æ­¤ç±»æ¨ä¸¤ä¸¤é…å¯¹ï¼Œå¯ä»¥ä½¿æ‰€æœ‰æ®µçš„æƒå€¼æ€»å’Œæœ€å°ã€‚</p><p>å¦‚æ­¤ä¸€æ¥ï¼Œä¸¤æ¡é“¾å®åˆ™è¢«åˆå¹¶æˆä¸ºä¸€æ¡é“¾ã€‚åŒç†ï¼Œå¤šæ¡é“¾ä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„æ–¹å¼åˆå¹¶ä¸ºä¸€æ¡é“¾ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç»´æŠ¤æ¯ä¸ªèŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹çš„ä¸€æ¡<strong>ç­‰æ•ˆé“¾</strong>ï¼Œå¹¶ä¸”è¦æ±‚é«˜æ•ˆåœ°å°†ä¸¤æ¡é“¾åˆå¹¶ä¸ºä¸€æ¡æ–°é“¾ã€‚</p><p>ä¸éš¾çœ‹å‡ºï¼Œç”±äºæˆ‘ä»¬éœ€è¦<strong>å–æœ€å¤§å€¼</strong>çš„æ€§è´¨ï¼Œå¯ä»¥ä½¿ç”¨å †æ¥ç»´æŠ¤é“¾ä¿¡æ¯ã€‚å³ï¼Œåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šå»ºç«‹ä¸€ä¸ªå †ï¼Œå †ä¸­å­˜å‚¨ä»å½“å‰èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹çš„ç­‰æ•ˆé“¾ä¸Šæ‰€æœ‰æƒå€¼ä¿¡æ¯ã€‚</p><p>æ¥ä¸‹æ¥éœ€è¦è§£å†³çš„å³ä¸ºé“¾çš„åˆå¹¶å³<strong>å †çš„åˆå¹¶</strong>é—®é¢˜ã€‚å‡è®¾éœ€è¦åˆå¹¶å † $q1$ ï¼Œ$q2$ ã€‚</p><p>å¦‚æœ $q1.size()&gt;q2.size()$ï¼Œé‚£ä¹ˆåªéœ€å–å‡º $q1$ çš„å‰ $q2.size()$ é¡¹ï¼Œå¹¶å°†å®ƒä»¬ä¸ $q2$ ä¸­çš„æ‰€æœ‰å…ƒç´ å–æœ€å¤§å€¼å³å¯ã€‚æ—¶é—´å¤æ‚åº¦ $O(q2.size()\log q2.size())$ ã€‚</p><p>å¦‚æœ $q1.size()&lt;q2.size()$ï¼Œé‚£ä¹ˆä¸ä»…éœ€è¦å–å‡º $q1$ çš„æ‰€æœ‰é¡¹ï¼Œå¹¶å°†å®ƒä»¬ä¸ $q2$ ä¸­çš„å‰ $q1.size()$ é¡¹å–æœ€å¤§å€¼ï¼Œè¿˜éœ€å°† $q2$ ä¸­å‰©ä½™çš„å…ƒç´ æ’å…¥ $q1$ ä¸­ã€‚æ—¶é—´å¤æ‚åº¦ $O(q2.size()\log q2.size())$ ã€‚</p><p>ä¸éš¾çœ‹å‡ºï¼Œå°†å¤§å †åˆå¹¶è¿›å…¥å°å †ï¼Œæ—¶é—´å¤æ‚åº¦åœ¨ $O(max(q1.size(),q2.size()))$ çº§åˆ«ã€‚ä½†å¦‚æœæ¢ä¸€ç§æ€è·¯ï¼Œå°†å°å †åˆå¹¶è¿›å…¥å¤§å †ï¼Œæ—¶é—´å¤æ‚åº¦å°±é™åˆ° $O(min(q1.size(),q2.size()))$ çº§åˆ«ã€‚æ­¤æ–¹æ³•ä¸å¹¶æŸ¥é›†çš„æŒ‰ç§©åˆå¹¶æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Œè¢«æˆä¸º<strong>å¯å‘å¼åˆå¹¶</strong>ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[<span class="number">200005</span>];</span><br><span class="line"><span class="keyword">int</span> M[<span class="number">200005</span>];</span><br><span class="line">priority_queue&lt;<span class="keyword">int</span>&gt; q[<span class="number">200005</span>];</span><br><span class="line"><span class="keyword">int</span> tmp[<span class="number">200005</span>], cnt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = *it;</span><br><span class="line">        dfs(v);</span><br><span class="line">        cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (q[u].size() &lt; q[v].size()) swap(q[u], q[v]);</span><br><span class="line">        <span class="keyword">while</span>(q[v].size()) &#123;</span><br><span class="line">            tmp[++cnt] = max(q[u].top(), q[v].top());</span><br><span class="line">            q[u].pop(), q[v].pop();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; ++i)</span><br><span class="line">            q[u].push(tmp[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    q[u].push(M[u]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;M[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> f;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;f);</span><br><span class="line">        G[f].push_back(i);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>);</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (q[<span class="number">1</span>].size()) ans += q[<span class="number">1</span>].top(), q[<span class="number">1</span>].pop();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/P5290&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç»™å®šä¸€æ£µæœ‰ $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œå°†æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹åˆ†ä¸ºè‹¥å¹²ç»„ï¼Œå…¶ä¸­æ¯ä¸€ç»„ä¸­çš„ä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹ä¸èƒ½å­˜åœ¨ç¥–å…ˆ-åä»£å…³ç³»ï¼Œæ¯ä¸€ç»„çš„æƒå€¼ä¸ºè¯¥ç»„ä¸­æ‰€æœ‰èŠ‚ç‚¹æƒå€¼çš„æœ€å¤§å€¼ï¼Œæ±‚æ‰€æœ‰ç»„çš„æƒå€¼æ€»å’Œæœ€å°å€¼ã€‚&lt;/p&gt;
&lt;p&gt;$1 \le n \le 200000$&lt;/p&gt;
&lt;p&gt;æˆ‘æ„Ÿè°¢æˆ‘è‡ªå·±&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="å¯å‘å¼åˆå¹¶" scheme="https://tth37.cn/tags/%E5%90%AF%E5%8F%91%E5%BC%8F%E5%90%88%E5%B9%B6/"/>
    
      <category term="å †" scheme="https://tth37.cn/tags/%E5%A0%86/"/>
    
  </entry>
  
  <entry>
    <title>ç®—æ³•å­¦ä¹ -ç‚¹åˆ†æ²»&amp;åŠ¨æ€ç‚¹åˆ†æ²»</title>
    <link href="https://tth37.cn/2019/09/11/algorithm-treedivide/"/>
    <id>https://tth37.cn/2019/09/11/algorithm-treedivide/</id>
    <published>2019-09-11T14:49:52.000Z</published>
    <updated>2019-09-11T14:56:54.783Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç‚¹åˆ†æ²»"><a href="#ç‚¹åˆ†æ²»" class="headerlink" title="ç‚¹åˆ†æ²»"></a>ç‚¹åˆ†æ²»</h2><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>ç‚¹åˆ†æ²»é€‚åˆå¤„ç†å¤§è§„æ¨¡çš„æ ‘ä¸Šè·¯å¾„ä¿¡æ¯é—®é¢˜ã€‚</p><p>ç‚¹åˆ†æ²»çš„å®ç°åŸºäºä»¥ä¸‹ç»“è®ºï¼šä¸€æ£µå­æ ‘ä¸Šçš„ä»»æ„ä¸€æ¡è·¯å¾„ï¼Œè¦ä¹ˆç»è¿‡æ ‘æ ¹ï¼Œè¦ä¹ˆè¢«å®Œå…¨åŒ…å«åœ¨æ ‘æ ¹çš„ä¸€æ£µå­æ ‘ä¸­ã€‚</p><p>å®šä¹‰ $solve()$ å‡½æ•°ï¼Œå¯¹æ¯æ£µå­æ ‘è¿›è¡Œåˆ†å€¼å¤„ç†ï¼Œå¹¶ä¿è¯ $O(n\log n)$ çš„æ—¶é—´å¤æ‚åº¦ã€‚</p><a id="more"></a><h3 id="æ¨¡æ¿"><a href="#æ¨¡æ¿" class="headerlink" title="æ¨¡æ¿"></a>æ¨¡æ¿</h3><p>è¿™ä¹ˆç®€å•è¿˜è¦æ¨¡æ¿ï¼Ÿ</p><h2 id="åŠ¨æ€ç‚¹åˆ†æ²»ï¼ˆç‚¹åˆ†æ ‘ï¼‰"><a href="#åŠ¨æ€ç‚¹åˆ†æ²»ï¼ˆç‚¹åˆ†æ ‘ï¼‰" class="headerlink" title="åŠ¨æ€ç‚¹åˆ†æ²»ï¼ˆç‚¹åˆ†æ ‘ï¼‰"></a>åŠ¨æ€ç‚¹åˆ†æ²»ï¼ˆç‚¹åˆ†æ ‘ï¼‰</h2><h3 id="æ¦‚è¿°-1"><a href="#æ¦‚è¿°-1" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>åœ¨æ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šå»ºç«‹æ•°æ®ç»“æ„ï¼Œå­˜å‚¨å…¶æ§åˆ¶èŒƒå›´å†…æ‰€æœ‰ç‚¹ä¸ä¹‹çš„è·ç¦»ä¿¡æ¯ã€‚åœ¨è¿›è¡Œä¿®æ”¹æˆ–æŸ¥è¯¢æ“ä½œæ—¶ï¼Œåªéœ€è®¿é—®å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰ç¥–å…ˆï¼ˆæœ€å¤š $O(\log n)$ ä¸ªï¼‰å³å¯ã€‚</p><h3 id="æ¨¡æ¿-1"><a href="#æ¨¡æ¿-1" class="headerlink" title="æ¨¡æ¿"></a>æ¨¡æ¿</h3><p>ä»£ç è¿‡äºæ¯’ç˜¤ ä¸è´´äº†</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ç‚¹åˆ†æ²»&quot;&gt;&lt;a href=&quot;#ç‚¹åˆ†æ²»&quot; class=&quot;headerlink&quot; title=&quot;ç‚¹åˆ†æ²»&quot;&gt;&lt;/a&gt;ç‚¹åˆ†æ²»&lt;/h2&gt;&lt;h3 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h3&gt;&lt;p&gt;ç‚¹åˆ†æ²»é€‚åˆå¤„ç†å¤§è§„æ¨¡çš„æ ‘ä¸Šè·¯å¾„ä¿¡æ¯é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ç‚¹åˆ†æ²»çš„å®ç°åŸºäºä»¥ä¸‹ç»“è®ºï¼šä¸€æ£µå­æ ‘ä¸Šçš„ä»»æ„ä¸€æ¡è·¯å¾„ï¼Œè¦ä¹ˆç»è¿‡æ ‘æ ¹ï¼Œè¦ä¹ˆè¢«å®Œå…¨åŒ…å«åœ¨æ ‘æ ¹çš„ä¸€æ£µå­æ ‘ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;å®šä¹‰ $solve()$ å‡½æ•°ï¼Œå¯¹æ¯æ£µå­æ ‘è¿›è¡Œåˆ†å€¼å¤„ç†ï¼Œå¹¶ä¿è¯ $O(n\log n)$ çš„æ—¶é—´å¤æ‚åº¦ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç®—æ³•å­¦ä¹ " scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="ç‚¹åˆ†æ²»" scheme="https://tth37.cn/tags/%E7%82%B9%E5%88%86%E6%B2%BB/"/>
    
      <category term="åŠ¨æ€ç‚¹åˆ†æ²»" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E7%82%B9%E5%88%86%E6%B2%BB/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p1311é€‰æ‹©å®¢æ ˆ</title>
    <link href="https://tth37.cn/2019/09/09/solution-luogu-p1311/"/>
    <id>https://tth37.cn/2019/09/09/solution-luogu-p1311/</id>
    <published>2019-09-09T14:17:18.000Z</published>
    <updated>2019-09-09T16:04:10.404Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problem/P1311" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>ç°åœ¨æˆ‘éšæœº@ä¸€ä¸ªäºº è¿™ä¸ªäººå¿…é¡»å¸®æˆ‘å†™é¢˜ç›®æ¦‚æ‹¬</p><p>@gzn7264</p></blockquote><a id="more"></a><p>è¿™ç¯‡é¢˜è§£å°±ä¸åœ¨æ´›è°·åšå®¢ä¸Šå‘å¸ƒäº†ã€‚</p><p>é¦–å…ˆæšä¸¾ç‚¹å¯¹çš„å³ç«¯ç‚¹ã€‚æ˜¾è€Œæ˜“è§ï¼Œåˆæ³•çš„å·¦ç«¯ç‚¹å¿…é¡»æ»¡è¶³ï¼š</p><ol><li>å·¦ç«¯ç‚¹ä¸å³ç«¯ç‚¹é¢œè‰²ç›¸åŒ</li><li>å·¦ç«¯ç‚¹åˆ°å³ç«¯ç‚¹ä¹‹é—´å¿…é¡»å­˜åœ¨è‡³å°‘ä¸€ä¸ªå®¢æ ˆï¼Œä½¿å¾—å…¶è´¹ç”¨å°äºç­‰äº $P$</li></ol><p>ç¬¬äºŒä¸ªæ¡ä»¶æœ‰ç‚¹éº»çƒ¦ï¼Œæˆ‘ä»¬å¯ä»¥ç¨å¾®è½¬åŒ–ä¸€ä¸‹ã€‚è®° $l_i$ ä¸ºå®¢æ ˆ $i$ çš„å·¦ä¾§ç¬¬ä¸€ä¸ªè´¹ç”¨å°äºç­‰äº $P$ çš„å®¢æ ˆç¼–å·ã€‚é‚£ä¹ˆï¼Œä»¥ $i$ ä¸ºå³ç«¯ç‚¹çš„æƒ…å†µä¸‹ï¼Œå·¦ç«¯ç‚¹çš„å¯é€‰ä½ç½®å³ä¸º $1-l_i$ ç§æ‰€æœ‰é¢œè‰²ä¸å®¢æ ˆ $i$ ç›¸åŒçš„å®¢æ ˆä¸ªæ•°ã€‚</p><p> ç”±äºæœ¬é¢˜å¡ç©ºé—´ï¼Œå¿…é¡»é‡‡ç”¨æ»šåŠ¨æ•°ç»„ã€‚æ•°ç»„ $s_i$ è®°å½•é¢œè‰² $i$ çš„å‡ºç°æ¬¡æ•°ï¼Œæ•°ç»„ $c_i$ è®°å½•é¢œè‰² $i$ çš„å¯é€‰å·¦ç«¯ç‚¹ä¸ªæ•°ã€‚æ¯æ¬¡æ›´æ–°ç­”æ¡ˆæ—¶ï¼ŒåŠ ä¸Š $c_{color}$ å³å¯ã€‚</p><p>åœ¨ç¤ºä¾‹ä»£ç ä¸­ï¼Œå¯é€‰çš„å·¦ç«¯ç‚¹åŒ…æ‹¬å…¶æœ¬èº«ï¼Œå› æ­¤å½“ $money\le P$ æ—¶å­˜åœ¨é‡å¤è®¡ç®—ï¼Œç­”æ¡ˆå‡ä¸€ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans;</span><br><span class="line"><span class="keyword">int</span> N, K, P;</span><br><span class="line"><span class="keyword">int</span> c[<span class="number">50</span>], s[<span class="number">50</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;N, &amp;K, &amp;P);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> color, money;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;color, &amp;money);</span><br><span class="line">        s[color]++;</span><br><span class="line">        <span class="keyword">if</span> (money &lt;= P)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; ++j)</span><br><span class="line">                c[j] = s[j];</span><br><span class="line">        ans += c[color] - (money &lt;= P);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%I64d"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problem/P1311&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç°åœ¨æˆ‘éšæœº@ä¸€ä¸ªäºº è¿™ä¸ªäººå¿…é¡»å¸®æˆ‘å†™é¢˜ç›®æ¦‚æ‹¬&lt;/p&gt;
&lt;p&gt;@gzn7264&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="å‰ç¼€å’Œ" scheme="https://tth37.cn/tags/%E5%89%8D%E7%BC%80%E5%92%8C/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p2495æ¶ˆè€—æˆ˜</title>
    <link href="https://tth37.cn/2019/08/30/solution-luogu-p2495/"/>
    <id>https://tth37.cn/2019/08/30/solution-luogu-p2495/</id>
    <published>2019-08-30T13:58:48.000Z</published>
    <updated>2019-08-30T14:58:40.135Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problem/P2495" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>ç°åœ¨æˆ‘éšæœº@ä¸€ä¸ªäºº è¿™ä¸ªäººå¿…é¡»å¸®æˆ‘å†™é¢˜ç›®æ¦‚æ‹¬</p><p>@xj</p></blockquote><a id="more"></a><p>è¿™æ˜¯ä¸€ç¯‡è™šæ ‘å…¥é—¨é¢˜è§£ã€‚</p><p>è€ƒè™‘é¢˜ç›®ä¸­ $m=1$ çš„æƒ…å†µã€‚æ ‘ä¸ŠåŠ¨è§„ï¼Œå®šä¹‰çŠ¶æ€ $f[u]$ è¡¨ç¤ºåˆ‡æ–­èŠ‚ç‚¹ $u$ ä¸è¯¥å­æ ‘å†…æ‰€æœ‰å…³é”®ç‚¹çš„è·¯å¾„ï¼Œæœ€å°æ€»ä»£ä»·ã€‚çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">f[u]=\begin{equation}\begin{cases}w(u,v) \ \texttt{if h[v]=1} \\\min(w(u,v),f[v])\  \texttt{if h[v]=0}\end{cases}\end{equation}</script><p>åŠ¨æ€è§„åˆ’éƒ¨åˆ†ä¸å†èµ˜è¿°ã€‚è¯¥ç®—æ³•å¤æ‚åº¦ä¸º $O(n)$ ã€‚</p><p>è€ƒè™‘é¢˜ç›®ä¸­ $m\not= 1$ çš„æƒ…å†µã€‚å¦‚æœå¯¹äºæ¯ä¸€æ¬¡æŸ¥è¯¢ï¼Œéƒ½è¿›è¡Œä¸€æ¬¡ $O(n)$ å¤æ‚åº¦çš„éå†æ˜¾ç„¶æ— æ³•æ¥å—ã€‚è§‚å¯Ÿåˆ°é¢˜ç›®ä¸­ $\Sigma{k}$ çš„å–å€¼ä¸å¤§ï¼Œå¯ä»¥è€ƒè™‘é’ˆå¯¹æ²¡ä¸ªè¯¢é—®ï¼Œ<strong>èˆå¼ƒæ ‘ä¸Šçš„ä¸€äº›éå…³é”®ç‚¹ï¼Œä»…ä¿ç•™ä¸€æ£µåŒ…å«åŸæ ‘ä¸Šéƒ¨åˆ†èŠ‚ç‚¹çš„è™šæ ‘</strong>ï¼Œå¹¶åœ¨<strong>è™šæ ‘</strong>ä¸Šè¿›è¡ŒåŠ¨æ€è§„åˆ’ã€‚</p><p>é‚£ä¹ˆï¼Œåœ¨è™šæ ‘ä¸Šåº”è¯¥ä¿ç•™åŸæ ‘ä¸Šçš„å“ªäº›ç‚¹å‘¢ï¼Ÿ</p><p>é¦–å…ˆï¼Œæ¯æ¬¡è®¯é—®ä¸­ç»™å‡ºçš„ $k$ ä¸ªå…³é”®ç‚¹ï¼ˆèµ„æºä¸°å¯Œçš„å²›å±¿ï¼‰æ˜¾ç„¶åº”è¯¥åŒ…å«åœ¨è™šæ ‘ä¸­ã€‚å…¶æ¬¡ï¼Œä»»æ„ä¸¤ä¸ªå…³é”®ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆä¹Ÿåº”è¯¥åŒ…å«åœ¨è™šæ ‘ä¸­ï¼›å› ä¸ºåœ¨æœ¬é¢˜ä¸­ï¼Œåˆ‡æ–­ä¸€æ¡è¾¹å¯ä»¥åŒæ—¶åˆ‡æ–­æ ¹èŠ‚ç‚¹ä¸å¤šä¸ªå…³é”®ç‚¹é—´çš„è·¯å¾„ï¼Œæœ€è¿‘å…¬å…±ç¥–å…ˆçš„å­˜åœ¨ä¸ºåŠ¨æ€è§„åˆ’æä¾›äº†è¿™ç§çŠ¶æ€è½¬ç§»ã€‚æœ€åä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬å¯ä»¥å°† $1$ å·èŠ‚ç‚¹ï¼ˆå³æ ¹èŠ‚ç‚¹ï¼‰ä¹ŸåŠ å…¥åˆ°è™šæ ‘ä¸­ã€‚</p><p>æ„é€ è™šæ ‘çš„æ–¹æ³•å¾ˆå¤šï¼Œåœ¨è¿™é‡Œä»‹ç»ä¸€ç§ç”¨<strong>æ ˆ</strong>å»ºæ ‘çš„ç®—æ³•æµç¨‹ã€‚</p><p>ä»¤ $1$ å·èŠ‚ç‚¹ä¸ºè™šæ ‘çš„æ ¹ã€‚</p><p>å°†æ‰€æœ‰å…³é”®ç‚¹æŒ‰ç…§å…¶åœ¨åŸæ ‘ä¸­çš„ dfs åºå‡åºæ’åºã€‚å‡è®¾å½“å‰æ­£åœ¨å¤„ç†çš„å…³é”®ç‚¹ä¸º $u$ ã€‚</p><p>ç»´æŠ¤ä¸€ä¸ªæ ˆï¼Œä½¿å¾—æ ˆåº•åˆ°æ ˆé¡¶çš„å…ƒç´ ä¾æ¬¡ä¸ºè™šæ ‘ä¸Š<strong>ä»æ ¹èŠ‚ç‚¹åˆ°èŠ‚ç‚¹ $u$ çš„ä¸€æ¡é“¾</strong>ã€‚</p><p>è¿™é‡Œä¸ºä»€ä¹ˆè¦ç»´æŠ¤ä¸€ä¸ªæ ˆå‘¢ï¼Ÿ</p><p><img src="https://i.loli.net/2019/08/30/qTkLb1Wca4yvwJ9.jpg" alt="1.jpg"></p><p>å¦‚å›¾ï¼šåœ¨å¤„ç†å®Œ $3$ å·å…³é”®ç‚¹åï¼Œè™šæ ‘ä¸­åªæœ‰ $1$ ã€ $3$ ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œæ ˆä¸­çš„å…ƒç´ ä¾æ¬¡ä¸º $1$ ã€ $3$ ã€‚ä½†æ˜¯è¿™æ¡é“¾æ˜¯ä¸å®Œæ•´çš„ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°åœ¨å¤„ç† $4$ å·å…³é”®ç‚¹æ—¶ï¼Œè¿˜éœ€è¦å°† $2$ å·èŠ‚ç‚¹æ·»åŠ åˆ°è™šæ ‘ä¸­ã€‚åˆ©ç”¨æ ˆçš„æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥åŠ¨æ€ç»´æŠ¤ä¸€æ¡è™šæ ‘ä¸Šçš„é“¾ï¼Œå¹¶åœ¨å¿…è¦çš„æ—¶å€™æ·»åŠ èŠ‚ç‚¹ã€‚</p><p>å›åˆ°åˆšæ‰çš„å™è¿°ï¼Œå½“å‰æ­£åœ¨å¤„ç†å…³é”®ç‚¹ $u$ ã€‚æ ¹æ®æ ˆçš„å®šä¹‰ï¼Œä¸Šä¸€ä¸ªå¤„ç†çš„å…³é”®ç‚¹ä¸€å®šä¸º $stack.top()$ ã€‚</p><p>ç”±äºè¿›è¡Œè¿‡æ’åºï¼Œå³èŠ‚ç‚¹ $u$  çš„ dfs åºå¤§äºä¸Šä¸€ä¸ªå…³é”®ç‚¹çš„ dfs åºï¼Œå› æ­¤èŠ‚ç‚¹ $u$ è¦ä¹ˆæ˜¯ä¸Šä¸€ä¸ªå…³é”®ç‚¹çš„åä»£ï¼Œè¦ä¹ˆä¸å…¶æ²¡æœ‰ç¥–å…ˆ-åä»£çš„å…³ç³»ã€‚</p><p>æ˜¾ç„¶ï¼Œå¦‚æœèŠ‚ç‚¹ $u$ æ˜¯ $stack.top()$ çš„åä»£ï¼Œé‚£ä¹ˆåªéœ€å°†èŠ‚ç‚¹ $u$ å…¥æ ˆå³å¯ï¼Œå› ä¸º $u$ åœ¨è™šæ ‘ä¸­ï¼Œä¸€å®šæ˜¯ä¸Šä¸€ä¸ªå…³é”®ç‚¹çš„å„¿å­ã€‚</p><p>ä½†æ˜¯å¦‚æœèŠ‚ç‚¹ $u$ ä¸ $stack.top()$ æ²¡æœ‰ç¥–å…ˆ-åä»£çš„å…³ç³»ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„è®¨è®ºå°†æ¯”è¾ƒå¤æ‚ã€‚</p><p>å¯ä»¥ç»“åˆä¸Šå›¾è§‚å¯Ÿï¼Œå‡è®¾å½“å‰æ­£åœ¨å¤„ç† $4$ å·å…³é”®ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥é¦–å…ˆå°†æ ˆé¡¶å¼¹å‡ºï¼Œå› ä¸º $stack.top()$ ä¸€å®šä¸åœ¨æ ¹èŠ‚ç‚¹åˆ°èŠ‚ç‚¹ $u$ çš„é“¾ä¸Šã€‚æ­¤æ—¶ï¼Œæ ˆä¸­å‰©ä½™çš„å…ƒç´ åªæœ‰ $1$ ã€‚ç„¶è€Œï¼Œ $3$ ä¸ $4$ çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ $2$ å·èŠ‚ç‚¹è¿˜ä¸åœ¨æ ˆä¸­ï¼›å› æ­¤æˆ‘ä»¬éœ€è¦æŠŠ $2$ å·èŠ‚ç‚¹å…¥æ ˆï¼Œå¹¶å°†<strong>åˆšåˆšå¼¹å‡ºçš„èŠ‚ç‚¹ä¸æ–°çš„æ ˆé¡¶</strong>åœ¨è™šæ ‘ä¸­è¿è¾¹ã€‚å¤„ç†ç»“æŸåï¼Œå°† $4$ å…¥æ ˆã€‚</p><p>æ¥ä¸‹æ¥å¤„ç† $5$ å·å…³é”®ç‚¹ï¼Œæ­¤æ—¶æ ˆä¸­çš„å…ƒç´ ä¾æ¬¡ä¸º $1$ ã€$2$ ã€$4$ ã€‚é¦–å…ˆå°†æ ˆé¡¶å¼¹å‡ºï¼Œä½†ç”±äºæˆ‘ä»¬æ¥ä¸‹æ¥éœ€è¦ç»´æŠ¤çš„é“¾ä¸º $1-&gt;5$ ï¼Œæ ˆä¸­ä»ç„¶æœ‰èŠ‚ç‚¹ $2$ ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°† $2$ å’Œåˆšåˆšå¼¹å‡ºçš„èŠ‚ç‚¹ $4$ è¿è¾¹ï¼Œå¹¶ä¸”é‡å¤ä»¥ä¸Šæ“ä½œã€‚å°†æ–°çš„æ ˆé¡¶ $2$ å¼¹å‡ºåï¼Œæ ˆä¸­åªå‰©ä¸‹èŠ‚ç‚¹ $1$ ã€‚è¿™æ—¶å‘ç° $1$ å·èŠ‚ç‚¹æ°å¥½ä¸º $5$ ä¸ä¸Šä¸€æ¬¡å¤„ç†çš„å…³é”®ç‚¹ $4$ çš„æœ€è¿‘å…¬å…±ç¥–å…ˆï¼Œå› æ­¤å°† $1$ ä¸ $2$ è¿è¾¹åï¼Œå¼¹æ ˆå¯ä»¥ä¸­æ­¢äº†ã€‚å¤„ç†ç»“æŸåï¼Œå°† $5$ å…¥æ ˆã€‚</p><p>æ­¤æ—¶æˆ‘ä»¬å·²ç»å¤„ç†å®Œäº†æ‰€æœ‰å…³é”®ç‚¹ï¼Œä½†æ˜¯æ ˆä¸­çš„å…ƒç´ é—´è¿˜æ²¡æœ‰è¿è¾¹ã€‚å°†æ ˆä¸­çš„èŠ‚ç‚¹ä¾æ¬¡è¿è¾¹åï¼Œè™šæ ‘çš„æ„å»ºå°±å®Œæˆäº†ã€‚</p><p>ä¼ªä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">å°†å…³é”®ç‚¹æŒ‰ç…§ dfs åºæ’åº</span><br><span class="line">stack.push(1)</span><br><span class="line">for u = 1 ~ k: // å‡è®¾å½“å‰æ­£åœ¨å¤„ç†èŠ‚ç‚¹ u</span><br><span class="line">lca = Lca(u, stack.top())</span><br><span class="line">while stack.top() != lca:</span><br><span class="line">tmp = stack.top()</span><br><span class="line">stack.pop()</span><br><span class="line">if dfn[stack.top()] &lt; dfn[lca]</span><br><span class="line">stack.push(lca)</span><br><span class="line">AddEdge(stack.top(), tmp)</span><br><span class="line">stack.push(u)</span><br><span class="line">while stack.top() != 1:</span><br><span class="line">tmp = stack.top()</span><br><span class="line">stack.pop()</span><br><span class="line">AddEdge(stack.top(), tmp)</span><br></pre></td></tr></table></figure><p>å¯ä»¥è¯æ˜ï¼Œå¯¹äºæœ¬é¢˜ï¼Œè™šæ ‘ä¸Šçš„è¾¹æƒä¸€å®šå¯¹åº”åŸæ ‘ä¸Šä¸¤èŠ‚ç‚¹ä¹‹é—´è¾¹æƒçš„æœ€å°å€¼ã€‚è¯æ˜ä¸å†èµ˜è¿°ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span><span class="keyword">int</span> v;ll w;Edge(<span class="keyword">int</span> a, ll b) &#123;v = a, w = b;&#125;&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Key</span> &#123;</span><span class="keyword">int</span> u, dfn;&#125;keys[<span class="number">250005</span>];</span><br><span class="line"><span class="keyword">int</span> keys_cnt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(Key a, Key b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.dfn &lt; b.dfn;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="built_in">vector</span>&lt;Edge&gt; G[<span class="number">250005</span>], VT[<span class="number">250005</span>];</span><br><span class="line"><span class="keyword">int</span> f[<span class="number">250005</span>][<span class="number">19</span>], g[<span class="number">250005</span>][<span class="number">19</span>], dep[<span class="number">250005</span>];</span><br><span class="line">ll d[<span class="number">250005</span>];</span><br><span class="line"><span class="keyword">bool</span> h[<span class="number">250005</span>];</span><br><span class="line"><span class="keyword">int</span> dfn[<span class="number">250005</span>], dfn_idx;</span><br><span class="line"><span class="keyword">int</span> lg[<span class="number">250005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa, ll w)</span> </span>&#123;</span><br><span class="line">    dep[u] = dep[fa] + <span class="number">1</span>;</span><br><span class="line">    dfn[u] = ++dfn_idx;</span><br><span class="line">    f[u][<span class="number">0</span>] = fa, g[u][<span class="number">0</span>] = w;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">18</span>; ++i)</span><br><span class="line">        f[u][i] = f[f[u][i - <span class="number">1</span>]][i - <span class="number">1</span>],</span><br><span class="line">        g[u][i] = min(g[f[u][i - <span class="number">1</span>]][i - <span class="number">1</span>], g[u][i - <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;Edge&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = it -&gt; v;</span><br><span class="line">        ll w = it -&gt; w;</span><br><span class="line">        <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(v, u, w);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;Edge&gt;::iterator it = VT[u].begin(); it != VT[u].end(); it++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = it -&gt; v;</span><br><span class="line">        ll w = it -&gt; w;</span><br><span class="line">        dp(v);</span><br><span class="line">        <span class="keyword">if</span> (h[v]) d[u] += w;</span><br><span class="line">        <span class="keyword">else</span> d[u] += min(w, d[v]);</span><br><span class="line">        h[v] = <span class="number">0</span>; d[v] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    VT[u].clear();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v]) swap(u, v);</span><br><span class="line">    <span class="keyword">while</span> (dep[u] &gt; dep[v]) &#123;</span><br><span class="line">        u = f[u][lg[dep[u] - dep[v]]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (u == v) <span class="keyword">return</span> u;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lg[dep[u]]; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">        <span class="keyword">if</span> (f[u][i] != f[v][i])</span><br><span class="line">            u = f[u][i], v = f[v][i];</span><br><span class="line">    <span class="keyword">return</span> f[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">while</span> (dep[u] &gt; dep[v]) &#123;</span><br><span class="line">        ans = min(ans, g[u][lg[dep[u] - dep[v]]]);</span><br><span class="line">        u = f[u][lg[dep[u] - dep[v]]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> w = query(v, u);</span><br><span class="line">    VT[u].push_back(Edge(v, w));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= <span class="number">250000</span>; ++i)</span><br><span class="line">        lg[i] = lg[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">memset</span>(g, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(g));</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> u, v;</span><br><span class="line">        ll w;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%lld"</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">        G[u].push_back(Edge(v, w));</span><br><span class="line">        G[v].push_back(Edge(u, w));</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;M);</span><br><span class="line">    <span class="keyword">while</span> (M--) &#123;</span><br><span class="line">        <span class="keyword">int</span> k;</span><br><span class="line">        keys_cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;k);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;keys[++keys_cnt].u);</span><br><span class="line">            h[keys[keys_cnt].u] = <span class="number">1</span>;</span><br><span class="line">            keys[keys_cnt].dfn = dfn[keys[keys_cnt].u];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; s;</span><br><span class="line">        sort(keys + <span class="number">1</span>, keys + keys_cnt + <span class="number">1</span>);</span><br><span class="line">        s.push(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= keys_cnt; ++i) &#123;</span><br><span class="line">            <span class="keyword">int</span> u = keys[i].u;</span><br><span class="line">            <span class="keyword">int</span> lca = Lca(u, s.top());</span><br><span class="line">            <span class="keyword">while</span> (s.top() != lca) &#123;</span><br><span class="line">                <span class="keyword">int</span> tmp = s.top(); s.pop();</span><br><span class="line">                <span class="keyword">if</span> (dfn[s.top()] &lt; dfn[lca])</span><br><span class="line">                    s.push(lca);</span><br><span class="line">                AddEdge(s.top(), tmp);</span><br><span class="line">            &#125;</span><br><span class="line">            s.push(u);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (s.top() != <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> tmp = s.top(); s.pop();</span><br><span class="line">            AddEdge(s.top(), tmp);</span><br><span class="line">        &#125;</span><br><span class="line">        dp(<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, d[<span class="number">1</span>]);</span><br><span class="line">        d[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problem/P2495&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç°åœ¨æˆ‘éšæœº@ä¸€ä¸ªäºº è¿™ä¸ªäººå¿…é¡»å¸®æˆ‘å†™é¢˜ç›®æ¦‚æ‹¬&lt;/p&gt;
&lt;p&gt;@xj&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="æ ‘å½¢dp" scheme="https://tth37.cn/tags/%E6%A0%91%E5%BD%A2dp/"/>
    
      <category term="è™šæ ‘" scheme="https://tth37.cn/tags/%E8%99%9A%E6%A0%91/"/>
    
      <category term="æ ˆ" scheme="https://tth37.cn/tags/%E6%A0%88/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p4103å¤§å·¥ç¨‹</title>
    <link href="https://tth37.cn/2019/08/30/solution-luogu-p4103/"/>
    <id>https://tth37.cn/2019/08/30/solution-luogu-p4103/</id>
    <published>2019-08-30T12:54:26.000Z</published>
    <updated>2019-08-30T13:11:15.234Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problem/P4103" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>ç»™å®šä¸€æ£µæœ‰ $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œè¾¹æƒä¸º $1$ ã€‚å…±æœ‰ $q$ æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡ç»™å‡º $k$ ä¸ªèŠ‚ç‚¹ï¼Œæ±‚ï¼š $k$ ä¸ªèŠ‚ç‚¹é—´ä¸¤ä¸¤è·ç¦»ä¹‹æ€»å’Œï¼›æœ€çŸ­è·ç¦»ï¼›æœ€é•¿è·ç¦»ã€‚</p><p>$1\le n \le 1000000,1 \le q \le 1000000, \Sigma{k}\le 2 * n$</p><p>æ„Ÿè°¢@tth37 çš„è´¡çŒ®</p></blockquote><a id="more"></a><p>æœ¬é¢˜ç”¨åˆ°äº†ä¸€äº›ç‚¹åˆ†æ²»çš„æ€æƒ³ã€‚</p><p>è€ƒè™‘ $q=1$ çš„æƒ…å†µã€‚ä¸€ç§æœ´ç´ çš„åšæ³•æ˜¯ï¼šæšä¸¾å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œå¹¶è®¡ç®—å­æ ‘é—´å…³é”®ç‚¹å½¢æˆçš„è·¯å¾„ã€æ›´æ–°ç­”æ¡ˆã€‚ä½†æ˜¯æœ¬é¢˜ä¸ä¸€èˆ¬ç‚¹åˆ†æ²»é¢˜ç›®ç•¥æœ‰ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é¢„å¤„ç†å­æ ‘ä¿¡æ¯æ¥ä¼˜åŒ–ç‚¹åˆ†æ²»è¿‡ç¨‹ã€‚</p><p>ç¨åŠ è§‚å¯Ÿå¯ä»¥å‘ç°ï¼Œåªéœ€é¢„å¤„ç†æ¯ä¸ªå­æ ‘ä¸­æ ‘æ ¹åˆ°å…³é”®ç‚¹çš„æœ€å°è·ç¦»ã€æœ€å¤§è·ç¦»ï¼Œä»¥åŠå­æ ‘ä¸­å…³é”®ç‚¹çš„ä¸ªæ•°ã€æ‰€æœ‰å…³é”®ç‚¹åˆ°æ ‘æ ¹çš„è·ç¦»æ€»å’Œå³å¯å®Œæˆç‚¹åˆ†æ²»å…¨éƒ¨è¿‡ç¨‹ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n)$ ã€‚</p><p>å¯¹äº $q\not=1$  çš„æƒ…å†µï¼Œè§‚å¯Ÿåˆ° $\Sigma{k}$ ä¸ $n$ åŒé˜¶ï¼Œå¯ä»¥å¯¹æ¯æ¬¡æŸ¥è¯¢å»ºç«‹ä¸€æ£µè™šæ ‘ï¼Œåœ¨è™šæ ‘ä¸Šç‚¹åˆ†æ²»å³å¯ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1000005</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span><span class="keyword">int</span> v, w; Edge(<span class="keyword">int</span> a, <span class="keyword">int</span> b) &#123;v = a, w = b;&#125;&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Key</span> &#123;</span><span class="keyword">int</span> u, dfn;&#125;keys[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(Key a, Key b)</span> </span>&#123;<span class="keyword">return</span> a.dfn &lt; b.dfn;&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;Edge&gt; G[MAXN], VT[MAXN];</span><br><span class="line"><span class="keyword">int</span> N, Q, K;</span><br><span class="line"><span class="keyword">int</span> f[MAXN][<span class="number">21</span>], dep[MAXN], dfn[MAXN], dfn_idx;</span><br><span class="line"><span class="keyword">int</span> lg[MAXN];</span><br><span class="line"><span class="keyword">bool</span> h[MAXN];</span><br><span class="line">ll g[MAXN];</span><br><span class="line"><span class="keyword">int</span> m[MAXN], n[MAXN];</span><br><span class="line"><span class="keyword">int</span> c[MAXN];</span><br><span class="line">ll ans1;</span><br><span class="line"><span class="keyword">int</span> ans2, ans3;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs0</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    dfn[u] = ++dfn_idx;</span><br><span class="line">    dep[u] = dep[fa] + <span class="number">1</span>;</span><br><span class="line">    f[u][<span class="number">0</span>] = fa;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= lg[dep[u]]; ++i)</span><br><span class="line">        f[u][i] = f[f[u][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;Edge&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = it -&gt; v;</span><br><span class="line">        <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs0(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    g[u] = <span class="number">0</span>;</span><br><span class="line">    c[u] = h[u];</span><br><span class="line">    m[u] = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">    n[u] = <span class="number">-0x3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">if</span> (h[u]) m[u] = n[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;Edge&gt;::iterator it = VT[u].begin(); it != VT[u].end(); it++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = it -&gt; v, w = it -&gt; w;</span><br><span class="line">        dfs1(v);</span><br><span class="line">        c[u] += c[v];</span><br><span class="line">        g[u] += g[v] + <span class="number">1l</span>l * w * c[v];</span><br><span class="line">        m[u] = min(m[u], w + m[v]);</span><br><span class="line">        n[u] = max(n[u], w + n[v]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    ll sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> cnt = h[u];</span><br><span class="line">    <span class="keyword">int</span> minn = <span class="number">0x3f3f3f3f</span>, maxx = <span class="number">-0x3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">if</span> (h[u]) minn = maxx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;Edge&gt;::iterator it = VT[u].begin(); it != VT[u].end(); it++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = it -&gt; v, w = it -&gt; w;</span><br><span class="line">        ans1 += <span class="number">1l</span>l * sum * c[v] + <span class="number">1l</span>l * w * cnt * c[v] + <span class="number">1l</span>l * g[v] * cnt;</span><br><span class="line">        ans2 = min(ans2, minn + w + m[v]);</span><br><span class="line">        ans3 = max(ans3, maxx + w + n[v]);</span><br><span class="line">        sum += g[v] + <span class="number">1l</span>l * c[v] * w;</span><br><span class="line">        cnt += c[v];</span><br><span class="line">        minn = min(minn, w + m[v]);</span><br><span class="line">        maxx = max(maxx, w + n[v]);</span><br><span class="line">        dfs2(v);</span><br><span class="line">    &#125;</span><br><span class="line">    h[u] = <span class="number">0</span>;</span><br><span class="line">    VT[u].clear();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v]) swap(u, v);</span><br><span class="line">    <span class="keyword">while</span> (dep[u] &gt; dep[v]) u = f[u][lg[dep[u] - dep[v]]];</span><br><span class="line">    <span class="keyword">if</span> (u == v) <span class="keyword">return</span> u;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lg[dep[u]]; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (f[u][i] != f[v][i]) u = f[u][i], v = f[v][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= <span class="number">1000000</span>; ++i)</span><br><span class="line">        lg[i] = lg[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> u, v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v);</span><br><span class="line">        G[u].push_back(Edge(v, <span class="number">1</span>));</span><br><span class="line">        G[v].push_back(Edge(u, <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    dfs0(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;Q);</span><br><span class="line">    <span class="keyword">while</span> (Q--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;K);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; ++i) &#123;</span><br><span class="line">            <span class="keyword">int</span> u;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;u);</span><br><span class="line">            h[u] = <span class="number">1</span>;</span><br><span class="line">            keys[i].u = u, keys[i].dfn = dfn[u];</span><br><span class="line">        &#125;</span><br><span class="line">        sort(keys + <span class="number">1</span>, keys + K + <span class="number">1</span>, cmp);</span><br><span class="line">        <span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; s;</span><br><span class="line">        s.push(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; ++i) &#123;</span><br><span class="line">            <span class="keyword">int</span> u = keys[i].u;</span><br><span class="line">            <span class="keyword">if</span> (u == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">int</span> lca = Lca(u, s.top());</span><br><span class="line">            <span class="keyword">while</span> (s.top() != lca) &#123;</span><br><span class="line">                <span class="keyword">int</span> tmp = s.top(); s.pop();</span><br><span class="line">                <span class="keyword">if</span> (dfn[s.top()] &lt; lca) s.push(lca);</span><br><span class="line">                VT[s.top()].push_back(Edge(tmp, dep[tmp] - dep[s.top()]));</span><br><span class="line">            &#125;</span><br><span class="line">            s.push(u);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (s.top() != <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> tmp = s.top(); s.pop();</span><br><span class="line">            VT[s.top()].push_back(Edge(tmp, dep[tmp] - dep[s.top()]));</span><br><span class="line">        &#125;</span><br><span class="line">        dfs1(<span class="number">1</span>);</span><br><span class="line">        ans1 = ans3 = <span class="number">0</span>;</span><br><span class="line">        ans2 = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">        dfs2(<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld %d %d\n"</span>, ans1, ans2, ans3);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problem/P4103&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç»™å®šä¸€æ£µæœ‰ $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œè¾¹æƒä¸º $1$ ã€‚å…±æœ‰ $q$ æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡ç»™å‡º $k$ ä¸ªèŠ‚ç‚¹ï¼Œæ±‚ï¼š $k$ ä¸ªèŠ‚ç‚¹é—´ä¸¤ä¸¤è·ç¦»ä¹‹æ€»å’Œï¼›æœ€çŸ­è·ç¦»ï¼›æœ€é•¿è·ç¦»ã€‚&lt;/p&gt;
&lt;p&gt;$1\le n \le 1000000,1 \le q \le 1000000, \Sigma{k}\le 2 * n$&lt;/p&gt;
&lt;p&gt;æ„Ÿè°¢@tth37 çš„è´¡çŒ®&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="æ ‘å½¢dp" scheme="https://tth37.cn/tags/%E6%A0%91%E5%BD%A2dp/"/>
    
      <category term="ç‚¹åˆ†æ²»" scheme="https://tth37.cn/tags/%E7%82%B9%E5%88%86%E6%B2%BB/"/>
    
      <category term="è™šæ ‘" scheme="https://tth37.cn/tags/%E8%99%9A%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>ç®—æ³•å­¦ä¹ -è™šæ ‘</title>
    <link href="https://tth37.cn/2019/08/29/algorithm-virtualtree/"/>
    <id>https://tth37.cn/2019/08/29/algorithm-virtualtree/</id>
    <published>2019-08-29T03:19:56.000Z</published>
    <updated>2019-08-29T03:34:48.476Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>åœ¨å¤„ç†æŸäº›æ ‘ä¸Šé—®é¢˜æ—¶ï¼Œå¹¶éæ ‘ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹éƒ½èµ·ä½œç”¨ï¼›è¿™æ—¶å¯ä»¥å€ŸåŠ©è™šæ ‘ï¼Œå°†æ ‘ä¸Šé‡è¦çš„ç‚¹æ„é€ æˆä¸€æ£µæ ‘ï¼Œåœ¨è™šæ ‘ä¸Šå¤„ç†é—®é¢˜ï¼Œä¼˜åŒ–æ—¶é—´å¤æ‚åº¦ã€‚</p><a id="more"></a><h3 id="æ¨¡æ¿"><a href="#æ¨¡æ¿" class="headerlink" title="æ¨¡æ¿"></a>æ¨¡æ¿</h3><p>ç”¨æ ˆæ¥ç»´æŠ¤è™šæ ‘ä¸Šçš„ä¸€æ¡ä»æ ¹åˆ° $u$ çš„é“¾ã€‚å¦‚æœ $u$ æ˜¯æ ˆé¡¶èŠ‚ç‚¹çš„å„¿å­ï¼Œåˆ™å…¥æ ˆï¼›å¦åˆ™å°†æ ˆä¸­ dfn å€¼å¤§äº $lca(u,s.top())$ çš„å…ƒç´ å‡ºæ ˆã€‚</p><h5 id="ä¼ªä»£ç "><a href="#ä¼ªä»£ç " class="headerlink" title="ä¼ªä»£ç "></a>ä¼ªä»£ç </h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">å°†æ ‘ä¸Šæ‰€æœ‰å…³é”®ç‚¹æŒ‰ç…§ dfs åºæ’åº</span><br><span class="line">stack.push(1)</span><br><span class="line">for u = 1 ~ n: //å‡è®¾å½“å‰æ­£åœ¨å¤„ç†èŠ‚ç‚¹ u</span><br><span class="line">lca = Lca(u, stack.top())</span><br><span class="line">while stack.top != lca:</span><br><span class="line">tmp = stack.top()</span><br><span class="line">stack.pop()</span><br><span class="line">if (dfn[stack.top()] &lt; dfn[lca]):</span><br><span class="line">stack.push(lca)</span><br><span class="line">AddEdge(stack.top(), tmp)</span><br><span class="line">stack.push(u)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h3&gt;&lt;p&gt;åœ¨å¤„ç†æŸäº›æ ‘ä¸Šé—®é¢˜æ—¶ï¼Œå¹¶éæ ‘ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹éƒ½èµ·ä½œç”¨ï¼›è¿™æ—¶å¯ä»¥å€ŸåŠ©è™šæ ‘ï¼Œå°†æ ‘ä¸Šé‡è¦çš„ç‚¹æ„é€ æˆä¸€æ£µæ ‘ï¼Œåœ¨è™šæ ‘ä¸Šå¤„ç†é—®é¢˜ï¼Œä¼˜åŒ–æ—¶é—´å¤æ‚åº¦ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç®—æ³•å­¦ä¹ " scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="è™šæ ‘" scheme="https://tth37.cn/tags/%E8%99%9A%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>ä¸­åäººæ°‘å…±å’Œå›½æˆç«‹70å‘¨å¹´</title>
    <link href="https://tth37.cn/2019/08/27/NationalDay/"/>
    <id>https://tth37.cn/2019/08/27/NationalDay/</id>
    <published>2019-08-27T13:40:39.000Z</published>
    <updated>2019-09-30T16:26:31.600Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p1314èªæ˜çš„è´¨ç›‘å‘˜</title>
    <link href="https://tth37.cn/2019/08/27/solution-luogu-p1314/"/>
    <id>https://tth37.cn/2019/08/27/solution-luogu-p1314/</id>
    <published>2019-08-27T07:49:57.000Z</published>
    <updated>2019-08-27T08:08:44.429Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problem/P1314" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>å’•å’•å’•</p></blockquote><a id="more"></a><p>æœ¬é¢˜éš¾åº¦ä¸å¤§ï¼Œç¬¬ä¸€çœ¼å°±èƒ½çœ‹å‡ºéœ€è¦ç”¨äºŒåˆ†ç­”æ¡ˆæˆ–<strong>å€å¢ç­”æ¡ˆ</strong>è§£å†³ã€‚</p><p>éœ€è¦è§£å†³çš„ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•æ ¹æ®ä¸€ä¸ªçŒœæµ‹çš„å‚æ•° $W$ ï¼Œå¿«é€Ÿè®¡ç®—å‡ºæ£€éªŒç»“æœ $Y$ ã€‚ç”±äºåªæœ‰ $w_j \ge W$ çš„çŸ¿çŸ³æ‰ä¼šå¯¹æ£€éªŒç»“æœåšå‡ºè´¡çŒ®ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°† $w_j &lt; W$ çš„çŸ¿çŸ³å¿½ç•¥å¹¶é¢„å¤„ç†å‰ç¼€å’Œï¼Œå¹¶ä¸”å›ç­” $M$ ä¸ªè¯¢é—®å³å¯ã€‚</p><p>æ¥ä¸‹æ¥åº”è¯¥è€ƒè™‘å¦‚ä½•è®¡ç®—çŒœæµ‹å€¼ $W$ ã€‚è§‚å¯Ÿåˆ° $Y(W)$ æ˜¯å•è°ƒä¸å¢çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<strong>å€å¢</strong>æ±‚å‡ºæ»¡è¶³ $Y \ge S$  çš„æœ€å¤§ $W$ å€¼ï¼Œé‚£ä¹ˆæ»¡è¶³ $Y&lt;S$ çš„æœ€å° $W$ å€¼ä¸€å®šä¸º $W+1$ ã€‚</p><p>æœ€ç»ˆç­”æ¡ˆå³ä¸º $\min\lbrace |Y(W)-S|,|Y(W+1)-S|\rbrace$ ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> N, M, ans = <span class="number">1</span>; ll S;</span><br><span class="line"><span class="keyword">int</span> w[<span class="number">200005</span>], v[<span class="number">200005</span>], l[<span class="number">200005</span>], r[<span class="number">200005</span>]; ll s1[<span class="number">200005</span>], s2[<span class="number">200005</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">Y</span><span class="params">(<span class="keyword">int</span> W)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">        s1[i] = w[i] &gt;= W ? s1[i - <span class="number">1</span>] + <span class="number">1</span> : s1[i - <span class="number">1</span>],</span><br><span class="line">        s2[i] = w[i] &gt;= W ? s2[i - <span class="number">1</span>] + v[i] : s2[i - <span class="number">1</span>];</span><br><span class="line">    ll ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i)</span><br><span class="line">        ret += (s1[r[i]] - s1[l[i] - <span class="number">1</span>]) * (s2[r[i]] - s2[l[i] - <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%lld"</span>, &amp;N, &amp;M, &amp;S);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;w[i], &amp;v[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;l[i], &amp;r[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">17</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">        ans += Y(ans + (<span class="number">1</span> &lt;&lt; i)) &gt;= S ? (<span class="number">1</span> &lt;&lt; i) : <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld"</span>, min(Y(ans) - S, S - Y(ans + <span class="number">1</span>)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problem/P1314&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å’•å’•å’•&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="äºŒåˆ†ç­”æ¡ˆ" scheme="https://tth37.cn/tags/%E4%BA%8C%E5%88%86%E7%AD%94%E6%A1%88/"/>
    
      <category term="å€å¢" scheme="https://tth37.cn/tags/%E5%80%8D%E5%A2%9E/"/>
    
      <category term="å‰ç¼€å’Œ" scheme="https://tth37.cn/tags/%E5%89%8D%E7%BC%80%E5%92%8C/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p5503ç¯å¡”</title>
    <link href="https://tth37.cn/2019/08/26/solution-luogu-p5503/"/>
    <id>https://tth37.cn/2019/08/26/solution-luogu-p5503/</id>
    <published>2019-08-26T15:29:57.000Z</published>
    <updated>2019-08-26T15:55:23.561Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problem/P5503" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>å’•å’•å’•</p></blockquote><a id="more"></a><p>ç”±äºæ ¹å·çš„å­˜åœ¨ï¼Œæœ¬é¢˜å¹¶æ²¡æœ‰ä»€ä¹ˆæ˜æ˜¾çš„å•è°ƒæ€§ï¼Œä¸èƒ½é€šè¿‡äºŒåˆ†æˆ–å•è°ƒé˜Ÿåˆ—å®ç°ã€‚</p><p>æœ¬é¢˜çš„å…³é”®åœ¨äºé—®é¢˜è½¬åŒ–ã€‚è®° $l_i$ è¡¨ç¤ºåœ¨å±±å³° $i$ ä¸Šå»ºç¯å¡”ï¼Œå¹¶ä½¿å¾—å±±å³° $1â€¦i$ å…¨éƒ¨è¢«ç…§äº®çš„æœ€å°é«˜åº¦ã€‚</p><script type="math/tex; mode=display">h_j\le h_i+l_i - \sqrt{i-j} (1\le j\le i)</script><script type="math/tex; mode=display">h_j+\sqrt{i-j}-h_i\le l_i(1\le j\le i)</script><script type="math/tex; mode=display">l_i=\max_{1\le j\le i}\lbrace  h_j+\lceil  (\sqrt{i-j})  \rceil \rbrace-h_i</script><p>è¿™æ · ${l}$ æ•°ç»„çš„æ±‚è§£å³è½¬åŒ–ä¸ºåŒºé—´æ±‚è§£æœ€å€¼é—®é¢˜ï¼Œç„¶è€Œ $\max$ å‡½æ•°ä¸­çš„ $\lceil  (\sqrt{i-j})  \rceil$ ä¼¼ä¹æœ‰äº›æ£˜æ‰‹ã€‚ç„¶è€Œè§‚å¯Ÿåˆ°å½“ $\lceil  (\sqrt{i-j})  \rceil$ ç›¸ç­‰æ—¶ï¼Œåªæœ‰è¯¥åŒºé—´å†…æœ€å¤§çš„ $h_j$ æ‰ä¼šå¯¹ç­”æ¡ˆäº§ç”Ÿè´¡çŒ®ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥æšä¸¾ $\lceil  (\sqrt{i-j})  \rceil$ çš„å€¼ï¼Œæ±‚å‡ºå¯¹åº”çš„ $j$ åŒºé—´å†… $h_j$ çš„æœ€å€¼ä½œä¸º $l_i$ çš„å€™é€‰ç­”æ¡ˆã€‚</p><p>$r_i$ çš„å®šä¹‰ä¸ $l_i$ ç±»ä¼¼ï¼Œæœ€ç»ˆçš„ $p_i$ å³ä¸º $\max \lbrace l_i,r_i\rbrace$ ã€‚</p><p>æ±‚è§£åŒºé—´æœ€å€¼å¯ä»¥ç”¨ ST è¡¨å®ç°ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> st[<span class="number">100005</span>][<span class="number">18</span>];</span><br><span class="line"><span class="keyword">int</span> lg[<span class="number">100005</span>];</span><br><span class="line"><span class="keyword">int</span> power[<span class="number">320</span>];</span><br><span class="line"><span class="keyword">int</span> p[<span class="number">100005</span>];</span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> s = lg[r - l + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> max(st[l][s], st[r - (<span class="number">1</span> &lt;&lt; s) + <span class="number">1</span>][s]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    lg[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= <span class="number">100000</span>; ++i)</span><br><span class="line">        lg[i] = lg[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">319</span>; ++i) &#123;</span><br><span class="line">        power[i] = i * i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;st[i][<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= lg[N]; ++j)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= N; ++i)</span><br><span class="line">            st[i][j] = max(st[i][j - <span class="number">1</span>], st[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> delta = <span class="number">0</span>, l = i, r = i;</span><br><span class="line">        <span class="keyword">while</span> (l &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p[i] = max(p[i], query(l, r) + delta - st[i][<span class="number">0</span>]);</span><br><span class="line">            r = l - <span class="number">1</span>, l = i - power[++delta];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (r &gt;= <span class="number">1</span>) p[i] = max(p[i], query(<span class="number">1</span>, r) + delta - st[i][<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = N; i &gt;= <span class="number">1</span>; --i) &#123;</span><br><span class="line">        <span class="keyword">int</span> delta = <span class="number">0</span>, l = i, r = i;</span><br><span class="line">        <span class="keyword">while</span> (r &lt;= N) &#123;</span><br><span class="line">            p[i] = max(p[i], query(l, r) + delta - st[i][<span class="number">0</span>]);</span><br><span class="line">            l = r + <span class="number">1</span>, r = i + power[++delta];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= N) p[i] = max(p[i], query(l, N) + delta - st[i][<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, p[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problem/P5503&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å’•å’•å’•&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="STç®—æ³•" scheme="https://tth37.cn/tags/ST%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>æ¨¡æ¿-å¸¸æ•°ä¼˜åŒ–</title>
    <link href="https://tth37.cn/2019/08/26/template-optimization/"/>
    <id>https://tth37.cn/2019/08/26/template-optimization/</id>
    <published>2019-08-26T13:00:29.000Z</published>
    <updated>2019-08-29T05:22:20.602Z</updated>
    
    <content type="html"><![CDATA[<h4 id="å®ç”¨æŠ€å·§"><a href="#å®ç”¨æŠ€å·§" class="headerlink" title="å®ç”¨æŠ€å·§"></a>å®ç”¨æŠ€å·§</h4><ol><li><p>å‡å°‘å‡½æ•°å‚æ•°ä¼ é€’ï¼Œå¼€å…¨å±€å˜é‡ <a href="https://www.luogu.org/record/23355022" target="_blank" rel="noopener">è¡€çš„æ•™è®­</a></p></li><li><p><code>memset</code> å®åœ¨æ˜¯å¤ªæ…¢äº†ï¼é¿å…å¤§æ•°ç»„çš„å¤šæ¬¡ <code>memset</code>ï¼Œå¯ä»¥åœ¨ç¨‹åºçš„å…¶ä»–ä½ç½®ï¼ˆå¦‚éå†ï¼‰é¡ºæ‰‹å°†æ•°ç»„æ¸…ç©º <a href="https://www.luogu.org/record/23451875" target="_blank" rel="noopener">è¡€çš„æ•™è®­</a></p></li></ol><a id="more"></a><h4 id="å¿«é€Ÿè¯»å…¥"><a href="#å¿«é€Ÿè¯»å…¥" class="headerlink" title="å¿«é€Ÿè¯»å…¥"></a>å¿«é€Ÿè¯»å…¥</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">readint</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T1</span>, <span class="title">class</span> ...<span class="title">T2</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">readint</span>(<span class="title">T1</span> &amp;<span class="title">i</span>, <span class="title">T2</span>&amp;... <span class="title">rest</span>)&#123;</span></span><br><span class="line">    i=<span class="number">0</span>;<span class="keyword">char</span> c;<span class="keyword">bool</span> f=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c=getchar())) f=c==<span class="string">'-'</span>;</span><br><span class="line">    <span class="keyword">do</span> i=(i&lt;&lt;<span class="number">3</span>)+(i&lt;&lt;<span class="number">1</span>)+c-<span class="string">'0'</span>; <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c=getchar()));</span><br><span class="line">    <span class="keyword">if</span> (f) i=-i;</span><br><span class="line">    readint(rest...);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¿«é€Ÿè¾“å‡º"><a href="#å¿«é€Ÿè¾“å‡º" class="headerlink" title="å¿«é€Ÿè¾“å‡º"></a>å¿«é€Ÿè¾“å‡º</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æš‚æ— </span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;å®ç”¨æŠ€å·§&quot;&gt;&lt;a href=&quot;#å®ç”¨æŠ€å·§&quot; class=&quot;headerlink&quot; title=&quot;å®ç”¨æŠ€å·§&quot;&gt;&lt;/a&gt;å®ç”¨æŠ€å·§&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;å‡å°‘å‡½æ•°å‚æ•°ä¼ é€’ï¼Œå¼€å…¨å±€å˜é‡ &lt;a href=&quot;https://www.luogu.org/record/23355022&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è¡€çš„æ•™è®­&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;memset&lt;/code&gt; å®åœ¨æ˜¯å¤ªæ…¢äº†ï¼é¿å…å¤§æ•°ç»„çš„å¤šæ¬¡ &lt;code&gt;memset&lt;/code&gt;ï¼Œå¯ä»¥åœ¨ç¨‹åºçš„å…¶ä»–ä½ç½®ï¼ˆå¦‚éå†ï¼‰é¡ºæ‰‹å°†æ•°ç»„æ¸…ç©º &lt;a href=&quot;https://www.luogu.org/record/23451875&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è¡€çš„æ•™è®­&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="æ¨¡æ¿" scheme="https://tth37.cn/categories/%E6%A8%A1%E6%9D%BF/"/>
    
    
  </entry>
  
  <entry>
    <title>å…¬å‘Š 2019-8-26</title>
    <link href="https://tth37.cn/2019/08/26/bulletin-2019-8-26/"/>
    <id>https://tth37.cn/2019/08/26/bulletin-2019-8-26/</id>
    <published>2019-08-26T06:18:33.000Z</published>
    <updated>2019-08-27T13:54:12.910Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://tth37.cn/2019/05/18/bulletin-2019-5-18/">ä¸Šä¸€ç¯‡å…¬å‘Š</a></p></blockquote><p>Hi~ è®¿é—®æˆ‘ç½‘ç«™çš„å°å´½å­ä»¬~</p><p>æƒ³åœ¨è¯„è®ºåŒºå‘è¨€çš„åŒæ—¶ç•™ä¸‹è‡ªå·±çš„ä¸ªäººå¤´åƒå—ï¼Ÿå¿«å¿«æ³¨å†Œä¸€ä¸ª<a href="https://www.github.com" target="_blank" rel="noopener">Github</a>è´¦å·å§ï¼<del>å­¦ä¿¡æ¯æ²¡ä¸ªGithubè´¦å·æ€ä¹ˆè¡Œ</del>  æˆ‘çš„ç½‘ç«™ä¸Githubå®Œå…¨å…¼å®¹ï¼Œå¯ä»¥ä½¿ç”¨Githubç™»å½•æˆ‘çš„ç½‘ç«™ï¼Œå¹¶ä¸”åœ¨æ–‡ç« ä¸‹æ–¹è¯„è®ºï¼</p><p><a href="https://tth37.cn/message/">å¯ä»¥åœ¨è¿™é‡Œæµ‹è¯•ä¸€ä¸‹</a></p><p>è™½ç„¶ç½‘ç«™æ˜¯å›½å®¶é¡¶çº§åŸŸåï¼ˆ<code>*.cn</code>ï¼‰ï¼Œä½†æ˜¯Githubå¤´åƒçš„æ›´æ–°æ˜¯å®æ—¶çš„ï¼Œæ³¨å†ŒGithubè´¦å·ä¹‹åç«‹åˆ»å¯ä»¥åˆ°æˆ‘çš„åšå®¢è¯„è®ºï¼</p><p>è°¢è°¢èµ„ç“·ï¼</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://tth37.cn/2019/05/18/bulletin-2019-5-18/&quot;&gt;ä¸Šä¸€ç¯‡å…¬å‘Š&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Hi~ è®¿é—®æˆ‘ç½‘ç«™çš„å°å´½å­ä»¬~&lt;/p&gt;
&lt;p&gt;æƒ³åœ¨è¯„è®ºåŒºå‘è¨€çš„åŒæ—¶ç•™ä¸‹
      
    
    </summary>
    
      <category term="å…¬å‘Š" scheme="https://tth37.cn/categories/%E5%85%AC%E5%91%8A/"/>
    
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p5502æœ€å¤§å…¬çº¦æ•°</title>
    <link href="https://tth37.cn/2019/08/23/solution-luogu-p5502/"/>
    <id>https://tth37.cn/2019/08/23/solution-luogu-p5502/</id>
    <published>2019-08-23T15:21:35.000Z</published>
    <updated>2019-08-23T15:23:12.327Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problem/P5502" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>å’•å’•å’•</p></blockquote><a id="more"></a><p>å¯¹äºæ±‚è§£åŒºé—´æƒå€¼ $=value *length$ çš„æœ€å€¼é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸å¯ä»¥æšä¸¾åŒºé—´å·¦ç«¯ç‚¹ï¼Œç„¶åé«˜æ•ˆåœ°æ‰¾å‡ºå³ç«¯ç‚¹æ›´æ–°ç­”æ¡ˆã€‚</p><p>æœ´ç´ çš„æƒ³æ³•æ˜¯æšä¸¾å³ç«¯ç‚¹ $r\in [l,n]$ ã€‚æ ¹æ®æ˜¾ç„¶çš„è´ªå¿ƒç­–ç•¥ï¼Œå¦‚æœå³ç«¯ç‚¹åœ¨æŸä¸€åŒºé—´ç§»åŠ¨æ—¶ï¼Œ$\gcd(a_l,a_{l+1},â€¦,a_r)$ ä¿æŒä¸å˜ï¼Œåˆ™å³ç«¯ç‚¹è¶Šå¤§è¶Šå¥½ã€‚</p><p>å› æ­¤å¯ä»¥ç”¨å€å¢ä¼˜åŒ–å³ç«¯ç‚¹çš„ç¡®å®šã€‚ä½†æ˜¯åœ¨å€å¢çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å¤šæ¬¡æŸ¥è¯¢åŒºé—´æœ€å¤§å…¬çº¦æ•°ï¼›æˆ‘ä»¬å¯ä»¥ç”¨STè¡¨çš„æ€è·¯å¯¹åºåˆ—é¢„å¤„ç†ï¼Œåšåˆ° $O(1)$ å¤æ‚åº¦æŸ¥è¯¢ã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœå·²ç»ç¡®å®šå·¦ç«¯ç‚¹ $l$ ï¼Œä¸åŒçš„å³ç«¯ç‚¹é€‰å–ä¼šå¯¹åº”è®¸å¤šä¸åŒçš„æœ€å¤§å…¬çº¦æ•°å€¼ï¼Œé‚£ä¹ˆè¯¥ç®—æ³•çš„å¤æ‚åº¦å°†æ— æ³•æ‰¿å—ã€‚</p><p>ç¨åŠ è§‚å¯Ÿï¼Œå¯ä»¥å‘ç°å½“å·¦ç«¯ç‚¹ç¡®å®šæ—¶ï¼Œå³ç«¯ç‚¹å³ç§»ä¸€ä¸ªå•ä½ï¼ŒåŸå­æ®µçš„æœ€å¤§å…¬çº¦æ•°è¦ä¹ˆç»´æŒä¸å˜ï¼›è¦ä¹ˆå˜ä¸ºåŸæœ€å¤§å…¬çº¦æ•°çš„ä¸€ä¸ªçº¦æ•°ã€‚æ¢è¨€ä¹‹ï¼Œå½“å·¦ç«¯ç‚¹ç¡®å®šæ—¶ï¼Œä¸åŒçš„å³ç«¯ç‚¹æœ€å¤šå¯¹åº” $\log_2n$ ä¸ªä¸åŒçš„æœ€å¤§å…¬çº¦æ•°å€¼ã€‚ç®—æ³•å¤æ‚åº¦å¾—ä»¥æ§åˆ¶åœ¨ $O(n(\log n)^2)$ ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">gcd</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b == <span class="number">0</span> ? a : gcd(b, a % b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T, N;</span><br><span class="line">ll ans;</span><br><span class="line">ll a[<span class="number">100005</span>];</span><br><span class="line">ll st[<span class="number">100005</span>][<span class="number">18</span>];</span><br><span class="line"><span class="keyword">int</span> lg[<span class="number">100005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k = lg[r - l + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> gcd(st[l][k], st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    lg[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= <span class="number">100000</span>; ++i)</span><br><span class="line">        lg[i] = lg[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;st[i][<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= lg[N]; ++j)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= N; ++i)</span><br><span class="line">            st[i][j] = gcd(st[i][j - <span class="number">1</span>], st[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> l = <span class="number">1</span>; l &lt;= N; ++l) &#123;</span><br><span class="line">        <span class="keyword">int</span> r = l;</span><br><span class="line">        <span class="keyword">while</span> (r &lt;= N) &#123;</span><br><span class="line">            ll cur = query(l, r);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = lg[N]; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (r + (<span class="number">1</span> &lt;&lt; i) &lt;= N &amp;&amp; query(l, r + (<span class="number">1</span> &lt;&lt; i)) == cur)</span><br><span class="line">                    r += (<span class="number">1</span> &lt;&lt; i);</span><br><span class="line">            &#125;</span><br><span class="line">            ans = max(ans, cur * (r - l + <span class="number">1</span>));</span><br><span class="line">            r += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problem/P5502&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å’•å’•å’•&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="æ•°å­¦" scheme="https://tth37.cn/tags/%E6%95%B0%E5%AD%A6/"/>
    
      <category term="å€å¢" scheme="https://tth37.cn/tags/%E5%80%8D%E5%A2%9E/"/>
    
      <category term="STç®—æ³•" scheme="https://tth37.cn/tags/ST%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-uva11021éº»çƒç¹è¡</title>
    <link href="https://tth37.cn/2019/08/23/solution-luogu-uva11021/"/>
    <id>https://tth37.cn/2019/08/23/solution-luogu-uva11021/</id>
    <published>2019-08-23T14:11:12.000Z</published>
    <updated>2019-08-23T14:22:20.823Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problem/UVA11021" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>æœ‰ $k$ åªéº»çƒï¼Œæ¯åªæ´»ä¸€å¤©å°±ä¼šæ­»äº¡ï¼Œä¸´æ­»å‰å¯èƒ½ä¼šç”Ÿå‡ºä¸€äº›æ–°çš„éº»çƒã€‚å…·ä½“æ¥è¯´ï¼Œç”Ÿ $i$ åªéº»çƒçš„æ¦‚ç‡ä¸º $P_i$ ã€‚ç»™å®š $m$ ï¼Œæ±‚ $m$ å¤©åæ‰€æœ‰éº»çƒå‡æ­»äº¡çš„æ¦‚ç‡ã€‚</p><p>æˆ‘æ„Ÿè°¢æˆ‘è‡ªå·±</p></blockquote><a id="more"></a><p>æ¯åªéº»çƒå‡å¯è§†ä¸ºä¸€ä¸ªç‹¬ç«‹çš„é—®é¢˜ã€‚è®¾ $f[i]$ è¡¨ç¤ºç¬¬ä¸€å¤©åªæœ‰ $1$ åªéº»çƒï¼Œåœ¨ç¬¬ $i$ å¤©å®ƒåŠå®ƒçš„åä»£å…¨éƒ¨æ­»äº¡çš„æ¦‚ç‡ã€‚ç”±å…¨æ¦‚ç‡å…¬å¼ï¼Œæœ‰</p><script type="math/tex; mode=display">f[i]=P_0+P_1f[i-1]+P_2f[i-1]^2+P_3f[i-1]^3+...+P_{n-1}f[i-1]^{n-1}</script><p>å…¶ä¸­ $P_jf[i-j]^j$ çš„å«ä¹‰æ˜¯è¿™ä¸ªéº»çƒç”Ÿäº† $j$ ä¸ªåä»£ï¼Œå¹¶ä¸”å®ƒä»¬åœ¨ $i-1$ å¤©åå…¨éƒ¨æ­»äº¡çš„æ¦‚ç‡ã€‚ç”±äºä¸€å¼€å§‹æœ‰ $k$ åªéº»çƒï¼Œæœ€ç»ˆç­”æ¡ˆä¸º $f[m]^k$ ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="keyword">int</span> N, K, M;</span><br><span class="line"><span class="keyword">double</span> P[<span class="number">1005</span>];</span><br><span class="line"><span class="keyword">double</span> f[<span class="number">1005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; ++Case) &#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K &gt;&gt; M;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; P[i];</span><br><span class="line">f[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</span><br><span class="line">f[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; ++j)</span><br><span class="line">f[i] += P[j] * <span class="built_in">pow</span>(f[i - <span class="number">1</span>], j);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"Case #"</span> &lt;&lt; Case &lt;&lt; <span class="string">": "</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; fixed &lt;&lt; setprecision(<span class="number">8</span>) &lt;&lt; <span class="built_in">pow</span>(f[M], K) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problem/UVA11021&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœ‰ $k$ åªéº»çƒï¼Œæ¯åªæ´»ä¸€å¤©å°±ä¼šæ­»äº¡ï¼Œä¸´æ­»å‰å¯èƒ½ä¼šç”Ÿå‡ºä¸€äº›æ–°çš„éº»çƒã€‚å…·ä½“æ¥è¯´ï¼Œç”Ÿ $i$ åªéº»çƒçš„æ¦‚ç‡ä¸º $P_i$ ã€‚ç»™å®š $m$ ï¼Œæ±‚ $m$ å¤©åæ‰€æœ‰éº»çƒå‡æ­»äº¡çš„æ¦‚ç‡ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘æ„Ÿè°¢æˆ‘è‡ªå·±&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="æ¦‚ç‡" scheme="https://tth37.cn/tags/%E6%A6%82%E7%8E%87/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p2279æ¶ˆé˜²å±€çš„è®¾ç«‹</title>
    <link href="https://tth37.cn/2019/08/19/solution-luogu-p2279/"/>
    <id>https://tth37.cn/2019/08/19/solution-luogu-p2279/</id>
    <published>2019-08-18T16:24:39.000Z</published>
    <updated>2019-08-26T10:04:49.452Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/P2279" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>ç»™å®šä¸€æ£µæœ‰ $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ±‚è‡³å°‘éœ€è¦æ ‡è®°å¤šå°‘ä¸ªç‚¹ä½¿å¾—æ ‘ä¸Šä»»æ„ä¸¤ä¸ªç‚¹çš„è·ç¦»å‡å°äºç­‰äº $2$</p><p>$n \le 1000$</p><p>æ„Ÿè°¢@oyçš„è´¡çŒ®</p></blockquote><a id="more"></a><p>å®é™…ä¸Šå°±æ˜¯<a href="https://www.luogu.org/problem/P3267" target="_blank" rel="noopener">è¿™é“é¢˜</a>çš„ç®€åŒ–ç‰ˆã€‚</p><p>é¦–å…ˆå®šä¹‰çŠ¶æ€ã€‚$f[u][4]$ è¡¨ç¤ºèŠ‚ç‚¹ $u$ çš„äºŒçº§ç¥–å…ˆï¼ˆçˆ¶äº²çš„çˆ¶äº²ï¼‰åŠä»¥ä¸‹èŠ‚ç‚¹è¢«å®Œå…¨è¦†ç›–ï¼Œæ‰€éœ€çš„æœ€å°ä»£ä»·ã€‚$f[u][3]$ è¡¨ç¤ºèŠ‚ç‚¹ $u$ çš„ä¸€çº§ç¥–å…ˆåŠä»¥ä¸‹èŠ‚ç‚¹è¢«å®Œå…¨è¦†ç›–æ‰€éœ€æœ€å°ä»£ä»·ã€‚ä»¥æ­¤ç±»æ¨ï¼Œ $f[u][0]$ è¡¨ç¤ºèŠ‚ç‚¹ $u$ çš„äºŒçº§å„¿å­ï¼ˆå„¿å­çš„å„¿å­ï¼‰åŠä»¥ä¸‹èŠ‚ç‚¹è¢«å®Œå…¨è¦†ç›–æ‰€éœ€çš„æœ€å°ä»£ä»·ã€‚</p><p>è€ƒè™‘ $f[u][4]$ çš„æ¨å¯¼ã€‚ç”±äºæ¯ä¸ªèŠ‚ç‚¹è¢«é€‰ä¸­ååªèƒ½è¦†ç›–åˆ°ä¸å…¶è·ç¦»å°äºç­‰äºäºŒçš„èŠ‚ç‚¹ï¼Œè¦ä½¿ $u$ çš„äºŒçº§ç¥–å…ˆè¢«è¦†ç›–åˆ°ï¼Œåˆ™èŠ‚ç‚¹ $u$ å¿…é¡»è¢«é€‰å–ã€‚å¯¹èŠ‚ç‚¹ $u$ çš„å„ä¸ªå„¿å­æ²¡æœ‰è¦æ±‚ã€‚å› æ­¤ï¼Œ$f[u][4]=1+\Sigma f[v][0â€¦4]$ ã€‚</p><p>è€ƒè™‘ $f[u][3]$ã€‚ç”±äºåªéœ€è¦è¦†ç›–åˆ°èŠ‚ç‚¹ $u$ çš„çˆ¶äº²ï¼Œåªéœ€ä½¿èŠ‚ç‚¹ $u$ çš„<strong>è‡³å°‘ä¸€ä¸ª</strong>å­èŠ‚ç‚¹å¯ä»¥è¦†ç›–åˆ°å…¶äºŒçº§ç¥–å…ˆå³å¯ã€‚åŒæ—¶ï¼Œè¯¥å­èŠ‚ç‚¹åœ¨è¦†ç›–åˆ°èŠ‚ç‚¹ $u$ çš„äºŒçº§ç¥–å…ˆæ—¶ï¼Œå¯ä»¥åŒæ—¶è¦†ç›–åˆ°èŠ‚ç‚¹ $u$  çš„å…¶ä»–å„¿å­ï¼Œå› æ­¤èŠ‚ç‚¹ $u$ çš„å…¶ä»–å„¿å­ä¸å¿…è¢«è¦†ç›–ã€‚$f[u][3]=f[k][4]+\Sigma f[v][1â€¦4]$ã€‚</p><p>$f[u][2]$ çš„æƒ…å†µä¸ $f[u][3]$ ç±»ä¼¼ï¼Œåªéœ€ä¿è¯ä¸€ä¸ªå„¿å­èƒ½å°†èŠ‚ç‚¹ $u$ è¦†ç›–å³å¯ã€‚ $f[u][2]=f[k][3]+\Sigma f[v][2â€¦4]$ ã€‚</p><p>$f[u][1]$ ä¸ $f[u][0]$ çš„æ¨å¯¼ç›¸å¯¹ç®€å•ï¼Œå› ä¸ºå„ä¸ªå­èŠ‚ç‚¹ä¹‹é—´ä¸ä¼šç›¸äº’å½±å“ã€‚ $f[u][1]=\Sigma f[v][2â€¦4]$ï¼Œ$f[u][0]=\Sigma f[v][1â€¦4]$ã€‚</p><p>å¯¹è½¬ç§»æ–¹ç¨‹è¿›è¡Œç®€å•ä¼˜åŒ–å³å¯ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[<span class="number">1005</span>];</span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> f[<span class="number">1005</span>][<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">f[u][<span class="number">3</span>] = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">f[u][<span class="number">2</span>] = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">f[u][<span class="number">4</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line"><span class="keyword">int</span> v = *it;</span><br><span class="line"><span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">dp(v, u);</span><br><span class="line">f[u][<span class="number">0</span>] += f[v][<span class="number">1</span>];</span><br><span class="line">f[u][<span class="number">1</span>] += f[v][<span class="number">2</span>];</span><br><span class="line">f[u][<span class="number">2</span>] = min(f[u][<span class="number">2</span>], f[v][<span class="number">3</span>] - f[v][<span class="number">2</span>]);</span><br><span class="line">f[u][<span class="number">3</span>] = min(f[u][<span class="number">3</span>], f[v][<span class="number">4</span>] - f[v][<span class="number">1</span>]);</span><br><span class="line">f[u][<span class="number">4</span>] += f[v][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line">f[u][<span class="number">2</span>] += f[u][<span class="number">1</span>];</span><br><span class="line">f[u][<span class="number">3</span>] += f[u][<span class="number">0</span>];</span><br><span class="line">f[u][<span class="number">3</span>] = min(f[u][<span class="number">3</span>], f[u][<span class="number">4</span>]);</span><br><span class="line">f[u][<span class="number">2</span>] = min(f[u][<span class="number">2</span>], f[u][<span class="number">3</span>]);</span><br><span class="line">f[u][<span class="number">1</span>] = min(f[u][<span class="number">1</span>], f[u][<span class="number">2</span>]);</span><br><span class="line">f[u][<span class="number">0</span>] = min(f[u][<span class="number">0</span>], f[u][<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> u = <span class="number">2</span>; u &lt;= N; ++u) &#123;</span><br><span class="line"><span class="keyword">int</span> v;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;v);</span><br><span class="line">G[u].push_back(v);</span><br><span class="line">G[v].push_back(u);</span><br><span class="line">&#125;</span><br><span class="line">dp(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, f[<span class="number">1</span>][<span class="number">2</span>]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/P2279&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç»™å®šä¸€æ£µæœ‰ $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ±‚è‡³å°‘éœ€è¦æ ‡è®°å¤šå°‘ä¸ªç‚¹ä½¿å¾—æ ‘ä¸Šä»»æ„ä¸¤ä¸ªç‚¹çš„è·ç¦»å‡å°äºç­‰äº $2$&lt;/p&gt;
&lt;p&gt;$n \le 1000$&lt;/p&gt;
&lt;p&gt;æ„Ÿè°¢@oyçš„è´¡çŒ®&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="åŠ¨æ€è§„åˆ’" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="æ ‘å½¢dp" scheme="https://tth37.cn/tags/%E6%A0%91%E5%BD%A2dp/"/>
    
  </entry>
  
  <entry>
    <title>ç®—æ³•å­¦ä¹ -PÃ³lyaè®¡æ•°ä¸Burnsideå¼•ç†</title>
    <link href="https://tth37.cn/2019/08/13/algorithm-polya/"/>
    <id>https://tth37.cn/2019/08/13/algorithm-polya/</id>
    <published>2019-08-12T17:00:09.000Z</published>
    <updated>2019-08-12T18:50:14.929Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>å¦‚æœé¢˜ç›®ä¸­å®šä¹‰ä¸€ç§ç­‰ä»·å…³ç³»ï¼Œæ»¡è¶³ç­‰ä»·å…³ç³»çš„å…ƒç´ è¢«çœ‹æˆåŒä¸€ç±»ï¼Œåªç»Ÿè®¡ä¸€æ¬¡ï¼›è¿™æ ·çš„é—®é¢˜ç§°ä¸º<strong>ç­‰ä»·ç±»è®¡æ•°é—®é¢˜</strong>ã€‚ä¸€èˆ¬çš„ç­‰ä»·ç±»è®¡æ•°é—®é¢˜å¯ä»¥ç”¨ Burnside å¼•ç†æˆ– PÃ³lyaå®šç†è§£å†³ã€‚</p><a id="more"></a><h3 id="æ¨¡æ¿"><a href="#æ¨¡æ¿" class="headerlink" title="æ¨¡æ¿"></a>æ¨¡æ¿</h3><h4 id="ç½®æ¢"><a href="#ç½®æ¢" class="headerlink" title="ç½®æ¢"></a>ç½®æ¢</h4><p>ç½®æ¢å®é™…ä¸Šå°±æ˜¯ä¸€ä¸€æ˜ å°„ï¼Œ$f$ å¯ä»¥çœ‹æˆå®šä¹‰åŸŸå’Œå€¼åŸŸä¸º $\lbrace 1,2,3,â€¦,n\rbrace$ çš„å‡½æ•°ï¼Œå…¶ä¸­ $f(1)=a_1$ï¼Œ $f(2)=a_2$ ç­‰ç­‰ã€‚</p><script type="math/tex; mode=display">f=\left(\begin{array}{cccc}     1&2&...&n \\     a_1&a_2&...&a_n \\ \end{array}\right)</script><h4 id="å‡½æ•°å¤åˆ"><a href="#å‡½æ•°å¤åˆ" class="headerlink" title="å‡½æ•°å¤åˆ"></a>å‡½æ•°å¤åˆ</h4><p>å¦‚æœ</p><script type="math/tex; mode=display">f=\left(\begin{array}{cccc}     1&2&...&n \\     a_1&a_2&...&a_n \\ \end{array}\right)</script><p>ä¸”</p><script type="math/tex; mode=display">g=\left(\begin{array}{cccc}     1&2&...&n \\     b_1&b_2&...&b_n \\ \end{array}\right)</script><p>æ˜¯ $\lbrace 1,2,3,â€¦,n\rbrace$  çš„ä¸¤ä¸ªç½®æ¢ï¼Œåˆ™ä»–ä»¬çš„<strong>å¤åˆ</strong>æŒ‰ç…§å…ˆ $f$ å $g$ çš„é¡ºåºæ”¾ç½®å¾—åˆ°ä¸€ä¸ªæ–°ç½®æ¢ï¼š</p><script type="math/tex; mode=display">g\circ f=\left(\begin{array}{cccc}     1&2&...&n \\\    a_1&a_2&...&a_n \\\end{array}\right)\circ\left(\begin{array}{cccc}     1&2&...&n \\     b_1&b_2&...&b_n \\ \end{array}\right)</script><h4 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h4><p>ä¸ºäº†å¤„ç†æ–¹ä¾¿ï¼Œå¸¸å¸¸æŠŠç½®æ¢åˆ†è§£æˆ<strong>å¾ªç¯</strong>çš„ä¹˜ç§¯ï¼Œå…¶ä¸­æ¯ä¸ªå¾ªç¯ä»£è¡¨ä¸€äº›å…ƒç´ â€œå¾ªç¯ç§»ä½â€ã€‚æ¯”å¦‚ $(1,4,3)$ è¿™ä¸ªå¾ªç¯è¡¨ç¤º $1\rightarrow 4$ï¼Œ$4\rightarrow 3$ï¼Œ$3\rightarrow 1$ã€‚</p><p>æ˜“è¯ä»»æ„ç½®æ¢éƒ½å¯ä»¥åˆ†è§£ä¸ºå¾ªç¯ä¹˜ç§¯çš„å½¢å¼ã€‚</p><h3 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h3><blockquote><p>åœ¨ 2*2 æ–¹æ ¼ä¸­æ¶‚é»‘ç™½ä¸¤è‰²ï¼Œæ–¹æ ¼å…è®¸æ—‹è½¬ï¼Œæœ‰å‡ ç§æ–¹æ³•ï¼Ÿ</p></blockquote><p>å‡è®¾ä¸è€ƒè™‘æ–¹æ ¼å…è®¸æ—‹è½¬ï¼Œåˆ™å…±æœ‰ 16 ç§ä¸Šè‰²æ–¹æ¡ˆã€‚æœ¬é¢˜ä¸­â€œæ—‹è½¬åç›¸åŒâ€å³ä¸ºä¸€ä¸ªç­‰ä»·å…³ç³»ï¼Œæœ‰äº†ç­‰ä»·å…³ç³»ï¼Œæ‰€æœ‰å…ƒç´ ä¼šè¢«åˆ†ä¸ºè‹¥å¹²ä¸ª<strong>ç­‰ä»·ç±»</strong>ï¼Œæˆ‘ä»¬éœ€è¦ç»Ÿè®¡çš„å³ä¸ºç­‰ä»·ç±»çš„ä¸ªæ•°ã€‚</p><p>å¯¹äºä¸€ä¸ªç½®æ¢ $f$ ï¼Œè‹¥ä¸€ä¸ªç€è‰²æ–¹æ¡ˆ $s$ ç»è¿‡ç½®æ¢åä¸å˜ï¼Œç§° $s$ ä¸º $f$ çš„<strong>ä¸åŠ¨ç‚¹</strong>ã€‚å°† $f$ çš„ä¸åŠ¨ç‚¹æ•°ç›®è®°ä¸º $C(f)$ï¼Œåˆ™å¯ä»¥è¯æ˜<strong>ç­‰ä»·ç±»æ•°ç›®ä¸ºç½®æ¢ç¾¤ä¸­æ‰€æœ‰ $C(f)$ çš„å¹³å‡å€¼</strong>ã€‚æ­¤ç»“è®ºç§°ä¸º Burnside å¼•ç†ã€‚</p><p>ä¸€èˆ¬åœ°ï¼Œå¦‚æœç½®æ¢ $f$ è¢«åˆ†è§£ä¸º $m(f)$ ä¸ªå¾ªç¯çš„ä¹˜ç§¯ï¼Œé‚£ä¹ˆæ¯ä¸ªå¾ªç¯å†…æ‰€æœ‰ä½ç½®çš„é¢œè‰²å¿…é¡»ç›¸åŒï¼Œå‡è®¾æ¶‚ $k$ ç§é¢œè‰²ï¼Œåˆ™æœ‰ $C(f)=k^{m(f)}$ã€‚å¸¦å…¥ Burnside å¼•ç†çš„è¡¨è¾¾å¼ä¹‹åå¾—åˆ° PÃ³lya å®šç†ï¼š<strong>ç­‰ä»·ç±»çš„ä¸ªæ•°ç­‰äºç½®æ¢ç¾¤ç§æ‰€æœ‰ç½®æ¢ $f$ çš„ $k^{m(f)}$ çš„å¹³å‡æ•°</strong>ã€‚ </p><blockquote><p>å°† $t$ ç§é¢œè‰²çš„ $n$ ä¸ªå°çƒæ’æˆä¸€ä¸ªç¯ï¼Œå…è®¸æ—‹è½¬å’Œç¿»è½¬ï¼Œæœ‰å‡ ç§æ–¹æ³•ï¼Ÿ</p></blockquote><p>é¦–å…ˆè€ƒè™‘æ—‹è½¬ç½®æ¢ã€‚è®°ç½®æ¢ $f_i$ ä¸ºå°†ç¯å½¢é¡ºæ—¶é’ˆæ—‹è½¬ $i$ ä¸ªå•ä½é•¿åº¦ã€‚æ˜¾ç„¶ï¼Œ$m(f_i)=gcd(i,n)$ ã€‚</p><p>å…¶æ¬¡è€ƒè™‘ç¿»è½¬ç½®æ¢ã€‚å½“ $n$ ä¸ºå¥‡æ•°æ—¶ï¼Œ$|G|=n$ï¼Œä¸” $m(f)=(n-1)/2+1$ï¼›å½“ $n$ ä¸ºå¶æ•°æ—¶ï¼Œ$|G|=n$ï¼Œä¸” $m(f)=n/2+1$ã€‚</p><p>è®°ï¼š</p><script type="math/tex; mode=display">a=\Sigma_{i=0}^{n-1} t^{gcd(i,n)}\\b=\begin{cases}t^{(n-1)/2+1} , n=2k+1\\t^{n/2+1},n=2k\end{cases}</script><p>æœ€ç»ˆç­”æ¡ˆ $ans=(a+b)/2n$ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h3&gt;&lt;p&gt;å¦‚æœé¢˜ç›®ä¸­å®šä¹‰ä¸€ç§ç­‰ä»·å…³ç³»ï¼Œæ»¡è¶³ç­‰ä»·å…³ç³»çš„å…ƒç´ è¢«çœ‹æˆåŒä¸€ç±»ï¼Œåªç»Ÿè®¡ä¸€æ¬¡ï¼›è¿™æ ·çš„é—®é¢˜ç§°ä¸º&lt;strong&gt;ç­‰ä»·ç±»è®¡æ•°é—®é¢˜&lt;/strong&gt;ã€‚ä¸€èˆ¬çš„ç­‰ä»·ç±»è®¡æ•°é—®é¢˜å¯ä»¥ç”¨ Burnside å¼•ç†æˆ– PÃ³lyaå®šç†è§£å†³ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="æ•°è®º" scheme="https://tth37.cn/tags/%E6%95%B0%E8%AE%BA/"/>
    
      <category term="ç¾¤è®º" scheme="https://tth37.cn/tags/%E7%BE%A4%E8%AE%BA/"/>
    
      <category term="PÃ³lyaè®¡æ•°" scheme="https://tth37.cn/tags/Polya%E8%AE%A1%E6%95%B0/"/>
    
  </entry>
  
  <entry>
    <title>ç®—æ³•å­¦ä¹ -KMPæ¨¡å¼åŒ¹é…</title>
    <link href="https://tth37.cn/2019/08/07/algorithm-kmp/"/>
    <id>https://tth37.cn/2019/08/07/algorithm-kmp/</id>
    <published>2019-08-07T12:06:38.000Z</published>
    <updated>2019-08-31T04:05:52.585Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>ç»™å®šä¸€ä¸ªæ–‡æœ¬ $A$ å’Œä¸€ä¸ªå­—ç¬¦ä¸² $B$ ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ KMP ç®—æ³•å°è¯•æ‰¾åˆ°å¹¶å±•ç¤º $B$ åœ¨ $A$ ä¸­çš„æ‰€æœ‰å‡ºç°ï¼ˆoccurrenceï¼‰ã€‚</p><a id="more"></a><h3 id="æ¨¡æ¿"><a href="#æ¨¡æ¿" class="headerlink" title="æ¨¡æ¿"></a>æ¨¡æ¿</h3><h4 id="é¢„å¤„ç†å‰ç¼€å‡½æ•°"><a href="#é¢„å¤„ç†å‰ç¼€å‡½æ•°" class="headerlink" title="é¢„å¤„ç†å‰ç¼€å‡½æ•°"></a>é¢„å¤„ç†å‰ç¼€å‡½æ•°</h4><p>é¢„å¤„ç†å‡ºå­—ç¬¦ä¸² $B$ çš„å‰ç¼€å‡½æ•° $next$ æ•°ç»„ï¼Œå…¶ä¸­ $next[i]$ ä¸º<strong>æ—¢æ˜¯å­ä¸² $B[1â€¦i]$ çš„å‰ç¼€åŒæ—¶ä¹Ÿæ˜¯è¯¥å­ä¸²çš„åç¼€çš„æœ€é•¿çœŸå‰ç¼€</strong>é•¿åº¦ã€‚ä¸€ä¸ªå­—ç¬¦ä¸²çš„çœŸå‰ç¼€æ˜¯å…¶å‰ç¼€ä½†ä¸ç­‰äºè¯¥å­—ç¬¦ä¸²æœ¬èº«ã€‚æ ¹æ®å®šä¹‰ï¼Œ $next[1]=0$ ã€‚</p><h5 id="ç®—æ³•æµç¨‹"><a href="#ç®—æ³•æµç¨‹" class="headerlink" title="ç®—æ³•æµç¨‹"></a>ç®—æ³•æµç¨‹</h5><blockquote><ol><li>åœ¨å¾ªç¯ä¸­ä»¥ $i=2$ åˆ° $i=n$çš„é¡ºåºè®¡ç®—å‰ç¼€å‡½æ•° $next[i]$ çš„å€¼ã€‚ï¼ˆ$next[1]$ è¢«èµ‹å€¼ä¸º0ï¼‰</li><li>ä¸ºäº†è®¡ç®—å½“å‰çš„å‰ç¼€å‡½æ•°å€¼ $next[i]$ï¼Œæˆ‘ä»¬ä»¤å˜é‡ $j$ è¡¨ç¤ºå³ç«¯ç‚¹ä½äº $i-1$  çš„æœ€é•¿åŒ¹é…å‰åç¼€çš„é•¿åº¦ã€‚åˆå§‹æ—¶ $j=next[i-1]$ ã€‚</li><li>é€šè¿‡æ¯”è¾ƒ $B[j+1]$ å’Œ $B[i]$ æ¥æ£€æŸ¥é•¿åº¦ä¸º $j+1$ çš„åç¼€æ˜¯å¦åŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªå‰ç¼€ã€‚å¦‚æœäºŒè€…ç›¸ç­‰ï¼Œé‚£ä¹ˆç½® $next[i]=j+1$ï¼Œå¦åˆ™å‡å°‘ $j$ è‡³ $next[j]$ å¹¶é‡å¤è¯¥è¿‡ç¨‹ã€‚</li><li>å¦‚æœ $j=0$ å¹¶ä¸”ä»æ²¡æœ‰ä»»ä½•ä¸€æ¬¡åŒ¹é…ï¼Œåˆ™ç½® $next[i]=0$ å¹¶ç§»è‡³ä¸‹ä¸€ä¸ªä¸‹æ ‡ $i+1$ ã€‚</li></ol></blockquote><h5 id="F-A-Q"><a href="#F-A-Q" class="headerlink" title="F.A.Q"></a>F.A.Q</h5><p><em>ç®—æ³•æµç¨‹ä¸­çš„æ­¥éª¤ä¸‰ï¼Œä¸ºä»€ä¹ˆè¦å°† $j$ å‡å°‘è‡³ $next[j]$ ï¼Ÿ</em></p><p>è€ƒè™‘æˆ‘ä»¬æ­£åœ¨è®¡ç®—çš„ $next[i]$ ã€‚æˆ‘ä»¬è¦ä½¿ $k$ æœ€å¤§åŒ–ï¼Œå¹¶ä¸”ä¿è¯ $B[1â€¦k]$ ä¸ $B[i-k+1â€¦i]$ ç›¸ç­‰ã€‚å°†å…¶æ‹†æˆä¸¤éƒ¨åˆ†çœ‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ $B[1â€¦k-1]$ ä¸ $B[i-k+1â€¦i-1]$ ç›¸ç­‰çš„åŒæ—¶ï¼Œä¿è¯ $B[k]=B[i]$ ï¼Œä¸” $k$ å–åˆ°æœ€å¤§å€¼ã€‚</p><p>ä¸éš¾å‘ç°ï¼Œå¦‚æœåªéœ€è¦æœ€å¤§åŒ– $k-1$ ä½¿å¾— $B[1â€¦k-1]$ ä¸ $B[i-k+1â€¦i-1]$ ç›¸ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå¿«å¾—å‡ºç­”æ¡ˆã€‚å›é¡¾ä¸€ä¸‹å‰ç¼€å‡½æ•°çš„å®šä¹‰å³å¯å‘ç°ï¼Œè®° $j$ ä¸º $next[i-1]$ï¼Œåˆ™æ­¤æ—¶çš„ $j$ å³ä¸ºæˆ‘ä»¬éœ€è¦æœ€å¤§åŒ–çš„ $k-1$ çš„å€¼ã€‚å¦‚æœè¿™æ—¶åˆæ°å¥½æ»¡è¶³ $B[j+1]=B[i]$ ï¼Œåˆ™æˆ‘ä»¬éœ€è¦æœ€å¤§åŒ–çš„ $k$ å³ä¸º $j+1$ ã€‚</p><p>ç„¶è€Œæ­¤æ—¶å¦‚æœä¸èƒ½æ»¡è¶³ $B[j+1]=B[i]$ ï¼Œæˆ‘ä»¬å°±åªèƒ½è€ƒè™‘å‡å° $j$ çš„å€¼ã€‚<strong>åœ¨å‡å° $j$ å€¼çš„åŒæ—¶ï¼Œæˆ‘ä»¬è¦å§‹ç»ˆä¿è¯å‡å°åçš„ $jâ€™$ æ»¡è¶³ $B[1â€¦jâ€™]=B[j-jâ€™+1â€¦j]$ ã€‚</strong></p><p><img src="http://tth37.cn/images/kmp.jpg" alt></p><p>ç»“åˆä¸Šå›¾ä¸éš¾çœ‹å‡ºï¼Œè¦ä½¿å¾— $B[1â€¦jâ€™]=B[i-jâ€™â€¦i-1]$ï¼Œå³ä¿è¯ $B[1â€¦jâ€™]=B[j-jâ€™+1â€¦j]$ ã€‚è€Œ $jâ€™$ çš„ç¡®å®šä¹Ÿååˆ†ç®€å•ï¼Œå†æ¬¡ç»“åˆå‰ç¼€å‡½æ•°çš„å®šä¹‰å¯å¾—ï¼Œ $jâ€™$ çš„å–å€¼åº”ä¸º $next[j]$ ã€‚</p><h5 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">next[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>, j = <span class="number">0</span>; i &lt;= M; ++i) &#123;</span><br><span class="line">    <span class="keyword">while</span> (j &gt; <span class="number">0</span> &amp;&amp; B[i] != B[j + <span class="number">1</span>]) j = next[j];</span><br><span class="line">    <span class="keyword">if</span> (B[i] == B[j + <span class="number">1</span>]) j++;</span><br><span class="line">    next[i] = j;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åœ¨ç›®æ ‡ä¸²ä¸­æŸ¥æ‰¾å­ä¸²"><a href="#åœ¨ç›®æ ‡ä¸²ä¸­æŸ¥æ‰¾å­ä¸²" class="headerlink" title="åœ¨ç›®æ ‡ä¸²ä¸­æŸ¥æ‰¾å­ä¸²"></a>åœ¨ç›®æ ‡ä¸²ä¸­æŸ¥æ‰¾å­ä¸²</h4><p>è®¡ç®—å‡º $f$ æ•°ç»„ï¼Œå…¶ä¸­ $f[i]$ ä¸º<strong>æ—¢æ˜¯å­ä¸² $B[1â€¦i]$ çš„å‰ç¼€åŒæ—¶ä¹Ÿæ˜¯å­ä¸² $A[1â€¦i]$ çš„åç¼€çš„æœ€é•¿å‰ç¼€</strong>é•¿åº¦ã€‚<strong>ï¼ˆæ³¨æ„è¿™é‡Œä¸ä¸€å®šæ˜¯çœŸå‰ç¼€ï¼‰</strong>åœ¨é¢„å¤„ç†å‰ç¼€å‡½æ•°çš„è¿‡ç¨‹ä¸­ï¼Œç›¸å½“äº $B$ ä¸²ä¸è‡ªå·±æœ¬èº«åšäº†ä¸€æ¬¡æ¨¡å¼åŒ¹é…ï¼Œå› æ­¤æ­¤å¤„çš„ç®—æ³•æµç¨‹ä¸ä¸Šä¸€ä¸ªæ“ä½œååˆ†ç±»ä¼¼ã€‚</p><h5 id="ç®—æ³•æµç¨‹-1"><a href="#ç®—æ³•æµç¨‹-1" class="headerlink" title="ç®—æ³•æµç¨‹"></a>ç®—æ³•æµç¨‹</h5><blockquote><ol><li>åœ¨å¾ªç¯ä¸­ä»¥ $i=1$ åˆ° $i=n$çš„é¡ºåºè®¡ç®— $f[i]$ çš„å€¼ã€‚</li><li>ä¸ºäº†è®¡ç®—å½“å‰çš„ $f[i]$ ï¼Œæˆ‘ä»¬ä»¤å˜é‡ $j$ è¡¨ç¤ºå³ç«¯ç‚¹ä½äº $i-1$ çš„æœ€é•¿åŒ¹é…å‰åç¼€çš„é•¿åº¦ã€‚åˆå§‹æ—¶ $j=f[i-1]$ ã€‚</li><li>é€šè¿‡æ¯”è¾ƒ $B[j+1]$ å’Œ $A[i]$ æ¥æ£€æŸ¥ $B$ ä¸²ä¸­é•¿åº¦ä¸º $j+1$ çš„å‰ç¼€æ˜¯å¦ä¹Ÿæ˜¯ $A$ ä¸²ä¸­é•¿åº¦ä¸º $j+1$ çš„åç¼€ã€‚å¦‚æœäºŒè€…ç›¸ç­‰ï¼Œé‚£ä¹ˆç½® $f[i]=j+1$ï¼Œå¦åˆ™å‡å°‘ $j$ è‡³ $next[j-1]$ å¹¶é‡å¤è¯¥è¿‡ç¨‹ã€‚</li><li>å¦‚æœ $j=0$ å¹¶ä¸”ä»æ²¡æœ‰ä»»ä½•ä¸€æ¬¡åŒ¹é…ï¼Œåˆ™ç½® $f[i]=0$ å¹¶ç§»è‡³ä¸‹ä¸€ä¸ªä¸‹æ ‡ $i+1$ ã€‚</li><li>å¦‚æœ $j=M$ï¼Œå³æ‰¾åˆ° $B$ åœ¨ $A$ ä¸­çš„ä¸€æ¬¡å‡ºç°ã€‚</li></ol></blockquote><h5 id="ä»£ç å®ç°-1"><a href="#ä»£ç å®ç°-1" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = <span class="number">0</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    <span class="keyword">while</span> (j &gt; <span class="number">0</span> &amp;&amp; A[i] != B[j + <span class="number">1</span>]) j = next[j];</span><br><span class="line">    <span class="keyword">if</span> (A[i] == B[j + <span class="number">1</span>]) j++;</span><br><span class="line">    f[i] = p;</span><br><span class="line">    <span class="comment">// if (f[i] == M) do something... </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h3&gt;&lt;p&gt;ç»™å®šä¸€ä¸ªæ–‡æœ¬ $A$ å’Œä¸€ä¸ªå­—ç¬¦ä¸² $B$ ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ KMP ç®—æ³•å°è¯•æ‰¾åˆ°å¹¶å±•ç¤º $B$ åœ¨ $A$ ä¸­çš„æ‰€æœ‰å‡ºç°ï¼ˆoccurrenceï¼‰ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç®—æ³•å­¦ä¹ " scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="å­—ç¬¦ä¸²" scheme="https://tth37.cn/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    
  </entry>
  
  <entry>
    <title>CFæ¸¸è®°-Codeforces Round</title>
    <link href="https://tth37.cn/2019/08/01/codeforces-1199/"/>
    <id>https://tth37.cn/2019/08/01/codeforces-1199/</id>
    <published>2019-08-01T15:21:39.000Z</published>
    <updated>2019-08-01T15:49:39.749Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://codeforces.com/contest/1199" target="_blank" rel="noopener">æ¯”èµ›é“¾æ¥</a></p></blockquote><p>äººç”Ÿç¬¬äºŒæ¬¡è§‰å¾—CFçš„é¢˜è¿˜æ˜¯å¯åšçš„ã€‚ç›®å‰åªå¼„äº†5é“ï¼Œå‰©ä¸‹ä¸€é¢˜å’•ç€ã€‚</p><a id="more"></a><h5 id="A-City-Day"><a href="#A-City-Day" class="headerlink" title="#A City Day"></a>#A <a href="https://codeforces.com/contest/1199/problem/A" target="_blank" rel="noopener">City Day</a></h5><p>ç®€å•æ¨¡æ‹Ÿï¼Œå¼€å¿ƒçš„è¯å¯ä»¥å†™ä¸ªå•è°ƒé˜Ÿåˆ—ã€‚</p><h5 id="B-Water-Lily"><a href="#B-Water-Lily" class="headerlink" title="#B Water Lily"></a>#B <a href="https://codeforces.com/contest/1199/problem/B" target="_blank" rel="noopener">Water Lily</a></h5><p>åˆä¸­æ•°å­¦é¢˜ï¼Œå‹¾è‚¡å®šç†ã€‚</p><script type="math/tex; mode=display">(x+H)^2=x^2+L^2 \\ x=(L^2-H^2)/2H</script><h5 id="C-MP3"><a href="#C-MP3" class="headerlink" title="#C MP3"></a>#C <a href="https://codeforces.com/contest/1199/problem/C" target="_blank" rel="noopener">MP3</a></h5><p>æ—¢ç„¶ç¡¬ç›˜çš„å¤§å°æ˜¯å›ºå®šçš„ï¼Œé‚£ä¹ˆ $K$ åº”è¯¥å°½å¯èƒ½å¤§ã€‚ä¸ºäº†è®© $K$ å°½å¯èƒ½å¤§ï¼Œ $k$ ä¹Ÿè¦å°½å¯èƒ½å¤§ã€‚</p><p>æ‰€ä»¥ï¼š</p><script type="math/tex; mode=display">k=\lfloor(I*8)/n\rfloor \\ K=2^k</script><p>æŠŠ $K$ æ±‚å‡ºæ¥ä¹‹åï¼Œæˆ‘ä»¬å®é™…ä¸Šåªéœ€ä¿ç•™ $K$ ç§ä¸åŒçš„æ•°å­—ï¼Œå¹¶ä½¿åˆ é™¤çš„æ•°å­—æœ€å°‘ã€‚</p><p>æ ¹æ®é¢˜æ„ï¼Œæˆ‘ä»¬åªèƒ½åˆ é™¤æœ€å¤§çš„æˆ–æœ€å°çš„æ•°ã€‚è€ƒè™‘å¯¹ $a$ æ•°ç»„ç¦»æ•£åŒ–ï¼Œå¹¶ç”¨ $b$ æ•°ç»„è®°å½•æ¯ä¸ªæ•°å€¼å‡ºç°çš„æ¬¡æ•°ã€‚ä¿ç•™ä¸‹æ¥çš„æ•°å€¼ä¸€å®šæ˜¯<strong>è¿ç»­çš„$K$ä¸ª</strong>ï¼Œåªéœ€åœ¨ $b$æ•°ç»„ä¸Šè¿›è¡Œå‰ç¼€å’Œé¢„å¤„ç†ï¼Œæšä¸¾ä¿ç•™çš„ $K$ ä¸ªæ•°å€¼ä½ç½®å³å¯ã€‚</p><h5 id="D-Welfare-State"><a href="#D-Welfare-State" class="headerlink" title="#D Welfare State"></a>#D <a href="https://codeforces.com/contest/1199/problem/D" target="_blank" rel="noopener">Welfare State</a></h5><p>éä¸»æµè­¦å‘Šâš </p><p>è§‚å¯Ÿåˆ°åªæœ‰ä¸€æ¬¡æŸ¥è¯¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é’ˆå¯¹æ¯ä¸ªä½ç½®ï¼Œæ±‚å‡ºå½“å‰ä½ç½®åœ¨ç»è¿‡ $q$ æ¬¡æ“ä½œåçš„å€¼å¹¶è¾“å‡ºã€‚</p><p>å…ˆæ¥çœ‹ä¸¤ä¸ªç»“è®ºï¼š</p><blockquote><p>å¯ä»¥å¿½ç•¥å¯¹å½“å‰ä½ç½®çš„<strong>æœ€åä¸€æ¬¡ä¸€å·æ“ä½œ</strong>ä¹‹å‰çš„æ‰€æœ‰æ“ä½œã€‚</p></blockquote><p>ç®¡ä½ ä¹‹å‰è¢«æ”¹æˆä»€ä¹ˆäº†ï¼Œç»è¿‡ä¸€æ¬¡ä¸€å·æ“ä½œå°±å¾—é‡æ–°æ¥è¿‡ã€‚</p><blockquote><p>å¯¹äº<strong>è¿ç»­çš„å‡ æ¬¡äºŒå·æ“ä½œ</strong>ï¼Œåªéœ€ä¿ç•™ $x$ æœ€å¤§çš„é‚£ä¸€æ¬¡æ“ä½œã€‚</p></blockquote><p>åºŸè¯ã€‚</p><p>æœ¬é¢˜ä¸­äºŒå·æ“ä½œæ˜¯é’ˆå¯¹æ•´ä½“çš„ï¼Œæ‰€ä»¥è€ƒè™‘å¼€æ•°ç»„ $s$ è®°å½•æ‰€æœ‰äºŒå·æ“ä½œçš„<strong>åç¼€æœ€å¤§å€¼</strong>ã€‚åœ¨é’ˆå¯¹æ¯ä¸€ä½ç½®è¿›è¡Œè®¡ç®—æ—¶ï¼Œåªéœ€å°†æœ€åä¸€æ¬¡ä¸€å·æ“ä½œä¹‹å‰çš„æ“ä½œåˆ é™¤åï¼Œä¸äºŒå·æ“ä½œçš„åç¼€æœ€å¤§å€¼æ¯”è¾ƒå³å¯å¾—å‡ºç­”æ¡ˆã€‚</p><h5 id="E-Matching-vs-Independent-Set"><a href="#E-Matching-vs-Independent-Set" class="headerlink" title="#E Matching vs Independent Set"></a>#E <a href="https://codeforces.com/contest/1199/problem/E" target="_blank" rel="noopener">Matching vs Independent Set</a></h5><h5 id="F-Rectangle-Painting-1"><a href="#F-Rectangle-Painting-1" class="headerlink" title="#F Rectangle Painting 1"></a>#F <a href="https://codeforces.com/contest/1199/problem/F" target="_blank" rel="noopener">Rectangle Painting 1</a></h5><p>è¶…æ°´çš„ä¸€é“ F é¢˜ï¼</p><p>$f[x1][y1][x2][y2]$è¡¨ç¤ºå°†ä¸€ä¸ªçŸ©å½¢å…¨éƒ¨æ¶‚æˆç™½è‰²çš„æœ€å°è´¹ç”¨ï¼ŒçŠ¶æ€è½¬ç§»è€ƒè™‘ç”±ä¸¤ä¸ªå­çŸ©å½¢åˆå¹¶æˆ–å°†ä¸€æ•´å—ä¸Šè‰²å³å¯ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://codeforces.com/contest/1199&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æ¯”èµ›é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;äººç”Ÿç¬¬äºŒæ¬¡è§‰å¾—CFçš„é¢˜è¿˜æ˜¯å¯åšçš„ã€‚ç›®å‰åªå¼„äº†5é“ï¼Œå‰©ä¸‹ä¸€é¢˜å’•ç€ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="CFæ¸¸è®°" scheme="https://tth37.cn/categories/CF%E6%B8%B8%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>ç®—æ³•å­¦ä¹ -splayä¼¸å±•æ ‘</title>
    <link href="https://tth37.cn/2019/07/24/algorithm-splay/"/>
    <id>https://tth37.cn/2019/07/24/algorithm-splay/</id>
    <published>2019-07-23T17:21:01.000Z</published>
    <updated>2019-08-27T05:03:11.657Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æœ¬æ–‡éƒ¨åˆ†å†…å®¹è½¬è½½è‡ª <a href="https://oi-wiki.org/ds/splay/" target="_blank" rel="noopener">OI Wiki Splay</a></p><p>$\LaTeX$ å°±å…ˆå’•ç€å§â€¦â€¦æœ‰æ—¶é—´æ…¢æ…¢æ</p></blockquote><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>Splayæ˜¯ä¸€ç§äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œå®ƒé€šè¿‡ä¸æ–­å°†æŸä¸ªèŠ‚ç‚¹æ—‹è½¬åˆ°æ ¹èŠ‚ç‚¹ï¼Œä½¿å¾—æ•´æ£µæ ‘ä»ç„¶æ»¡è¶³äºŒå‰æŸ¥æ‰¾æ ‘çš„æ€§è´¨ï¼Œå¹¶ä¸”ä¿æŒå¹³è¡¡è€Œä¸è‡³äºé€€åŒ–ä¸ºé“¾ï¼Œå®ƒç”± Daniel Sleator å’Œ Robert Tarjan å‘æ˜ã€‚</p><a id="more"></a><h2 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h2><h3 id="èŠ‚ç‚¹ç»´æŠ¤ä¿¡æ¯"><a href="#èŠ‚ç‚¹ç»´æŠ¤ä¿¡æ¯" class="headerlink" title="èŠ‚ç‚¹ç»´æŠ¤ä¿¡æ¯"></a>èŠ‚ç‚¹ç»´æŠ¤ä¿¡æ¯</h3><ul><li>root æ ¹èŠ‚ç‚¹ç¼–å·</li><li>cnt èŠ‚ç‚¹ä¸ªæ•°</li><li>node[] èŠ‚ç‚¹å†…éƒ¨ä¿¡æ¯<ul><li>fa çˆ¶äº²</li><li>ch[0/1] å·¦å³å„¿å­ç¼–å·</li><li>val èŠ‚ç‚¹æƒå€¼</li><li>cnt æƒå€¼å‡ºç°æ¬¡æ•°</li><li>sum å­æ ‘å¤§å°</li></ul></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> fa, ch[<span class="number">2</span>], val, cnt, sum;</span><br><span class="line">&#125;node[MAXN];</span><br><span class="line"><span class="keyword">int</span> root, cnt;</span><br></pre></td></tr></table></figure><h3 id="åŸºæœ¬æ“ä½œ"><a href="#åŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºæœ¬æ“ä½œ"></a>åŸºæœ¬æ“ä½œ</h3><ul><li>update(u) åœ¨æ”¹å˜èŠ‚ç‚¹ä½ç½®åï¼Œå°†èŠ‚ç‚¹uçš„sumå€¼æ›´æ–°</li><li>identify(u) åˆ¤æ–­èŠ‚ç‚¹uæ˜¯çˆ¶äº²çš„å·¦å„¿å­è¿˜æ˜¯å³å„¿å­</li><li>clear(u) é”€æ¯èŠ‚ç‚¹u</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    node[u].sum = node[u].cnt + node[node[u].ch[<span class="number">0</span>]].sum + node[node[u].ch[<span class="number">1</span>]].sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">identify</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> u == node[node[u].fa].ch[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    node[u].fa = node[u].ch[<span class="number">0</span>] = node[u].ch[<span class="number">1</span>] = node[u].val = node[u].cnt = node[u].sum = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¿æ¥æ“ä½œ"><a href="#è¿æ¥æ“ä½œ" class="headerlink" title="è¿æ¥æ“ä½œ"></a>è¿æ¥æ“ä½œ</h3><ul><li>connect(u, f, p) å°†uè¿æ¥åœ¨fçš„ä¸‹æ–¹ï¼Œè¿æ¥æ–¹å‘ä¸ºp</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">connect</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> f, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    node[u].fa = f;</span><br><span class="line">    node[f].ch[p] = u;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ—‹è½¬æ“ä½œ"><a href="#æ—‹è½¬æ“ä½œ" class="headerlink" title="æ—‹è½¬æ“ä½œ"></a>æ—‹è½¬æ“ä½œ</h3><p>åˆ†æå’•å’•å’•</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y = node[x].fa;</span><br><span class="line">    <span class="keyword">int</span> r = node[y].fa;</span><br><span class="line">    <span class="keyword">int</span> rp = identify(y);</span><br><span class="line">    <span class="keyword">int</span> yp = identify(x);</span><br><span class="line">    <span class="keyword">int</span> b = node[x].ch[yp ^ <span class="number">1</span>];</span><br><span class="line">    connect(b, y, yp);</span><br><span class="line">    connect(y, x, yp ^ <span class="number">1</span>);</span><br><span class="line">    connect(x, r, rp);</span><br><span class="line">    update(y), update(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ—‹è½¬éœ€è¦ä¿è¯ï¼š</strong></p><ul><li>å¹³è¡¡æ ‘çš„ä¸­åºéå†ä¸å˜ï¼ˆä¸èƒ½ç ´åBSTçš„æ€§è´¨ï¼‰</li><li>å—å½±å“çš„èŠ‚ç‚¹ç»´æŠ¤çš„ä¿¡æ¯ä¾ç„¶æ­£ç¡®æœ‰æ•ˆ</li><li>rootå¿…é¡»æŒ‡å‘æ—‹è½¬åçš„æ ¹èŠ‚ç‚¹</li></ul><p><img src="https://cdn.luogu.org/upload/pic/4410.png" alt="å¦‚æœä½ èƒ½çœ‹åˆ°è¿™è¡Œå­—ï¼Œå°±è¯´æ˜å›¾ç‰‡çˆ†ç‚¸äº†"></p><p><img src="https://cdn.luogu.org/upload/pic/4411.png" alt="å¦‚æœä½ èƒ½çœ‹åˆ°è¿™è¡Œå­—ï¼Œå°±è¯´æ˜å›¾ç‰‡çˆ†ç‚¸äº†"></p><p><strong>å…·ä½“åˆ†ææ—‹è½¬æ­¥éª¤ï¼ˆå‡è®¾éœ€è¦æ—‹è½¬çš„èŠ‚ç‚¹ä¸ºxï¼Œå…¶çˆ¶äº²ä¸ºyï¼Œä»¥å³æ—‹ä¸ºä¾‹ï¼‰ï¼š</strong></p><ol><li>å°†yçš„å·¦å„¿å­æŒ‡å‘xçš„å³å„¿å­ï¼Œä¸”xçš„å³å„¿å­çš„çˆ¶äº²æŒ‡å‘y</li><li>å°†xçš„å³å„¿å­æŒ‡å‘yï¼Œä¸”yçš„çˆ¶äº²æŒ‡å‘x</li><li>å¦‚æœåŸæ¥çš„yè¿˜æœ‰çˆ¶äº²zï¼Œé‚£ä¹ˆæŠŠzçš„æŸä¸ªå„¿å­ï¼ˆåŸæ¥yæ‰€åœ¨çš„å„¿å­ä½ç½®ï¼‰æŒ‡å‘xï¼Œä¸”xçš„çˆ¶äº²æŒ‡å‘z</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y = node[x].fa, z = node[y].fa, p = identify(x);</span><br><span class="line">    node[y].ch[p] = node[x].ch[p ^ <span class="number">1</span>];</span><br><span class="line">    node[node[x].ch[p ^ <span class="number">1</span>]].fa = y;</span><br><span class="line">    node[x].ch[p ^ <span class="number">1</span>] = y;</span><br><span class="line">    node[y].fa = x;</span><br><span class="line">    node[x].fa = z;</span><br><span class="line">    <span class="keyword">if</span> (z) node[z].ch[y == node[z].ch[<span class="number">1</span>]] = x;</span><br><span class="line">    update(y);</span><br><span class="line">    update(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Splay-æ“ä½œ"><a href="#Splay-æ“ä½œ" class="headerlink" title="Splay æ“ä½œ"></a>Splay æ“ä½œ</h3><p>Splayè§„å®šï¼šæ¯è®¿é—®ä¸€ä¸ªèŠ‚ç‚¹åéƒ½è¦å¼ºåˆ¶å°†å…¶æ—‹è½¬åˆ°æ ¹èŠ‚ç‚¹ã€‚æ­¤æ—¶æ—‹è½¬æ“ä½œå…·ä½“åˆ†ä¸º6ç§æƒ…å†µè®¨è®ºï¼ˆå…¶ä¸­xä¸ºéœ€è¦æ—‹è½¬åˆ°æ ¹çš„èŠ‚ç‚¹ï¼‰</p><p><img src="https://oi-wiki.org/ds/images/splay1.png" alt></p><p>åˆ†æå’•å’•å’•</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> f = node[x].fa; f = node[x].fa, f; rotate(x)) </span><br><span class="line">        <span class="keyword">if</span> (node[f].fa &amp;&amp; identify(x) == identify(f)) rotate(f);</span><br><span class="line">   root = x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ’å…¥æ“ä½œ"><a href="#æ’å…¥æ“ä½œ" class="headerlink" title="æ’å…¥æ“ä½œ"></a>æ’å…¥æ“ä½œ</h3><p>åˆ†æå’•å’•å’•</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="number">0</span>) &#123;</span><br><span class="line">        node[++cnt].val = val;</span><br><span class="line">        node[cnt].cnt++;</span><br><span class="line">        root = cnt;</span><br><span class="line">        update(root);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> cur = root, f = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (node[cur].val == val) &#123;</span><br><span class="line">            node[cur].cnt++;</span><br><span class="line">            update(cur);</span><br><span class="line">            update(f);</span><br><span class="line">            splay(cur);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        f = cur, cur = node[cur].ch[node[cur].val &lt; k];</span><br><span class="line">        <span class="keyword">if</span> (cur == <span class="number">0</span>) &#123;</span><br><span class="line">            node[++cnt].val = val;</span><br><span class="line">            node[cnt].cnt++;</span><br><span class="line">            node[cnt].fa = f;</span><br><span class="line">            node[f].ch[node[f].val &lt; k] = cnt;</span><br><span class="line">            update(cnt);</span><br><span class="line">            update(f);</span><br><span class="line">            splay(cnt);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æŸ¥è¯¢xçš„æ’å"><a href="#æŸ¥è¯¢xçš„æ’å" class="headerlink" title="æŸ¥è¯¢xçš„æ’å"></a>æŸ¥è¯¢xçš„æ’å</h3><p>åˆ†æå’•å’•å’•</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">queryid</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>, cur = root;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (val &lt; node[cur].val) cur = node[cur].ch[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            ans += node[node[cur].ch[<span class="number">0</span>]].sum;</span><br><span class="line">            <span class="keyword">if</span> (val == node[cur].val) &#123;</span><br><span class="line">                splay(cur);</span><br><span class="line">                <span class="keyword">return</span> ans + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            ans += node[cur].cnt;</span><br><span class="line">            cur = node[cur].ch[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æŸ¥è¯¢æ’åä¸ºkçš„æ•°"><a href="#æŸ¥è¯¢æ’åä¸ºkçš„æ•°" class="headerlink" title="æŸ¥è¯¢æ’åä¸ºkçš„æ•°"></a>æŸ¥è¯¢æ’åä¸ºkçš„æ•°</h3><p>åˆ†æå’•å’•å’•</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">queryrid</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cur = root;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (node[cur].ch[<span class="number">0</span>] &amp;&amp; k &lt;= node[node[cur].ch[<span class="number">0</span>]].sum) cur = node[cur].ch[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            k -= node[cur].cnt + node[node[cur].ch[<span class="number">0</span>]].sum;</span><br><span class="line">            <span class="keyword">if</span> (k &lt;= <span class="number">0</span>) <span class="keyword">return</span> node[cur].val;</span><br><span class="line">            cur = node[cur].ch[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æŸ¥è¯¢å‰é©±"><a href="#æŸ¥è¯¢å‰é©±" class="headerlink" title="æŸ¥è¯¢å‰é©±"></a>æŸ¥è¯¢å‰é©±</h3><p>åˆ†æå¤å¤å¤</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">querypre</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    insert(val);</span><br><span class="line">    <span class="keyword">int</span> cur = node[root].ch[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">while</span> (node[cur].ch[<span class="number">1</span>]) cur = node[cur].ch[<span class="number">1</span>];</span><br><span class="line">    delet(val);</span><br><span class="line">    <span class="keyword">return</span> cur;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æŸ¥è¯¢åç»§"><a href="#æŸ¥è¯¢åç»§" class="headerlink" title="æŸ¥è¯¢åç»§"></a>æŸ¥è¯¢åç»§</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">querynxt</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    insert(val);</span><br><span class="line">    <span class="keyword">int</span> cur = node[root].ch[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">while</span> (node[cur].ch[<span class="number">0</span>]) cur = node[cur].ch[<span class="number">0</span>];</span><br><span class="line">    delet(val);</span><br><span class="line">    <span class="keyword">return</span> cur;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ é™¤å…ƒç´ "><a href="#åˆ é™¤å…ƒç´ " class="headerlink" title="åˆ é™¤å…ƒç´ "></a>åˆ é™¤å…ƒç´ </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delet</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    queryid(val);</span><br><span class="line">    <span class="keyword">if</span> (node[root].cnt &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        node[root].cnt--;</span><br><span class="line">        update(root);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (node[root].ch[<span class="number">0</span>] == <span class="number">0</span> &amp;&amp; node[root].ch[<span class="number">1</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">        clear(root);</span><br><span class="line">        root = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (node[root].ch[<span class="number">1</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> cur = root;</span><br><span class="line">        root = node[root].ch[<span class="number">0</span>];</span><br><span class="line">        node[root].fa = <span class="number">0</span>;</span><br><span class="line">        clear(cur);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (node[root].ch[<span class="number">0</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> cur = root;</span><br><span class="line">        root = node[root].ch[<span class="number">1</span>];</span><br><span class="line">        node[root].fa = <span class="number">0</span>;</span><br><span class="line">        clear(cur);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> u = querypre(val), cur = root; <span class="comment">// ???</span></span><br><span class="line">    node[node[cur].ch[<span class="number">1</span>]].fa = u;</span><br><span class="line">    node[u].ch[<span class="number">1</span>] = node[cur].ch[<span class="number">1</span>];</span><br><span class="line">    clear(cur);</span><br><span class="line">    update(root);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡éƒ¨åˆ†å†…å®¹è½¬è½½è‡ª &lt;a href=&quot;https://oi-wiki.org/ds/splay/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;OI Wiki Splay&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;$\LaTeX$ å°±å…ˆå’•ç€å§â€¦â€¦æœ‰æ—¶é—´æ…¢æ…¢æ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h2&gt;&lt;p&gt;Splayæ˜¯ä¸€ç§äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œå®ƒé€šè¿‡ä¸æ–­å°†æŸä¸ªèŠ‚ç‚¹æ—‹è½¬åˆ°æ ¹èŠ‚ç‚¹ï¼Œä½¿å¾—æ•´æ£µæ ‘ä»ç„¶æ»¡è¶³äºŒå‰æŸ¥æ‰¾æ ‘çš„æ€§è´¨ï¼Œå¹¶ä¸”ä¿æŒå¹³è¡¡è€Œä¸è‡³äºé€€åŒ–ä¸ºé“¾ï¼Œå®ƒç”± Daniel Sleator å’Œ Robert Tarjan å‘æ˜ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç®—æ³•å­¦ä¹ " scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="æ•°æ®ç»“æ„" scheme="https://tth37.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="å¹³è¡¡æ ‘" scheme="https://tth37.cn/tags/%E5%B9%B3%E8%A1%A1%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p3275ç³–æœ</title>
    <link href="https://tth37.cn/2019/07/23/solution-luogu-p3275/"/>
    <id>https://tth37.cn/2019/07/23/solution-luogu-p3275/</id>
    <published>2019-07-23T15:28:24.000Z</published>
    <updated>2019-07-23T15:34:21.841Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/P3275" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º$n$çš„åºåˆ—ä»¥åŠ$k$ä¸ªæ¡ä»¶ï¼Œæ¯ä¸ªæ¡ä»¶è¦æ±‚åºåˆ—å½“ä¸­ä¸€ä¸ªç‚¹çš„æƒå€¼å¤§äº/å°äº/ä¸å¤§äº/ä¸å°äº/ç­‰äºå¦ä¸€ä¸ªç‚¹ã€‚æ±‚è¿™ä¸ªåºåˆ—æ€»å’Œçš„æœ€å°å€¼</p><p>$1 \le k,n \le 100000$</p><p>æ„Ÿè°¢@oy çš„è´¡çŒ®</p></blockquote><a id="more"></a><p>å·®åˆ†çº¦æŸç³»ç»Ÿçš„æ¨¡æ¿é¢˜ã€‚</p><p>è®° $d$ æ•°ç»„ä¸ºä»¥ $S$ ä¸ºæºç‚¹åˆ°å„ä¸ªèŠ‚ç‚¹çš„æœ€é•¿è·¯ã€‚æ ¹æ®æœ€é•¿è·¯çš„æ€§è´¨ï¼Œå¦‚æœå­˜åœ¨ä¸€æ¡è¾¹ $(u,v,w)$ ï¼Œåˆ™ä¸€å®šæ»¡è¶³ä»¥ä¸‹ä¸ç­‰å¼ï¼š</p><script type="math/tex; mode=display">d[u]+w(u,v)\le d[v]</script><p>æˆ‘ä»¬å¯ä»¥å°†é¢˜ç›®ä¸­ç»™å‡ºçš„ä¸ç­‰å…³ç³»è½¬åŒ–ä¸ºå›¾ä¸­çš„æœ‰å‘è¾¹ï¼Œç„¶åé€šè¿‡å•æºæœ€é•¿è·¯æ±‚å‡ºçš„ä¸€ç»„ $\lbrace d_n\rbrace$ å³ä¸ºå·®åˆ†çº¦æŸç³»ç»Ÿçš„ä¸€ç»„è§£ã€‚</p><p>å› æ­¤ï¼Œåœ¨å›¾ä¸­è¿ä¸€æ¡è¾¹ $(u,v,w)$ ç›¸å½“äºå¯¹ $d[u]$ å’Œ $d[v]$ çš„å–å€¼ä½œå‡ºé™åˆ¶ï¼Œæˆ‘ä»¬åªéœ€åœ¨æ„é€ å‡ºä¸€å¼ æœ‰å‘å›¾ï¼Œå¹¶æ±‚å‡ºå…¶å•æºæœ€é•¿è·¯å³ä¸ºç­”æ¡ˆã€‚</p><p>æœ‰å‘è¾¹çš„æ„é€ æ–¹å¼å¦‚ä¸‹ï¼š</p><ol><li>é™åˆ¶ $d[A]=d[B]$</li></ol><script type="math/tex; mode=display">d[A]=d[B] \Leftrightarrow (d[B]\le d[A])\wedge(d[A]\le d[B])</script><script type="math/tex; mode=display">\Leftrightarrow (d[B]+0\le d[A])\wedge(d[A]+0\le d[B])</script><p>è¿è¾¹ï¼š$(A,B,0)$ï¼Œ$(B,A,0)$</p><ol><li>é™åˆ¶ $d[A]&lt;d[B]$<script type="math/tex; mode=display">d[A]<d[B]\Leftrightarrow d[A]+1\le d[B]</script></li></ol><p>è¿è¾¹ï¼š$(A,B,1)$</p><ol><li>é™åˆ¶ $d[A]\geq d[B]$<script type="math/tex; mode=display">d[A]\ge d[B]\Leftrightarrow d[B]+0\le d[A]</script></li></ol><p>è¿è¾¹ï¼š$(B,A,0)$</p><ol><li>é™åˆ¶ $d[A]&gt;d[B]$<script type="math/tex; mode=display">d[A]>d[B]\Leftrightarrow d[B]+1\le d[A]</script></li></ol><p>è¿è¾¹ï¼š$(B,A,1)$</p><ol><li>é™åˆ¶ $d[A]\le d[B]$</li></ol><p>è¿è¾¹ï¼š$(A,B,0)$</p><ol><li>é™åˆ¶ $d[i]&gt;0$</li></ol><p>è¿è¾¹ï¼š$(S,i,1)$</p><p>è¿å®Œæ‰€æœ‰çš„è¾¹åï¼Œè·‘ä¸€éå•æºæœ€é•¿è·¯ï¼›å¦‚æœå­˜åœ¨æ­£ç¯åˆ™è¾“å‡ºæ— è§£ã€‚</p><p>ç»Ÿè®¡ç­”æ¡ˆæ—¶è®°å¾—å¼€$long$ $long$ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> die &#123;puts(<span class="meta-string">"-1"</span>); exit(0);&#125;</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100005</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> v, w;</span><br><span class="line">Edge(<span class="keyword">int</span> v, <span class="keyword">int</span> w) &#123;</span><br><span class="line"><span class="keyword">this</span> -&gt; v = v, <span class="keyword">this</span> -&gt; w = w;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;Edge&gt; G[MAXN];</span><br><span class="line"><span class="keyword">int</span> N, K;</span><br><span class="line"><span class="keyword">bool</span> inq[MAXN];</span><br><span class="line"><span class="keyword">int</span> d[MAXN], cnt[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">G[u].push_back(Edge(v, w));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SPFA</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">q.push(N + <span class="number">1</span>);</span><br><span class="line">d[N + <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">inq[N + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line"><span class="keyword">int</span> u = q.front();</span><br><span class="line">q.pop();</span><br><span class="line"><span class="keyword">if</span> (cnt[u] &gt;= N) die</span><br><span class="line">cnt[u]++;</span><br><span class="line">inq[u] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">vector</span>&lt;Edge&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line"><span class="keyword">int</span> v = it -&gt; v, w = it -&gt; w;</span><br><span class="line"><span class="keyword">if</span> (d[u] + w &gt; d[v]) &#123;</span><br><span class="line">d[v] = d[u] + w;</span><br><span class="line"><span class="keyword">if</span> (inq[v] == <span class="number">0</span>) &#123;</span><br><span class="line">inq[v] = <span class="number">1</span>;</span><br><span class="line">q.push(v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;N, &amp;K);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; ++i) &#123;</span><br><span class="line"><span class="keyword">int</span> X, A, B;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;X, &amp;A, &amp;B);</span><br><span class="line"><span class="keyword">switch</span> (X) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">AddEdge(A, B, <span class="number">0</span>);</span><br><span class="line">AddEdge(B, A, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line"><span class="keyword">if</span> (A == B) die</span><br><span class="line">AddEdge(A, B, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">AddEdge(B, A, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line"><span class="keyword">if</span> (A == B) die</span><br><span class="line">AddEdge(B, A, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">AddEdge(A, B, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">AddEdge(N + <span class="number">1</span>, i, <span class="number">1</span>);</span><br><span class="line">SPFA();</span><br><span class="line">ll ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">ans += d[i];</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld"</span>, ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/P3275&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º$n$çš„åºåˆ—ä»¥åŠ$k$ä¸ªæ¡ä»¶ï¼Œæ¯ä¸ªæ¡ä»¶è¦æ±‚åºåˆ—å½“ä¸­ä¸€ä¸ªç‚¹çš„æƒå€¼å¤§äº/å°äº/ä¸å¤§äº/ä¸å°äº/ç­‰äºå¦ä¸€ä¸ªç‚¹ã€‚æ±‚è¿™ä¸ªåºåˆ—æ€»å’Œçš„æœ€å°å€¼&lt;/p&gt;
&lt;p&gt;$1 \le k,n \le 100000$&lt;/p&gt;
&lt;p&gt;æ„Ÿè°¢@oy çš„è´¡çŒ®&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="æœ€çŸ­è·¯" scheme="https://tth37.cn/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/"/>
    
      <category term="å·®åˆ†çº¦æŸç³»ç»Ÿ" scheme="https://tth37.cn/tags/%E5%B7%AE%E5%88%86%E7%BA%A6%E6%9D%9F%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p4175ç½‘ç»œç®¡ç†</title>
    <link href="https://tth37.cn/2019/07/21/solution-luogu-p4175/"/>
    <id>https://tth37.cn/2019/07/21/solution-luogu-p4175/</id>
    <published>2019-07-21T14:42:33.000Z</published>
    <updated>2019-07-23T15:35:15.422Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/P4175" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>ç»™å®šä¸€æ£µ$n$ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œè¿›è¡Œ$q$æ¬¡æ“ä½œï¼šå•ç‚¹ä¿®æ”¹ï¼Œæˆ–æŸ¥è¯¢ä¸€æ¡æ ‘é“¾ä¸Šçš„ç¬¬$k$å°å€¼ã€‚</p><p>$n,q \le 80000,0 \le k \le n$</p><p>æ„Ÿè°¢@oyçš„è´¡çŒ®</p></blockquote><a id="more"></a><p>æ€è·¯ï¼šæ ‘é“¾å‰–åˆ†+æ ‘çŠ¶æ•°ç»„å¥—ä¸»å¸­æ ‘</p><p>è€ƒè™‘åˆ°æƒå€¼çº¿æ®µæ ‘è‡ªå¸¦buffâ€”â€”æ•´ä½“äºŒåˆ†ï¼Œä¸éš¾æƒ³åˆ°å¯¹æ ‘é“¾ä¸Šçš„æƒå€¼çº¿æ®µæ ‘æ±‚å’Œï¼Œå¹¶åœ¨åˆå¹¶åçš„æƒå€¼çº¿æ®µæ ‘ä¸Šæ±‚ç¬¬ $k$ å¤§å³å¯æ„‰å¿«åœ°è§£å†³æœ¬é¢˜ã€‚</p><p>åœ¨æ ‘é“¾ä¸Šçš„æ±‚å’Œæ“ä½œå¯ä»¥ç”¨æ ‘å‰–åŠ çº¿æ€§æ•°æ®ç»“æ„è¿›è¡Œç»´æŠ¤ã€‚æœ¬é¢˜éœ€è¦æ”¯æŒçš„æ“ä½œåªæœ‰å•ç‚¹ä¿®æ”¹å’ŒåŒºé—´æŸ¥è¯¢ï¼Œæ‰€ä»¥å¯ä»¥ç”¨æ ‘çŠ¶æ•°ç»„å¥—ä¸»å¸­æ ‘ç»´æŠ¤ dfs åºä¸Šçš„ä¿¡æ¯ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> id(x) (lower_bound(b + 1, b + L + 1, x) - b)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rid(x) (b[x])</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson(x) (node[x].l)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson(x) (node[x].r)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sum(x) (node[x].sum)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lowbit(x) (x &amp; (-x))</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">80005</span> * <span class="number">2</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAXN];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">opt</span> &#123;</span><span class="keyword">int</span> k, a, b;&#125; op[MAXN];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, sum;</span><br><span class="line">    Node() &#123;l = r = sum = <span class="number">0</span>;&#125;</span><br><span class="line">&#125; node[MAXN * <span class="number">80</span>];</span><br><span class="line"><span class="keyword">int</span> c[MAXN], cnt;</span><br><span class="line"><span class="keyword">int</span> N, Q, L;</span><br><span class="line"><span class="keyword">int</span> t[MAXN], b[MAXN];</span><br><span class="line"><span class="keyword">int</span> q1[MAXN], q2[MAXN], len1, len2;</span><br><span class="line"><span class="keyword">int</span> dep[MAXN], dfn[MAXN], f[MAXN], son[MAXN], top[MAXN], size[MAXN], dfn_idx;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span>&amp; u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (u == <span class="number">0</span>) u = ++cnt;</span><br><span class="line">    sum(u) += val;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (p &lt;= mid) insert(lson(u), l, mid, p, val);</span><br><span class="line">    <span class="keyword">else</span> insert(rson(u), mid + <span class="number">1</span>, r, p, val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> p, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (; u &lt;= N; u += lowbit(u)) insert(c[u], <span class="number">1</span>, L, p, val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    dep[u] = dep[fa] + <span class="number">1</span>;</span><br><span class="line">    f[u] = fa;</span><br><span class="line">    size[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = *it;</span><br><span class="line">        <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs1(v, u);</span><br><span class="line">        <span class="keyword">if</span> (size[v] &gt; size[son[u]]) son[u] = v;</span><br><span class="line">        size[u] += size[v];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> topc)</span> </span>&#123;</span><br><span class="line">    dfn[u] = ++dfn_idx;</span><br><span class="line">    top[u] = topc;</span><br><span class="line">    modify(dfn[u], t[u], <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (son[u]) dfs2(son[u], topc);</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = *it;</span><br><span class="line">        <span class="keyword">if</span> (v == son[u] || v == f[u]) <span class="keyword">continue</span>;</span><br><span class="line">        dfs2(v, v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre_bin</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span>* a, <span class="keyword">int</span>&amp; len)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (; u &gt;= <span class="number">1</span>; u -= lowbit(u)) a[++len] = c[u];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pre</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    len1 = len2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (top[u] != top[v]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dep[top[u]] &lt; dep[top[v]]) swap(u, v);</span><br><span class="line">        pre_bin(dfn[u], q1, len1);</span><br><span class="line">        pre_bin(dfn[top[u]] - <span class="number">1</span>, q2, len2);</span><br><span class="line">        u = f[top[u]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v]) swap(u, v);</span><br><span class="line">    pre_bin(dfn[u], q1, len1);</span><br><span class="line">    pre_bin(dfn[v] - <span class="number">1</span>, q2, len2);</span><br><span class="line">    <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> l;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, rsum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len1; ++i) rsum += sum(rson(q1[i]));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len2; ++i) rsum -= sum(rson(q2[i]));</span><br><span class="line">    <span class="keyword">if</span> (k &lt;= rsum) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len1; ++i) q1[i] = rson(q1[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len2; ++i) q2[i] = rson(q2[i]);</span><br><span class="line">        <span class="keyword">return</span> query(mid + <span class="number">1</span>, r, k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len1; ++i) q1[i] = lson(q1[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len2; ++i) q2[i] = lson(q2[i]);</span><br><span class="line">        <span class="keyword">return</span> query(l, mid, k - rsum);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;N, &amp;Q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;t[i]), b[++L] = t[i], c[i] = ++cnt;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> u, v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v);</span><br><span class="line">        G[u].push_back(v), G[v].push_back(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Q; ++i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;op[i].k, &amp;op[i].a, &amp;op[i].b);</span><br><span class="line">        <span class="keyword">if</span> (op[i].k == <span class="number">0</span>) b[++L] = op[i].b;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(b + <span class="number">1</span>, b + L + <span class="number">1</span>);</span><br><span class="line">    L = unique(b + <span class="number">1</span>, b + L + <span class="number">1</span>) - b - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) t[i] = id(t[i]);</span><br><span class="line">    dfs1(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    dfs2(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Q; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> k = op[i].k, a = op[i].a, b_ = op[i].b;</span><br><span class="line">        <span class="keyword">if</span> (k == <span class="number">0</span>) &#123;</span><br><span class="line">            b_ = id(b_);</span><br><span class="line">            modify(dfn[a], t[a], <span class="number">-1</span>);</span><br><span class="line">            t[a] = b_;</span><br><span class="line">            modify(dfn[a], t[a], <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> lca = pre(a, b_);</span><br><span class="line">            <span class="keyword">int</span> maxk = dep[a] + dep[b_] - dep[lca] * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (maxk &lt; k) &#123;</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">"invalid request!"</span>);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, rid(query(<span class="number">1</span>, L, k)));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/P4175&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç»™å®šä¸€æ£µ$n$ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œè¿›è¡Œ$q$æ¬¡æ“ä½œï¼šå•ç‚¹ä¿®æ”¹ï¼Œæˆ–æŸ¥è¯¢ä¸€æ¡æ ‘é“¾ä¸Šçš„ç¬¬$k$å°å€¼ã€‚&lt;/p&gt;
&lt;p&gt;$n,q \le 80000,0 \le k \le n$&lt;/p&gt;
&lt;p&gt;æ„Ÿè°¢@oyçš„è´¡çŒ®&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="ä¸»å¸­æ ‘" scheme="https://tth37.cn/tags/%E4%B8%BB%E5%B8%AD%E6%A0%91/"/>
    
      <category term="æ ‘çŠ¶æ•°ç»„" scheme="https://tth37.cn/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/"/>
    
      <category term="æ ‘é“¾å‰–åˆ†" scheme="https://tth37.cn/tags/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/"/>
    
      <category term="æ ‘å¥—æ ‘" scheme="https://tth37.cn/tags/%E6%A0%91%E5%A5%97%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>ç®—æ³•å­¦ä¹ -æ ‘å¥—æ ‘</title>
    <link href="https://tth37.cn/2019/07/21/algorithm-treeintree/"/>
    <id>https://tth37.cn/2019/07/21/algorithm-treeintree/</id>
    <published>2019-07-21T05:39:53.000Z</published>
    <updated>2019-07-23T17:23:55.898Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æœ¬æ–‡éƒ¨åˆ†å†…å®¹è½¬è½½è‡ª <a href="https://oi-wiki.org/ds/persistent-in-bit/" target="_blank" rel="noopener">OI Wiki æ ‘çŠ¶æ•°ç»„å¥—ä¸»å¸­æ ‘</a></p></blockquote><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>æ™®é€šæ•°æ®ç»“æ„ç»´æŠ¤å•ä¸€ç»´åº¦ä¿¡æ¯ï¼Œæ ‘å¥—æ ‘ç»´æŠ¤å¤šç»´åº¦ä¿¡æ¯ã€‚</p><a id="more"></a><h2 id="æ ‘çŠ¶æ•°ç»„å¥—æƒå€¼çº¿æ®µæ ‘"><a href="#æ ‘çŠ¶æ•°ç»„å¥—æƒå€¼çº¿æ®µæ ‘" class="headerlink" title="æ ‘çŠ¶æ•°ç»„å¥—æƒå€¼çº¿æ®µæ ‘"></a>æ ‘çŠ¶æ•°ç»„å¥—æƒå€¼çº¿æ®µæ ‘</h2><p>æ ‘çŠ¶æ•°ç»„å¥—æƒå€¼çº¿æ®µæ ‘å¯ä»¥åœ¨ $O(n \log^2 n)$ çš„æ—¶é—´å¤æ‚åº¦è§£å†³åŠ¨æ€åŒºé—´ $k$ å°å€¼é—®é¢˜ã€‚</p><p>å¦‚æœç”¨<a href="https://oi-wiki.org/ds/balanced-in-seg/" target="_blank" rel="noopener">çº¿æ®µæ ‘å¥—å¹³è¡¡æ ‘</a>ä¸­æ‰€è®ºè¿°çš„ï¼Œç”¨çº¿æ®µæ ‘å¥—å¹³è¡¡æ ‘ï¼Œå³å¯¹äºçº¿æ®µæ ‘çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¯¹äºå…¶æ‰€è¡¨ç¤ºçš„åŒºé—´ç»´æŠ¤ä¸€ä¸ªå¹³è¡¡æ ‘ï¼Œç„¶åç”¨äºŒåˆ†æ¥æŸ¥æ‰¾ $k$ å°å€¼ã€‚ç”±äºæ¯æ¬¡æŸ¥è¯¢æ“ä½œéƒ½è¦è¦†ç›–å¤šä¸ªåŒºé—´ï¼Œå³æœ‰å¤šä¸ªèŠ‚ç‚¹ï¼Œä½†æ˜¯å¹³è¡¡æ ‘å¹¶ä¸èƒ½å¤šä¸ªå€¼ä¸€èµ·æŸ¥æ‰¾ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n\log^3 n)$ï¼Œå¹¶ä¸æ˜¯æœ€ä¼˜çš„ã€‚</p><p>æ€è·¯æ˜¯ï¼ŒæŠŠäºŒåˆ†ç­”æ¡ˆçš„æ“ä½œå’ŒæŸ¥è¯¢å°äºä¸€ä¸ªå€¼çš„æ•°çš„æ•°é‡ä¸¤ç§æ“ä½œç»“åˆèµ·æ¥ã€‚æœ€å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨ <strong>çº¿æ®µæ ‘å¥—ä¸»å¸­æ ‘</strong> ã€‚</p><p>è¯´æ˜¯ä¸»å¸­æ ‘å…¶å®ä¸å‡†ç¡®ï¼Œå› ä¸ºå¹¶ä¸æ˜¯å¯¹çº¿æ®µæ ‘çš„å¯æŒä¹…åŒ–ï¼Œå„ä¸ªçº¿æ®µæ ‘ä¹‹é—´ä¹Ÿæ²¡æœ‰åƒä¸»å¸­æ ‘å„ç‰ˆæœ¬ä¹‹é—´çš„å¼ºå…³è”æ€§ï¼Œæ‰€ä»¥ç§°ä¸º <strong>åŠ¨æ€å¼€ç‚¹æƒå€¼çº¿æ®µæ ‘</strong> æ›´ä¸ºç¡®åˆ‡ã€‚</p><p>æ€è·¯ç±»ä¼¼äºçº¿æ®µæ ‘å¥—å¹³è¡¡æ ‘ï¼Œå³å¯¹äºçº¿æ®µæ ‘æ‰€ç»´æŠ¤çš„æ¯ä¸ªåŒºé—´ï¼Œå»ºç«‹ä¸€ä¸ªåŠ¨æ€å¼€ç‚¹æƒå€¼çº¿æ®µæ ‘ï¼Œè¡¨ç¤ºå…¶æ‰€ç»´æŠ¤çš„åŒºé—´çš„å€¼ã€‚</p><p>åœ¨ä¿®æ”¹æ“ä½œè¿›è¡Œæ—¶ï¼Œå…ˆåœ¨çº¿æ®µæ ‘ä¸Šä»ä¸Šå¾€ä¸‹è·³åˆ°è¢«ä¿®æ”¹çš„ç‚¹ï¼Œåˆ é™¤æ‰€ç»è¿‡çš„ç‚¹æ‰€æŒ‡å‘çš„åŠ¨æ€å¼€ç‚¹æƒå€¼çº¿æ®µæ ‘ä¸Šçš„åŸæ¥çš„å€¼ï¼Œç„¶åæ’å…¥æ–°çš„å€¼ï¼Œè¦ç»è¿‡ $O(\log n)$ ä¸ªçº¿æ®µæ ‘ä¸Šçš„èŠ‚ç‚¹ï¼Œåœ¨åŠ¨æ€å¼€ç‚¹æƒå€¼çº¿æ®µæ ‘ä¸Šä¸€æ¬¡ä¿®æ”¹æ“ä½œæ˜¯ $O(\log n)$ çš„ï¼Œæ‰€ä»¥ä¿®æ”¹æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º $O(\log^2 n)$ ã€‚</p><p>ç”±äºçº¿æ®µæ ‘çš„å¸¸æ•°è¾ƒå¤§ï¼Œåœ¨å®ç°ä¸­å¾€å¾€ä½¿ç”¨å¸¸æ•°æ›´å°ä¸”æ›´æ–¹ä¾¿å¤„ç†å‰ç¼€å’Œçš„ <strong>æ ‘çŠ¶æ•°ç»„</strong> å®ç°ã€‚</p><p>ç»™å‡ºä¸€ç§ä»£ç å®ç°ï¼š<a href="https://www.luogu.org/problemnew/show/P2617" target="_blank" rel="noopener">luogu-p2617</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> id(x) (lower_bound(b + 1, b + L + 1, x) - b)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rid(x) (b[x])</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lowbit(x) (x &amp; (-x))</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100005</span> * <span class="number">2</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">op</span> &#123;</span></span><br><span class="line">    <span class="keyword">char</span> opt;</span><br><span class="line">    <span class="keyword">int</span> i, j, k, t;</span><br><span class="line">&#125;ops[MAXN];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, sum;</span><br><span class="line">    Node() &#123;l = r = sum = <span class="number">0</span>;&#125;</span><br><span class="line">&#125;node[MAXN * <span class="number">80</span>];</span><br><span class="line"><span class="keyword">int</span> cnt, c[MAXN];</span><br><span class="line"><span class="keyword">int</span> N, M, L;</span><br><span class="line"><span class="keyword">int</span> a[MAXN], b[MAXN];</span><br><span class="line"><span class="keyword">int</span> qr[MAXN], ql[MAXN], qrlen, qllen;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span>&amp; u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (u == <span class="number">0</span>) u = ++cnt;</span><br><span class="line">    node[u].sum += val;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (p &lt;= mid) insert(node[u].l, l, mid, p, val);</span><br><span class="line">    <span class="keyword">else</span> insert(node[u].r, mid + <span class="number">1</span>, r, p, val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> p, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (; u &lt;= N; u += lowbit(u)) insert(c[u], <span class="number">1</span>, L, p, val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span>* a, <span class="keyword">int</span>&amp; len)</span> </span>&#123;</span><br><span class="line">    len = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (; u &gt;= <span class="number">1</span>; u -= lowbit(u)) a[++len] = c[u];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> l;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, lsum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= qrlen; ++i) lsum += node[node[qr[i]].l].sum;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= qllen; ++i) lsum -= node[node[ql[i]].l].sum;</span><br><span class="line">    <span class="keyword">if</span> (lsum &gt;= k) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= qrlen; ++i) qr[i] = node[qr[i]].l;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= qllen; ++i) ql[i] = node[ql[i]].l;</span><br><span class="line">        <span class="keyword">return</span> query(l, mid, k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= qrlen; ++i) qr[i] = node[qr[i]].r;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= qllen; ++i) ql[i] = node[ql[i]].r;</span><br><span class="line">        <span class="keyword">return</span> query(mid + <span class="number">1</span>, r, k - lsum);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;N, &amp;M);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]), b[++L] = a[i], c[i] = ++cnt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; ops[i].opt;</span><br><span class="line">        <span class="keyword">if</span> (ops[i].opt == <span class="string">'Q'</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;ops[i].i, &amp;ops[i].j, &amp;ops[i].k);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;ops[i].i, &amp;ops[i].t);</span><br><span class="line">            b[++L] = ops[i].t;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(b + <span class="number">1</span>, b + L + <span class="number">1</span>);</span><br><span class="line">    L = unique(b + <span class="number">1</span>, b + L + <span class="number">1</span>) - b - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">        a[i] = id(a[i]);</span><br><span class="line">        modify(i, a[i], <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ops[i].opt == <span class="string">'Q'</span>) &#123;</span><br><span class="line">            pre(ops[i].j, qr, qrlen);</span><br><span class="line">            pre(ops[i].i - <span class="number">1</span>, ql, qllen);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, rid(query(<span class="number">1</span>, L, ops[i].k)));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            modify(ops[i].i, a[ops[i].i], <span class="number">-1</span>);</span><br><span class="line">            a[ops[i].i] = id(ops[i].t);</span><br><span class="line">            modify(ops[i].i, a[ops[i].i], <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœªå®Œå¾…ç»­â€¦â€¦ç­‰æˆ‘å­¦å®Œå¹³è¡¡æ ‘å†æ¥ç€å¼„</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡éƒ¨åˆ†å†…å®¹è½¬è½½è‡ª &lt;a href=&quot;https://oi-wiki.org/ds/persistent-in-bit/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;OI Wiki æ ‘çŠ¶æ•°ç»„å¥—ä¸»å¸­æ ‘&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h2&gt;&lt;p&gt;æ™®é€šæ•°æ®ç»“æ„ç»´æŠ¤å•ä¸€ç»´åº¦ä¿¡æ¯ï¼Œæ ‘å¥—æ ‘ç»´æŠ¤å¤šç»´åº¦ä¿¡æ¯ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç®—æ³•å­¦ä¹ " scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="æ•°æ®ç»“æ„" scheme="https://tth37.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="ä¸»å¸­æ ‘" scheme="https://tth37.cn/tags/%E4%B8%BB%E5%B8%AD%E6%A0%91/"/>
    
      <category term="çº¿æ®µæ ‘" scheme="https://tth37.cn/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
      <category term="æ ‘çŠ¶æ•°ç»„" scheme="https://tth37.cn/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-cf1195c Basketball Exercise</title>
    <link href="https://tth37.cn/2019/07/18/solution-luogu-cf1195c/"/>
    <id>https://tth37.cn/2019/07/18/solution-luogu-cf1195c/</id>
    <published>2019-07-18T13:15:10.000Z</published>
    <updated>2019-07-18T13:18:46.024Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/CF1195C" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>ç»™å®šä¸€ä¸ª$2*n$çš„çŸ©é˜µï¼Œä»ä¸­é€‰å‡ºè‹¥å¹²æ•°ï¼Œä¸”ä»»æ„ä¸¤ä¸ªæ•°ä¸ä¸Šä¸‹æˆ–å·¦å³ç›¸é‚»ï¼Œæ±‚è¿™äº›æ•°çš„æœ€å¤§æ€»å’Œ</p><p>$1\le n \le 100000,1 \le h_{i,j}\le 1000000000$</p></blockquote><a id="more"></a><p>å¾ˆæ°´çš„ä¸€é“Cé¢˜â€¦â€¦ç›®æµ‹éš¾åº¦åœ¨é»„~ç»¿å·¦å³ã€‚è¯·å„ä½åˆ‡é¢˜è€…åˆç†è¯„åˆ†ã€‚</p><p>æ³¨æ„åˆ°å¯ä»¥é€‰æ‹©çš„çƒå‘˜ç¼–å·æ˜¯ä¸¥æ ¼é€’å¢çš„ï¼Œå› æ­¤å¯ä»¥æŠŠçŠ¶æ€çš„ç¬¬ä¸€ç»´å®šä¹‰ä¸ºçƒå‘˜ç¼–å·ï¼Œç¬¬äºŒç»´æè¿°ç¼–å·åŒä¸º $i$ çš„ä¸¤åçƒå‘˜çš„é€‰å–æƒ…å†µã€‚</p><p>å®šä¹‰çŠ¶æ€ï¼š$f[i][0/1/2]$ è¡¨ç¤ºé€‰å–äº†ç¼–å·åœ¨ $i$ åŠä»¥å‰çš„çƒå‘˜ï¼Œæ‰€èƒ½å¾—åˆ°çš„èº«é«˜æ€»å’Œæœ€å¤§å€¼ã€‚å…¶ä¸­ï¼Œç¬¬äºŒç»´çš„ $0$ è¡¨ç¤ºç¼–å·ä¸º $i$ çš„çƒå‘˜ä¸€ä¸ªéƒ½ä¸é€‰ï¼›$1$ è¡¨ç¤ºåªé€‰ä¸Šé¢ä¸€ä¸ªï¼›$i$ è¡¨ç¤ºåªé€‰ä¸‹é¢ä¸€ä¸ªã€‚ï¼ˆæ˜¾ç„¶æ²¡æœ‰ä¸Šä¸‹éƒ½é€‰çš„æƒ…å†µï¼‰</p><p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">f[i][0]=max\lbrace f[i-1][0],f[i-1][1],f[i-1][2]\rbrace</script><script type="math/tex; mode=display">f[i][1]=max\lbrace f[i-1][0],f[i-1][2]\rbrace+height[i][1]</script><script type="math/tex; mode=display">f[i][2]=max\lbrace f[i-1][0],f[i-1][1]\rbrace+height[i][2]</script><p><strong>Update: ç”¨è´ªå¿ƒå¯ä»¥è¯æ˜ï¼Œåœ¨æœ€ä¼˜è§£ä¸­ï¼Œä¸ä¼šå‡ºç°è¿ç»­ä¸¤åˆ—ä¸€ä¸ªä¸å–çš„æƒ…å†µã€‚å› æ­¤ï¼Œ $f[i][0]$ å…¶å®æ²¡æœ‰å¿…è¦è€ƒè™‘æ¥è‡ª $f[i-1][0]$ çš„çŠ¶æ€è½¬ç§»ã€‚</strong></p><p>ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line">ll h[<span class="number">100005</span>][<span class="number">3</span>];</span><br><span class="line">ll f[<span class="number">100005</span>][<span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; N;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) <span class="built_in">cin</span> &gt;&gt; h[i][<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) <span class="built_in">cin</span> &gt;&gt; h[i][<span class="number">2</span>];</span><br><span class="line">    f[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    f[<span class="number">1</span>][<span class="number">1</span>] = h[<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">    f[<span class="number">1</span>][<span class="number">2</span>] = h[<span class="number">1</span>][<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">        f[i][<span class="number">0</span>] = max(f[i - <span class="number">1</span>][<span class="number">0</span>], max(f[i - <span class="number">1</span>][<span class="number">1</span>], f[i - <span class="number">1</span>][<span class="number">2</span>]));</span><br><span class="line">        f[i][<span class="number">1</span>] = max(f[i - <span class="number">1</span>][<span class="number">0</span>], f[i - <span class="number">1</span>][<span class="number">2</span>]) + h[i][<span class="number">1</span>];</span><br><span class="line">        f[i][<span class="number">2</span>] = max(f[i - <span class="number">1</span>][<span class="number">0</span>], f[i - <span class="number">1</span>][<span class="number">1</span>]) + h[i][<span class="number">2</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; max(f[N][<span class="number">0</span>], max(f[N][<span class="number">1</span>], f[N][<span class="number">2</span>]));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/CF1195C&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ª$2*n$çš„çŸ©é˜µï¼Œä»ä¸­é€‰å‡ºè‹¥å¹²æ•°ï¼Œä¸”ä»»æ„ä¸¤ä¸ªæ•°ä¸ä¸Šä¸‹æˆ–å·¦å³ç›¸é‚»ï¼Œæ±‚è¿™äº›æ•°çš„æœ€å¤§æ€»å’Œ&lt;/p&gt;
&lt;p&gt;$1\le n \le 100000,1 \le h_{i,j}\le 1000000000$&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="åŠ¨æ€è§„åˆ’" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
  </entry>
  
  <entry>
    <title>ç®—æ³•å­¦ä¹ -æ•°è®ºä¸“é¢˜-å¡ç‰¹å…°æ•°</title>
    <link href="https://tth37.cn/2019/07/14/algorithm-maths-catalan/"/>
    <id>https://tth37.cn/2019/07/14/algorithm-maths-catalan/</id>
    <published>2019-07-13T16:10:52.000Z</published>
    <updated>2019-07-13T16:11:49.198Z</updated>
    
    <content type="html"><![CDATA[<p>å’•å’•å’•~</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å’•å’•å’•~&lt;/p&gt;

      
    
    </summary>
    
      <category term="ç®—æ³•å­¦ä¹ " scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="æ•°è®ºä¸“é¢˜" scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/%E6%95%B0%E8%AE%BA%E4%B8%93%E9%A2%98/"/>
    
    
      <category term="æ•°å­¦" scheme="https://tth37.cn/tags/%E6%95%B0%E5%AD%A6/"/>
    
      <category term="å¡ç‰¹å…°æ•°" scheme="https://tth37.cn/tags/%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p1641ç”Ÿæˆå­—ç¬¦ä¸²</title>
    <link href="https://tth37.cn/2019/07/13/solution-luogu-p1641/"/>
    <id>https://tth37.cn/2019/07/13/solution-luogu-p1641/</id>
    <published>2019-07-13T15:19:46.000Z</published>
    <updated>2019-07-13T15:33:00.647Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/P1641" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>å°†$n$ä¸ª$1$å’Œ$m$ä¸ª$0$ç»„æˆå­—ç¬¦ä¸²ï¼Œä½¿å¾—åœ¨ä»»æ„çš„å‰$k$ä¸ªå­—ç¬¦ä¸­ï¼Œ$1$çš„ä¸ªæ•°ä¸èƒ½å°‘äº$0$çš„ä¸ªæ•°ã€‚æ±‚æ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ä¸²å…±æœ‰å¤šå°‘ä¸ªã€‚</p><p>$1\le m \le n \le 1000000$</p></blockquote><a id="more"></a><p>æœ¬é¢˜æ˜¯å¡ç‰¹å…°æ•°çš„ä¸€ä¸ªç®€å•å˜å¼ã€‚</p><p>å›å¿†å¡ç‰¹å…°æ•°çš„æ¨å¯¼è¿‡ç¨‹ï¼Œå¯ä»¥ç”Ÿæˆçš„æ‰€æœ‰å­—ç¬¦ä¸²å…±æœ‰$C_{n+m}^n$ä¸ªï¼Œå…¶ä¸­ä¸åˆæ³•çš„å­—ç¬¦ä¸²æœ‰$C_{n+m}^{n+1}$ä¸ªã€‚æœ€ç»ˆç­”æ¡ˆå³ä¸º$C_{n+m}^{n}-C_{n+m}^{n+1}$ã€‚è®¡ç®—ç»„åˆæ•°å‰é¡»é¢„å¤„ç†å‡ºé˜¶ä¹˜é€†å…ƒã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> p = <span class="number">20100403</span>;</span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">int</span> inv[<span class="number">2000005</span>], fac[<span class="number">2000005</span>], facinv[<span class="number">2000005</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (ll) fac[n] * facinv[m] % p * facinv[n - m] % p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M;</span><br><span class="line">    inv[<span class="number">1</span>] = <span class="number">1</span>; fac[<span class="number">0</span>] = fac[<span class="number">1</span>] = <span class="number">1</span>; facinv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N + M; ++i) &#123;</span><br><span class="line">        inv[i] = (ll) (p - p / i) * inv[p % i] % p;</span><br><span class="line">        fac[i] = (ll) i * fac[i - <span class="number">1</span>] % p;</span><br><span class="line">        facinv[i] = (ll) facinv[i - <span class="number">1</span>] * inv[i] % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; (C(N + M, N) - C(N + M, N + <span class="number">1</span>) + p) % p;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/P1641&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å°†$n$ä¸ª$1$å’Œ$m$ä¸ª$0$ç»„æˆå­—ç¬¦ä¸²ï¼Œä½¿å¾—åœ¨ä»»æ„çš„å‰$k$ä¸ªå­—ç¬¦ä¸­ï¼Œ$1$çš„ä¸ªæ•°ä¸èƒ½å°‘äº$0$çš„ä¸ªæ•°ã€‚æ±‚æ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ä¸²å…±æœ‰å¤šå°‘ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;$1\le m \le n \le 1000000$&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="æ•°å­¦" scheme="https://tth37.cn/tags/%E6%95%B0%E5%AD%A6/"/>
    
      <category term="å¡ç‰¹å…°æ•°" scheme="https://tth37.cn/tags/%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0/"/>
    
      <category term="é€†å…ƒ" scheme="https://tth37.cn/tags/%E9%80%86%E5%85%83/"/>
    
      <category term="ç»„åˆæ•°" scheme="https://tth37.cn/tags/%E7%BB%84%E5%90%88%E6%95%B0/"/>
    
  </entry>
  
  <entry>
    <title>ç®—æ³•å­¦ä¹ -æ•°è®ºä¸“é¢˜-ä¹˜æ³•é€†å…ƒ</title>
    <link href="https://tth37.cn/2019/07/13/algorithm-maths-multiplicativeinversion/"/>
    <id>https://tth37.cn/2019/07/13/algorithm-maths-multiplicativeinversion/</id>
    <published>2019-07-13T04:59:09.000Z</published>
    <updated>2019-07-13T08:34:13.350Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><blockquote><p>ä¹˜æ³•é€†å…ƒå®šä¹‰ï¼šå¦‚æœä¸€ä¸ªçº¿æ€§åŒä½™æ–¹ç¨‹$ax\equiv 1 \mod b$ï¼Œåˆ™$x$æˆä¸º$a \mod b$çš„é€†å…ƒï¼Œè®°ä½œ$a^{-1}$ã€‚</p></blockquote><p>ä¹˜æ³•é€†å…ƒä¸€èˆ¬ç”¨äºæ±‚$a\/b\mod p$çš„å€¼ï¼ˆ$p$é€šå¸¸ä¸ºè´¨æ•°ï¼‰ï¼Œæ˜¯è§£å†³æ¨¡æ„ä¹‰ä¸‹åˆ†æ•°æ•°å€¼çš„å¿…è¦æ‰‹æ®µã€‚</p><p>å¯¹äº$a\/b\mod p$ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚å‡º$b$åœ¨$\mod p$ä¸‹çš„é€†å…ƒï¼Œç„¶åä¹˜ä¸Š$a$å†$\mod p$ï¼Œå°±æ˜¯è¿™ä¸ªåˆ†æ•°çš„å€¼äº†ã€‚</p><a id="more"></a><h2 id="æ±‚è§£é€†å…ƒçš„æ–¹æ³•"><a href="#æ±‚è§£é€†å…ƒçš„æ–¹æ³•" class="headerlink" title="æ±‚è§£é€†å…ƒçš„æ–¹æ³•"></a>æ±‚è§£é€†å…ƒçš„æ–¹æ³•</h2><h3 id="æ‰©å±•æ¬§å‡ é‡Œå¾—æ³•"><a href="#æ‰©å±•æ¬§å‡ é‡Œå¾—æ³•" class="headerlink" title="æ‰©å±•æ¬§å‡ é‡Œå¾—æ³•"></a>æ‰©å±•æ¬§å‡ é‡Œå¾—æ³•</h3><p>æ±‚è§£$ax\equiv 1 \mod b$ ç­‰ä»·äºè§£ä¸å®šæ–¹ç¨‹ $ax+by=1$ï¼Œæ±‚è§£å‡ºçš„$x$å³ä¸º$a \mod b$çš„é€†å…ƒã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span>&amp; x, <span class="keyword">int</span>&amp; y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>) &#123;</span><br><span class="line">        x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    exgcd(b, a % b, y, x);</span><br><span class="line">    y -= a / b * x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¿«é€Ÿå¹‚æ³•"><a href="#å¿«é€Ÿå¹‚æ³•" class="headerlink" title="å¿«é€Ÿå¹‚æ³•"></a>å¿«é€Ÿå¹‚æ³•</h3><blockquote><p>è´¹é©¬å°å®šç†</p><p>è‹¥$p$ä¸ºè´¨æ•°ï¼Œ$a$ä¸ºæ­£æ•´æ•°ï¼Œä¸”$a$ã€$p$äº’è´¨ï¼Œåˆ™$a^{p-1}\equiv 1 (\mod p)$ã€‚</p></blockquote><p>å› ä¸º$ax\equiv 1\mod b$</p><p>æ‰€ä»¥$ax\equiv a^{b-1}\mod b$</p><p>æ‰€ä»¥$x\equiv a^{b-2}\mod b$</p><p>ç„¶åå¯ä»¥ä½¿ç”¨å¿«é€Ÿå¹‚æ±‚è§£é€†å…ƒã€‚</p><p>ä»£ç ç•¥ã€‚</p><h3 id="çº¿æ€§æ±‚é€†å…ƒ"><a href="#çº¿æ€§æ±‚é€†å…ƒ" class="headerlink" title="çº¿æ€§æ±‚é€†å…ƒ"></a>çº¿æ€§æ±‚é€†å…ƒ</h3><p>å‡è®¾ç°åœ¨è¦æ±‚$inv[i]$ã€‚</p><p>è€ƒè™‘å¸¦ä½™é™¤æ³•ï¼Œè®¾$p=iq+r$ï¼Œåˆ™æœ‰$iq+r\equiv 0\mod p$</p><p>æ³¨æ„åˆ°$p$æ˜¯è´¨æ•°ï¼Œå› æ­¤$r$ä¸ä¸º$0$ï¼Œ$r$çš„é€†å…ƒå­˜åœ¨</p><p>ç­‰å¼ä¸¤è¾¹ä¹˜$i^{-1}r^{-1}$ï¼Œå¾—åˆ°$qr^{-1}+i^{-1}\equiv 0\mod p$</p><p>å› æ­¤$i^{-1}\equiv -qr^{-1}\equiv -(p\/i)(p \mod i)^{-1}\mod p$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (inv[<span class="number">1</span>] = <span class="number">1</span>, i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">    inv[i] = (p - p / i) * inv[p % i] % p;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;ä¹˜æ³•é€†å…ƒå®šä¹‰ï¼šå¦‚æœä¸€ä¸ªçº¿æ€§åŒä½™æ–¹ç¨‹$ax\equiv 1 \mod b$ï¼Œåˆ™$x$æˆä¸º$a \mod b$çš„é€†å…ƒï¼Œè®°ä½œ$a^{-1}$ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¹˜æ³•é€†å…ƒä¸€èˆ¬ç”¨äºæ±‚$a\/b\mod p$çš„å€¼ï¼ˆ$p$é€šå¸¸ä¸ºè´¨æ•°ï¼‰ï¼Œæ˜¯è§£å†³æ¨¡æ„ä¹‰ä¸‹åˆ†æ•°æ•°å€¼çš„å¿…è¦æ‰‹æ®µã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº$a\/b\mod p$ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚å‡º$b$åœ¨$\mod p$ä¸‹çš„é€†å…ƒï¼Œç„¶åä¹˜ä¸Š$a$å†$\mod p$ï¼Œå°±æ˜¯è¿™ä¸ªåˆ†æ•°çš„å€¼äº†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç®—æ³•å­¦ä¹ " scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="æ•°è®ºä¸“é¢˜" scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/%E6%95%B0%E8%AE%BA%E4%B8%93%E9%A2%98/"/>
    
    
      <category term="æ•°å­¦" scheme="https://tth37.cn/tags/%E6%95%B0%E5%AD%A6/"/>
    
      <category term="ä¹˜æ³•é€†å…ƒ" scheme="https://tth37.cn/tags/%E4%B9%98%E6%B3%95%E9%80%86%E5%85%83/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p5021èµ›é“ä¿®å»º</title>
    <link href="https://tth37.cn/2019/07/13/solution-luogu-p5021/"/>
    <id>https://tth37.cn/2019/07/13/solution-luogu-p5021/</id>
    <published>2019-07-12T16:54:10.000Z</published>
    <updated>2019-07-18T13:13:16.561Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/P5021" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>ç»™å®šä¸€ä¸ªæœ‰$n$ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œåœ¨å…¶ä¸­é€‰å‡º$m$æ¡æ²¡æœ‰å…¬å…±è¾¹çš„è·¯å¾„ï¼Œå¹¶ä½¿å¾—$m$æ¡è·¯å¾„ä¸­æœ€çŸ­è·¯å¾„çš„é•¿åº¦å°½å¯èƒ½å¤§ã€‚è¾“å‡ºè¿™ä¸ªæœ€çŸ­è·¯å¾„çš„é•¿åº¦ã€‚</p><p>$2\le n \le 50000,1\le m\le n-1 $</p></blockquote><a id="more"></a><p>é¢˜ç›®è¦æ±‚ä½¿$m$æ¡èµ›é“ä¸­æœ€çŸ­èµ›é“çš„é•¿åº¦å°½å¯èƒ½å¤§ï¼Œä¸éš¾æƒ³åˆ°äºŒåˆ†æœ€çŸ­èµ›é“çš„é•¿åº¦$len$ï¼Œå¹¶åˆ¤å®šæ˜¯å¦èƒ½ä¿®å»ºå‡º$m$æ¡èµ›é“ã€‚</p><p>å®šä¹‰$f[u]$ä¸ºè‡ªèŠ‚ç‚¹$u$å‘ä¸‹å»¶ä¼¸çš„<strong>ä¸ä½œä¸ºèµ›é“</strong>çš„æœ€é•¿é“¾é•¿åº¦ã€‚å‡è®¾å·²çŸ¥æ‰€æœ‰çš„$f[v]+w(u,v) (v\in son(u))$ï¼ˆå³è‡ªèŠ‚ç‚¹$u$å‘ä¸‹å»¶ä¼¸çš„æ‰€æœ‰é“¾çš„é•¿åº¦ï¼‰ï¼Œåˆ™æˆ‘ä»¬åº”åœ¨ä¿è¯è¿™äº›é“¾èƒ½ç»„æˆæœ€å¤šèµ›é“çš„å‰æä¸‹ï¼Œä½¿ä¿ç•™ä¸‹æ¥çš„$f[v]+w(u,v)$æœ€å¤§ã€‚</p><p>è€ƒè™‘è´ªå¿ƒã€‚å¯¹äº$f[v]+w(u,v)\ge len$çš„æƒ…å†µï¼Œå¯ä»¥ç›´æ¥å°†å…¶ä½œä¸ºä¸€æ¡èµ›é“ã€‚è€Œå‰©ä½™çš„é“¾ï¼Œåªèƒ½å°†å®ƒä»¬ä¸¤ä¸¤æ‹¼æ¥æˆèµ›é“ã€‚ç”±äºéœ€è¦ä½¿ä¿ç•™ä¸‹æ¥çš„$f[v]+w(u,v)$å–æœ€å¤§å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼˜å…ˆä½¿è¾ƒçŸ­çš„é“¾å¾—åˆ°åŒ¹é…ï¼Œåœ¨å‰©ä½™çš„æ— æ³•åŒ¹é…çš„é“¾ä¸­å–æœ€å€¼ä½œä¸ºæ–°çš„$f[u]$ã€‚</p><p>è´ªå¿ƒæ“ä½œå¯ä»¥ç”¨$multiset$å®ç°ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">50005</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span><span class="keyword">int</span> v, w;&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;Edge&gt; G[MAXN];</span><br><span class="line"><span class="keyword">int</span> N, M, L, cnt;</span><br><span class="line"><span class="keyword">int</span> f[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;<span class="keyword">return</span> a &gt; b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">multiset</span>&lt;<span class="keyword">int</span>&gt; s;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;Edge&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = it -&gt; v, w = it -&gt; w;</span><br><span class="line">        <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(v, u);</span><br><span class="line">        <span class="keyword">if</span> (f[v] + w &gt;= L) cnt++;</span><br><span class="line">        <span class="keyword">else</span> s.insert(f[v] + w);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!s.empty()) &#123;</span><br><span class="line">        <span class="built_in">multiset</span>&lt;<span class="keyword">int</span>&gt;::iterator it = s.begin();</span><br><span class="line">        s.erase(it);</span><br><span class="line">        <span class="built_in">multiset</span>&lt;<span class="keyword">int</span>&gt;::iterator it1 = s.lower_bound(L - *it);</span><br><span class="line">        <span class="keyword">if</span> (it1 == s.end())</span><br><span class="line">            f[u] = max(f[u], *it);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            cnt++;</span><br><span class="line">            s.erase(it1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (cnt &gt;= M) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;N, &amp;M);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> u, v, w;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">        G[u].push_back((Edge)&#123;v, w&#125;);</span><br><span class="line">        G[v].push_back((Edge)&#123;u, w&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>, r = <span class="number">500000000</span>;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        L = mid;</span><br><span class="line">        <span class="keyword">if</span> (check()) &#123;</span><br><span class="line">            ans = mid;</span><br><span class="line">            l = mid + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/P5021&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªæœ‰$n$ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œåœ¨å…¶ä¸­é€‰å‡º$m$æ¡æ²¡æœ‰å…¬å…±è¾¹çš„è·¯å¾„ï¼Œå¹¶ä½¿å¾—$m$æ¡è·¯å¾„ä¸­æœ€çŸ­è·¯å¾„çš„é•¿åº¦å°½å¯èƒ½å¤§ã€‚è¾“å‡ºè¿™ä¸ªæœ€çŸ­è·¯å¾„çš„é•¿åº¦ã€‚&lt;/p&gt;
&lt;p&gt;$2\le n \le 50000,1\le m\le n-1 $&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="åŠ¨æ€è§„åˆ’" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="äºŒåˆ†ç­”æ¡ˆ" scheme="https://tth37.cn/tags/%E4%BA%8C%E5%88%86%E7%AD%94%E6%A1%88/"/>
    
  </entry>
  
  <entry>
    <title>ç®—æ³•å­¦ä¹ -æ ‘é“¾å‰–åˆ†</title>
    <link href="https://tth37.cn/2019/07/04/algorithm-treechainsectioning/"/>
    <id>https://tth37.cn/2019/07/04/algorithm-treechainsectioning/</id>
    <published>2019-07-04T15:21:49.000Z</published>
    <updated>2019-07-05T05:51:32.501Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>æ ‘é“¾å‰–åˆ†ç”¨äºå°†æ ‘åˆ†å‰²æˆè‹¥å¹²æ¡é“¾çš„å½¢å¼ï¼Œä»¥ç»´æŠ¤æ ‘ä¸Šè·¯å¾„çš„ä¿¡æ¯ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œå°†æ•´æ£µæ ‘å‰–åˆ†ä¸ºè‹¥å¹²æ¡é“¾ï¼Œä½¿å®ƒç»„åˆæˆçº¿æ€§ç»“æ„ï¼Œç„¶åç”¨å…¶ä»–çš„æ•°æ®ç»“æ„ç»´æŠ¤ä¿¡æ¯ã€‚</p><a id="more"></a><h2 id="æ¨¡æ¿"><a href="#æ¨¡æ¿" class="headerlink" title="æ¨¡æ¿"></a>æ¨¡æ¿</h2><h3 id="ã€å®ç°è¿‡ç¨‹ã€‘"><a href="#ã€å®ç°è¿‡ç¨‹ã€‘" class="headerlink" title="ã€å®ç°è¿‡ç¨‹ã€‘"></a>ã€å®ç°è¿‡ç¨‹ã€‘</h3><ol><li><p>ç¬¬ä¸€ä¸ª DFS è®°å½•æ¯ä¸ªç»“ç‚¹çš„æ·±åº¦ï¼ˆdeepï¼‰ã€å­æ ‘å¤§å°ï¼ˆsizeï¼‰ã€‚</p></li><li><p>ç¬¬äºŒä¸ª DFS è®°å½•æ¯ä¸ªç»“ç‚¹çš„é‡å­ç»“ç‚¹ï¼ˆheavy-sonï¼‰ã€é‡è¾¹ä¼˜å…ˆéå†æ—¶çš„ DFN åºã€æ‰€åœ¨é“¾çš„é“¾é¡¶ï¼ˆtopï¼Œä¸”åº”åˆå§‹åŒ–ä¸ºç»“ç‚¹æœ¬èº«ï¼‰ã€‚</p></li><li><p>é“¾ä¸Šçš„ DFN åºæ˜¯è¿ç»­çš„ï¼Œå¯ä»¥ä½¿ç”¨çº¿æ®µæ ‘ï¼Œæ ‘çŠ¶æ•°ç»„ç»´æŠ¤ã€‚</p><p>æ¯æ¬¡é€‰æ‹©æ·±åº¦è¾ƒå¤§çš„é“¾å¾€ä¸Šè·³ï¼Œç›´åˆ°ä¸¤ç‚¹åœ¨åŒä¸€æ¡é“¾ä¸Šã€‚</p></li><li><p>åœ¨ DFS æœç´¢çš„æ—¶å€™ï¼Œå­æ ‘ä¸­çš„ç»“ç‚¹çš„ DFN åºæ˜¯è¿ç»­çš„ã€‚</p><p>æ¯ä¸€ä¸ªç»“ç‚¹è®°å½• bottom è¡¨ç¤ºæ‰€åœ¨å­æ ‘è¿ç»­åŒºé—´æœ«ç«¯çš„ç»“ç‚¹ã€‚</p><p>è¿™æ ·å°±æŠŠå­æ ‘ä¿¡æ¯è½¬åŒ–ä¸ºè¿ç»­çš„ä¸€æ®µåŒºé—´ä¿¡æ¯ã€‚</p></li></ol><p><img src="https://oi-wiki.org/graph/images/hld.png" alt></p><h3 id="ã€ä»£ç ã€‘"><a href="#ã€ä»£ç ã€‘" class="headerlink" title="ã€ä»£ç ã€‘"></a>ã€ä»£ç ã€‘</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100005</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAXN];</span><br><span class="line"><span class="keyword">int</span> N, M, R, P;</span><br><span class="line"><span class="keyword">int</span> w[MAXN], fa[MAXN], size[MAXN], son[MAXN], top[MAXN], dep[MAXN];</span><br><span class="line"><span class="keyword">int</span> dfn[MAXN], dfn_index;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, sum, tag;</span><br><span class="line">&#125;node[MAXN * <span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> cnt;</span><br><span class="line"><span class="keyword">int</span> a[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(Node&amp; u, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    u.tag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        u.sum = a[l];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    build(node[u.l = ++cnt], l, mid);</span><br><span class="line">    build(node[u.r = ++cnt], mid + <span class="number">1</span>, r);</span><br><span class="line">    u.sum = (node[u.l].sum + node[u.r].sum);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(Node&amp; u, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (u.tag) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        node[u.l].sum = (node[u.l].sum + u.tag * (mid - l + <span class="number">1</span>));</span><br><span class="line">        node[u.r].sum = (node[u.r].sum + u.tag * (r - mid));</span><br><span class="line">        node[u.l].tag = (node[u.l].tag + u.tag);</span><br><span class="line">        node[u.r].tag = (node[u.r].tag + u.tag);</span><br><span class="line">        u.tag = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">modify</span><span class="params">(Node&amp; u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) &#123;</span><br><span class="line">        u.tag = (u.tag + val) % P;</span><br><span class="line">        u.sum = (u.sum + val * (r - l + <span class="number">1</span>)) % P;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(u, l, r);</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= mid) modify(node[u.l], l, mid, ql, qr, val);</span><br><span class="line">    <span class="keyword">if</span> (mid &lt; qr) modify(node[u.r], mid + <span class="number">1</span>, r, ql, qr, val);</span><br><span class="line">    u.sum = (node[u.l].sum + node[u.r].sum) % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query</span><span class="params">(Node&amp; u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) &#123;</span><br><span class="line">        <span class="keyword">return</span> u.sum;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, ans = <span class="number">0</span>;</span><br><span class="line">    pushdown(u, l, r);</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= mid) ans = (ans + query(node[u.l], l, mid, ql, qr)) % P;</span><br><span class="line">    <span class="keyword">if</span> (mid &lt; qr) ans = (ans + query(node[u.r], mid + <span class="number">1</span>, r, ql, qr)) % P;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fath)</span> </span>&#123;</span><br><span class="line">    size[u] = <span class="number">1</span>;</span><br><span class="line">    fa[u] = fath;</span><br><span class="line">    dep[u] = dep[fath] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = *it;</span><br><span class="line">        <span class="keyword">if</span> (v == fath) <span class="keyword">continue</span>;</span><br><span class="line">        dfs1(v, u);</span><br><span class="line">        size[u] += size[v];</span><br><span class="line">        <span class="keyword">if</span> (size[v] &gt; size[son[u]]) son[u] = v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> topc)</span> </span>&#123;</span><br><span class="line">    top[u] = topc;</span><br><span class="line">    dfn[u] = ++dfn_index;</span><br><span class="line">    a[dfn[u]] = w[u];</span><br><span class="line">    <span class="keyword">if</span> (son[u] == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    dfs2(son[u], topc);</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = *it;</span><br><span class="line">        <span class="keyword">if</span> (v == fa[u] || v == son[u]) <span class="keyword">continue</span>;</span><br><span class="line">        dfs2(v, v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ModifySubtree</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    modify(node[<span class="number">0</span>], <span class="number">1</span>, N, dfn[u], dfn[u] + size[u] - <span class="number">1</span>, val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">QuerySubtree</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> query(node[<span class="number">0</span>], <span class="number">1</span>, N, dfn[u], dfn[u] + size[u] - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ModifyChain</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    val %= P;</span><br><span class="line">    <span class="keyword">while</span> (top[u] != top[v]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dep[top[u]] &lt; dep[top[v]]) swap(u, v);</span><br><span class="line">        modify(node[<span class="number">0</span>], <span class="number">1</span>, N, dfn[top[u]], dfn[u], val);</span><br><span class="line">        u = fa[top[u]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v]) swap(u, v);</span><br><span class="line">    modify(node[<span class="number">0</span>], <span class="number">1</span>, N, dfn[v], dfn[u], val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">QueryChain</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (top[u] != top[v]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dep[top[u]] &lt; dep[top[v]]) swap(u, v);</span><br><span class="line">        ans = (ans + query(node[<span class="number">0</span>], <span class="number">1</span>, N, dfn[top[u]], dfn[u])) % P;</span><br><span class="line">        u = fa[top[u]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v]) swap(u, v);</span><br><span class="line">    ans = (ans + query(node[<span class="number">0</span>], <span class="number">1</span>, N, dfn[v], dfn[u])) % P;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;N, &amp;M, &amp;R, &amp;P);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;w[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> u, v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v);</span><br><span class="line">        G[u].push_back(v);</span><br><span class="line">        G[v].push_back(u);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs1(R, <span class="number">0</span>);</span><br><span class="line">    dfs2(R, R);</span><br><span class="line">    build(node[<span class="number">0</span>], <span class="number">1</span>, N);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> opt, x, y, z;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;opt);</span><br><span class="line">        <span class="keyword">if</span> (opt == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;x, &amp;y, &amp;z);</span><br><span class="line">            ModifyChain(x, y, z);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (opt == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, QueryChain(x, y));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (opt == <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;z);</span><br><span class="line">            ModifySubtree(x, z);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (opt == <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, QuerySubtree(x));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h2&gt;&lt;p&gt;æ ‘é“¾å‰–åˆ†ç”¨äºå°†æ ‘åˆ†å‰²æˆè‹¥å¹²æ¡é“¾çš„å½¢å¼ï¼Œä»¥ç»´æŠ¤æ ‘ä¸Šè·¯å¾„çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“æ¥è¯´ï¼Œå°†æ•´æ£µæ ‘å‰–åˆ†ä¸ºè‹¥å¹²æ¡é“¾ï¼Œä½¿å®ƒç»„åˆæˆçº¿æ€§ç»“æ„ï¼Œç„¶åç”¨å…¶ä»–çš„æ•°æ®ç»“æ„ç»´æŠ¤ä¿¡æ¯ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç®—æ³•å­¦ä¹ " scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="æ•°æ®ç»“æ„" scheme="https://tth37.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="çº¿æ®µæ ‘" scheme="https://tth37.cn/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
      <category term="æ ‘é“¾å‰–åˆ†" scheme="https://tth37.cn/tags/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/"/>
    
      <category term="dfsåº" scheme="https://tth37.cn/tags/dfs%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p2831æ„¤æ€’çš„å°é¸Ÿ</title>
    <link href="https://tth37.cn/2019/07/03/solution-luogu-p2831/"/>
    <id>https://tth37.cn/2019/07/03/solution-luogu-p2831/</id>
    <published>2019-07-03T06:25:55.000Z</published>
    <updated>2019-07-14T08:51:07.995Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/P2831" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>åœ¨å¹³é¢ç›´è§’åæ ‡ç³»ä¸­ç»™å®š$n$ä¸ªä½äºç¬¬ä¸€è±¡é™çš„ç‚¹ï¼Œæ±‚è‡³å°‘éœ€è¦ä»åŸç‚¹å¼•å‡ºå¤šå°‘æ¡å¼€å£å‘ä¸‹çš„æŠ›ç‰©çº¿ï¼Œä½¿å®ƒä»¬ç»è¿‡æ‰€æœ‰çš„ç‚¹ã€‚</p><p>$ 1 \le n \le 18 $</p><p>æ„Ÿè°¢@oyçš„è´¡çŒ®</p></blockquote><a id="more"></a><p>ä¸€é“å¹¶ä¸æ˜¯ç‰¹åˆ«éš¾çš„çŠ¶å‹dpã€‚</p><p>çŠ¶æ€å®šä¹‰ï¼š$f[s]$è¡¨ç¤ºå°†æ‰€æœ‰å‰©ä½™çš„çŒªæ¶ˆç­è‡³å°‘éœ€è¦å¤šå°‘åªå°é¸Ÿï¼Œå…¶ä¸­$s$è¡¨ç¤ºå·²ç»æ¶ˆç­çš„çŒªçš„é›†åˆã€‚</p><p>è€ƒè™‘çŠ¶æ€è½¬ç§»ï¼Œå‘å°„ä¸€ä¸ªå°é¸Ÿå¯ä»¥æ¶ˆç­å°šæœªè¢«æ¶ˆç­çš„çŒªã€‚è®°$curve[i][j]$ä¸ºä¸€ä¸ªäºŒè¿›åˆ¶é›†åˆï¼Œè¡¨ç¤ºç»è¿‡ç¬¬$i$ã€$j$å·çŒªçš„æŠ›ç‰©çº¿èƒ½æ¶ˆç­å“ªäº›çŒªã€‚</p><p>å³ï¼š</p><script type="math/tex; mode=display">f[s]=min\lbrace f[s|curve[i][j]]+1\rbrace</script><p>å¯ä»¥ç”¨è®°å¿†åŒ–æœç´¢å®ç°ï¼Œæ³¨æ„ç²¾åº¦æ§åˆ¶å’Œè§¦æ‘¸çŠ¶æ€ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> EPS = <span class="number">1e-7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> x[<span class="number">19</span>], y[<span class="number">19</span>];</span><br><span class="line"><span class="keyword">int</span> curve[<span class="number">19</span>][<span class="number">19</span>];</span><br><span class="line"><span class="keyword">int</span> f[<span class="number">524289</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">equals</span><span class="params">(<span class="keyword">double</span>&amp; a, <span class="keyword">double</span>&amp; b, <span class="keyword">double</span> x1, <span class="keyword">double</span> y1, <span class="keyword">double</span> x2, <span class="keyword">double</span> y2)</span> </span>&#123;</span><br><span class="line">    a = (y1 * x2 - x1 * y2) / (x1 * x1 * x2 - x2 * x2 * x1);</span><br><span class="line">    b = (y1 - x1 * x1 * a) / x1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (f[s] != <span class="number">-1</span>) <span class="keyword">return</span> f[s];</span><br><span class="line">    <span class="keyword">if</span> (s == (<span class="number">1</span> &lt;&lt; N) - <span class="number">1</span>) <span class="keyword">return</span> f[s] = <span class="number">0</span>;</span><br><span class="line">    f[s] = INF;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> j = i; j &lt;= N; ++j) &#123;</span><br><span class="line">            f[s] = min(f[s], dp(s | curve[i][j]) + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[s];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(curve, <span class="number">0</span>, <span class="keyword">sizeof</span>(curve));</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;N, &amp;M);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lf%lf"</span>, &amp;x[i], &amp;y[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> p1 = <span class="number">1</span>; p1 &lt;= N; ++p1) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> p2 = p1 + <span class="number">1</span>; p2 &lt;= N; ++p2) &#123;</span><br><span class="line">                <span class="keyword">double</span> a, b;</span><br><span class="line">                equals(a, b, x[p1], y[p1], x[p2], y[p2]);</span><br><span class="line">                <span class="keyword">if</span> (a &gt;= <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (x[i] * x[i] * a + x[i] * b &gt;= y[i] - EPS &amp;&amp; x[i] * x[i] * a + x[i] * b &lt;= y[i] + EPS) &#123;</span><br><span class="line">                        curve[p1][p2] |= (<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>));</span><br><span class="line">                        curve[p2][p1] |= (<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> p = <span class="number">1</span>; p &lt;= N; ++p)</span><br><span class="line">            curve[p][p] = (<span class="number">1</span> &lt;&lt; (p - <span class="number">1</span>));</span><br><span class="line">        <span class="built_in">memset</span>(f, <span class="number">-1</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, dp(<span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/P2831&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åœ¨å¹³é¢ç›´è§’åæ ‡ç³»ä¸­ç»™å®š$n$ä¸ªä½äºç¬¬ä¸€è±¡é™çš„ç‚¹ï¼Œæ±‚è‡³å°‘éœ€è¦ä»åŸç‚¹å¼•å‡ºå¤šå°‘æ¡å¼€å£å‘ä¸‹çš„æŠ›ç‰©çº¿ï¼Œä½¿å®ƒä»¬ç»è¿‡æ‰€æœ‰çš„ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;$ 1 \le n \le 18 $&lt;/p&gt;
&lt;p&gt;æ„Ÿè°¢@oyçš„è´¡çŒ®&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="åŠ¨æ€è§„åˆ’" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="çŠ¶æ€å‹ç¼©" scheme="https://tth37.cn/tags/%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p3959å®è—</title>
    <link href="https://tth37.cn/2019/06/30/solution-luogu-p3959/"/>
    <id>https://tth37.cn/2019/06/30/solution-luogu-p3959/</id>
    <published>2019-06-29T16:26:07.000Z</published>
    <updated>2019-07-21T14:43:17.704Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/P3959" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>è¾“å…¥ä¸€ä¸ªæœ‰$n$ä¸ªç‚¹$m$æ¡è¾¹çš„æœ‰æƒæ— å‘å›¾ã€‚é€‰å®šä»»æ„èŠ‚ç‚¹ä½œä¸ºæ ¹èŠ‚ç‚¹ã€‚æ„é€ ä¸€æ£µç”Ÿæˆæ ‘ï¼Œä½¿å¾—æ ‘ä¸Šæ‰€æœ‰çœŸå®è¾¹æƒçš„æ€»å’Œæœ€å°ã€‚çœŸå®è¾¹æƒçš„è®¡ç®—å…¬å¼ï¼š$w(u,v)\times L$ï¼Œå…¶ä¸­$L$ä¸ºæ ¹èŠ‚ç‚¹åˆ°$u$è·¯å¾„ä¸Šçš„èŠ‚ç‚¹æ€»æ•°ã€‚</p><p>$1\le n \le 12,1 \le m \le 1000$</p><p>æ„Ÿè°¢@oyçš„è´¡çŒ®</p></blockquote><a id="more"></a><p>è¿™é“é¢˜åšäº†å¾ˆé•¿æ—¶é—´ï¼Œä»ä¸€å¼€å§‹æ¨å‡ºé”™è¯¯çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œåˆ°åŸ‹å¤´ä¼˜åŒ–æ­£ç¡®çš„çŠ¶æ€è½¬ç§»ï¼Œå‰åèŠ±äº†ä¸€ä¸ªå¤šæ˜ŸæœŸâ€¦â€¦</p><p>æœ¬é¢˜é¢˜è§£å¯ä»¥ä¿è¯æ­£ç¡®æ€§ï¼ˆå½“ç„¶æ¬¢è¿Hackï¼‰ï¼Œå´åœ¨é€Ÿåº¦ä¸Šç•¥æœ‰æ¬ ç¼ºã€‚</p><p>çŠ¶æ€å®šä¹‰ï¼š$f[s][u][d]$ $s$è¡¨ç¤ºå½“å‰å·²è”é€šçš„ç‚¹é›†ï¼Œ$u$è¡¨ç¤ºå½“å‰ç‚¹é›†ç”Ÿæˆæ ‘çš„æ ‘æ ¹ï¼Œ$d$è¡¨ç¤º$u$åˆ°èµ·ç‚¹çš„è·ç¦»ã€‚ï¼ˆæ³¨æ„ï¼š$u$ä¸æ˜¯èµ·ç‚¹ï¼‰</p><p>çŠ¶æ€è½¬ç§»ï¼šçŠ¶æ€è‚¯å®šæ˜¯é€šè¿‡æŒ–é€šé“æ¥è½¬ç§»çš„ã€‚å¦‚æœå°†$u$å’Œ$v$ä¹‹é—´æŒ–é€šï¼Œåˆ™$u$æ‰€åœ¨çš„è¿é€šå—å’Œ$v$æ‰€åœ¨çš„è¿é€šå—å°†ä¼šåˆå¹¶ã€‚å¦‚æœä»¥$u$ä½œä¸ºæ ¹ï¼Œ$u$åˆ°èµ·ç‚¹çš„è·ç¦»ä¸º$d$ï¼Œåˆ™$v$åˆ°èµ·ç‚¹çš„è·ç¦»ä¸º$(d+1)$ã€‚æ–¹ç¨‹å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">f[s][u][d]=min\lbrace f[s1][u][d]+f[s2][v][d+1]+w(u,v)*d\rbrace</script><p>å…¶ä¸­ï¼š</p><script type="math/tex; mode=display">s1 \cup s2=s,u\in s1,v\in s2,w(u,v)\not= \inf</script><p>æœ€ç»ˆè¦æ±‚çš„ç­”æ¡ˆå³ä¸º$\min_{1\le i \le n}f[(1&lt;&lt;n)-1][i][1]$ï¼Œé‡‡ç”¨è®°å¿†åŒ–æœç´¢å®ç°ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">int</span> w[<span class="number">13</span>][<span class="number">13</span>];</span><br><span class="line"><span class="keyword">int</span> f[<span class="number">1</span>&lt;&lt;<span class="number">13</span>][<span class="number">13</span>][<span class="number">13</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> u, <span class="keyword">int</span> d)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (f[s][u][d] != <span class="number">-1</span>) <span class="keyword">return</span> f[s][u][d];</span><br><span class="line">    <span class="keyword">if</span> (s == (<span class="number">1</span> &lt;&lt; (u - <span class="number">1</span>))) <span class="keyword">return</span> f[s][u][d] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span>&amp; ans = f[s][u][d] = INF;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> s1 = s; s1; s1 = (s1 - <span class="number">1</span>) &amp; s) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!(s1 &amp; (<span class="number">1</span> &lt;&lt; (u - <span class="number">1</span>)))) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> v = <span class="number">1</span>; v &lt;= N; ++v) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!(s &amp; (<span class="number">1</span> &lt;&lt; (v - <span class="number">1</span>)))) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (w[u][v] == INF) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">int</span> s2 = s ^ s1;</span><br><span class="line">            ans = min(ans, dp(s1, u, d) + dp(s2, v, d + <span class="number">1</span>) + w[u][v] * d);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(w, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(w));</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">-1</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;N, &amp;M);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> u, v, t;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;u, &amp;v, &amp;t);</span><br><span class="line">        w[u][v] = w[v][u] = min(w[u][v], t);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> ans = INF;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> u = <span class="number">1</span>; u &lt;= N; ++u) &#123;</span><br><span class="line">        ans = min(ans, dp((<span class="number">1</span> &lt;&lt; N) - <span class="number">1</span>, u, <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/P3959&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¾“å…¥ä¸€ä¸ªæœ‰$n$ä¸ªç‚¹$m$æ¡è¾¹çš„æœ‰æƒæ— å‘å›¾ã€‚é€‰å®šä»»æ„èŠ‚ç‚¹ä½œä¸ºæ ¹èŠ‚ç‚¹ã€‚æ„é€ ä¸€æ£µç”Ÿæˆæ ‘ï¼Œä½¿å¾—æ ‘ä¸Šæ‰€æœ‰çœŸå®è¾¹æƒçš„æ€»å’Œæœ€å°ã€‚çœŸå®è¾¹æƒçš„è®¡ç®—å…¬å¼ï¼š$w(u,v)\times L$ï¼Œå…¶ä¸­$L$ä¸ºæ ¹èŠ‚ç‚¹åˆ°$u$è·¯å¾„ä¸Šçš„èŠ‚ç‚¹æ€»æ•°ã€‚&lt;/p&gt;
&lt;p&gt;$1\le n \le 12,1 \le m \le 1000$&lt;/p&gt;
&lt;p&gt;æ„Ÿè°¢@oyçš„è´¡çŒ®&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="åŠ¨æ€è§„åˆ’" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="çŠ¶æ€å‹ç¼©" scheme="https://tth37.cn/tags/%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9/"/>
    
  </entry>
  
  <entry>
    <title>å…¬å‘Š 2019-6-20</title>
    <link href="https://tth37.cn/2019/06/20/bulletin-2019-6-20/"/>
    <id>https://tth37.cn/2019/06/20/bulletin-2019-6-20/</id>
    <published>2019-06-19T16:16:06.000Z</published>
    <updated>2019-07-05T16:08:30.575Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ‹›å‹Ÿå¯äº‹"><a href="#æ‹›å‹Ÿå¯äº‹" class="headerlink" title="æ‹›å‹Ÿå¯äº‹"></a>æ‹›å‹Ÿå¯äº‹</h2><p>tth37æœ€è¿‘å‘ç°ï¼Œä»–å†™äº†<del>å¥½å¤šå¥½å¤š</del>é¢˜è§£å•¦ã€‚ä½†æ˜¯è¿™äº›é¢˜è§£å…¨éƒ½è¢«å±•ç¤ºåœ¨Homepageé‡Œï¼Œå¯¼è‡´Homepageä¸å¤Ÿç®€æ´ï¼Œé¢˜ç›®æ£€ç´¢ä¸å¤ªæ–¹ä¾¿ã€‚</p><p>äºæ˜¯ï¼Œtth37å†³å®šåœ¨æ¯ç¯‡é¢˜è§£æœ€å‰é¢ï¼Œå†™ä¸€æ®µ<strong>é¢˜ç›®å†…å®¹çš„ä¸€å¥è¯æ€»ç»“</strong>ã€‚ä½†æ˜¯tth37æ¯”è¾ƒå¿™ï¼Œå®åœ¨ä¸æƒ³åšè¿™ä»¶äº‹ï¼Œå› æ­¤ä»–å†³å®š<del>æ‹›å‹Ÿ</del>è·ªæ±‚å·¨ä½¬æ¥å¸®ä»–å®Œæˆè¿™é¡¹å·¥ä½œã€‚</p><p>ä¸€ä»½å®Œæ•´çš„ä¸€å¥è¯æ€»ç»“å¿…é¡»<strong>æ¸…æ¥šåœ°æ¦‚æ‹¬é¢˜é¢ï¼ˆæ‹’ç»èŠ±é‡Œèƒ¡å“¨ï¼‰</strong>ï¼Œå¹¶ä¸”ç»™å‡º<strong>æ•°æ®èŒƒå›´</strong>ã€‚ä¸€åˆ‡å­—æ¯å¿…é¡»é‡‡ç”¨$L^AT_EX$å…¬å¼ã€‚ï¼ˆç™¾åº¦ä¸€ä¸‹ï¼Ÿï¼‰</p><p>å†™å¥½ä¸€å¥è¯æ€»ç»“åï¼Œè¯·å°†å…¶ä¸Šä¼ è‡³<strong>æ´›è°·å‰ªè´´æ¿</strong>ï¼Œå¹¶å°†å‰ªè´´æ¿é“¾æ¥å‘ç»™tth37ã€‚tth37ä¼šæ ¹æ®å…¶è´¨é‡ï¼Œé…Œæƒ…å‘é€<strong>0.01~0.66å…ƒçº¢åŒ…</strong>ä½œä¸ºæŠ¥é…¬ã€‚</p><p>å¦‚æœåœ¨åº§çš„å„ä½å¯¹æœ¬æ´»åŠ¨åå“ä¸å¤Ÿçƒ­çƒˆï¼Œtth37å¯èƒ½ä¼š<strong>å¼ºè¿«</strong>ä½ ä»¬å½“ä¸­çš„ä¸€äº›äººå®Œæˆè¿™é¡¹ä»»åŠ¡ã€‚å½“ç„¶ï¼Œ<strong>æ²¡æœ‰æŠ¥é…¬</strong>ã€‚</p><a id="more"></a>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ‹›å‹Ÿå¯äº‹&quot;&gt;&lt;a href=&quot;#æ‹›å‹Ÿå¯äº‹&quot; class=&quot;headerlink&quot; title=&quot;æ‹›å‹Ÿå¯äº‹&quot;&gt;&lt;/a&gt;æ‹›å‹Ÿå¯äº‹&lt;/h2&gt;&lt;p&gt;tth37æœ€è¿‘å‘ç°ï¼Œä»–å†™äº†&lt;del&gt;å¥½å¤šå¥½å¤š&lt;/del&gt;é¢˜è§£å•¦ã€‚ä½†æ˜¯è¿™äº›é¢˜è§£å…¨éƒ½è¢«å±•ç¤ºåœ¨Homepageé‡Œï¼Œå¯¼è‡´Homepageä¸å¤Ÿç®€æ´ï¼Œé¢˜ç›®æ£€ç´¢ä¸å¤ªæ–¹ä¾¿ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯ï¼Œtth37å†³å®šåœ¨æ¯ç¯‡é¢˜è§£æœ€å‰é¢ï¼Œå†™ä¸€æ®µ&lt;strong&gt;é¢˜ç›®å†…å®¹çš„ä¸€å¥è¯æ€»ç»“&lt;/strong&gt;ã€‚ä½†æ˜¯tth37æ¯”è¾ƒå¿™ï¼Œå®åœ¨ä¸æƒ³åšè¿™ä»¶äº‹ï¼Œå› æ­¤ä»–å†³å®š&lt;del&gt;æ‹›å‹Ÿ&lt;/del&gt;è·ªæ±‚å·¨ä½¬æ¥å¸®ä»–å®Œæˆè¿™é¡¹å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä»½å®Œæ•´çš„ä¸€å¥è¯æ€»ç»“å¿…é¡»&lt;strong&gt;æ¸…æ¥šåœ°æ¦‚æ‹¬é¢˜é¢ï¼ˆæ‹’ç»èŠ±é‡Œèƒ¡å“¨ï¼‰&lt;/strong&gt;ï¼Œå¹¶ä¸”ç»™å‡º&lt;strong&gt;æ•°æ®èŒƒå›´&lt;/strong&gt;ã€‚ä¸€åˆ‡å­—æ¯å¿…é¡»é‡‡ç”¨$L^AT_EX$å…¬å¼ã€‚ï¼ˆç™¾åº¦ä¸€ä¸‹ï¼Ÿï¼‰&lt;/p&gt;
&lt;p&gt;å†™å¥½ä¸€å¥è¯æ€»ç»“åï¼Œè¯·å°†å…¶ä¸Šä¼ è‡³&lt;strong&gt;æ´›è°·å‰ªè´´æ¿&lt;/strong&gt;ï¼Œå¹¶å°†å‰ªè´´æ¿é“¾æ¥å‘ç»™tth37ã€‚tth37ä¼šæ ¹æ®å…¶è´¨é‡ï¼Œé…Œæƒ…å‘é€&lt;strong&gt;0.01~0.66å…ƒçº¢åŒ…&lt;/strong&gt;ä½œä¸ºæŠ¥é…¬ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœåœ¨åº§çš„å„ä½å¯¹æœ¬æ´»åŠ¨åå“ä¸å¤Ÿçƒ­çƒˆï¼Œtth37å¯èƒ½ä¼š&lt;strong&gt;å¼ºè¿«&lt;/strong&gt;ä½ ä»¬å½“ä¸­çš„ä¸€äº›äººå®Œæˆè¿™é¡¹ä»»åŠ¡ã€‚å½“ç„¶ï¼Œ&lt;strong&gt;æ²¡æœ‰æŠ¥é…¬&lt;/strong&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="å…¬å‘Š" scheme="https://tth37.cn/categories/%E5%85%AC%E5%91%8A/"/>
    
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p3953é€›å…¬å›­</title>
    <link href="https://tth37.cn/2019/06/19/solution-luogu-p3953/"/>
    <id>https://tth37.cn/2019/06/19/solution-luogu-p3953/</id>
    <published>2019-06-19T15:39:55.000Z</published>
    <updated>2019-06-29T17:35:41.267Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/P3953" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>ç»™å®šä¸€ä¸ª$n$ä¸ªç‚¹$m$æ¡è¾¹çš„æœ‰å‘å¸¦æƒå›¾ï¼Œè®¾èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯ä¸º$d$ï¼Œæ±‚èµ·ç‚¹åˆ°ç»ˆç‚¹æ»¡è¶³æƒå€¼æ€»å’Œå°äºç­‰äº$(d+k)$çš„è·¯å¾„æ•°é‡</p><p>$1 \le p\le 10^9 $ , $1 \le n\le 10^5$ , $1 \le m\le 2 \times 10^5$ , $1 \le k\le 50$</p><p>æ„Ÿè°¢@oy çš„è´¡çŒ®</p></blockquote><a id="more"></a><p>ä¸€é“çœ‹ä¼¼å›¾è®ºå®åˆ™å¯ä»¥ç”¨åŠ¨æ€è§„åˆ’è§£å†³çš„é¢˜ç›®ã€‚</p><p>æœ´ç´ çš„çŠ¶æ€å®šä¹‰ï¼š$f[u][k]$è¡¨ç¤ºä»$1$å·èŠ‚ç‚¹èµ°åˆ°$u$å·èŠ‚ç‚¹ï¼Œè·¯å¾„é•¿åº¦ä¸º$k$çš„æ–¹æ¡ˆæ€»æ•°ã€‚çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">f[u][k]=\sum_{(u,v)\in E}f[v][k-w(u,v)]</script><p>ä½†æ˜¯è¿™æ ·çš„çŠ¶æ€å®šä¹‰æœ‰ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼šç©ºé—´æ¶ˆè€—è¿‡å¤§ã€‚è€ƒè™‘åˆ°é¢˜ç›®ä¸­ç»™å‡ºçš„$K$å€¼å¹¶ä¸å¤§ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨é¢˜ç›®æ‰€è¦æ±‚çš„ä¿¡æ¯æ¥ä¼˜åŒ–çŠ¶æ€è®¾è®¡ã€‚</p><p>ä¼˜åŒ–åçš„çŠ¶æ€å®šä¹‰ï¼š$d[u]$è¡¨ç¤ºä»$1$å·èŠ‚ç‚¹èµ°åˆ°$u$å·èŠ‚ç‚¹çš„æœ€çŸ­è·¯é•¿åº¦ï¼Œ$f[u][k]$è¡¨ç¤ºä»$1$å·èŠ‚ç‚¹èµ°åˆ°$u$å·èŠ‚ç‚¹ï¼Œ<strong>è·¯å¾„é•¿åº¦ä¸º$d[u]+k$çš„æ–¹æ¡ˆæ€»æ•°</strong>ã€‚</p><p>å¦‚æ­¤ä¸€æ¥ï¼ŒçŠ¶æ€æ‰€éœ€çš„ç©ºé—´å¤§å¤§å‡å°‘ï¼Œä½†ç›¸åº”çš„çŠ¶æ€è½¬ç§»ç•¥æ˜¾å¤æ‚ã€‚ä¸å¦¨è®¾$f[u][k]$çŠ¶æ€å¯ä»¥ç”±$f[v][x]$è½¬ç§»å¾—åˆ°ï¼Œåˆ™ï¼š</p><script type="math/tex; mode=display">d[v]+x+w(u,v)=d[u]+k</script><p>ç§»é¡¹ï¼Œå¾—åˆ°ï¼š</p><script type="math/tex; mode=display">x=d[u]-d[v]+k-w(u,v)</script><p>å› æ­¤ï¼Œå®Œæ•´çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">f[u][k]=\sum_{(u,v)\in E}f[v][d[u]-d[v]+k-w(u,v)]</script><p>æˆ‘ä»¬æœ€ç»ˆè¦æ±‚çš„ç­”æ¡ˆå³ä¸º$\sum_{i=0}^Kf[N][i]$ï¼Œç”¨è®°å¿†åŒ–æœç´¢å®ç°å³å¯ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// luogu-judger-enable-o2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100001</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span><span class="keyword">int</span> v, w;&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;Edge&gt; G1[MAXN], G2[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T, N, M, K, P;</span><br><span class="line"><span class="keyword">bool</span> fail;</span><br><span class="line"><span class="keyword">int</span> f[MAXN][<span class="number">51</span>];</span><br><span class="line"><span class="keyword">int</span> d[MAXN];</span><br><span class="line"><span class="keyword">bool</span> vis[MAXN];</span><br><span class="line"><span class="keyword">bool</span> ins[MAXN][<span class="number">51</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Dijkstra</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">    <span class="built_in">memset</span>(d, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(d));</span><br><span class="line">    priority_queue&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; q;</span><br><span class="line">    q.push(make_pair(<span class="number">0</span>, <span class="number">1</span>));</span><br><span class="line">    d[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">        <span class="keyword">int</span> u = q.top().second;</span><br><span class="line">        q.pop();</span><br><span class="line">        <span class="keyword">if</span> (vis[u]) <span class="keyword">continue</span>;</span><br><span class="line">        vis[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;Edge&gt;::iterator it = G1[u].begin(); it != G1[u].end(); it++) &#123;</span><br><span class="line">            <span class="keyword">int</span> v = it-&gt;v, w = it-&gt;w;</span><br><span class="line">            <span class="keyword">if</span> (d[u] + w &lt; d[v]) &#123;</span><br><span class="line">                d[v] = d[u] + w;</span><br><span class="line">                q.push(make_pair(-d[v], v));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (k &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (ins[u][k])&#123;</span><br><span class="line">        fail = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (f[u][k]) <span class="keyword">return</span> f[u][k];</span><br><span class="line">    ins[u][k] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;Edge&gt;::iterator it = G2[u].begin(); it != G2[u].end(); it++) &#123;</span><br><span class="line">        <span class="keyword">int</span> p = it-&gt;v, w = it-&gt;w;</span><br><span class="line">        ans = (ans + dp(p, d[u] - d[p] + k - w))%P;</span><br><span class="line">        <span class="keyword">if</span> (fail == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ins[u][k] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> f[u][k] = ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;N, &amp;M, &amp;K, &amp;P);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</span><br><span class="line">            <span class="keyword">int</span> u, v, w;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">            G1[u].push_back((Edge)&#123;v, w&#125;);</span><br><span class="line">            G2[v].push_back((Edge)&#123;u, w&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        Dijkstra();</span><br><span class="line">        dp(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        f[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= K; ++i) &#123;</span><br><span class="line">            ans = (ans + dp(N, i))%P;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(fail == <span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">        fail = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">        <span class="built_in">memset</span>(ins, <span class="number">0</span>, <span class="keyword">sizeof</span>(ins));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">            G1[i].clear(), G2[i].clear();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/P3953&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ª$n$ä¸ªç‚¹$m$æ¡è¾¹çš„æœ‰å‘å¸¦æƒå›¾ï¼Œè®¾èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯ä¸º$d$ï¼Œæ±‚èµ·ç‚¹åˆ°ç»ˆç‚¹æ»¡è¶³æƒå€¼æ€»å’Œå°äºç­‰äº$(d+k)$çš„è·¯å¾„æ•°é‡&lt;/p&gt;
&lt;p&gt;$1 \le p\le 10^9 $ , $1 \le n\le 10^5$ , $1 \le m\le 2 \times 10^5$ , $1 \le k\le 50$&lt;/p&gt;
&lt;p&gt;æ„Ÿè°¢@oy çš„è´¡çŒ®&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="åŠ¨æ€è§„åˆ’" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p2627ä¿®å‰ªè‰åª</title>
    <link href="https://tth37.cn/2019/06/09/solution-luogu-p2627/"/>
    <id>https://tth37.cn/2019/06/09/solution-luogu-p2627/</id>
    <published>2019-06-08T17:42:17.000Z</published>
    <updated>2019-06-22T17:15:10.371Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/P2627" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>è¯»å…¥$n$ä¸ªæ•´æ•°ï¼Œé€‰å–å…¶ä¸­è‹¥å¹²ä¸ªæ•°ï¼Œæœ€å¤šè¿ç»­å–$k$ä¸ªï¼Œæ±‚å–åˆ°æ•°å­—å’Œçš„æœ€å¤§å€¼</p><p>$1\le k \le n \le 100000$</p><p>æ„Ÿè°¢@oy çš„è´¡çŒ®</p></blockquote><a id="more"></a><p>ä¸€é“å•è°ƒé˜Ÿåˆ—å…¥é—¨é¢˜ã€‚</p><p>é¢å¯¹åŠ¨è§„é¢˜ï¼Œé¦–å…ˆè®¾è®¡çŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€‚ä»¤$f[i]$è¡¨ç¤º$1-i$ä¸­è¿å–ä¸è¶…è¿‡$K$ä¸ªæ•°ï¼Œä¸”<strong>ç¬¬$i$ä¸ªæ•°ä¸å–</strong>æ‰€èƒ½ç´¯åŠ çš„æœ€å¤§å’Œã€‚</p><p>å› ä¸ºç¬¬$i$ä¸ªæ•°ä¸å–ï¼Œæ‰€ä»¥åœ¨$i$ä¹‹å‰ä¸€å®šè¿å–äº†ä¸€æ®µæ•°ã€‚è¿™æ®µæ•°çš„é•¿åº¦å¯èƒ½ä¸º$0-K$ï¼ˆæ³¨æ„æ˜¯$0-K$è€Œä¸æ˜¯$1-K$ï¼Œå¯ä»¥é€šè¿‡æ‰‹æ¨æ ·ä¾‹å‘ç°æœ€ä¼˜è§£ä¸­å¯èƒ½å­˜åœ¨è¿ç€ä¸¤ä¸ªæ•°ä¸å–çš„æƒ…å†µï¼‰ã€‚è¿å–çš„ä¸€æ®µæ•°æ‰€èƒ½ç´¯åŠ çš„å’Œå¯ä»¥ç”¨å‰ç¼€å’Œè®¡ç®—ã€‚è€ƒè™‘è¾¹ç•Œæ¡ä»¶åï¼ŒçŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">f[i]=\max_{i-K-1\le j \le i-1} \lbrace f[j]+s[i-1]-s[j] \rbrace</script><p>ç”±äº$max$å‡½æ•°çš„å¾ªç¯å˜é‡æ˜¯$j$ï¼Œæ‰€ä»¥<strong>åªä¸$i$ç›¸å…³çš„å˜é‡</strong>$s[i-1]$å¯ä»¥ä½œä¸ºå¸¸æ•°æå‡ºåˆ°$max$å‡½æ•°ä¹‹å¤–ï¼Œå³ï¼š</p><script type="math/tex; mode=display">f[i]=\max_{i-K-1\le j \le i-1}\lbrace f[j]-s[j]\rbrace +s[i-1]</script><p>å°†çŠ¶æ€è½¬ç§»æ–¹ç¨‹åŒ–ç®€åˆ°è¿™æ ·ï¼Œå°±å·²ç»å¯ä»¥ç”¨å•è°ƒé˜Ÿåˆ—è¿›è¡Œä¼˜åŒ–äº†ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å•è°ƒé˜Ÿåˆ—ç»´æŠ¤$f[j]-s[j]$çš„æœ€å€¼ï¼Œåœ¨å¾ªç¯æ—¶å°†å…¶æœ€å¤§å€¼å–å‡ºå†åŠ ä¸Š$s[i-1]$å³ä¸º$f[i]$ã€‚</p><p>å¦‚æœæƒ³ä¸åˆ°è¯¥å¦‚ä½•æ“ä½œï¼Œä¹Ÿå¯ä»¥è¿™æ ·ç†è§£ï¼š</p><script type="math/tex; mode=display">g[i]=f[i]-s[i]</script><script type="math/tex; mode=display">f[i]=\max_{i-K-1\le j \le i-1}\lbrace g[j]\rbrace+s[i-1]</script><p>ç”±äºæˆ‘ä»¬å®šä¹‰$f[i]$æ˜¯ç¬¬$i$ä¸ªæ•°ä¸å–çš„æœ€ä¼˜è§£ï¼Œå¯ä»¥å¼ºè¡Œæ±‚è§£$f[N+1]$ï¼ˆè™½ç„¶å®ƒä¼¼ä¹æ²¡æœ‰å®é™…æ„ä¹‰ï¼‰ä½œä¸ºæœ¬é¢˜çš„æœ€ç»ˆç­”æ¡ˆã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K;</span><br><span class="line">ll s[<span class="number">100005</span>], f[<span class="number">100005</span>];</span><br><span class="line"><span class="keyword">int</span> q[<span class="number">100005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;N, &amp;K);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;s[i]);</span><br><span class="line">        s[i] += s[i<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>, r = <span class="number">1</span>;</span><br><span class="line">    q[<span class="number">0</span>] = <span class="number">0</span>, f[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N + <span class="number">1</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; r &amp;&amp; q[l] &lt; i - K - <span class="number">1</span>) l++;</span><br><span class="line">        f[i] = f[q[l]] - s[q[l]] + s[i<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">while</span> (l &lt; r &amp;&amp; f[q[r - <span class="number">1</span>]] - s[q[r - <span class="number">1</span>]] &lt; f[i] - s[i]) r--;</span><br><span class="line">        q[r++] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld"</span>, f[N + <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/P2627&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¯»å…¥$n$ä¸ªæ•´æ•°ï¼Œé€‰å–å…¶ä¸­è‹¥å¹²ä¸ªæ•°ï¼Œæœ€å¤šè¿ç»­å–$k$ä¸ªï¼Œæ±‚å–åˆ°æ•°å­—å’Œçš„æœ€å¤§å€¼&lt;/p&gt;
&lt;p&gt;$1\le k \le n \le 100000$&lt;/p&gt;
&lt;p&gt;æ„Ÿè°¢@oy çš„è´¡çŒ®&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="åŠ¨æ€è§„åˆ’" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="å•è°ƒé˜Ÿåˆ—" scheme="https://tth37.cn/tags/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p1600å¤©å¤©çˆ±è·‘æ­¥(Beta)</title>
    <link href="https://tth37.cn/2019/06/07/solution-luogu-p1600/"/>
    <id>https://tth37.cn/2019/06/07/solution-luogu-p1600/</id>
    <published>2019-06-07T15:41:27.000Z</published>
    <updated>2019-07-07T06:50:26.902Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/P1600" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>$n$ä¸ªç‚¹çš„æ ‘ä¸Šæœ‰$m$æ¡è·¯å¾„$(S_i, T_i)$ï¼Œæ¯æ¡è·¯å¾„ä¸Šå„æœ‰ä¸€ä¸ªäººä»$S_i$è·‘åˆ°$T_i$ã€‚ä»–ä»¬åœ¨ç¬¬$0$æ—¶åˆ»åŒæ—¶è·‘ï¼Œæ¯ç§’èƒ½è·‘ä¸€æ¡è¾¹ã€‚å›ç­”$n$ä¸ªè¯¢é—®ï¼Œè¯¢é—®æ°å¥½åœ¨ç¬¬$W_i$æ—¶åˆ»åˆ°è¾¾èŠ‚ç‚¹$i$çš„äººæ•°ã€‚</p><p>$1 \le n \le 300000,1 \le m \le 300000 $</p><p>æ„Ÿè°¢@tth37 çš„è´¡çŒ®</p></blockquote><a id="more"></a><p>å‡†å¤‡å†™ä¸€ç¯‡è¾ƒä¸ºè¯¦ç»†çš„é¢˜è§£ã€‚éƒ¨åˆ†æ€è·¯æ¥è‡ªã€Šç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ã€‹ã€‚</p><hr><p>æ¸¸æˆåœ°å›¾æ„æˆæ ‘å½¢ç»“æ„ï¼Œä¸ºæ–¹ä¾¿å¤„ç†ï¼Œå¯ä»¥å–$1$å·èŠ‚ç‚¹ä½œä¸ºæ ¹ï¼Œè½¬åŒ–ä¸ºæœ‰æ ¹æ ‘å¤„ç†ã€‚</p><p>å¯ä»¥å‘ç°ï¼Œä»Såˆ°Tçš„è·¯å¾„æœ‰ä¸”åªæœ‰ä¸€æ¡ï¼Œå¹¶ä¸”å¿…å°†ç»è¿‡$lca(S,T)$ã€‚</p><p>ä¸å¦¨è®¾$x$èŠ‚ç‚¹ä¸Šæœ‰ä¸€åè§‚å¯Ÿå‘˜ï¼Œå…¶è§‚å¯Ÿæ—¶é—´ä¸º$W[x]$ã€‚æˆ‘ä»¬å¯ä»¥å¯¹$x$çš„ä½ç½®è¿›è¡Œåˆ†æƒ…å†µè®¨è®ºã€‚</p><ol><li><p>$x$åœ¨$S$åˆ°$lca(S,T)$çš„è·¯å¾„ä¸Šï¼ˆè¯¥è·¯å¾„åŒ…å«$lca(S,T)$ï¼‰ã€‚</p><p><img src="https://tth37.cn/images/tmp1.png" alt></p><p>ä¸ºæ–¹ä¾¿è¯´æ˜ï¼Œå‡è®¾$S=6$ï¼Œ$T=4$ã€‚é‚£ä¹ˆï¼Œæ­¤æ—¶$x$å¯èƒ½ä¸º$1$ï¼Œ$3$æˆ–$6$ã€‚<strong>å¦‚æœæ­¤è§‚å¯Ÿå‘˜å¯ä»¥è§‚å¯Ÿåˆ°å½“å‰ç©å®¶ï¼Œå½“ä¸”ä»…å½“</strong>$W[x]=d[S]-d[x]$ï¼ˆ$d$æ•°ç»„è¡¨ç¤ºèŠ‚ç‚¹æ·±åº¦ï¼‰ã€‚å¯¹ä¸Šå¼ç§»é¡¹ï¼Œå¾—åˆ°$W[x]+d[x]=d[S]$ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç»™æ¯ä¸€ä¸ªèŠ‚ç‚¹åˆ†é…è‹¥å¹²ä¸ªæƒå€¼ï¼Œå³åœ¨æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¸Šå¼€ä¸€ä¸ªä¸€ç»´æ•°ç»„ï¼Œè®°å½•å„ä¸ªæƒå€¼ã€‚æ ¹æ®ä¸Šå¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†$S$åˆ°$lca(S,T)$çš„è·¯å¾„ä¸Šæ¯ä¸€ä¸ªèŠ‚ç‚¹çš„$d[S]$å·æƒå€¼åŠ ä¸€ã€‚æŒ‰ç…§è¿™ç§æ–¹å¼å¤„ç†å®Œæ‰€æœ‰ç©å®¶çš„ä¿¡æ¯ä¹‹åï¼Œæˆ‘ä»¬éå†æ‰€æœ‰èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„$(W[x]+d[x])$å·æƒå€¼å³ä¸ºæ‰€æ±‚ã€‚</p><p><img src="https://tth37.cn/images/tmp2.png" alt></p><p>è¯¥æ–¹æ³•çš„æ­£ç¡®æ€§åº”è¯¥ä¸éš¾ç†è§£ã€‚$(W[x]+d[x])$å·æƒå€¼çš„æ„ä¹‰å³ä¸ºè¯¥èŠ‚ç‚¹ä¸Šæ»¡è¶³å‰æ–‡æ‰€è¿°ç­‰å¼çš„ç©å®¶ä¸ªæ•°ï¼Œè€Œæ»¡è¶³ç­‰å¼æ„å‘³ç€ç©å®¶å°†ä¼šåœ¨è§‚å¯Ÿå‘˜æ¢å¤´æ—¶ç»è¿‡è§‚å¯Ÿç‚¹ï¼Œç¬¦åˆé¢˜æ„ã€‚</p><p>ä½†æ˜¯è¿™ç§æš´åŠ›æ–¹æ³•æ˜¾ç„¶è¿˜æœ‰ä¼˜åŒ–çš„ç©ºé—´ã€‚åœ¨æœ‰æ ¹æ ‘çš„ä¸€æ¡é“¾ä¸Šè¿›è¡Œæƒå€¼æ›´æ”¹ï¼Œå¯ä»¥å°è¯•ç”¨æ ‘ä¸Šå·®åˆ†çš„çŸ¥è¯†è§£å†³ã€‚<strong>åœ¨èŠ‚ç‚¹$S$ä¸Šçš„$d[S]$å·æƒå€¼åŠ ä¸€ï¼ŒèŠ‚ç‚¹$fa[lca(S,T)]$ä¸Šçš„$d[S]$å·æƒå€¼å‡ä¸€</strong>ï¼ˆå¯ä»¥åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šå¼€ä¸€ä¸ªä¸å®šé•¿æ•°ç»„vectorè®°å½•å½“å‰èŠ‚ç‚¹ä¸Šçš„åŠ å‡æ“ä½œï¼‰ï¼Œæœ€åè¿›è¡Œç»Ÿè®¡æ—¶ï¼Œè®¡ç®—<strong>å½“å‰å­æ ‘æ‰€æœ‰$(W[x]+d[x])$å·æƒå€¼å’Œ</strong>å³å¯ã€‚ä½†å³ä¾¿å¦‚æ­¤ï¼Œç­”æ¡ˆç»Ÿè®¡ä¹Ÿå¹¶ä¸å®¹æ˜“å®ç°ï¼›æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š</p><p>å»ºç«‹å…¨å±€æ•°ç»„$s$ï¼Œå…¶ä¸­$s[i]$è¡¨ç¤º$i$å·æƒå€¼ä¹‹å’Œã€‚æ·±åº¦ä¼˜å…ˆéå†æ‰€æœ‰èŠ‚ç‚¹ï¼Œåœ¨<strong>åˆšè®¿é—®åˆ°å½“å‰èŠ‚ç‚¹æ—¶ï¼Œè®°å½•$cnt=s[W[x]+d[x]]$</strong>ã€‚éå†å½“å‰èŠ‚ç‚¹ä¸Šçš„vectorï¼Œæ‰§è¡ŒåŠ å‡æ“ä½œï¼ˆä¾‹å¦‚ï¼švectorä¸­çš„ä¸€é¡¹æ“ä½œæŠŠ$3$å·æƒå€¼å‡ä¸€ï¼Œåˆ™$s[3]=s[3]-1$ï¼‰ã€‚é€’å½’è®¿é—®å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹ã€‚<strong>è®¿é—®ç»“æŸåï¼Œ$(s[W[x]+d[x]]-cnt)$å³ä¸ºæ‰€æ±‚</strong>ã€‚</p><p>ç»“åˆdfsåºçš„ç›¸å…³çŸ¥è¯†ï¼Œè®¿é—®å®Œå½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹ä¹‹åï¼Œ$s$æ•°ç»„å·²ç»è®°å½•äº†ä»¥$x$ä¸ºæ ¹çš„å­æ ‘ä¸Šæ‰€æœ‰æ“ä½œã€‚å› æ­¤å°†è®¿é—®åä¸è®¿é—®å‰çš„æƒå€¼ç›¸å‡ï¼Œå³ä¸ºæ ‘ä¸Šå·®åˆ†æ‰€å¾—åˆ°çš„ç­”æ¡ˆã€‚</p><p>åˆ«å¿˜äº†æ‰åˆ†ç±»è®¨è®ºäº†ä¸€åŠå‘¢â€¦â€¦</p></li><li><p>$x$åœ¨$lca(S,T)$åˆ°$T$çš„è·¯å¾„ä¸Šï¼ˆè¯¥è·¯å¾„ä¸åŒ…å«$lca(S,T)$ï¼‰ã€‚<br><img src="https://tth37.cn/images/tmp3.png" alt><br>åŒæ ·å‡è®¾$S=6$ï¼Œ$T=4$ã€‚æ­¤æ—¶$x$å¯èƒ½ä¸º$2$æˆ–$4$ã€‚<strong>å¦‚æœæ­¤è§‚å¯Ÿå‘˜å¯ä»¥è§‚å¯Ÿåˆ°å½“å‰ç©å®¶ï¼Œå½“ä¸”ä»…å½“</strong>$W[x]=(d[S]-d[lca(S,T)])+(d[x]-d[lca(S,T)])$ã€‚å¯¹ä¸Šå¼ç§»é¡¹ï¼Œå¾—åˆ°$W[x]-d[x]=d[S]-2*d[lca(S,T)]$ã€‚</p><p>ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬åªéœ€å°†æ“ä½œæ”¹ä¸ºå¯¹$(d[S]-2*d[lca(S,T)])$å·æƒå€¼çš„æ“ä½œå³å¯ã€‚ç”±äºæƒå€¼æœ‰å¯èƒ½ä¸ºè´Ÿï¼Œéœ€è¦å°†åºå·æ•´ä½“å¹³ç§»$N$ä¸ªå•ä½ï¼Œå³æ”¹ä¸ºå¯¹$(d[S]-2*d[lca(S,T)]+N)$å·æƒå€¼çš„æ“ä½œã€‚åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šå¦å¼€ä¸€ä¸ªæ“ä½œvectorï¼Œç»Ÿè®¡ç­”æ¡ˆæ—¶å¦å¼€ä¸€ä¸ª$s$æ•°ç»„ï¼Œå°†è®¡ç®—å‡ºçš„ç­”æ¡ˆä¸ç¬¬ä¸€ç§æƒ…å†µçš„ç­”æ¡ˆç›¸åŠ å³å¯ã€‚</p></li></ol><p> <strong>Qï¼šä¸ºä»€ä¹ˆå¿…é¡»å¦å¼€æ“ä½œvectorå’Œ$s$æ•°ç»„ï¼Ÿ</strong></p><p> <strong>Aï¼šå›é¡¾ä¸€ä¸‹æåˆ°çš„ä¸¤ä¸ªå¼å­ï¼š$W[x]+d[x]=d[S]$ï¼Œ$W[x]-d[x]=d[S]-2*d[lca(S,T)]$å¦‚æœå°†ä¸¤è€…åˆèµ·æ¥æ“ä½œï¼Œæœ‰å¯èƒ½äº§ç”Ÿâ€œå°†$d[S]$å·æƒå€¼åŠ ä¸€ï¼Œç¢°å·§ç»Ÿè®¡ç­”æ¡ˆæ—¶$W[x]-d[x]=d[S]$â€çš„æƒ…å†µã€‚ç„¶è€Œï¼Œä¸Šè¿°ç­‰å¼æ˜¯æ²¡æœ‰ä»»ä½•æ„ä¹‰çš„ï¼š$x$å·èŠ‚ç‚¹æ ¹æœ¬æ— æ³•è§‚å¯Ÿåˆ°ç©å®¶ã€‚ä¸ºäº†é¿å…æ­¤ç±»é”™è¯¯ï¼Œå¿…é¡»å°†ä¸¤ç§æ“ä½œåˆ†å¼€å¤„ç†ã€‚</strong></p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">300005</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">opt</span> &#123;</span><span class="keyword">int</span> id, op;&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAXN];</span><br><span class="line"><span class="built_in">vector</span>&lt;opt&gt; opt1[MAXN], opt2[MAXN];</span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">int</span> W[MAXN];</span><br><span class="line"><span class="keyword">int</span> f[MAXN][<span class="number">20</span>], d[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    f[u][<span class="number">0</span>] = fa, d[u] = d[fa] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">19</span>; ++i)</span><br><span class="line">        f[u][i] = f[f[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = *it;</span><br><span class="line">        <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs1(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (d[u] &lt; d[v]) swap(u, v);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">19</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (d[f[u][i]] &gt;= d[v]) u = f[u][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (u == v) <span class="keyword">return</span> u;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">19</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (f[u][i] != f[v][i]) u = f[u][i], v = f[v][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> s1[MAXN*<span class="number">3</span>], s2[MAXN*<span class="number">3</span>];</span><br><span class="line"><span class="keyword">int</span> ans[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt1 = s1[W[u] + d[u] + N];</span><br><span class="line">    <span class="keyword">int</span> cnt2 = s2[W[u] - d[u] + N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;opt&gt;::iterator it = opt1[u].begin(); it != opt1[u].end(); it++)</span><br><span class="line">        s1[it-&gt;id] += it-&gt;op;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;opt&gt;::iterator it = opt2[u].begin(); it != opt2[u].end(); it++)</span><br><span class="line">        s2[it-&gt;id] += it-&gt;op;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = *it;</span><br><span class="line">        <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs2(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    ans[u] = s1[W[u] + d[u] + N] - cnt1 + s2[W[u] - d[u] + N] - cnt2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;N, &amp;M);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> u, v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v);</span><br><span class="line">        G[u].push_back(v), G[v].push_back(u);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs1(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;W[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> S, T;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;S, &amp;T);</span><br><span class="line">        <span class="keyword">int</span> lca = Lca(S, T);</span><br><span class="line">        opt1[S].push_back((opt)&#123;d[S] + N, <span class="number">1</span>&#125;);</span><br><span class="line">        opt1[f[lca][<span class="number">0</span>]].push_back((opt)&#123;d[S] + N, <span class="number">-1</span>&#125;);</span><br><span class="line">        opt2[T].push_back((opt)&#123;d[S] - <span class="number">2</span>*d[lca] + N, <span class="number">1</span>&#125;);</span><br><span class="line">        opt2[lca].push_back((opt)&#123;d[S] - <span class="number">2</span>*d[lca] + N, <span class="number">-1</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs2(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/P1600&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;$n$ä¸ªç‚¹çš„æ ‘ä¸Šæœ‰$m$æ¡è·¯å¾„$(S_i, T_i)$ï¼Œæ¯æ¡è·¯å¾„ä¸Šå„æœ‰ä¸€ä¸ªäººä»$S_i$è·‘åˆ°$T_i$ã€‚ä»–ä»¬åœ¨ç¬¬$0$æ—¶åˆ»åŒæ—¶è·‘ï¼Œæ¯ç§’èƒ½è·‘ä¸€æ¡è¾¹ã€‚å›ç­”$n$ä¸ªè¯¢é—®ï¼Œè¯¢é—®æ°å¥½åœ¨ç¬¬$W_i$æ—¶åˆ»åˆ°è¾¾èŠ‚ç‚¹$i$çš„äººæ•°ã€‚&lt;/p&gt;
&lt;p&gt;$1 \le n \le 300000,1 \le m \le 300000 $&lt;/p&gt;
&lt;p&gt;æ„Ÿè°¢@tth37 çš„è´¡çŒ®&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="æ ‘ä¸Šå·®åˆ†" scheme="https://tth37.cn/tags/%E6%A0%91%E4%B8%8A%E5%B7%AE%E5%88%86/"/>
    
      <category term="æœ€è¿‘å…¬å…±ç¥–å…ˆ" scheme="https://tth37.cn/tags/%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p2633 Count on a tree(COT)</title>
    <link href="https://tth37.cn/2019/05/20/solution-luogu-p2633/"/>
    <id>https://tth37.cn/2019/05/20/solution-luogu-p2633/</id>
    <published>2019-05-20T11:04:53.000Z</published>
    <updated>2019-07-03T08:55:45.060Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/P2633" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>ç»™å®šä¸€æ£µ$n$ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸Šæœ‰ä¸€ä¸ªæƒå€¼ã€‚å¯¹äº$m$æ¬¡è¯¢é—®ï¼Œéœ€è¦è¾“å‡º$u$åˆ°$v$çš„æœ€çŸ­è·¯å¾„ä¸Šç¬¬$k$å°çš„ç‚¹æƒã€‚</p><p>$1\le n\le 100000,1 \le m\le 100000$</p><p>æ„Ÿè°¢@tth37 çš„è´¡çŒ®</p></blockquote><a id="more"></a><blockquote><p>è¿™é¢˜ä¸éš¾å‘€ï¼Œæ€ä¹ˆè°ƒäº†è¿™ä¹ˆä¹…ï¼Ÿ         â€”â€”Mr. G</p></blockquote><p>å‰ç½®çŸ¥è¯†æ˜¯ä¸»å¸­æ ‘ã€‚åœ¨åˆ©ç”¨ä¸»å¸­æ ‘æ±‚è§£åŒºé—´ç¬¬Kå°æ•°æ—¶å¯ä»¥å‘ç°ï¼Œä¸»å¸­æ ‘æ˜¯ä¸€ç§ç±»ä¼¼å‰ç¼€å’Œçš„æ•°æ®ç»“æ„ï¼Œå…·æœ‰å’Œå‰ç¼€å’Œç±»ä¼¼çš„åŒºé—´åŠ å‡åŠå·®åˆ†ç­‰ä¼˜ç§€æ€§è´¨ã€‚åœ¨æ±‚è§£çº¿æ€§åŒºé—´çš„ç¬¬Kå°æ•°æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†è¯¥åŒºé—´å†…çš„æ‰€æœ‰æ•°å€¼ä¿¡æ¯æ‰”åˆ°ä¸€æ£µä¸»å¸­æ ‘ä¸­ï¼Œå¹¶åœ¨è¿™æ£µä¸»å¸­æ ‘ä¸Šå·¦å³é€’å½’ï¼Œä»¥æ‰¾åˆ°ç¬¬Kå°æ•°ï¼›åŒæ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç±»æ¯”æ ‘ä¸Šå‰ç¼€å’Œçš„æ“ä½œï¼Œå®šä¹‰$s[u]$ä¸ºä»æ ¹èŠ‚ç‚¹åˆ°ç¬¬$u$å·èŠ‚ç‚¹çš„â€œå‰ç¼€ä¸»å¸­æ ‘â€ï¼ˆæ„Ÿæ€§ç†è§£è°¢è°¢ï¼‰ã€‚é‚£ä¹ˆï¼ŒåŒ…å«$u$åˆ°$v$ä¸Šæ‰€æœ‰æ•°å€¼ä¿¡æ¯çš„ä¸»å¸­æ ‘å°±åº”è¯¥æ˜¯ï¼š</p><script type="math/tex; mode=display">s[u]+s[v]-s[lca(u,v)]-s[fa[lca(u,v)]]</script><p>ç†è§£ä¸Šå¼åï¼Œé—®é¢˜åŸºæœ¬å¯ä»¥è§£å†³äº†ã€‚å¦å¤–æ³¨æ„ç¦»æ•£åŒ–å’Œä¸»å¸­æ ‘çš„ä»£ç ç»†èŠ‚ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="comment">// ç¦»æ•£åŒ–æ“ä½œ</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> id(x) (lower_bound(b+1,b+L+1,a[x])-b)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rid(x) (b[x])</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100005</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, sum;</span><br><span class="line">&#125;node[<span class="number">10000005</span>];</span><br><span class="line"><span class="keyword">int</span> head[MAXN],cnt;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, L, lastans;</span><br><span class="line"><span class="keyword">int</span> a[MAXN], b[MAXN];</span><br><span class="line"><span class="keyword">int</span> f[MAXN][<span class="number">19</span>], dep[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(Node &amp;u, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    u.sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    build(node[u.l = ++cnt], l, mid);</span><br><span class="line">    build(node[u.r = ++cnt], mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(Node c, Node &amp;u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    u.sum = c.sum + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(p &lt;= mid)</span><br><span class="line">        insert(node[c.l], node[u.l = ++cnt], l, mid, p), u.r = c.r;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        insert(node[c.r], node[u.r = ++cnt], mid+<span class="number">1</span>, r, p), u.l = c.l;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    insert(node[head[fa]], node[head[u] = ++cnt], <span class="number">1</span>, L, id(u));</span><br><span class="line">    f[u][<span class="number">0</span>] = fa;</span><br><span class="line">    dep[u] = dep[fa] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">18</span>; ++i)</span><br><span class="line">        f[u][i] = f[f[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = *it;</span><br><span class="line">        <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v]) swap(u, v);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">18</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dep[f[u][i]] &gt;= dep[v]) u = f[u][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (u == v) <span class="keyword">return</span> u;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">18</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (f[u][i] != f[v][i])</span><br><span class="line">            u = f[u][i], v = f[v][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query</span><span class="params">(Node x, Node y, Node z, Node w, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> l;</span><br><span class="line">    <span class="keyword">int</span> sum = node[x.l].sum + node[y.l].sum - node[z.l].sum - node[w.l].sum;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(sum &gt;= k) <span class="keyword">return</span> query(node[x.l], node[y.l], node[z.l], node[w.l], l, mid, k);</span><br><span class="line">    <span class="keyword">return</span> query(node[x.r], node[y.r], node[z.r], node[w.r], mid+<span class="number">1</span>, r, k - sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">querypath</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> lca = Lca(u, v);</span><br><span class="line">    <span class="keyword">return</span> rid(query(node[head[u]], node[head[v]], node[head[lca]], node[head[f[lca][<span class="number">0</span>]]], <span class="number">1</span>, L, k));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;N, &amp;M);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]), b[i] = a[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> u, v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v);</span><br><span class="line">        G[u].push_back(v);</span><br><span class="line">        G[v].push_back(u);</span><br><span class="line">    &#125;</span><br><span class="line">    sort(b + <span class="number">1</span>, b + N + <span class="number">1</span>);</span><br><span class="line">    L = unique(b + <span class="number">1</span>, b + N + <span class="number">1</span>) - (b + <span class="number">1</span>);</span><br><span class="line">    build(node[head[<span class="number">0</span>] = ++cnt], <span class="number">1</span>, L);</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> u, v, k;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;u, &amp;v, &amp;k);</span><br><span class="line">        <span class="keyword">int</span> nowans = querypath(u^lastans, v, k);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, nowans);</span><br><span class="line">        lastans = nowans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/P2633&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç»™å®šä¸€æ£µ$n$ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸Šæœ‰ä¸€ä¸ªæƒå€¼ã€‚å¯¹äº$m$æ¬¡è¯¢é—®ï¼Œéœ€è¦è¾“å‡º$u$åˆ°$v$çš„æœ€çŸ­è·¯å¾„ä¸Šç¬¬$k$å°çš„ç‚¹æƒã€‚&lt;/p&gt;
&lt;p&gt;$1\le n\le 100000,1 \le m\le 100000$&lt;/p&gt;
&lt;p&gt;æ„Ÿè°¢@tth37 çš„è´¡çŒ®&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="ä¸»å¸­æ ‘" scheme="https://tth37.cn/tags/%E4%B8%BB%E5%B8%AD%E6%A0%91/"/>
    
      <category term="æ ‘ä¸Šå‰ç¼€å’Œ" scheme="https://tth37.cn/tags/%E6%A0%91%E4%B8%8A%E5%89%8D%E7%BC%80%E5%92%8C/"/>
    
  </entry>
  
  <entry>
    <title>å…¬å‘Š 2019-5-18</title>
    <link href="https://tth37.cn/2019/05/18/bulletin-2019-5-18/"/>
    <id>https://tth37.cn/2019/05/18/bulletin-2019-5-18/</id>
    <published>2019-05-18T09:44:02.000Z</published>
    <updated>2019-06-08T18:13:46.614Z</updated>
    
    <content type="html"><![CDATA[<p>Hi~ è®¿é—®æˆ‘ç½‘ç«™çš„å°å´½å­ä»¬~</p><p>æƒ³åœ¨è¯„è®ºåŒºå‘è¨€çš„åŒæ—¶ç•™ä¸‹è‡ªå·±çš„ä¸ªäººå¤´åƒå—ï¼Ÿ<a href="http://cn.gravatar.com/" target="_blank" rel="noopener">é€Ÿæˆ³è¿™é‡Œï¼ï¼ˆGravatar.comï¼‰</a> åœ¨è¿™ä¸ªç½‘ç«™æ³¨å†Œç”¨æˆ·ï¼Œå¹¶åœ¨è¯„è®ºåŒºç•™è¨€æ—¶ç•™ä¸‹åœ¨<code>Gravatar</code>çš„è´¦å·é‚®ç®±ï¼Œå³å¯åœ¨è¯„è®ºåŒºæ˜¾ç¤ºå¤´åƒï¼</p><p><a href="https://tth37.cn/message/">å¯ä»¥åœ¨è¿™é‡Œæµ‹è¯•ä¸€ä¸‹</a></p><p>ç”±äºç½‘ç«™æ˜¯å›½å®¶é¡¶çº§åŸŸåï¼ˆ<code>*.cn</code>ï¼‰ï¼Œæ‰€ä»¥ç¼“å­˜å¯èƒ½éœ€è¦ä¸€å‘¨ï¼ˆæˆ–æ›´é•¿ï¼‰çš„æ—¶é—´æ‰èƒ½æ›´æ–°ï¼Œè¯·è€å¿ƒç­‰å¾…ï¼</p><p>è°¢è°¢èµ„ç“·ï¼</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Hi~ è®¿é—®æˆ‘ç½‘ç«™çš„å°å´½å­ä»¬~&lt;/p&gt;
&lt;p&gt;æƒ³åœ¨è¯„è®ºåŒºå‘è¨€çš„åŒæ—¶ç•™ä¸‹è‡ªå·±çš„ä¸ªäººå¤´åƒå—ï¼Ÿ&lt;a href=&quot;http://cn.gravatar.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é€Ÿæˆ³è¿™é‡Œï¼ï¼ˆGravatar.comï¼‰&lt;/a&gt; åœ¨è¿™ä¸ªç½‘
      
    
    </summary>
    
      <category term="å…¬å‘Š" scheme="https://tth37.cn/categories/%E5%85%AC%E5%91%8A/"/>
    
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p1273æœ‰çº¿ç”µè§†ç½‘</title>
    <link href="https://tth37.cn/2019/04/25/solution-luogu-p1273/"/>
    <id>https://tth37.cn/2019/04/25/solution-luogu-p1273/</id>
    <published>2019-04-25T09:25:50.000Z</published>
    <updated>2019-08-27T08:10:26.308Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/fe/problem/P1273" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p></blockquote><p>èƒŒåŒ…ç±»æ ‘å½¢dpã€‚æœ¬é¢˜éœ€è¦è¿ç”¨åˆ†ç»„èƒŒåŒ…æ¨¡å‹ã€‚</p><p>é¦–å…ˆå®šä¹‰çŠ¶æ€ï¼š$f[u][i]$è¡¨ç¤ºä»¥$u$ä¸ºæ ¹çš„å­æ ‘ä¸Šï¼Œé€‰æ‹©$i$ä¸ªç”¨æˆ·æ—¶çš„æœ€å¤§åˆ©æ¶¦ã€‚ç”±äºç”µè§†å…¬å¸å¯èƒ½äºæœ¬ï¼Œå› æ­¤$f$æ•°ç»„åº”èµ‹æå°åˆå€¼ã€‚</p><p>å¯ä»¥å°†é€‰æ‹©çš„ç”¨æˆ·ä¸ªæ•°çœ‹ä½œèƒŒåŒ…çš„å®¹é‡ç»´åº¦ï¼Œå°†è·å¾—çš„åˆ©æ¶¦çœ‹ä½œèƒŒåŒ…çš„ä»·å€¼ç»´åº¦ã€‚å¯ä»¥è®¾è®¡å‡ºå¦‚ä¸‹çš„çŠ¶æ€è½¬ç§»ï¼š</p><script type="math/tex; mode=display">f[u][i]=\max_{v\in son(u)}\{f[u][i-j]+f[v][j]-w\}</script><p>å…¶ä¸­ï¼Œ$v$ä¸º$u$çš„å­èŠ‚ç‚¹ï¼Œ$w$ä¸ºè¿™æ¡è¾¹çš„æƒå€¼ã€‚åœ¨$u$æ¯ä¸ªå­èŠ‚ç‚¹ä¸Šæœ‰è®¸å¤šâ€œç‰©å“â€ï¼Œâ€œç‰©å“â€æ€»æ•°å³ä¸ºä»¥$v$ä¸ºæ ¹çš„å­æ ‘ä¸Šç”¨æˆ·çš„ä¸ªæ•°ï¼›æ¯ä¸ªâ€œç‰©å“â€æ‰€å…·æœ‰çš„ä»·å€¼å³ä¸ºå…¶æœ€å¤§åˆ©æ¶¦ï¼Œå³$f[v][j]$ã€‚åŒæ—¶ä¸åº”å¿½ç•¥è¾¹æƒå¯¹åˆ©æ¶¦å¸¦æ¥çš„å½±å“ã€‚</p><p>æ³¨æ„ç»†èŠ‚å¤„ç†åŠè¾¹ç•Œã€‚ä»£ç å¦‚ä¸‹ï¼š</p><a id="more"></a><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> v,w,nxt;</span><br><span class="line">&#125;mem[<span class="number">3005</span>*<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> head[<span class="number">3005</span>],cnt;</span><br><span class="line"><span class="keyword">int</span> size[<span class="number">3005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    mem[++cnt].v=v;</span><br><span class="line">    mem[cnt].w=w;</span><br><span class="line">    mem[cnt].nxt=head[u];</span><br><span class="line">    head[u]=cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N,M;</span><br><span class="line"><span class="keyword">int</span> leaf[<span class="number">3005</span>];</span><br><span class="line"><span class="keyword">int</span> f[<span class="number">3005</span>][<span class="number">3005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(leaf[u])&#123;</span><br><span class="line">        f[u][<span class="number">1</span>]=leaf[u];</span><br><span class="line">        size[u]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=head[u];i;i=mem[i].nxt)&#123;</span><br><span class="line">        <span class="keyword">int</span> v=mem[i].v,w=mem[i].w;</span><br><span class="line">        dfs(v);</span><br><span class="line">        size[u]+=size[v];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> j=M;j&gt;=<span class="number">1</span>;--j)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> k=<span class="number">0</span>;k&lt;=min(size[v],j);++k)</span><br><span class="line">                f[u][j]=max(f[u][j],f[u][j-k]+f[v][k]-w);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(f,<span class="number">0xcf</span>,<span class="keyword">sizeof</span>(f));</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;N,&amp;M);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N-M;++i)&#123;</span><br><span class="line">        <span class="keyword">int</span> k;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;k);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=k;++j)&#123;</span><br><span class="line">            <span class="keyword">int</span> a,c;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;c);</span><br><span class="line">            AddEdge(i,a,c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=M;++i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;leaf[N-M+i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N;++i) f[i][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    dfs(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=M;i&gt;=<span class="number">1</span>;--i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(f[<span class="number">1</span>][i]&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d"</span>,i);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/fe/problem/P1273&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;èƒŒåŒ…ç±»æ ‘å½¢dpã€‚æœ¬é¢˜éœ€è¦è¿ç”¨åˆ†ç»„èƒŒåŒ…æ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå®šä¹‰çŠ¶æ€ï¼š$f[u][i]$è¡¨ç¤ºä»¥$u$ä¸ºæ ¹çš„å­æ ‘ä¸Šï¼Œé€‰æ‹©$i$ä¸ªç”¨æˆ·æ—¶çš„æœ€å¤§åˆ©æ¶¦ã€‚ç”±äºç”µè§†å…¬å¸å¯èƒ½äºæœ¬ï¼Œå› æ­¤$f$æ•°ç»„åº”èµ‹æå°åˆå€¼ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥å°†é€‰æ‹©çš„ç”¨æˆ·ä¸ªæ•°çœ‹ä½œèƒŒåŒ…çš„å®¹é‡ç»´åº¦ï¼Œå°†è·å¾—çš„åˆ©æ¶¦çœ‹ä½œèƒŒåŒ…çš„ä»·å€¼ç»´åº¦ã€‚å¯ä»¥è®¾è®¡å‡ºå¦‚ä¸‹çš„çŠ¶æ€è½¬ç§»ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
f[u][i]=\max_{v\in son(u)}\{f[u][i-j]+f[v][j]-w\}&lt;/script&gt;&lt;p&gt;å…¶ä¸­ï¼Œ$v$ä¸º$u$çš„å­èŠ‚ç‚¹ï¼Œ$w$ä¸ºè¿™æ¡è¾¹çš„æƒå€¼ã€‚åœ¨$u$æ¯ä¸ªå­èŠ‚ç‚¹ä¸Šæœ‰è®¸å¤šâ€œç‰©å“â€ï¼Œâ€œç‰©å“â€æ€»æ•°å³ä¸ºä»¥$v$ä¸ºæ ¹çš„å­æ ‘ä¸Šç”¨æˆ·çš„ä¸ªæ•°ï¼›æ¯ä¸ªâ€œç‰©å“â€æ‰€å…·æœ‰çš„ä»·å€¼å³ä¸ºå…¶æœ€å¤§åˆ©æ¶¦ï¼Œå³$f[v][j]$ã€‚åŒæ—¶ä¸åº”å¿½ç•¥è¾¹æƒå¯¹åˆ©æ¶¦å¸¦æ¥çš„å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ç»†èŠ‚å¤„ç†åŠè¾¹ç•Œã€‚ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="èƒŒåŒ…" scheme="https://tth37.cn/tags/%E8%83%8C%E5%8C%85/"/>
    
      <category term="æ ‘å½¢dp" scheme="https://tth37.cn/tags/%E6%A0%91%E5%BD%A2dp/"/>
    
  </entry>
  
  <entry>
    <title>ç®—æ³•å­¦ä¹ -æ•°è®ºä¸“é¢˜-ç´ æ•°çš„åˆ¤å®š</title>
    <link href="https://tth37.cn/2019/04/13/algorithm-maths-primecheck/"/>
    <id>https://tth37.cn/2019/04/13/algorithm-maths-primecheck/</id>
    <published>2019-04-13T13:58:41.000Z</published>
    <updated>2019-04-20T09:57:29.594Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç‰ˆæƒå£°æ˜ï¼šæœ¬ç¯‡æ–‡ç« ç”±ç‰¹é‚€è®²å¸ˆèƒ¡å®¶ç¿æ’°å†™ï¼Œtth37åªè´Ÿè´£æ¬è¿ã€æ•´ç†å’Œå‘å¸ƒï¼›ç‰ˆæƒå½’èƒ¡å®¶ç¿æ‰€æœ‰ã€‚</p></blockquote><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><blockquote><p>ç´ æ•°å®šä¹‰ï¼šé™¤1å’Œæœ¬èº«ä»¥å¤–æ²¡æœ‰å…¶ä»–å› æ•°çš„æ•°</p></blockquote><p>ç´ æ•°åœ¨ä¿¡æ¯å­¦ç«èµ›ä¸­æœ‰è¾ƒå¤šçš„åº”ç”¨ï¼Œç´ æ•°åˆ¤å®šæ˜¯è§£å†³å¤æ‚æ•°è®ºé—®é¢˜çš„åŸºç¡€ã€‚æœ¬ç¯‡æ–‡ç« ä»‹ç»äº†ä¸€äº›ç´ æ•°åˆ¤å®šçš„æ–¹æ³•ã€‚</p><a id="more"></a><h2 id="å•ä¸ªç´ æ•°åˆ¤å®š"><a href="#å•ä¸ªç´ æ•°åˆ¤å®š" class="headerlink" title="å•ä¸ªç´ æ•°åˆ¤å®š"></a>å•ä¸ªç´ æ•°åˆ¤å®š</h2><p>æœ´ç´ åˆ¤å®šï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">prime</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//ç‰¹åˆ¤1ï¼ˆä¸ä¸ºç´ æ•°ï¼‰</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;n;++i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n%i==<span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//é™¤1ã€nä»¥å¤–è¿˜å­˜åœ¨å› æ•°ï¼Œæ‰€ä»¥nä¸ºåˆæ•°ï¼›</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>ï¼›<span class="comment">//å¾ªç¯åæ²¡æœ‰åˆ¤å®šä¸ºåˆæ•°ï¼Œåˆ™ä¸ºç´ æ•°ã€‚</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦ï¼š$\Theta (n)$</p><p>ä¼˜åŒ–ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">prime</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//ç‰¹åˆ¤1ï¼ˆä¸ä¸ºç´ æ•°ï¼‰</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=<span class="built_in">sqrt</span>(n);++i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n%i==<span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>ï¼›</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦ï¼š$\Theta(\sqrt{n})$</p><p>è¯æ˜ï¼š</p><p>â€‹    è‹¥ä¸€ä¸ªæ•°$n$ä¸ºåˆæ•°ï¼Œåˆ™å®ƒä¸€å®šæ‹¥æœ‰ä¸€ä¸ªè´¨å› æ•°$k$ã€‚å¯ä»¥çŸ¥é“ï¼Œ$n/k$ï¼ˆè®°ä¸º$s$ï¼‰ä¸º$n$çš„å› æ•°ï¼Œä¸”$s$ä¸ç­‰äº$n$ã€‚$k$å’Œ$s$äºŒè€…å¿…å®šæœ‰ä¸€ä¸ªæ•°å°äºç­‰äº$\sqrt{n}$ï¼Œå¦åˆ™$k*s$ä¸€å®šå¤§äº$n$ã€‚æ‰€ä»¥åªè¦åœ¨$\sqrt{n}$ä»¥å†…å¾ªç¯ä¸€éå³å¯ã€‚</p><h2 id="åŸƒæ°ç´ æ•°ç­›"><a href="#åŸƒæ°ç´ æ•°ç­›" class="headerlink" title="åŸƒæ°ç´ æ•°ç­›"></a>åŸƒæ°ç´ æ•°ç­›</h2><p>å¦‚æœç”¨ä¸Šé¢çš„æ–¹æ³•åˆ¤å®š$1-n$ä»¥å†…æ‰€æœ‰ç´ æ•°ï¼Œä¼šå‘ç°æ—¶é—´å¤æ‚åº¦éå¸¸é«˜ã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±è¦ç”¨ç­›æ³•äº†ã€‚å¤§è‡´æ„æ€æ˜¯ç”¨ç´ æ•°æ¥ç­›æ‰åˆæ•°ï¼Œç„¶åç”¨$f$æ•°ç»„å‚¨å­˜æ˜¯å¦æ˜¯ç´ æ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">f[<span class="number">1</span>]=<span class="literal">true</span>;<span class="comment">//ç‰¹åˆ¤è¿˜æ˜¯å¾ˆå¿…è¦çš„</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)&#123;</span><br><span class="line">    <span class="keyword">if</span>(f[i]) <span class="keyword">continue</span>;<span class="comment">//iä¸ºåˆæ•°ç›´æ¥è·³è¿‡</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=i+i;j&lt;=n;j+=i)&#123;</span><br><span class="line">        f[j]=<span class="literal">true</span>;<span class="comment">//iä¸ºç´ æ•°ï¼Œiçš„å€æ•°ä¸€å®šä¸ºåˆæ•°</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼˜åŒ–ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">f[<span class="number">1</span>]=<span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)&#123;</span><br><span class="line">    <span class="keyword">if</span>(f[i]) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=i*i;j&lt;=n;j+=i)&#123;<span class="comment">//è¿™é‡Œåªå˜äº†ä¹˜å·ï¼Œä½†æ˜¯ä¼šå¿«å¾ˆå¤šå–”</span></span><br><span class="line">        f[j]=<span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŸå› æ˜¯ï¼š$i*i$ä»¥ä¸‹çš„æ‰€æœ‰åˆæ•°éƒ½å·²ç»è¢«ç­›æ‰äº†ã€‚å…·ä½“è¯æ³•ï¼Œå¯ä»¥æ¥ç€çœ‹ä¸‹å»ï¼ˆåœ¨çº¿æ€§ç­›é‡Œæœ‰ç±»ä¼¼çš„æ€æƒ³ï¼Œæ‰€ä»¥çœ‹å®Œå¯ä»¥å°è¯•ä¸€ä¸‹è‡ªå·±è¯æ˜ï¼‰ã€‚</p><h2 id="ç´ æ•°çº¿æ€§ç­›"><a href="#ç´ æ•°çº¿æ€§ç­›" class="headerlink" title="ç´ æ•°çº¿æ€§ç­›"></a>ç´ æ•°çº¿æ€§ç­›</h2><p>ä¸Šä¸€ä¸ªç­›æ³•æ—¶é—´å¤æ‚åº¦$\Theta(log log n)$éå¸¸æ¥è¿‘çº¿æ€§ã€‚ä½†æ˜¯è¦è¾¾åˆ°çº¿æ€§è¿˜å·®ä¸€ç‚¹ï¼ˆè¿™é‡Œä¸æ˜¯æ¯”èµ›è¦æ±‚æŒæ¡æ‰€ä»¥å°±å½“å…´è¶£å­¦å§ï¼‰</p><p>ä¸Šä¸€ä¸ªç­›æ³•çš„å¤§æ¦‚æƒ³æ³•ï¼Œæ˜¯æ¯ä¸€ä¸ªç´ æ•°çš„å€æ•°éƒ½ç­›æ‰ï¼Œæ‰€ä»¥æ˜¯è®©æ¯ä¸€ä¸ªåˆæ•°éƒ½è¢«å®ƒçš„è´¨å› å­ç­›ä¸€éã€‚</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥çš„ç­›æ³•ï¼Œå°±æ˜¯è®©æ¯ä¸ªåˆæ•°çš„æœ€å°è´¨å› å­ç­›ä¸€éï¼ˆè¦å¼€ä¸€ä¸ªprimeæ•°ç»„å­˜æ‰€æœ‰ç´ æ•°ï¼‰ã€‚å…ˆæ”¾ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll f[<span class="number">10005</span>],prime[<span class="number">10005</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n,i,j,cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">    <span class="comment">//è¿™ä¸ªåœ°æ–¹ä¸ç”¨ç‰¹åˆ¤1,å› ä¸ºæˆ‘ä»¬åˆ¤å®šæ˜¯å¦ä¸ºç´ æ•°çš„æ–¹æ³•æ˜¯f[i]æ˜¯å¦ä¸º0; </span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!f[i]) </span><br><span class="line">        &#123;</span><br><span class="line">            prime[++cnt]=i;<span class="comment">//å­˜å…¥ç´ æ•°; </span></span><br><span class="line">            f[i]=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=cnt;++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(prime[j]*i&gt;n||prime[j]&gt;f[i]) <span class="keyword">break</span>;<span class="comment">//åˆ¤å®šå‡ºç•Œæˆ–içš„å› å­ä¸­æœ‰æ¯”å½“å‰ç´ æ•°æ›´å°çš„ï¼ˆå³prime[j]*iå·²ç»è¢«f[i]ç­›è¿‡äº†ï¼‰; </span></span><br><span class="line">            f[prime[j]*i]=prime[j];<span class="comment">//æ ‡è®°æ‰€æœ‰æœªè¢«æ ‡è®°çš„içš„å€æ•°ï¼› </span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;i;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;f[i]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>æ ¸å¿ƒå°±åœ¨äºç¥å¥‡çš„åˆ¤å®šæ–¹æ³•ï¼Œå¯ä»¥å¤šå’€åš¼å’€åš¼</p><p>æ—¶é—´å¤æ‚åº¦$\Theta(n)$æå®šï¼Œè¿˜å¯ä»¥æ‰¾åˆ°$1-n$å†…æ‰€æœ‰åˆæ•°çš„æœ€å°è´¨å› æ•°ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç‰ˆæƒå£°æ˜ï¼šæœ¬ç¯‡æ–‡ç« ç”±ç‰¹é‚€è®²å¸ˆèƒ¡å®¶ç¿æ’°å†™ï¼Œtth37åªè´Ÿè´£æ¬è¿ã€æ•´ç†å’Œå‘å¸ƒï¼›ç‰ˆæƒå½’èƒ¡å®¶ç¿æ‰€æœ‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;ç´ æ•°å®šä¹‰ï¼šé™¤1å’Œæœ¬èº«ä»¥å¤–æ²¡æœ‰å…¶ä»–å› æ•°çš„æ•°&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç´ æ•°åœ¨ä¿¡æ¯å­¦ç«èµ›ä¸­æœ‰è¾ƒå¤šçš„åº”ç”¨ï¼Œç´ æ•°åˆ¤å®šæ˜¯è§£å†³å¤æ‚æ•°è®ºé—®é¢˜çš„åŸºç¡€ã€‚æœ¬ç¯‡æ–‡ç« ä»‹ç»äº†ä¸€äº›ç´ æ•°åˆ¤å®šçš„æ–¹æ³•ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç®—æ³•å­¦ä¹ " scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="æ•°è®ºä¸“é¢˜" scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/%E6%95%B0%E8%AE%BA%E4%B8%93%E9%A2%98/"/>
    
    
      <category term="æ•°å­¦" scheme="https://tth37.cn/tags/%E6%95%B0%E5%AD%A6/"/>
    
      <category term="ç´ æ•°" scheme="https://tth37.cn/tags/%E7%B4%A0%E6%95%B0/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p4559åˆ—é˜Ÿ</title>
    <link href="https://tth37.cn/2019/04/10/solution-luogu-p4559/"/>
    <id>https://tth37.cn/2019/04/10/solution-luogu-p4559/</id>
    <published>2019-04-10T15:42:59.000Z</published>
    <updated>2019-05-12T13:00:53.173Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/P4559" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p></blockquote><p>æœ¬é¢˜æ˜¯ä¸»å¸­æ ‘çš„ä¸€ä¸ªç®€å•åº”ç”¨ã€‚</p><p>é˜…è¯»é¢˜ç›®ï¼Œä¸éš¾å¾—å‡º<strong>è´ªå¿ƒç­–ç•¥</strong>ã€‚åœ¨ç¼–å·ä½äº$[l,r]$çš„æ‰€æœ‰äººä¸­ï¼Œå…¶ä½ç½®æœ€é å‰çš„è·‘åˆ°$K$ä½ç½®ï¼Œä½ç½®ç¬¬äºŒé å‰çš„è·‘åˆ°$K+1$ä½ç½®ï¼Œä»¥æ­¤ç±»æ¨ï¼Œå¯ä»¥ä½¿ä½“åŠ›å€¼æ€»å’Œæœ€å°ã€‚æ­£ç¡®æ€§ä¸ç»™å‡ºè¯æ˜ã€‚<del>ï¼ˆä¸ä¼šè¯ï¼‰</del></p><p>å¯¹äºæ‰€æœ‰å­¦ç”Ÿçš„ä½ç½®åºåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥å»ºç«‹ä¸»å¸­æ ‘ï¼Œå¹¶å¯ä»¥ç”¨ä¸»å¸­æ ‘çš„åŸºæœ¬æŸ¥è¯¢æ“ä½œæå–å‡ºåŒºé—´ä¸º$[l,r]$çš„å­¦ç”Ÿä½ç½®å€¼åŸŸä¿¡æ¯ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿å­¦ç”Ÿå·¦å³è·‘åŠ¨æ—¶ä½“åŠ›å€¼çš„ç»Ÿè®¡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸»å¸­æ ‘ä¸Šé¢å¤–è®°å½•ä¸¤ä¸ªæ•°å€¼ï¼š$gl$å’Œ$gr$ï¼Œåˆ†åˆ«è¡¨ç¤ºå½“å‰èŠ‚ç‚¹å¯¹åº”çš„åŒºé—´å†…æ‰€æœ‰å­¦ç”Ÿè·‘åŠ¨è‡³å·¦ç«¯ç‚¹å’Œå³ç«¯ç‚¹æ‰€æ¶ˆè€—çš„ä½“åŠ›å€¼ã€‚åœ¨å»ºæ ‘è¿‡ç¨‹ä¸­å³å¯å¯¹è¿™ä¸¤ä¸ªå˜é‡è¿›è¡Œç»Ÿè®¡ï¼Œå…¶ä¸­$gl$ç­‰äºå½“å‰èŠ‚ç‚¹$u$çš„å·¦å„¿å­ä¸Šçš„$gl$ï¼ŒåŠ ä¸Š$u$çš„å³å„¿å­ä¸Šçš„$gl$ï¼Œå†åŠ ä¸Šå³å„¿å­ä¸Šæ‰€æœ‰å­¦ç”Ÿä»å³å„¿å­çš„å·¦ç«¯ç‚¹è·‘åˆ°$u$çš„å·¦ç«¯ç‚¹æ‰€è¦æ¶ˆè€—çš„ä½“åŠ›å€¼ã€‚ï¼ˆå¯ä»¥è‡ªå·±åœ¨æ•°è½´ä¸Šæ¨¡æ‹Ÿä¸€ä¸‹ï¼‰</p><p>æ¥ä¸‹æ¥è®¾è®¡æŸ¥è¯¢å‡½æ•°ã€‚å‚æ•°åŒ…æ‹¬å€¼åŸŸçš„å·¦ç«¯ç‚¹å’Œå³ç«¯ç‚¹$l$å’Œ$r$ï¼Œä»¥åŠç›®æ ‡ä½ç½®åŒºé—´çš„å·¦ç«¯ç‚¹å’Œå³ç«¯ç‚¹$ql$å’Œ$qr$ã€‚æ˜¾ç„¶å¯¹äºä»¥ä¸‹æƒ…å†µï¼Œå‡½æ•°å¯ä»¥ç›´æ¥é€šè¿‡è®¡ç®—å¾—å‡ºç­”æ¡ˆï¼š</p><ul><li>$r\le ql$ æ­¤æ—¶å¤„äºå½“å‰å€¼åŸŸå†…çš„æ‰€æœ‰å­¦ç”Ÿéƒ½è¦å¾€å³è·‘</li><li>$qr\le l$ æ­¤æ—¶å¤„äºå½“å‰å€¼åŸŸå†…çš„æ‰€æœ‰å­¦ç”Ÿéƒ½è¦å¾€å·¦è·‘</li><li>å½“å‰å€¼åŸŸå†…æ²¡æœ‰å­¦ç”Ÿ è¿”å› $0$</li></ul><p>å¦åˆ™ï¼Œå¿…é¡»å°†å€¼åŸŸæ‹†åˆ†ï¼Œé€’å½’åˆ°å·¦å³å­èŠ‚ç‚¹è¿›è¡Œç»Ÿè®¡ã€‚</p><p>æœ¬é¢˜æœ€ç»•çš„åœ°æ–¹åœ¨äº<strong>å­¦ç”Ÿç¼–å·</strong>å’Œ<strong>å­¦ç”Ÿä½ç½®</strong>æ˜¯ä¸¤ä¸ªä¸åŒçš„ä¸œè¥¿ï¼Œåœ¨è®¾è®¡æŸ¥è¯¢å‡½æ•°æ—¶å¿…é¡»åŒºåˆ†å€¼åŸŸå’Œç¼–å·çš„æ¦‚å¿µã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><a id="more"></a><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// luogu-judger-enable-o2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN=<span class="number">500005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> L=<span class="number">1000005</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N,M;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l,r;</span><br><span class="line">    ll gl,gr,sum;</span><br><span class="line">&#125;node[L*<span class="number">22</span>+<span class="number">5</span>];</span><br><span class="line"><span class="keyword">int</span> head[MAXN];</span><br><span class="line"><span class="keyword">int</span> cnt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(Node&amp; u,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    u.sum=u.gl=u.gr=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    build(node[u.l=++cnt],l,mid);</span><br><span class="line">    build(node[u.r=++cnt],mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(Node c,Node&amp; u,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    u.sum=c.sum+<span class="number">1</span>;u.gl=u.gr=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(p&lt;=mid)</span><br><span class="line">        insert(node[c.l],node[u.l=++cnt],l,mid,p),u.r=c.r;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        insert(node[c.r],node[u.r=++cnt],mid+<span class="number">1</span>,r,p),u.l=c.l;</span><br><span class="line">    u.gl=node[u.l].gl+node[u.r].gl+node[u.r].sum*(mid-l+<span class="number">1</span>);</span><br><span class="line">    u.gr=node[u.r].gr+node[u.l].gr+node[u.l].sum*(r-mid);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">query</span><span class="params">(Node x,Node y,<span class="keyword">int</span> l,<span class="keyword">int</span> r,ll ql,ll qr)</span></span>&#123;</span><br><span class="line">    ll sum=y.sum-x.sum; </span><br><span class="line">    ll gl=y.gl-x.gl,gr=y.gr-x.gr;</span><br><span class="line">    <span class="keyword">if</span>(sum==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(qr&lt;=l)</span><br><span class="line">        <span class="keyword">return</span> gl+(<span class="number">2</span>*l-ql-qr)*(qr-ql+<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(ql&gt;=r)</span><br><span class="line">        <span class="keyword">return</span> gr+(ql+qr<span class="number">-2</span>*r)*(qr-ql+<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    ll lsum=node[y.l].sum-node[x.l].sum;</span><br><span class="line">    <span class="keyword">return</span> query(node[x.l],node[y.l],l,mid,ql,ql+lsum<span class="number">-1</span>)+</span><br><span class="line">           query(node[x.r],node[y.r],mid+<span class="number">1</span>,r,ql+lsum,qr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;N,&amp;M);</span><br><span class="line">    build(node[<span class="number">0</span>],<span class="number">1</span>,L);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N;++i)&#123;</span><br><span class="line">        <span class="keyword">int</span> a;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a);</span><br><span class="line">        insert(node[head[i<span class="number">-1</span>]],node[head[i]=++cnt],<span class="number">1</span>,L,a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=M;++i)&#123;</span><br><span class="line">        ll l,r,k;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>,&amp;l,&amp;r,&amp;k);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,query(node[head[l<span class="number">-1</span>]],node[head[r]],<span class="number">1</span>,L,k,k+r-l));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/P4559&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æœ¬é¢˜æ˜¯ä¸»å¸­æ ‘çš„ä¸€ä¸ªç®€å•åº”ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;é˜…è¯»é¢˜ç›®ï¼Œä¸éš¾å¾—å‡º&lt;strong&gt;è´ªå¿ƒç­–ç•¥&lt;/strong&gt;ã€‚åœ¨ç¼–å·ä½äº$[l,r]$çš„æ‰€æœ‰äººä¸­ï¼Œå…¶ä½ç½®æœ€é å‰çš„è·‘åˆ°$K$ä½ç½®ï¼Œä½ç½®ç¬¬äºŒé å‰çš„è·‘åˆ°$K+1$ä½ç½®ï¼Œä»¥æ­¤ç±»æ¨ï¼Œå¯ä»¥ä½¿ä½“åŠ›å€¼æ€»å’Œæœ€å°ã€‚æ­£ç¡®æ€§ä¸ç»™å‡ºè¯æ˜ã€‚&lt;del&gt;ï¼ˆä¸ä¼šè¯ï¼‰&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºæ‰€æœ‰å­¦ç”Ÿçš„ä½ç½®åºåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥å»ºç«‹ä¸»å¸­æ ‘ï¼Œå¹¶å¯ä»¥ç”¨ä¸»å¸­æ ‘çš„åŸºæœ¬æŸ¥è¯¢æ“ä½œæå–å‡ºåŒºé—´ä¸º$[l,r]$çš„å­¦ç”Ÿä½ç½®å€¼åŸŸä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æ–¹ä¾¿å­¦ç”Ÿå·¦å³è·‘åŠ¨æ—¶ä½“åŠ›å€¼çš„ç»Ÿè®¡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸»å¸­æ ‘ä¸Šé¢å¤–è®°å½•ä¸¤ä¸ªæ•°å€¼ï¼š$gl$å’Œ$gr$ï¼Œåˆ†åˆ«è¡¨ç¤ºå½“å‰èŠ‚ç‚¹å¯¹åº”çš„åŒºé—´å†…æ‰€æœ‰å­¦ç”Ÿè·‘åŠ¨è‡³å·¦ç«¯ç‚¹å’Œå³ç«¯ç‚¹æ‰€æ¶ˆè€—çš„ä½“åŠ›å€¼ã€‚åœ¨å»ºæ ‘è¿‡ç¨‹ä¸­å³å¯å¯¹è¿™ä¸¤ä¸ªå˜é‡è¿›è¡Œç»Ÿè®¡ï¼Œå…¶ä¸­$gl$ç­‰äºå½“å‰èŠ‚ç‚¹$u$çš„å·¦å„¿å­ä¸Šçš„$gl$ï¼ŒåŠ ä¸Š$u$çš„å³å„¿å­ä¸Šçš„$gl$ï¼Œå†åŠ ä¸Šå³å„¿å­ä¸Šæ‰€æœ‰å­¦ç”Ÿä»å³å„¿å­çš„å·¦ç«¯ç‚¹è·‘åˆ°$u$çš„å·¦ç«¯ç‚¹æ‰€è¦æ¶ˆè€—çš„ä½“åŠ›å€¼ã€‚ï¼ˆå¯ä»¥è‡ªå·±åœ¨æ•°è½´ä¸Šæ¨¡æ‹Ÿä¸€ä¸‹ï¼‰&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥è®¾è®¡æŸ¥è¯¢å‡½æ•°ã€‚å‚æ•°åŒ…æ‹¬å€¼åŸŸçš„å·¦ç«¯ç‚¹å’Œå³ç«¯ç‚¹$l$å’Œ$r$ï¼Œä»¥åŠç›®æ ‡ä½ç½®åŒºé—´çš„å·¦ç«¯ç‚¹å’Œå³ç«¯ç‚¹$ql$å’Œ$qr$ã€‚æ˜¾ç„¶å¯¹äºä»¥ä¸‹æƒ…å†µï¼Œå‡½æ•°å¯ä»¥ç›´æ¥é€šè¿‡è®¡ç®—å¾—å‡ºç­”æ¡ˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$r\le ql$ æ­¤æ—¶å¤„äºå½“å‰å€¼åŸŸå†…çš„æ‰€æœ‰å­¦ç”Ÿéƒ½è¦å¾€å³è·‘&lt;/li&gt;
&lt;li&gt;$qr\le l$ æ­¤æ—¶å¤„äºå½“å‰å€¼åŸŸå†…çš„æ‰€æœ‰å­¦ç”Ÿéƒ½è¦å¾€å·¦è·‘&lt;/li&gt;
&lt;li&gt;å½“å‰å€¼åŸŸå†…æ²¡æœ‰å­¦ç”Ÿ è¿”å› $0$&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦åˆ™ï¼Œå¿…é¡»å°†å€¼åŸŸæ‹†åˆ†ï¼Œé€’å½’åˆ°å·¦å³å­èŠ‚ç‚¹è¿›è¡Œç»Ÿè®¡ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬é¢˜æœ€ç»•çš„åœ°æ–¹åœ¨äº&lt;strong&gt;å­¦ç”Ÿç¼–å·&lt;/strong&gt;å’Œ&lt;strong&gt;å­¦ç”Ÿä½ç½®&lt;/strong&gt;æ˜¯ä¸¤ä¸ªä¸åŒçš„ä¸œè¥¿ï¼Œåœ¨è®¾è®¡æŸ¥è¯¢å‡½æ•°æ—¶å¿…é¡»åŒºåˆ†å€¼åŸŸå’Œç¼–å·çš„æ¦‚å¿µã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="æ•°æ®ç»“æ„" scheme="https://tth37.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="ä¸»å¸­æ ‘" scheme="https://tth37.cn/tags/%E4%B8%BB%E5%B8%AD%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p5283å¼‚æˆ–ç²½å­</title>
    <link href="https://tth37.cn/2019/04/09/solution-luogu-p5283/"/>
    <id>https://tth37.cn/2019/04/09/solution-luogu-p5283/</id>
    <published>2019-04-09T15:41:48.000Z</published>
    <updated>2019-05-12T13:01:05.454Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/P5283" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p></blockquote><p>åˆ†æé¢˜æ„ï¼Œå³æ‰¾å‡º$n$ä¸ªæ•°ä¸­äº’ä¸ç›¸åŒä¸”å¼‚æˆ–å’Œæœ€å¤§çš„å‰$k$æ®µåŒºé—´ã€‚</p><p>ç”¨å¼‚æˆ–å‰ç¼€å’Œ$s[i]$è¡¨ç¤º$a[1]\oplus a[2]\oplus â€¦ \oplus a[i]$ã€‚æ ¹æ®å¼‚æˆ–è¿ç®—çš„æ€§è´¨ï¼ŒåŒºé—´$[l,r]$çš„å¼‚æˆ–å’Œå³ä¸º$s[r] \oplus  s[l-1]$ã€‚</p><p>å°†$s[1]$åˆ°$s[n]$ä¾æ¬¡æ’å…¥$01trie$æ ‘ä¸­ï¼Œæ¯æ¬¡æ‰¾å‡ºå¯¹äºå›ºå®šçš„å³ç«¯ç‚¹$r$ï¼Œä¸$s[r]$å¼‚æˆ–å€¼æœ€å¤§çš„$s[l]$ã€‚æ˜¾ç„¶ï¼Œæ­¤æ¬¡æ“ä½œæ‰¾åˆ°çš„æ˜¯å›ºå®šå³ç«¯ç‚¹ä¸º$r$æ—¶çš„æœ€å¤§åŒºé—´å¼‚æˆ–å’Œã€‚</p><p>å°†æ¯ä¸ªä¸åŒçš„$r$å€¼æ‰€å¯¹åº”çš„æœ€å¤§åŒºé—´å¼‚æˆ–å’Œæ’å…¥å †ä¸­ï¼Œæ˜¾ç„¶å †é¡¶çš„å…ƒç´ å³ä¸º$n$ä¸ªæ•°ä¸­ä»»æ„åŒºé—´çš„æœ€å¤§å¼‚æˆ–å’Œã€‚å–å‡ºå †é¡¶å…ƒç´ ï¼Œå¹¶åŒæ—¶å¾—åˆ°è¿™æ˜¯ä»¥$r$ä¸ºå³ç«¯ç‚¹çš„ç¬¬$1$å¤§åŒºé—´å¼‚æˆ–å’Œã€‚å‘å †ä¸­æ’å…¥ä»¥$r$ä¸ºå³ç«¯ç‚¹çš„ç¬¬$2$å¤§åŒºé—´å¼‚æˆ–å’Œã€‚</p><p>åœ¨æŸ¥è¯¢ä»¥$r$ä¸ºå³ç«¯ç‚¹çš„ç¬¬$k$å¤§åŒºé—´å¼‚æˆ–å’Œæ—¶ï¼Œåªéœ€ç¨å¾®æ›´æ”¹åœ¨$01trie$æ ‘ä¸ŠæŸ¥æ‰¾çš„æ–¹å¼å³å¯ï¼Œä¸ä¸»å¸­æ ‘æŸ¥è¯¢åŒºé—´ç¬¬$k$å°æ•°çš„æ€æƒ³ç±»ä¼¼ã€‚ç”±äºéœ€è¦è®¿é—®$01trie$æ ‘çš„å†å²çŠ¶æ€ï¼Œå› æ­¤$01trie$éœ€è¦å¯æŒä¹…åŒ–ã€‚</p><p>æ³¨æ„ï¼šä»¥$r$ä¸ºå³ç«¯ç‚¹çš„åŒºé—´å¼‚æˆ–å’Œä¸€å…±åªæœ‰$r$ä¸ªï¼Œå› æ­¤æŸ¥è¯¢ä»¥$r$ä¸ºå³ç«¯ç‚¹çš„ç¬¬$r+1$å¤§åŒºé—´å¼‚æˆ–å’Œæ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚</p><p>å¦å¤–ï¼Œåœ¨å°†<code>(1&lt;&lt;d)</code>è¿™æ ·çš„å¼å­è½¬<code>long long</code>æ—¶ï¼Œä¸èƒ½å†™æˆ<code>(long long)(1&lt;&lt;d)</code>ï¼Œè€Œæ˜¯<code>((long long)1&lt;&lt;d)</code>ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><a id="more"></a><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN=<span class="number">500005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> DEP=<span class="number">31</span>;</span><br><span class="line"><span class="keyword">int</span> N,M;</span><br><span class="line">ll ans,s[MAXN];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">State</span>&#123;</span></span><br><span class="line">    ll val;</span><br><span class="line">    <span class="keyword">int</span> r,k;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> State&amp; rhs) <span class="keyword">const</span> &#123;<span class="keyword">return</span> val&lt;rhs.val;&#125;</span><br><span class="line">&#125;;</span><br><span class="line">priority_queue&lt;State&gt; q;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> son[<span class="number">2</span>],sum;</span><br><span class="line">&#125;trie[MAXN*(DEP+<span class="number">2</span>)];</span><br><span class="line"><span class="keyword">int</span> head[MAXN],cnt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(Node c,Node&amp; u,ll val,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    u.sum=c.sum+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(d&lt;<span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> x=(val&gt;&gt;d)&amp;<span class="number">1</span>;</span><br><span class="line">    u.son[!x]=c.son[!x];</span><br><span class="line">    insert(trie[c.son[x]],trie[u.son[x]=++cnt],val,d<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">query</span><span class="params">(Node u,ll val,<span class="keyword">int</span> d,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(d&lt;<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> x=(val&gt;&gt;d)&amp;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> lsum=trie[u.son[!x]].sum;</span><br><span class="line">    <span class="keyword">if</span>(lsum&gt;=k)</span><br><span class="line">      <span class="keyword">return</span> ((ll)<span class="number">1</span>&lt;&lt;d)+(ll)query(trie[u.son[!x]],val,d<span class="number">-1</span>,k);</span><br><span class="line">    <span class="keyword">return</span> (ll)query(trie[u.son[x]],val,d<span class="number">-1</span>,k-lsum);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    trie[<span class="number">0</span>].son[<span class="number">0</span>]=trie[<span class="number">0</span>].son[<span class="number">1</span>]=trie[<span class="number">0</span>].sum=<span class="number">0</span>;</span><br><span class="line">    insert(trie[<span class="number">0</span>],trie[head[<span class="number">0</span>]=++cnt],<span class="number">0</span>,DEP);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;N,&amp;M);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N;++i)&#123;</span><br><span class="line">        ll a;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;a);</span><br><span class="line">        s[i]=s[i<span class="number">-1</span>]^a;</span><br><span class="line">        insert(trie[head[i<span class="number">-1</span>]],trie[head[i]=++cnt],s[i],DEP);</span><br><span class="line">        q.push((State)&#123;query(trie[head[i<span class="number">-1</span>]],s[i],DEP,<span class="number">1</span>),i,<span class="number">1</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=M;++i)&#123;</span><br><span class="line">        ans+=q.top().val;</span><br><span class="line">        <span class="keyword">int</span> r=q.top().r,k=q.top().k;</span><br><span class="line">        q.pop();</span><br><span class="line">        <span class="keyword">if</span>(k==r) <span class="keyword">continue</span>;</span><br><span class="line">        q.push((State)&#123;query(trie[head[r<span class="number">-1</span>]],s[r],DEP,k+<span class="number">1</span>),r,k+<span class="number">1</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>$p.s.$æ´›è°·è¯„æµ‹æœºæœ‰ç‚¹å°æ…¢ï¼Œä¸å¼€<code>O2</code>ä¼šå°æ¦‚ç‡å‘ç”ŸTLE QwQ</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/P5283&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åˆ†æé¢˜æ„ï¼Œå³æ‰¾å‡º$n$ä¸ªæ•°ä¸­äº’ä¸ç›¸åŒä¸”å¼‚æˆ–å’Œæœ€å¤§çš„å‰$k$æ®µåŒºé—´ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨å¼‚æˆ–å‰ç¼€å’Œ$s[i]$è¡¨ç¤º$a[1]\oplus a[2]\oplus â€¦ \oplus a[i]$ã€‚æ ¹æ®å¼‚æˆ–è¿ç®—çš„æ€§è´¨ï¼ŒåŒºé—´$[l,r]$çš„å¼‚æˆ–å’Œå³ä¸º$s[r] \oplus  s[l-1]$ã€‚&lt;/p&gt;
&lt;p&gt;å°†$s[1]$åˆ°$s[n]$ä¾æ¬¡æ’å…¥$01trie$æ ‘ä¸­ï¼Œæ¯æ¬¡æ‰¾å‡ºå¯¹äºå›ºå®šçš„å³ç«¯ç‚¹$r$ï¼Œä¸$s[r]$å¼‚æˆ–å€¼æœ€å¤§çš„$s[l]$ã€‚æ˜¾ç„¶ï¼Œæ­¤æ¬¡æ“ä½œæ‰¾åˆ°çš„æ˜¯å›ºå®šå³ç«¯ç‚¹ä¸º$r$æ—¶çš„æœ€å¤§åŒºé—´å¼‚æˆ–å’Œã€‚&lt;/p&gt;
&lt;p&gt;å°†æ¯ä¸ªä¸åŒçš„$r$å€¼æ‰€å¯¹åº”çš„æœ€å¤§åŒºé—´å¼‚æˆ–å’Œæ’å…¥å †ä¸­ï¼Œæ˜¾ç„¶å †é¡¶çš„å…ƒç´ å³ä¸º$n$ä¸ªæ•°ä¸­ä»»æ„åŒºé—´çš„æœ€å¤§å¼‚æˆ–å’Œã€‚å–å‡ºå †é¡¶å…ƒç´ ï¼Œå¹¶åŒæ—¶å¾—åˆ°è¿™æ˜¯ä»¥$r$ä¸ºå³ç«¯ç‚¹çš„ç¬¬$1$å¤§åŒºé—´å¼‚æˆ–å’Œã€‚å‘å †ä¸­æ’å…¥ä»¥$r$ä¸ºå³ç«¯ç‚¹çš„ç¬¬$2$å¤§åŒºé—´å¼‚æˆ–å’Œã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æŸ¥è¯¢ä»¥$r$ä¸ºå³ç«¯ç‚¹çš„ç¬¬$k$å¤§åŒºé—´å¼‚æˆ–å’Œæ—¶ï¼Œåªéœ€ç¨å¾®æ›´æ”¹åœ¨$01trie$æ ‘ä¸ŠæŸ¥æ‰¾çš„æ–¹å¼å³å¯ï¼Œä¸ä¸»å¸­æ ‘æŸ¥è¯¢åŒºé—´ç¬¬$k$å°æ•°çš„æ€æƒ³ç±»ä¼¼ã€‚ç”±äºéœ€è¦è®¿é—®$01trie$æ ‘çš„å†å²çŠ¶æ€ï¼Œå› æ­¤$01trie$éœ€è¦å¯æŒä¹…åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼šä»¥$r$ä¸ºå³ç«¯ç‚¹çš„åŒºé—´å¼‚æˆ–å’Œä¸€å…±åªæœ‰$r$ä¸ªï¼Œå› æ­¤æŸ¥è¯¢ä»¥$r$ä¸ºå³ç«¯ç‚¹çš„ç¬¬$r+1$å¤§åŒºé—´å¼‚æˆ–å’Œæ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œåœ¨å°†&lt;code&gt;(1&amp;lt;&amp;lt;d)&lt;/code&gt;è¿™æ ·çš„å¼å­è½¬&lt;code&gt;long long&lt;/code&gt;æ—¶ï¼Œä¸èƒ½å†™æˆ&lt;code&gt;(long long)(1&amp;lt;&amp;lt;d)&lt;/code&gt;ï¼Œè€Œæ˜¯&lt;code&gt;((long long)1&amp;lt;&amp;lt;d)&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="å¯æŒä¹…åŒ–trie" scheme="https://tth37.cn/tags/%E5%8F%AF%E6%8C%81%E4%B9%85%E5%8C%96trie/"/>
    
      <category term="å¼‚æˆ–" scheme="https://tth37.cn/tags/%E5%BC%82%E6%88%96/"/>
    
      <category term="äºŒå‰å †" scheme="https://tth37.cn/tags/%E4%BA%8C%E5%8F%89%E5%A0%86/"/>
    
  </entry>
  
  <entry>
    <title>å…¬å‘Š 2019-04-08</title>
    <link href="https://tth37.cn/2019/04/08/bulletin-2019-4-8/"/>
    <id>https://tth37.cn/2019/04/08/bulletin-2019-4-8/</id>
    <published>2019-04-08T15:46:27.000Z</published>
    <updated>2019-04-23T15:51:02.197Z</updated>
    
    <content type="html"><![CDATA[<p><strong>tth37 Blog</strong>å·²ç»ç»‘å®šäº†æœ€æ–°åŸŸåï¼štth37.cn ï¼(è´­ä¹°è‡ªé˜¿é‡Œäº‘)</p><p><del>ç”±äºä¸€äº›å¥‡æ€ªçš„åŸå› ï¼ˆDNSåŸŸåè§£æå’ŒCNAMEé…ç½®é—®é¢˜ï¼‰ï¼Œæˆ‘çš„åšå®¢åœ¨å››æœˆä¸ƒæ—¥è‡³å››æœˆå…«æ—¥å‡ºç°è®¸å¤šå¼‚å¸¸ï¼Œç°å·²å…¨éƒ¨ä¿®å¤ã€‚</del></p><p>ä½†åœ¨å››æœˆä¹æ—¥è‡³å››æœˆåæ—¥çš„æµ‹è¯•ä¸­ï¼Œæˆ‘è¢«ç–¯ç‹‚æ‰“è„¸ï¼›ç°åœ¨å·²ç»å¯ä»¥ä¿è¯ï¼Œåªè¦åœ¨æµè§ˆå™¨è¾“å…¥æ è¾“å…¥ tth37.cnï¼Œå³å¯è‡ªåŠ¨è·³è½¬<a href="https://tth37.cnï¼Œå¹¶åœ¨*CloudFlare*è¯ä¹¦æˆæƒä¸‹å®‰å…¨è¿è¡Œã€‚" target="_blank" rel="noopener">https://tth37.cnï¼Œå¹¶åœ¨*CloudFlare*è¯ä¹¦æˆæƒä¸‹å®‰å…¨è¿è¡Œã€‚</a></p><p>è¯·å¤§ä½¬ä»¬åœ¨æ–°åŸŸåä¸‹ä½“éªŒé«˜é€ŸåŠ è½½å’Œæµç•…è®¿é—®æ–°ä½“éªŒå§ï¼</p><p>å¦å¤–ï¼Œå·¦ä¾§è¾¹æ â€œæ—¥ç¨‹è¡¨â€å·²ç»å¯ç”¨ï¼›ç½‘ç«™åŸºæœ¬æ­å»ºå®Œæ¯•ã€‚ä»¥åå°†ç¼©å‡ç½‘ç«™ç»´æŠ¤æ—¶é—´ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;tth37 Blog&lt;/strong&gt;å·²ç»ç»‘å®šäº†æœ€æ–°åŸŸåï¼štth37.cn ï¼(è´­ä¹°è‡ªé˜¿é‡Œäº‘)&lt;/p&gt;
&lt;p&gt;&lt;del&gt;ç”±äºä¸€äº›å¥‡æ€ªçš„åŸå› ï¼ˆDNSåŸŸåè§£æå’ŒCNAMEé…ç½®é—®é¢˜ï¼‰ï¼Œæˆ‘çš„åšå®¢åœ¨å››æœˆä¸ƒæ—¥è‡³å››æœˆå…«æ—¥å‡ºç°è®¸å¤šå¼‚å¸¸ï¼Œç°å·²å…¨éƒ¨ä¿®å¤ã€‚&lt;/del&gt;&lt;/p&gt;
&lt;
      
    
    </summary>
    
      <category term="å…¬å‘Š" scheme="https://tth37.cn/categories/%E5%85%AC%E5%91%8A/"/>
    
    
  </entry>
  
  <entry>
    <title>ç®—æ³•å­¦ä¹ -å¯æŒä¹…åŒ–æ•°æ®ç»“æ„</title>
    <link href="https://tth37.cn/2019/03/29/algorithm-persistentdatastructure/"/>
    <id>https://tth37.cn/2019/03/29/algorithm-persistentdatastructure/</id>
    <published>2019-03-29T11:19:42.000Z</published>
    <updated>2019-07-04T15:32:34.158Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>å¯æŒä¹…åŒ–æ•°æ®ç»“æ„å¯ä»¥å­˜å‚¨æ•°æ®é›†åœ¨ä»»æ„æ—¶é—´çš„å†å²çŠ¶æ€ã€‚â€œå¯æŒä¹…åŒ–â€çš„åŸºæœ¬æ€æƒ³æ˜¯åœ¨æ¯é¡¹æ“ä½œç»“æŸåï¼Œä»…åˆ›å»ºæ•°æ®ç»“æ„ä¸­å‘ç”Ÿæ”¹å˜çš„éƒ¨åˆ†çš„å‰¯æœ¬ï¼Œä¸æ‹·è´å…¶ä»–éƒ¨åˆ†ã€‚è¿™æ ·ä¸€æ¥ï¼Œç»´æŠ¤æ•°æ®ç»“æ„çš„æ—¶é—´å¤æ‚åº¦æ²¡æœ‰å¢åŠ ï¼Œç©ºé—´å¤æ‚åº¦ä»…å¢é•¿ä¸ºä¸æ—¶é—´åŒçº§çš„è§„æ¨¡ã€‚æ¢è¨€ä¹‹ï¼Œå¯æŒä¹…åŒ–æ•°æ®ç»“æ„èƒ½å¤Ÿé«˜æ•ˆåœ°è®°å½•ä¸€ä¸ªæ•°æ®ç»“æ„çš„æ‰€æœ‰å†å²çŠ¶æ€ã€‚</p><a id="more"></a><h2 id="å¯æŒä¹…åŒ–Trie"><a href="#å¯æŒä¹…åŒ–Trie" class="headerlink" title="å¯æŒä¹…åŒ–Trie"></a>å¯æŒä¹…åŒ–Trie</h2><h3 id="ã€å®ç°è¿‡ç¨‹ã€‘"><a href="#ã€å®ç°è¿‡ç¨‹ã€‘" class="headerlink" title="ã€å®ç°è¿‡ç¨‹ã€‘"></a>ã€å®ç°è¿‡ç¨‹ã€‘</h3><ol><li>è®¾å½“å‰å¯æŒä¹…åŒ–Trieçš„æ ¹èŠ‚ç‚¹ä¸ºrootï¼Œä»¤p=rootï¼Œi=0</li><li>å»ºç«‹ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œä»¤rootâ€˜=q</li><li>è‹¥p!=0ï¼Œåˆ™å¯¹äºæ¯ç§å­—ç¬¦cï¼Œä»¤trie[q,c]=trie[p,c]</li><li>å»ºç«‹ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹qâ€™ï¼Œä»¤trie[q,s]=qâ€˜</li><li>ä»¤p=trie[p,s]ï¼Œq=trie[q,s]ï¼Œi=i+1</li><li>é‡å¤æ­¥éª¤3-5ï¼Œç›´åˆ°iåˆ°è¾¾å­—ç¬¦ä¸²æœ«å°¾</li></ol><h3 id="ã€ä¾‹é¢˜ã€‘æœ€å¤§å¼‚æˆ–å’Œ-luogu-p4735"><a href="#ã€ä¾‹é¢˜ã€‘æœ€å¤§å¼‚æˆ–å’Œ-luogu-p4735" class="headerlink" title="ã€ä¾‹é¢˜ã€‘æœ€å¤§å¼‚æˆ–å’Œ luogu-p4735"></a>ã€ä¾‹é¢˜ã€‘<a href="https://www.luogu.org/problemnew/show/P4735" target="_blank" rel="noopener">æœ€å¤§å¼‚æˆ–å’Œ</a> luogu-p4735</h3><p>ç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•°åºåˆ—{a}ï¼Œåˆå§‹é•¿åº¦ä¸ºNã€‚ </p><p>æœ‰Mä¸ªæ“ä½œï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ“ä½œç±»å‹ï¼š </p><ol><li><code>A x</code>ï¼šæ·»åŠ æ“ä½œï¼Œè¡¨ç¤ºåœ¨åºåˆ—æœ«å°¾æ·»åŠ ä¸€ä¸ªæ•°xï¼Œåºåˆ—çš„é•¿åº¦N+1ã€‚ </li><li><code>Q l r x</code>ï¼šè¯¢é—®æ“ä½œï¼Œä½ éœ€è¦æ‰¾åˆ°ä¸€ä¸ªä½ç½®pï¼Œæ»¡è¶³lâ‰¤pâ‰¤rï¼Œä½¿å¾—ï¼š a[p]âŠ•a[p+1]âŠ•â€¦âŠ•a[N]âŠ•x æœ€å¤§ï¼Œè¾“å‡ºæœ€å¤§æ˜¯å¤šå°‘ã€‚ </li></ol><h3 id="ã€åˆ†æã€‘"><a href="#ã€åˆ†æã€‘" class="headerlink" title="ã€åˆ†æã€‘"></a>ã€åˆ†æã€‘</h3><p>è€ƒè™‘å¼‚æˆ–å‰ç¼€å’Œã€‚æ ¹æ®å¼‚æˆ–è¿ç®—çš„æ€§è´¨ï¼š</p><script type="math/tex; mode=display">a[p]\oplus a[p+1]\oplus ...\oplus a[N]\oplus x=s[p-1]\oplus s[N]\oplus x</script><p>å¯¹äºæ·»åŠ æ“ä½œï¼Œåºåˆ—så¾ˆå®¹æ˜“ç»´æŠ¤ã€‚å¯¹äºè¯¢é—®æ“ä½œï¼Œé—®é¢˜å˜ä¸ºï¼š<strong>å·²çŸ¥ä¸€ä¸ªæ•´æ•°val=s[N] xor xï¼Œæ±‚ä¸€ä¸ªä½ç½®pï¼Œæ»¡è¶³l-1&lt;=p&lt;=r-1ï¼Œä½¿å¾—s[p] xor valæœ€å¤§ã€‚</strong>æ˜¾ç„¶å¯ä»¥å°†sæ•°ç»„æ’å…¥å¯æŒä¹…åŒ–Trieä¸­ï¼Œæ¯æ¬¡å–å‡ºåœ¨lä¸rèŒƒå›´å†…çš„æ•°æ®è¿›è¡Œè´ªå¿ƒï¼ˆå°½é‡å¾€ç›¸åçš„èŠ‚ç‚¹èµ°ï¼‰ï¼Œä»è€Œæ±‚å‡ºç­”æ¡ˆã€‚</p><h3 id="ã€ä»£ç ã€‘"><a href="#ã€ä»£ç ã€‘" class="headerlink" title="ã€ä»£ç ã€‘"></a>ã€ä»£ç ã€‘</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)<span class="comment">//QwQ</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN=<span class="number">600005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> DEP=<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N,M;</span><br><span class="line"><span class="keyword">int</span> trie[MAXN*<span class="number">26</span>][<span class="number">2</span>],sum[MAXN*<span class="number">26</span>];</span><br><span class="line"><span class="keyword">int</span> head[MAXN],cnt=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> s[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> c,<span class="keyword">int</span> u,<span class="keyword">int</span> val,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    sum[u]=sum[c]+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(d&lt;<span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> x=(val&gt;&gt;d)&amp;<span class="number">1</span>;</span><br><span class="line">    trie[u][!x]=trie[c][!x];</span><br><span class="line">    insert(trie[c][x],trie[u][x]=++cnt,val,d<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> c,<span class="keyword">int</span> u,<span class="keyword">int</span> val,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(d&lt;<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> x=(val&gt;&gt;d)&amp;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(sum[trie[u][!x]]&gt;sum[trie[c][!x]])</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">1</span>&lt;&lt;d)+query(trie[c][!x],trie[u][!x],val,d<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> query(trie[c][x],trie[u][x],val,d<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;N,&amp;M);</span><br><span class="line">    insert(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,DEP);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N;++i)&#123;</span><br><span class="line">        <span class="keyword">int</span> a;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a);</span><br><span class="line">        s[i]=s[i<span class="number">-1</span>]^a;</span><br><span class="line">        insert(head[i<span class="number">-1</span>],head[i]=++cnt,s[i],DEP);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=M;++i)&#123;</span><br><span class="line">        <span class="keyword">char</span> opt;</span><br><span class="line">        getchar(),opt=getchar();</span><br><span class="line">        <span class="keyword">if</span>(opt==<span class="string">'A'</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> a;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a);</span><br><span class="line">            N++;</span><br><span class="line">            s[N]=s[N<span class="number">-1</span>]^a;</span><br><span class="line">            insert(head[N<span class="number">-1</span>],head[N]=++cnt,s[N],DEP);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> l,r,a;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;l,&amp;r,&amp;a);</span><br><span class="line">            <span class="keyword">if</span>(l==r) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,s[l<span class="number">-1</span>]^s[N]^a);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,query(head[l<span class="number">-2</span>],head[r<span class="number">-1</span>],a^s[N],DEP));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¯æŒä¹…åŒ–æ•°ç»„"><a href="#å¯æŒä¹…åŒ–æ•°ç»„" class="headerlink" title="å¯æŒä¹…åŒ–æ•°ç»„"></a>å¯æŒä¹…åŒ–æ•°ç»„</h2><h3 id="ã€ä¾‹é¢˜ã€‘ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–æ•°ç»„-luogu-p3919"><a href="#ã€ä¾‹é¢˜ã€‘ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–æ•°ç»„-luogu-p3919" class="headerlink" title="ã€ä¾‹é¢˜ã€‘ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–æ•°ç»„ luogu-p3919"></a>ã€ä¾‹é¢˜ã€‘<a href="https://www.luogu.org/problemnew/show/P3919" target="_blank" rel="noopener">ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–æ•°ç»„</a> luogu-p3919</h3><p>å¦‚é¢˜ï¼Œä½ éœ€è¦ç»´æŠ¤è¿™æ ·çš„ä¸€ä¸ªé•¿åº¦ä¸º N çš„æ•°ç»„ï¼Œæ”¯æŒå¦‚ä¸‹å‡ ç§æ“ä½œ</p><ol><li>åœ¨æŸä¸ªå†å²ç‰ˆæœ¬ä¸Šä¿®æ”¹æŸä¸€ä¸ªä½ç½®ä¸Šçš„å€¼</li><li>è®¿é—®æŸä¸ªå†å²ç‰ˆæœ¬ä¸Šçš„æŸä¸€ä½ç½®çš„å€¼</li></ol><p>æ­¤å¤–ï¼Œæ¯è¿›è¡Œä¸€æ¬¡æ“ä½œï¼ˆ<strong>å¯¹äºæ“ä½œ2ï¼Œå³ä¸ºç”Ÿæˆä¸€ä¸ªå®Œå…¨ä¸€æ ·çš„ç‰ˆæœ¬ï¼Œä¸ä½œä»»ä½•æ”¹åŠ¨</strong>ï¼‰ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ã€‚ç‰ˆæœ¬ç¼–å·å³ä¸ºå½“å‰æ“ä½œçš„ç¼–å·ï¼ˆä»1å¼€å§‹ç¼–å·ï¼Œç‰ˆæœ¬0è¡¨ç¤ºåˆå§‹çŠ¶æ€æ•°ç»„ï¼‰</p><h3 id="ã€åˆ†æã€‘-1"><a href="#ã€åˆ†æã€‘-1" class="headerlink" title="ã€åˆ†æã€‘"></a>ã€åˆ†æã€‘</h3><p>åœ¨åŸæ•°ç»„ä¸Šå»ºç«‹çº¿æ®µæ ‘ï¼Œåœ¨å¶å­èŠ‚ç‚¹ä¸Šè®°å½•åŸæ•°ç»„æ•°å€¼ã€‚æ‰§è¡Œå®Œä¿®æ”¹æ“ä½œåï¼Œæ ¹æ®å¯æŒä¹…åŒ–çš„æ€æƒ³ï¼Œåªéœ€æ›´æ”¹ä¸€æ¡é“¾ä¸Šçš„èŠ‚ç‚¹ä¿¡æ¯ï¼›æ‰§è¡Œå®Œè®¿é—®æ“ä½œåï¼Œåˆ™å¯ä»¥å°†ç›®å‰æ“ä½œçš„æ ¹èŠ‚ç‚¹æŒ‡é’ˆæŒ‡å‘è¢«æŸ¥è¯¢çš„å†å²çŠ¶æ€æ ¹èŠ‚ç‚¹ã€‚</p><p><img src="/images/1.png" alt></p><h3 id="ã€ä»£ç ã€‘-1"><a href="#ã€ä»£ç ã€‘-1" class="headerlink" title="ã€ä»£ç ã€‘"></a>ã€ä»£ç ã€‘</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN=<span class="number">1000005</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l,r,val;</span><br><span class="line">&#125;node[MAXN*<span class="number">22</span>+<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N,M,cnt;</span><br><span class="line"><span class="keyword">int</span> a[MAXN],head[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(Node&amp; u,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        u.val=a[l];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    build(node[u.l=++cnt],l,mid);</span><br><span class="line">    build(node[u.r=++cnt],mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">change</span><span class="params">(Node c,Node&amp; u,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> p,<span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        u.val=val;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(p&lt;=mid)&#123;</span><br><span class="line">        change(node[c.l],node[u.l=++cnt],l,mid,p,val);</span><br><span class="line">        u.r=c.r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        change(node[c.r],node[u.r=++cnt],mid+<span class="number">1</span>,r,p,val);</span><br><span class="line">        u.l=c.l;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query</span><span class="params">(Node u,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> u.val;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(p&lt;=mid) <span class="keyword">return</span> query(node[u.l],l,mid,p);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> query(node[u.r],mid+<span class="number">1</span>,r,p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;N,&amp;M);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</span><br><span class="line">    build(node[<span class="number">0</span>],<span class="number">1</span>,N);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=M;++i)&#123;</span><br><span class="line">        <span class="keyword">int</span> v,opt,p,val;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;v,&amp;opt);</span><br><span class="line">        <span class="keyword">if</span>(opt==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;p,&amp;val);</span><br><span class="line">            change(node[head[v]],node[head[i]=++cnt],<span class="number">1</span>,N,p,val);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;p);</span><br><span class="line">            head[i]=head[v];</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,query(node[head[i]],<span class="number">1</span>,N,p));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¯æŒä¹…åŒ–å€¼åŸŸçº¿æ®µæ ‘ï¼ˆä¸»å¸­æ ‘ï¼‰"><a href="#å¯æŒä¹…åŒ–å€¼åŸŸçº¿æ®µæ ‘ï¼ˆä¸»å¸­æ ‘ï¼‰" class="headerlink" title="å¯æŒä¹…åŒ–å€¼åŸŸçº¿æ®µæ ‘ï¼ˆä¸»å¸­æ ‘ï¼‰"></a>å¯æŒä¹…åŒ–å€¼åŸŸçº¿æ®µæ ‘ï¼ˆä¸»å¸­æ ‘ï¼‰</h2><h3 id="ã€ä¾‹é¢˜ã€‘ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–çº¿æ®µæ ‘-luogu-p3834"><a href="#ã€ä¾‹é¢˜ã€‘ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–çº¿æ®µæ ‘-luogu-p3834" class="headerlink" title="ã€ä¾‹é¢˜ã€‘ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–çº¿æ®µæ ‘ luogu-p3834"></a>ã€ä¾‹é¢˜ã€‘<a href="https://www.luogu.org/problemnew/show/P3834" target="_blank" rel="noopener">ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–çº¿æ®µæ ‘</a> luogu-p3834</h3><p>ç»™å®šNä¸ªæ•´æ•°æ„æˆçš„åºåˆ—ï¼Œå°†å¯¹äºæŒ‡å®šçš„é—­åŒºé—´æŸ¥è¯¢å…¶åŒºé—´å†…çš„ç¬¬Kå°å€¼ã€‚</p><h3 id="ã€åˆ†æã€‘-2"><a href="#ã€åˆ†æã€‘-2" class="headerlink" title="ã€åˆ†æã€‘"></a>ã€åˆ†æã€‘</h3><p>å€¼åŸŸæœ‰è´Ÿæ•°å‡ºç°ï¼Œè€ƒè™‘ç¦»æ•£åŒ–ã€‚å‡è®¾ç¦»æ•£åŒ–åçš„å€¼åŸŸä¸º[1,L]ã€‚</p><p>åœ¨å€¼åŸŸä¸Šå»ºç«‹çº¿æ®µæ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸Šå­˜å‚¨è¯¥å€¼åŸŸå†…æœ‰å¤šå°‘ä¸ªæ•°æ®ã€‚å¯¹çº¿æ®µæ ‘è¿›è¡Œå¯æŒä¹…åŒ–å¤„ç†ï¼Œä¸ä¸Šä¸€é¢˜å¯æŒä¹…åŒ–æ•°ç»„å®ç°æ–¹å¼ç±»ä¼¼ã€‚</p><p>åœ¨æŸ¥è¯¢æ—¶ï¼Œå¦‚æœä¸€ä¸ªèŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ä¸Šçš„cntå€¼å°äºç­‰äºæ­£åœ¨æŸ¥è¯¢çš„Kï¼Œåˆ™é—®é¢˜è½¬åŒ–ä¸ºæ±‚å·¦åŠåŒºé—´å†…ç¬¬Kå°å€¼ï¼›å¦åˆ™ï¼Œè½¬åŒ–ä¸ºæ±‚å³åŠåŒºé—´å†…ç¬¬K-cntå°å€¼ã€‚</p><p>æŸ¥è¯¢æ—¶çš„æ“ä½œç±»ä¼¼äºåœ¨å€¼åŸŸä¸Šçš„äºŒåˆ†ï¼Œå› æ­¤å¤æ‚åº¦åœ¨logçº§åˆ«ã€‚</p><h3 id="ã€ä»£ç ã€‘-2"><a href="#ã€ä»£ç ã€‘-2" class="headerlink" title="ã€ä»£ç ã€‘"></a>ã€ä»£ç ã€‘</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> id(x) (lower_bound(b+1,b+L+1,a[x])-b)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rid(x) (b[x])</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN=<span class="number">200005</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l,r,sum;</span><br><span class="line">&#125;node[MAXN&lt;&lt;<span class="number">6</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N,M,L,cnt;</span><br><span class="line"><span class="keyword">int</span> a[MAXN],b[MAXN];</span><br><span class="line"><span class="keyword">int</span> head[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(Node u,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    u.sum=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    build(node[u.l=++cnt],l,mid);</span><br><span class="line">    build(node[u.r=++cnt],mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(Node c,Node&amp; u,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    u.sum=c.sum+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(p&lt;=mid) insert(node[c.l],node[u.l=++cnt],<span class="number">1</span>,mid,p),u.r=c.r;</span><br><span class="line">    <span class="keyword">else</span> insert(node[c.r],node[u.r=++cnt],mid+<span class="number">1</span>,r,p),u.l=c.l;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query</span><span class="params">(Node c,Node u,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> l;</span><br><span class="line">    <span class="keyword">int</span> sum=node[u.l].sum-node[c.l].sum,mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(sum&gt;=k) <span class="keyword">return</span> query(node[c.l],node[u.l],<span class="number">1</span>,mid,k);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> query(node[c.r],node[u.r],mid+<span class="number">1</span>,r,k-sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;N,&amp;M);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N;++i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</span><br><span class="line">        b[i]=a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    sort(b+<span class="number">1</span>,b+N+<span class="number">1</span>);</span><br><span class="line">    L=unique(b+<span class="number">1</span>,b+N+<span class="number">1</span>)-(b+<span class="number">1</span>);</span><br><span class="line">    head[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    build(node[<span class="number">0</span>],<span class="number">1</span>,L);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">        insert(node[head[i<span class="number">-1</span>]],node[head[i]=++cnt],<span class="number">1</span>,L,id(i));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=M;++i)&#123;</span><br><span class="line">        <span class="keyword">int</span> l,r,k;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;l,&amp;r,&amp;k);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,rid(query(node[head[l<span class="number">-1</span>]],node[head[r]],<span class="number">1</span>,L,k)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h2&gt;&lt;p&gt;å¯æŒä¹…åŒ–æ•°æ®ç»“æ„å¯ä»¥å­˜å‚¨æ•°æ®é›†åœ¨ä»»æ„æ—¶é—´çš„å†å²çŠ¶æ€ã€‚â€œå¯æŒä¹…åŒ–â€çš„åŸºæœ¬æ€æƒ³æ˜¯åœ¨æ¯é¡¹æ“ä½œç»“æŸåï¼Œä»…åˆ›å»ºæ•°æ®ç»“æ„ä¸­å‘ç”Ÿæ”¹å˜çš„éƒ¨åˆ†çš„å‰¯æœ¬ï¼Œä¸æ‹·è´å…¶ä»–éƒ¨åˆ†ã€‚è¿™æ ·ä¸€æ¥ï¼Œç»´æŠ¤æ•°æ®ç»“æ„çš„æ—¶é—´å¤æ‚åº¦æ²¡æœ‰å¢åŠ ï¼Œç©ºé—´å¤æ‚åº¦ä»…å¢é•¿ä¸ºä¸æ—¶é—´åŒçº§çš„è§„æ¨¡ã€‚æ¢è¨€ä¹‹ï¼Œå¯æŒä¹…åŒ–æ•°æ®ç»“æ„èƒ½å¤Ÿé«˜æ•ˆåœ°è®°å½•ä¸€ä¸ªæ•°æ®ç»“æ„çš„æ‰€æœ‰å†å²çŠ¶æ€ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç®—æ³•å­¦ä¹ " scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="æ•°æ®ç»“æ„" scheme="https://tth37.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="å¯æŒä¹…åŒ–trie" scheme="https://tth37.cn/tags/%E5%8F%AF%E6%8C%81%E4%B9%85%E5%8C%96trie/"/>
    
      <category term="ä¸»å¸­æ ‘" scheme="https://tth37.cn/tags/%E4%B8%BB%E5%B8%AD%E6%A0%91/"/>
    
      <category term="çº¿æ®µæ ‘" scheme="https://tth37.cn/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p4516æ½œå…¥è¡ŒåŠ¨</title>
    <link href="https://tth37.cn/2019/03/28/solution-luogu-p4516/"/>
    <id>https://tth37.cn/2019/03/28/solution-luogu-p4516/</id>
    <published>2019-03-27T17:11:44.000Z</published>
    <updated>2019-05-12T13:00:49.081Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™æ˜¯ä¸€ä¸ªå¹¶ä¸ç®€å•çš„èƒŒåŒ…ç±»æ ‘å½¢dpâ€¦â€¦</p><p><del>å¾ˆè‡ªç„¶åœ°</del>æƒ³åˆ°çŠ¶æ€å®šä¹‰ï¼š$f[u][k][0/1][0/1]$è¡¨ç¤ºä»¥$u$ä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œæ€»å…±é€‰æ‹©$k$ä¸ªç»“ç‚¹ï¼Œå…¶ä¸­é™¤äº†$u$ä»¥å¤–çš„æ‰€æœ‰ç»“ç‚¹å‡è¢«ç›‘å¬åˆ°ï¼Œ$u$ç»“ç‚¹é€‰æˆ–ä¸é€‰ï¼Œ$u$ç»“ç‚¹æ˜¯å¦è¢«è¦†ç›–çš„æƒ…å†µä¸‹ï¼Œä¸€å…±æœ‰å¤šå°‘ç§æ–¹æ¡ˆã€‚</p><p>çŠ¶æ€è½¬ç§»çœ‹ä¼¼ååˆ†éº»çƒ¦ã€‚æ¯ä¸ªç»“ç‚¹$u$éƒ½æœ‰è®¸å¤šå­ç»“ç‚¹ï¼Œå¾ˆéš¾ç»Ÿè®¡å‡ºæ¯ä¸ªå­ç»“ç‚¹çš„æ‰€æœ‰æƒ…å†µï¼ˆä¼¼ä¹åœ¨ç»„åˆæ•°å­¦çš„èŒƒç•´ï¼‰ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨ååˆ†å·§å¦™çš„æ ‘å½¢èƒŒåŒ…æ¥è¿›è¡ŒçŠ¶æ€è½¬ç§»ã€‚æ ‘ä¸ŠèƒŒåŒ…çš„è½¬ç§»å¥—è·¯æ˜¯ï¼š</p><script type="math/tex; mode=display">f[u][i+j]=combine(f[u][i],f[v][j])</script><p>ç›¸å½“äºæ¯é€’å½’è®¿é—®å®Œä¸€ä¸ªå­ç»“ç‚¹ï¼Œå°±æŠŠå­èŠ‚ç‚¹ä¸Šçš„çŠ¶æ€ä¸å½“å‰å·²ç»å¤„ç†çš„çŠ¶æ€ä¸€ä¸€é…å¯¹ï¼Œä¿è¯ä¸é‡ä¸æ¼ä¸”å…¼é¡¾æ•ˆç‡ã€‚å…·ä½“çš„è½¬ç§»æ–¹ç¨‹ä¸ºï¼š</p><script type="math/tex; mode=display">f[u][i+j][0][0]=\sum f[u][i][0][0]*f[v][j][0][1]</script><script type="math/tex; mode=display">f[u][i+j][1][0]=\sum f[u][i][1][0]*(f[v][j][0][0]+f[v][j][0][1])</script><script type="math/tex; mode=display">f[u][i+j][0][1]=\sum (f[u][i][0][1]\*(f[v][j][0][1]+f[v][j][1][1])+f[u][i][0][0]\*f[v][j][1][1]</script><script type="math/tex; mode=display">f[u][i+j][1][1]=\sum (f[u][i][1][0]\*(f[v][j][1][0]+f[v][j][1][1])+f[u][i][1][1]\*(f[v][j][0][0]+f[v][j][0][1]+f[v][j][1][0]+f[v][j][1][1]))</script><p>å…·ä½“å®ç°æ—¶è¿˜åº”æ³¨æ„ï¼šå› ä¸ºé˜¶æ®µï¼ˆå³æ‰«æå­ç»“ç‚¹ä¸ªæ•°ï¼‰çš„åˆ’åˆ†ï¼Œåœ¨æ¯æ¬¡è½¬ç§»å‰éƒ½è¦å…ˆè®°å½•åŸå§‹çš„$u$ç»“ç‚¹ä¸Šçš„æ•°æ®ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ··ä¹±ã€‚</p><a id="more"></a><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN=<span class="number">100005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1000000007</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N,K;</span><br><span class="line"><span class="keyword">int</span> f[MAXN][<span class="number">105</span>][<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> g[<span class="number">105</span>][<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> size[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Mod</span><span class="params">(ll x,ll y)</span></span>&#123;</span><br><span class="line">    x%=mod,y%=mod;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">int</span>)(x+y)%mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    size[u]=<span class="number">1</span>;</span><br><span class="line">    f[u][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>]=f[u][<span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::iterator it=G[u].begin();it!=G[u].end();it++)&#123;</span><br><span class="line">        <span class="keyword">int</span> v=*it;</span><br><span class="line">        <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">        dp(v,u);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=min(size[u],K);++i)&#123;</span><br><span class="line">            g[i][<span class="number">0</span>][<span class="number">0</span>]=f[u][i][<span class="number">0</span>][<span class="number">0</span>],f[u][i][<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">            g[i][<span class="number">0</span>][<span class="number">1</span>]=f[u][i][<span class="number">0</span>][<span class="number">1</span>],f[u][i][<span class="number">0</span>][<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">            g[i][<span class="number">1</span>][<span class="number">0</span>]=f[u][i][<span class="number">1</span>][<span class="number">0</span>],f[u][i][<span class="number">1</span>][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">            g[i][<span class="number">1</span>][<span class="number">1</span>]=f[u][i][<span class="number">1</span>][<span class="number">1</span>],f[u][i][<span class="number">1</span>][<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=min(size[u],K);++i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=min(size[v],K-i);++j)&#123;</span><br><span class="line">                f[u][i+j][<span class="number">0</span>][<span class="number">0</span>]=Mod((ll)f[u][i+j][<span class="number">0</span>][<span class="number">0</span>],(ll)g[i][<span class="number">0</span>][<span class="number">0</span>]*(ll)f[v][j][<span class="number">0</span>][<span class="number">1</span>]);</span><br><span class="line">                f[u][i+j][<span class="number">0</span>][<span class="number">1</span>]=Mod((ll)f[u][i+j][<span class="number">0</span>][<span class="number">1</span>],(ll)g[i][<span class="number">0</span>][<span class="number">0</span>]*(ll)f[v][j][<span class="number">1</span>][<span class="number">1</span>]+(ll)g[i][<span class="number">0</span>][<span class="number">1</span>]*((ll)f[v][j][<span class="number">1</span>][<span class="number">1</span>]+(ll)f[v][j][<span class="number">0</span>][<span class="number">1</span>]));</span><br><span class="line">                f[u][i+j][<span class="number">1</span>][<span class="number">0</span>]=Mod((ll)f[u][i+j][<span class="number">1</span>][<span class="number">0</span>],(ll)g[i][<span class="number">1</span>][<span class="number">0</span>]*((ll)f[v][j][<span class="number">0</span>][<span class="number">0</span>]+(ll)f[v][j][<span class="number">0</span>][<span class="number">1</span>]));</span><br><span class="line">                f[u][i+j][<span class="number">1</span>][<span class="number">1</span>]=Mod((ll)f[u][i+j][<span class="number">1</span>][<span class="number">1</span>],(ll)g[i][<span class="number">1</span>][<span class="number">0</span>]*((ll)f[v][j][<span class="number">1</span>][<span class="number">0</span>]+(ll)f[v][j][<span class="number">1</span>][<span class="number">1</span>])+(ll)g[i][<span class="number">1</span>][<span class="number">1</span>]*((ll)f[v][j][<span class="number">0</span>][<span class="number">0</span>]+(ll)f[v][j][<span class="number">0</span>][<span class="number">1</span>]+(ll)f[v][j][<span class="number">1</span>][<span class="number">0</span>]+(ll)f[v][j][<span class="number">1</span>][<span class="number">1</span>]));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        size[u]+=size[v];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;N,&amp;K);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;++i)&#123;</span><br><span class="line">        <span class="keyword">int</span> u,v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;u,&amp;v);</span><br><span class="line">        G[u].push_back(v);</span><br><span class="line">        G[v].push_back(u);</span><br><span class="line">    &#125;</span><br><span class="line">    dp(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,(<span class="keyword">int</span>)(f[<span class="number">1</span>][K][<span class="number">0</span>][<span class="number">1</span>]+f[<span class="number">1</span>][K][<span class="number">1</span>][<span class="number">1</span>])%mod);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™æ˜¯ä¸€ä¸ªå¹¶ä¸ç®€å•çš„èƒŒåŒ…ç±»æ ‘å½¢dpâ€¦â€¦&lt;/p&gt;
&lt;p&gt;&lt;del&gt;å¾ˆè‡ªç„¶åœ°&lt;/del&gt;æƒ³åˆ°çŠ¶æ€å®šä¹‰ï¼š$f[u][k][0/1][0/1]$è¡¨ç¤ºä»¥$u$ä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œæ€»å…±é€‰æ‹©$k$ä¸ªç»“ç‚¹ï¼Œå…¶ä¸­é™¤äº†$u$ä»¥å¤–çš„æ‰€æœ‰ç»“ç‚¹å‡è¢«ç›‘å¬åˆ°ï¼Œ$u$ç»“ç‚¹é€‰æˆ–ä¸é€‰ï¼Œ$u$ç»“ç‚¹æ˜¯å¦è¢«è¦†ç›–çš„æƒ…å†µä¸‹ï¼Œä¸€å…±æœ‰å¤šå°‘ç§æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;çŠ¶æ€è½¬ç§»çœ‹ä¼¼ååˆ†éº»çƒ¦ã€‚æ¯ä¸ªç»“ç‚¹$u$éƒ½æœ‰è®¸å¤šå­ç»“ç‚¹ï¼Œå¾ˆéš¾ç»Ÿè®¡å‡ºæ¯ä¸ªå­ç»“ç‚¹çš„æ‰€æœ‰æƒ…å†µï¼ˆä¼¼ä¹åœ¨ç»„åˆæ•°å­¦çš„èŒƒç•´ï¼‰ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨ååˆ†å·§å¦™çš„æ ‘å½¢èƒŒåŒ…æ¥è¿›è¡ŒçŠ¶æ€è½¬ç§»ã€‚æ ‘ä¸ŠèƒŒåŒ…çš„è½¬ç§»å¥—è·¯æ˜¯ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
f[u][i+j]=combine(f[u][i],f[v][j])&lt;/script&gt;&lt;p&gt;ç›¸å½“äºæ¯é€’å½’è®¿é—®å®Œä¸€ä¸ªå­ç»“ç‚¹ï¼Œå°±æŠŠå­èŠ‚ç‚¹ä¸Šçš„çŠ¶æ€ä¸å½“å‰å·²ç»å¤„ç†çš„çŠ¶æ€ä¸€ä¸€é…å¯¹ï¼Œä¿è¯ä¸é‡ä¸æ¼ä¸”å…¼é¡¾æ•ˆç‡ã€‚å…·ä½“çš„è½¬ç§»æ–¹ç¨‹ä¸ºï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
f[u][i+j][0][0]=\sum f[u][i][0][0]*f[v][j][0][1]&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
f[u][i+j][1][0]=\sum f[u][i][1][0]*(f[v][j][0][0]+f[v][j][0][1])&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
f[u][i+j][0][1]=\sum (f[u][i][0][1]\*(f[v][j][0][1]+f[v][j][1][1])+f[u][i][0][0]\*f[v][j][1][1]&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
f[u][i+j][1][1]=\sum (f[u][i][1][0]\*(f[v][j][1][0]+f[v][j][1][1])+f[u][i][1][1]\*(f[v][j][0][0]+f[v][j][0][1]+f[v][j][1][0]+f[v][j][1][1]))&lt;/script&gt;&lt;p&gt;å…·ä½“å®ç°æ—¶è¿˜åº”æ³¨æ„ï¼šå› ä¸ºé˜¶æ®µï¼ˆå³æ‰«æå­ç»“ç‚¹ä¸ªæ•°ï¼‰çš„åˆ’åˆ†ï¼Œåœ¨æ¯æ¬¡è½¬ç§»å‰éƒ½è¦å…ˆè®°å½•åŸå§‹çš„$u$ç»“ç‚¹ä¸Šçš„æ•°æ®ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ··ä¹±ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="åŠ¨æ€è§„åˆ’" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="èƒŒåŒ…" scheme="https://tth37.cn/tags/%E8%83%8C%E5%8C%85/"/>
    
      <category term="æ ‘å½¢dp" scheme="https://tth37.cn/tags/%E6%A0%91%E5%BD%A2dp/"/>
    
  </entry>
  
  <entry>
    <title>ç®—æ³•å­¦ä¹ -èƒŒåŒ…ç±»æ ‘å½¢dp</title>
    <link href="https://tth37.cn/2019/03/25/algorithm-knapsacktreedp/"/>
    <id>https://tth37.cn/2019/03/25/algorithm-knapsacktreedp/</id>
    <published>2019-03-25T15:21:45.000Z</published>
    <updated>2019-05-12T11:10:35.668Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ ‘å½¢åˆ†ç»„èƒŒåŒ…"><a href="#æ ‘å½¢åˆ†ç»„èƒŒåŒ…" class="headerlink" title="æ ‘å½¢åˆ†ç»„èƒŒåŒ…"></a>æ ‘å½¢åˆ†ç»„èƒŒåŒ…</h2><h3 id="ã€ä¾‹é¢˜ã€‘-é€‰è¯¾-luogu-p2014"><a href="#ã€ä¾‹é¢˜ã€‘-é€‰è¯¾-luogu-p2014" class="headerlink" title="ã€ä¾‹é¢˜ã€‘ é€‰è¯¾ luogu-p2014 "></a>ã€ä¾‹é¢˜ã€‘ <a href="https://www.luogu.org/problemnew/show/P2014" target="_blank" rel="noopener"><strong>é€‰è¯¾</strong></a> <strong>luogu-p2014 </strong></h3><p>åœ¨å¤§å­¦é‡Œæ¯ä¸ªå­¦ç”Ÿï¼Œä¸ºäº†è¾¾åˆ°ä¸€å®šçš„å­¦åˆ†ï¼Œå¿…é¡»ä»å¾ˆå¤šè¯¾ç¨‹é‡Œé€‰æ‹©ä¸€äº›è¯¾ç¨‹æ¥å­¦ä¹ ï¼Œåœ¨è¯¾ç¨‹é‡Œæœ‰äº›è¯¾ç¨‹å¿…é¡»åœ¨æŸäº›è¯¾ç¨‹ä¹‹å‰å­¦ä¹ ï¼Œå¦‚é«˜ç­‰æ•°å­¦æ€»æ˜¯åœ¨å…¶å®ƒè¯¾ç¨‹ä¹‹å‰å­¦ä¹ ã€‚ç°åœ¨æœ‰Né—¨åŠŸè¯¾ï¼Œæ¯é—¨è¯¾æœ‰ä¸ªå­¦åˆ†ï¼Œæ¯é—¨è¯¾æœ‰ä¸€é—¨æˆ–æ²¡æœ‰ç›´æ¥å…ˆä¿®è¯¾ï¼ˆè‹¥è¯¾ç¨‹aæ˜¯è¯¾ç¨‹bçš„å…ˆä¿®è¯¾å³åªæœ‰å­¦å®Œäº†è¯¾ç¨‹aï¼Œæ‰èƒ½å­¦ä¹ è¯¾ç¨‹bï¼‰ã€‚ä¸€ä¸ªå­¦ç”Ÿè¦ä»è¿™äº›è¯¾ç¨‹é‡Œé€‰æ‹©Mé—¨è¯¾ç¨‹å­¦ä¹ ï¼Œé—®ä»–èƒ½è·å¾—çš„æœ€å¤§å­¦åˆ†æ˜¯å¤šå°‘ï¼Ÿ</p><h3 id="ã€åˆ†æã€‘"><a href="#ã€åˆ†æã€‘" class="headerlink" title="ã€åˆ†æã€‘"></a>ã€åˆ†æã€‘</h3><p>è®°å½•çŠ¶æ€ï¼š$f[u][i]$ä¸ºä»¥$u$ä¸ºæ ¹çš„å­æ ‘ä¸Šï¼Œé€‰æ‹©$i$é—¨è¯¾æ‰€èƒ½è·å¾—çš„æœ€å¤§å­¦åˆ†ã€‚</p><p>è®°$u$ä¸ºå½“å‰æ­£åœ¨å¤„ç†çš„ç»“ç‚¹ï¼Œ$v$ä¸ºåˆšåˆšé€’å½’è®¿é—®ç»“æŸçš„ç»“ç‚¹ã€‚é‚£ä¹ˆåœ¨$u$ä¸Šç›¸å½“äºæœ‰ä¸€ä¸ªå®¹é‡ä¸º$M$çš„èƒŒåŒ…ï¼Œæ¯ä¸ªå­æ ‘ä¸­ä¸åŒçš„çŠ¶æ€ç›¸å½“äºä¸åŒçš„ç‰©å“ï¼Œä¾‹å¦‚$f[v][j]$ä¸ºä½“ç§¯ä¸º$j$ï¼Œä»·å€¼ä¸º$f[v][j]$ä¸­å­˜å‚¨çš„æ•°å€¼ã€‚</p><p>åœ¨æœ¬é¢˜ä¸­ï¼Œç”±äºæ‰€æœ‰å…³ç³»æ„æˆæ£®æ—ç»“æ„ï¼Œå› æ­¤å¯ä»¥è®¾$0$å·ç»“ç‚¹ä¸ºâ€œæ²¡æœ‰å…ˆä¿®è¯¾â€çš„è¯¾çš„å…ˆä¿®è¯¾ã€‚ç„¶åä»¥$0$ä¸ºæ ¹ï¼Œè¿›è¡ŒçŠ¶æ€è½¬ç§»å³å¯ã€‚</p><h3 id="ã€ä»£ç ã€‘"><a href="#ã€ä»£ç ã€‘" class="headerlink" title="ã€ä»£ç ã€‘"></a>ã€ä»£ç ã€‘</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Pb push_back</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN=<span class="number">305</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM=<span class="number">305</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N,M;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; son[MAXN];</span><br><span class="line"><span class="keyword">int</span> a[MAXN],f[MAXN][MAXM];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::iterator it=son[u].begin();it!=son[u].end();it++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> v=*it;</span><br><span class="line">        dp(v);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=M;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=i;++j)</span><br><span class="line">                f[u][i]=max(f[u][i],f[u][i-j]+f[v][j]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(u)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=M;i&gt;=<span class="number">1</span>;--i)</span><br><span class="line">            f[u][i]=f[u][i<span class="number">-1</span>]+a[u];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;N,&amp;M);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> k,s;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;k,&amp;s);</span><br><span class="line">        son[k].Pb(i);a[i]=s;</span><br><span class="line">    &#125;</span><br><span class="line">    dp(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,f[<span class="number">0</span>][M]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ã€ä¾‹é¢˜ã€‘æœ‰çº¿ç”µè§†ç½‘-luogu-p1273"><a href="#ã€ä¾‹é¢˜ã€‘æœ‰çº¿ç”µè§†ç½‘-luogu-p1273" class="headerlink" title="ã€ä¾‹é¢˜ã€‘æœ‰çº¿ç”µè§†ç½‘ luogu-p1273"></a>ã€ä¾‹é¢˜ã€‘<a href="https://www.luogu.org/fe/problem/P1273" target="_blank" rel="noopener">æœ‰çº¿ç”µè§†ç½‘</a> luogu-p1273</h3><p>æŸæ”¶è´¹æœ‰çº¿ç”µè§†ç½‘è®¡åˆ’è½¬æ’­ä¸€åœºé‡è¦çš„è¶³çƒæ¯”èµ›ã€‚ä»–ä»¬çš„è½¬æ’­ç½‘å’Œç”¨æˆ·ç»ˆç«¯æ„æˆä¸€æ£µæ ‘çŠ¶ç»“æ„ï¼Œè¿™æ£µæ ‘çš„æ ¹ç»“ç‚¹ä½äºè¶³çƒæ¯”èµ›çš„ç°åœºï¼Œæ ‘å¶ä¸ºå„ä¸ªç”¨æˆ·ç»ˆç«¯ï¼Œå…¶ä»–ä¸­è½¬ç«™ä¸ºè¯¥æ ‘çš„å†…éƒ¨èŠ‚ç‚¹ã€‚</p><p>ä»è½¬æ’­ç«™åˆ°è½¬æ’­ç«™ä»¥åŠä»è½¬æ’­ç«™åˆ°æ‰€æœ‰ç”¨æˆ·ç»ˆç«¯çš„ä¿¡å·ä¼ è¾“è´¹ç”¨éƒ½æ˜¯å·²çŸ¥çš„ï¼Œä¸€åœºè½¬æ’­çš„æ€»è´¹ç”¨ç­‰äºä¼ è¾“ä¿¡å·çš„è´¹ç”¨æ€»å’Œã€‚</p><p>ç°åœ¨æ¯ä¸ªç”¨æˆ·éƒ½å‡†å¤‡äº†ä¸€ç¬”è´¹ç”¨æƒ³è§‚çœ‹è¿™åœºç²¾å½©çš„è¶³çƒæ¯”èµ›ï¼Œæœ‰çº¿ç”µè§†ç½‘æœ‰æƒå†³å®šç»™å“ªäº›ç”¨æˆ·æä¾›ä¿¡å·è€Œä¸ç»™å“ªäº›ç”¨æˆ·æä¾›ä¿¡å·ã€‚</p><p>å†™ä¸€ä¸ªç¨‹åºæ‰¾å‡ºä¸€ä¸ªæ–¹æ¡ˆä½¿å¾—æœ‰çº¿ç”µè§†ç½‘åœ¨ä¸äºæœ¬çš„æƒ…å†µä¸‹ä½¿è§‚çœ‹è½¬æ’­çš„ç”¨æˆ·å°½å¯èƒ½å¤šã€‚</p><h3 id="ã€åˆ†æã€‘-1"><a href="#ã€åˆ†æã€‘-1" class="headerlink" title="ã€åˆ†æã€‘"></a>ã€åˆ†æã€‘</h3><p>è®°å½•çŠ¶æ€ï¼š$f[i][j]$ä¸ºä»¥$i$ä¸ºæ ¹ï¼Œé€‰æ‹©$j$ä¸ªç”¨æˆ·æœ€å¤šæœ‰å¤šå°‘æ”¶å…¥ã€‚çŠ¶æ€è½¬ç§»æ—¶å¦‚æœæ— æ³•ä»æ­£é¢å…¥æ‰‹ï¼ˆå¦‚æœ¬é¢˜ä¸çŸ¥é“ä»·æ ¼çš„æœ€å€¼ï¼Œä¸”ä»·å€¼åˆ†å¸ƒæ›´ä¸ºç¨€ç–ï¼‰ï¼Œå¯ä»¥ä»åé¢è®¾è®¡çŠ¶æ€ï¼Œåœ¨è¾“å‡ºç­”æ¡ˆæ—¶è¿›è¡Œåˆ¤æ–­å³å¯ã€‚è½¬ç§»æ—¶å¯ä»¥è®°å½•$size$æ•°ç»„è¿›è¡Œä¼˜åŒ–ã€‚</p><h3 id="ã€ä»£ç ã€‘-1"><a href="#ã€ä»£ç ã€‘-1" class="headerlink" title="ã€ä»£ç ã€‘"></a>ã€ä»£ç ã€‘</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> v,w,nxt;</span><br><span class="line">&#125;mem[<span class="number">3005</span>*<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> head[<span class="number">3005</span>],cnt;</span><br><span class="line"><span class="keyword">int</span> size[<span class="number">3005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    mem[++cnt].v=v;</span><br><span class="line">    mem[cnt].w=w;</span><br><span class="line">    mem[cnt].nxt=head[u];</span><br><span class="line">    head[u]=cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N,M;</span><br><span class="line"><span class="keyword">int</span> leaf[<span class="number">3005</span>];</span><br><span class="line"><span class="keyword">int</span> f[<span class="number">3005</span>][<span class="number">3005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(leaf[u])&#123;</span><br><span class="line">        f[u][<span class="number">1</span>]=leaf[u];</span><br><span class="line">        size[u]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=head[u];i;i=mem[i].nxt)&#123;</span><br><span class="line">        <span class="keyword">int</span> v=mem[i].v,w=mem[i].w;</span><br><span class="line">        dfs(v);</span><br><span class="line">        size[u]+=size[v];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> j=M;j&gt;=<span class="number">1</span>;--j)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> k=<span class="number">0</span>;k&lt;=min(size[v],j);++k)</span><br><span class="line">                f[u][j]=max(f[u][j],f[u][j-k]+f[v][k]-w);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(f,<span class="number">0xcf</span>,<span class="keyword">sizeof</span>(f));</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;N,&amp;M);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N-M;++i)&#123;</span><br><span class="line">        <span class="keyword">int</span> k;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;k);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=k;++j)&#123;</span><br><span class="line">            <span class="keyword">int</span> a,c;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;c);</span><br><span class="line">            AddEdge(i,a,c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=M;++i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;leaf[N-M+i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N;++i) f[i][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    dfs(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=M;i&gt;=<span class="number">1</span>;--i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(f[<span class="number">1</span>][i]&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d"</span>,i);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç»„åˆè®¡æ•°ç±»æ ‘å½¢èƒŒåŒ…"><a href="#ç»„åˆè®¡æ•°ç±»æ ‘å½¢èƒŒåŒ…" class="headerlink" title="ç»„åˆè®¡æ•°ç±»æ ‘å½¢èƒŒåŒ…"></a>ç»„åˆè®¡æ•°ç±»æ ‘å½¢èƒŒåŒ…</h2><h3 id="ã€ä¾‹é¢˜ã€‘æ ‘çš„ç‹¬ç«‹é›†-ï¼ˆåŸåˆ›ï¼‰"><a href="#ã€ä¾‹é¢˜ã€‘æ ‘çš„ç‹¬ç«‹é›†-ï¼ˆåŸåˆ›ï¼‰" class="headerlink" title="ã€ä¾‹é¢˜ã€‘æ ‘çš„ç‹¬ç«‹é›† ï¼ˆåŸåˆ›ï¼‰"></a>ã€ä¾‹é¢˜ã€‘æ ‘çš„ç‹¬ç«‹é›† ï¼ˆåŸåˆ›ï¼‰</h3><p>ç»™å®šä¸€æ£µæœ‰$N$ä¸ªç»“ç‚¹çš„æ ‘ï¼Œè¾“å‡ºè¿™æ£µæ ‘ä¸­åŒ…å«$K$ä¸ªç»“ç‚¹çš„ç‹¬ç«‹é›†ä¸ªæ•°ã€‚</p><h3 id="ã€åˆ†æã€‘-2"><a href="#ã€åˆ†æã€‘-2" class="headerlink" title="ã€åˆ†æã€‘"></a>ã€åˆ†æã€‘</h3><p>æœ‰å…³ç»„åˆè®¡æ•°çš„èƒŒåŒ…ç±»æ ‘å½¢dpé—®é¢˜ï¼Œä¸€èˆ¬å‡å¯ç”¨ä»¥ä¸‹æ–¹å¼è§£å†³ã€‚</p><p>è®°å½•çŠ¶æ€ï¼š$f[u][k][0/1]$ ä¸ºä»¥$u$ä¸ºæ ¹çš„å­æ ‘ï¼Œ$u$çš„çŠ¶æ€ä¸ºé€‰æˆ–ä¸é€‰ï¼Œå…±é€‰æ‹©$k$ä¸ªç»“ç‚¹æ—¶ç‹¬ç«‹é›†çš„ä¸ªæ•°ã€‚</p><p>è®°$u$ä¸ºå½“å‰æ­£åœ¨å¤„ç†çš„ç»“ç‚¹ï¼Œ$v$ä¸ºåˆšåˆšé€’å½’è®¿é—®ç»“æŸçš„ç»“ç‚¹ã€‚æ¯é€’å½’è®¿é—®ç»“æŸä¸€ä¸ªå­ç»“ç‚¹ï¼Œå°±è€ƒè™‘æŠŠè¯¥å­ç»“ç‚¹çš„çŠ¶æ€ä¸å·²ç»å¤„ç†ä¸€éƒ¨åˆ†çš„å½“å‰ç»“ç‚¹çŠ¶æ€ç›¸åŒ¹é…ã€‚æ¯è®¿é—®å®Œä¸€ä¸ªç»“ç‚¹ï¼Œå°±æŠŠé…å¯¹åäº§ç”Ÿçš„çŠ¶æ€å½’ä¸ºå·²å¤„ç†çš„çŠ¶æ€ã€‚ç”±äºéœ€è¦æ ¹æ®ä¹‹å‰çš„çŠ¶æ€æ¨å¯¼åç»­çŠ¶æ€ï¼Œå› æ­¤ä¸éš¾çœ‹å‡ºåˆ©ç”¨åˆ°èƒŒåŒ…çš„æ€æƒ³ã€‚</p><p><img src="/images/2.png" alt></p><p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹çš„åŸºæœ¬æ€æƒ³å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">f[u][i+j][(state)]=combine(f[u][i][(state)]*f[u][j][(state)])</script><p>æœ¬é¢˜çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¹Ÿä¸éš¾æ¨å‡ºï¼š</p><script type="math/tex; mode=display">f[u][0][i+j]=\sum f[u][0][i]*(f[v][0][j]+f[v][1][j])</script><script type="math/tex; mode=display">f[u][1][i+j]=\sum f[u][1][i]*f[v][0][j]</script><h3 id="ã€ä»£ç ã€‘-2"><a href="#ã€ä»£ç ã€‘-2" class="headerlink" title="ã€ä»£ç ã€‘"></a>ã€ä»£ç ã€‘</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN=<span class="number">10005</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N,K;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[MAXN][<span class="number">105</span>][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> g[<span class="number">105</span>][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> size[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> fa,<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    size[u]=<span class="number">1</span>;</span><br><span class="line">    f[u][<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>,f[u][<span class="number">1</span>][<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::iterator it=G[u].begin();it!=G[u].end();it++)&#123;</span><br><span class="line">        <span class="keyword">int</span> v=*it;</span><br><span class="line">        <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">        dp(u,v);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=min(K,size[u]);++i)&#123;</span><br><span class="line">            g[i][<span class="number">0</span>]=f[u][i][<span class="number">0</span>],f[u][i][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">            g[i][<span class="number">1</span>]=f[u][i][<span class="number">1</span>],f[u][i][<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=min(K,size[u]);++i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=min(K-i,size[v]);++j)&#123;</span><br><span class="line">                f[u][i+j][<span class="number">0</span>]+=g[i][<span class="number">0</span>]*(f[v][j][<span class="number">0</span>]+f[v][j][<span class="number">1</span>]);</span><br><span class="line">                f[u][i+j][<span class="number">1</span>]+=g[i][<span class="number">1</span>]*f[v][j][<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        size[u]+=size[v];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;N,&amp;K);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;++i)&#123;</span><br><span class="line">        <span class="keyword">int</span> u,v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;u,&amp;v);</span><br><span class="line">        G[u].push_back(v);</span><br><span class="line">        G[v].push_back(u);</span><br><span class="line">    &#125;</span><br><span class="line">    dp(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,f[<span class="number">1</span>][K][<span class="number">0</span>]+f[<span class="number">1</span>][K][<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¹ é¢˜"><a href="#ä¹ é¢˜" class="headerlink" title="ä¹ é¢˜"></a>ä¹ é¢˜</h2><p><a href="https://www.luogu.org/problemnew/show/P4516" target="_blank" rel="noopener">æ½œå…¥è¡ŒåŠ¨</a></p><p>æœªå®Œå¾…ç»­~</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;æ ‘å½¢åˆ†ç»„èƒŒåŒ…&quot;&gt;&lt;a href=&quot;#æ ‘å½¢åˆ†ç»„èƒŒåŒ…&quot; class=&quot;headerlink&quot; title=&quot;æ ‘å½¢åˆ†ç»„èƒŒåŒ…&quot;&gt;&lt;/a&gt;æ ‘å½¢åˆ†ç»„èƒŒåŒ…&lt;/h2&gt;&lt;h3 id=&quot;ã€ä¾‹é¢˜ã€‘-é€‰è¯¾-luogu-p2014&quot;&gt;&lt;a href=&quot;#ã€ä¾‹é¢˜ã€‘-é€‰è¯¾-luogu-p201
      
    
    </summary>
    
      <category term="ç®—æ³•å­¦ä¹ " scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="åŠ¨æ€è§„åˆ’" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="èƒŒåŒ…" scheme="https://tth37.cn/tags/%E8%83%8C%E5%8C%85/"/>
    
      <category term="æ ‘å½¢dp" scheme="https://tth37.cn/tags/%E6%A0%91%E5%BD%A2dp/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p2774æ–¹æ ¼å–æ•°é—®é¢˜</title>
    <link href="https://tth37.cn/2019/03/24/solution-luogu-p2774/"/>
    <id>https://tth37.cn/2019/03/24/solution-luogu-p2774/</id>
    <published>2019-03-24T14:16:21.000Z</published>
    <updated>2019-07-03T08:35:15.366Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/P2774" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p></blockquote><p>ä¸éš¾å‘ç°ï¼Œæ¯ä¸ªæ–¹æ ¼ä¼šä¸å…¶ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹æ ¼äº§ç”ŸçŸ›ç›¾ã€‚ç¼–ç¨‹çš„ä»»åŠ¡å³æ‰¾åˆ°ä¸€ç§ä¸äº§ç”ŸçŸ›ç›¾çš„é€‰æ‹©æ–¹æ¡ˆï¼Œå¹¶ä¸”ä½¿å¾—å–å‡ºçš„æ•°æ€»å’Œæœ€å¤§ã€‚</p><p>é¦–å…ˆå¯¹å›¾è¿›è¡Œé»‘ç™½æŸ“è‰²ï¼Œç›®çš„æ˜¯ä½¿äº§ç”ŸçŸ›ç›¾çš„ä¸¤ä¸ªä½ç½®åˆ†åˆ«ä½äºä¸åŒçš„è‰²å—ä¸­ï¼Œæ–¹ä¾¿å»ºå›¾ã€‚</p><p><img src="https://i.loli.net/2019/03/24/5c979a716191f.png" alt></p><p>æºç‚¹ä¸æ‰€æœ‰ç™½è‰²ä½ç½®ç›¸è¿ï¼Œæƒå€¼ä¸ºè¯¥ä½ç½®ä¸Šçš„æ•°å­—ï¼›æ‰€æœ‰é»‘è‰²ä½ç½®ä¸æ±‡ç‚¹ç›¸è¿ï¼Œæƒå€¼ä¹Ÿä¸ºè¯¥ä½ç½®ä¸Šçš„æ•°å­—ï¼›æ‰€æœ‰ç™½è‰²ä½ç½®ä¸å…¶ä¸Šä¸‹å·¦å³ï¼ˆæ³¨æ„è¾¹ç•Œæƒ…å†µï¼‰çš„é»‘è‰²ä½ç½®ç›¸è¿ï¼Œæƒå€¼ä¸ºæ— ç©·å¤§ã€‚</p><p><img src="https://i.loli.net/2019/03/24/5c979a7163abf.png" alt></p><p>å¦‚æ­¤å»ºå›¾åï¼Œå¯ä»¥å‘ç°å­˜åœ¨æºç‚¹åˆ°æ±‡ç‚¹çš„å¢å¹¿è·¯ï¼Œè¿™ä¹Ÿæ„å‘³ç€åŸå›¾ä¸­å­˜åœ¨äº§ç”ŸçŸ›ç›¾çš„ä¸¤ä¸ªä½ç½®ã€‚å‡è®¾ä¸€å¼€å§‹é€‰å–M*Nç½‘æ ¼ä¸­çš„æ‰€æœ‰æ–¹å—ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡æ˜¯å‰²æ‰ç½‘ç»œä¸­çš„ä¸€äº›è¾¹ï¼ˆå³åˆ å»ä¸€äº›æ–¹å—ï¼‰ï¼Œä½¿å¾—å‰²å»çš„è¾¹æƒæœ€å°ã€‚å‰²å»ç½‘ç»œä¸­çš„è¾¹å°±ç›¸å½“äºåˆ æ‰ä¸¤ä¸ªçŸ›ç›¾ä½ç½®ä¸­çš„å…¶ä¸­ä¸€ä¸ªï¼Œå› æ­¤å½“ç½‘ç»œä¸­ä¸å†æœ‰æºç‚¹åˆ°æ±‡ç‚¹çš„å¢å¹¿è·¯ï¼Œå°±æ„å‘³ç€çŸ›ç›¾å…¨éƒ¨æ¶ˆé™¤ã€‚</p><p>é—®é¢˜ä¾¿è½¬åŒ–ä¸ºæ±‚è§£æœ€å°å‰²ï¼ˆæœ€å¤§æµï¼‰çš„é—®é¢˜ã€‚è¾“å‡ºç­”æ¡ˆä¸ºå…¨å±€å’Œå‡å»æœ€å°å‰²ã€‚</p><a id="more"></a><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF=<span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN=<span class="number">100005</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N,M,S,T;</span><br><span class="line">ll sum;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> nx[]=&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">-1</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> ny[]=&#123;<span class="number">1</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> v,w,nxt;</span><br><span class="line">&#125;mem[MAXN];</span><br><span class="line"><span class="keyword">int</span> head[MAXN],cnt=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    mem[++cnt].w=w;</span><br><span class="line">    mem[cnt].v=v;</span><br><span class="line">    mem[cnt].nxt=head[u];</span><br><span class="line">    head[u]=cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> d[MAXN];</span><br><span class="line"><span class="keyword">bool</span> vis[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line">    vis[S]=<span class="number">1</span>;d[S]=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    q.push(S);</span><br><span class="line">    <span class="keyword">while</span>(q.size())&#123;</span><br><span class="line">        <span class="keyword">int</span> u=q.front();q.pop();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=head[u];i;i=mem[i].nxt)&#123;</span><br><span class="line">            <span class="keyword">int</span> v=mem[i].v,w=mem[i].w;</span><br><span class="line">            <span class="keyword">if</span>(vis[v]||(w==<span class="number">0</span>)) <span class="keyword">continue</span>;</span><br><span class="line">            vis[v]=<span class="number">1</span>;d[v]=d[u]+<span class="number">1</span>;</span><br><span class="line">            q.push(v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> vis[T];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> flow)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(u==T) <span class="keyword">return</span> flow;</span><br><span class="line">    <span class="keyword">int</span> rflow;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=head[u];i;i=mem[i].nxt)&#123;</span><br><span class="line">        <span class="keyword">int</span> v=mem[i].v,w=mem[i].w;</span><br><span class="line">        <span class="keyword">if</span>(w==<span class="number">0</span>||d[u]+<span class="number">1</span>!=d[v]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span>(rflow=dfs(v,min(flow,w)))&#123;</span><br><span class="line">            mem[i].w-=rflow;</span><br><span class="line">            mem[i^<span class="number">1</span>].w+=rflow;</span><br><span class="line">            <span class="keyword">return</span> rflow;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Dinic</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> maxflow=<span class="number">0</span>,lowflow;</span><br><span class="line">    <span class="keyword">while</span>(bfs())&#123;</span><br><span class="line">        <span class="keyword">while</span>(lowflow=dfs(S,INF)) maxflow+=lowflow;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> maxflow;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;M,&amp;N);</span><br><span class="line">    S=<span class="number">0</span>,T=M*N+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=M;++i)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=N;++j)&#123;</span><br><span class="line">            <span class="keyword">int</span> w;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;w);</span><br><span class="line">            sum+=w;</span><br><span class="line">            <span class="keyword">if</span>((i+j)&amp;<span class="number">1</span>)&#123;</span><br><span class="line">                AddEdge(S,(i<span class="number">-1</span>)*N+j,w);</span><br><span class="line">                AddEdge((i<span class="number">-1</span>)*N+j,S,INF);</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> k=<span class="number">0</span>;k&lt;=<span class="number">3</span>;++k)&#123;</span><br><span class="line">                    <span class="keyword">int</span> tx=i+nx[k],ty=j+ny[k];</span><br><span class="line">                    <span class="keyword">if</span>(tx&lt;<span class="number">1</span>||tx&gt;M||ty&lt;<span class="number">1</span>||ty&gt;N) <span class="keyword">continue</span>;</span><br><span class="line">                    AddEdge((i<span class="number">-1</span>)*N+j,(tx<span class="number">-1</span>)*N+ty,INF);</span><br><span class="line">                    AddEdge((tx<span class="number">-1</span>)*N+ty,(i<span class="number">-1</span>)*N+j,<span class="number">0</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                AddEdge((i<span class="number">-1</span>)*N+j,T,w);</span><br><span class="line">                AddEdge(T,(i<span class="number">-1</span>)*N+j,INF);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld"</span>,sum-Dinic());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/P2774&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸éš¾å‘ç°ï¼Œæ¯ä¸ªæ–¹æ ¼ä¼šä¸å…¶ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹æ ¼äº§ç”ŸçŸ›ç›¾ã€‚ç¼–ç¨‹çš„ä»»åŠ¡å³æ‰¾åˆ°ä¸€ç§ä¸äº§ç”ŸçŸ›ç›¾çš„é€‰æ‹©æ–¹æ¡ˆï¼Œå¹¶ä¸”ä½¿å¾—å–å‡ºçš„æ•°æ€»å’Œæœ€å¤§ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå¯¹å›¾è¿›è¡Œé»‘ç™½æŸ“è‰²ï¼Œç›®çš„æ˜¯ä½¿äº§ç”ŸçŸ›ç›¾çš„ä¸¤ä¸ªä½ç½®åˆ†åˆ«ä½äºä¸åŒçš„è‰²å—ä¸­ï¼Œæ–¹ä¾¿å»ºå›¾ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.loli.net/2019/03/24/5c979a716191f.png&quot; alt&gt;&lt;/p&gt;
&lt;p&gt;æºç‚¹ä¸æ‰€æœ‰ç™½è‰²ä½ç½®ç›¸è¿ï¼Œæƒå€¼ä¸ºè¯¥ä½ç½®ä¸Šçš„æ•°å­—ï¼›æ‰€æœ‰é»‘è‰²ä½ç½®ä¸æ±‡ç‚¹ç›¸è¿ï¼Œæƒå€¼ä¹Ÿä¸ºè¯¥ä½ç½®ä¸Šçš„æ•°å­—ï¼›æ‰€æœ‰ç™½è‰²ä½ç½®ä¸å…¶ä¸Šä¸‹å·¦å³ï¼ˆæ³¨æ„è¾¹ç•Œæƒ…å†µï¼‰çš„é»‘è‰²ä½ç½®ç›¸è¿ï¼Œæƒå€¼ä¸ºæ— ç©·å¤§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.loli.net/2019/03/24/5c979a7163abf.png&quot; alt&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æ­¤å»ºå›¾åï¼Œå¯ä»¥å‘ç°å­˜åœ¨æºç‚¹åˆ°æ±‡ç‚¹çš„å¢å¹¿è·¯ï¼Œè¿™ä¹Ÿæ„å‘³ç€åŸå›¾ä¸­å­˜åœ¨äº§ç”ŸçŸ›ç›¾çš„ä¸¤ä¸ªä½ç½®ã€‚å‡è®¾ä¸€å¼€å§‹é€‰å–M*Nç½‘æ ¼ä¸­çš„æ‰€æœ‰æ–¹å—ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡æ˜¯å‰²æ‰ç½‘ç»œä¸­çš„ä¸€äº›è¾¹ï¼ˆå³åˆ å»ä¸€äº›æ–¹å—ï¼‰ï¼Œä½¿å¾—å‰²å»çš„è¾¹æƒæœ€å°ã€‚å‰²å»ç½‘ç»œä¸­çš„è¾¹å°±ç›¸å½“äºåˆ æ‰ä¸¤ä¸ªçŸ›ç›¾ä½ç½®ä¸­çš„å…¶ä¸­ä¸€ä¸ªï¼Œå› æ­¤å½“ç½‘ç»œä¸­ä¸å†æœ‰æºç‚¹åˆ°æ±‡ç‚¹çš„å¢å¹¿è·¯ï¼Œå°±æ„å‘³ç€çŸ›ç›¾å…¨éƒ¨æ¶ˆé™¤ã€‚&lt;/p&gt;
&lt;p&gt;é—®é¢˜ä¾¿è½¬åŒ–ä¸ºæ±‚è§£æœ€å°å‰²ï¼ˆæœ€å¤§æµï¼‰çš„é—®é¢˜ã€‚è¾“å‡ºç­”æ¡ˆä¸ºå…¨å±€å’Œå‡å»æœ€å°å‰²ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="ç½‘ç»œæµ" scheme="https://tth37.cn/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜ç›®åˆ—è¡¨-ç½‘ç»œæµ</title>
    <link href="https://tth37.cn/2019/03/24/list-networkflow/"/>
    <id>https://tth37.cn/2019/03/24/list-networkflow/</id>
    <published>2019-03-24T14:07:49.000Z</published>
    <updated>2019-05-12T11:10:53.718Z</updated>
    
    <content type="html"><![CDATA[<ol><li><h5 id="æ–¹æ ¼å–æ•°é—®é¢˜ï¼ˆäºŒåˆ†å›¾-å»ºæ¨¡æŠ€å·§ï¼‰"><a href="#æ–¹æ ¼å–æ•°é—®é¢˜ï¼ˆäºŒåˆ†å›¾-å»ºæ¨¡æŠ€å·§ï¼‰" class="headerlink" title="æ–¹æ ¼å–æ•°é—®é¢˜ï¼ˆäºŒåˆ†å›¾+å»ºæ¨¡æŠ€å·§ï¼‰"></a><a href="https://www.luogu.org/problemnew/show/P2774" target="_blank" rel="noopener">æ–¹æ ¼å–æ•°é—®é¢˜</a>ï¼ˆäºŒåˆ†å›¾+å»ºæ¨¡æŠ€å·§ï¼‰</h5><p>å°†åŸå›¾é»‘ç™½æŸ“è‰²ï¼Œå¹¶ä¿è¯äº§ç”ŸçŸ›ç›¾çš„ä¸¤ä¸ªä½ç½®é¢œè‰²ä¸åŒã€‚æºç‚¹è¿æ¥é»‘ç‚¹ï¼Œç™½ç‚¹è¿æ¥æ±‡ç‚¹ï¼Œé»‘ç‚¹è¿æ¥ä¸ä¹‹äº§ç”ŸçŸ›ç›¾çš„ç™½ç‚¹ã€‚é€šè¿‡ æœ€å¤§å’Œ=å…¨å±€å’Œ-æœ€å°å‰²ï¼Œåœ¨å»ºç«‹çš„ç½‘ç»œä¸Šè·‘æœ€å°å‰²ï¼ˆæœ€å¤§æµï¼‰å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=M;++i)&#123;</span><br><span class="line">       <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=N;++j)&#123;</span><br><span class="line">           <span class="keyword">int</span> w;</span><br><span class="line">           <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;w);</span><br><span class="line">           sum+=w;</span><br><span class="line">           <span class="keyword">if</span>((i+j)&amp;<span class="number">1</span>)&#123;</span><br><span class="line">               AddEdge(S,(i<span class="number">-1</span>)*N+j,w);</span><br><span class="line">               AddEdge((i<span class="number">-1</span>)*N+j,S,INF);</span><br><span class="line">               <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> k=<span class="number">0</span>;k&lt;=<span class="number">3</span>;++k)&#123;</span><br><span class="line">                   <span class="keyword">int</span> tx=i+nx[k],ty=j+ny[k];</span><br><span class="line">                   <span class="keyword">if</span>(tx&lt;<span class="number">1</span>||tx&gt;M||ty&lt;<span class="number">1</span>||ty&gt;N) <span class="keyword">continue</span>;</span><br><span class="line">                   AddEdge((i<span class="number">-1</span>)*N+j,(tx<span class="number">-1</span>)*N+ty,INF);</span><br><span class="line">                   AddEdge((tx<span class="number">-1</span>)*N+ty,(i<span class="number">-1</span>)*N+j,<span class="number">0</span>);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">else</span>&#123;</span><br><span class="line">               AddEdge((i<span class="number">-1</span>)*N+j,T,w);</span><br><span class="line">               AddEdge(T,(i<span class="number">-1</span>)*N+j,INF);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ol&gt;
&lt;li&gt;&lt;h5 id=&quot;æ–¹æ ¼å–æ•°é—®é¢˜ï¼ˆäºŒåˆ†å›¾-å»ºæ¨¡æŠ€å·§ï¼‰&quot;&gt;&lt;a href=&quot;#æ–¹æ ¼å–æ•°é—®é¢˜ï¼ˆäºŒåˆ†å›¾-å»ºæ¨¡æŠ€å·§ï¼‰&quot; class=&quot;headerlink&quot; title=&quot;æ–¹æ ¼å–æ•°é—®é¢˜ï¼ˆäºŒåˆ†å›¾+å»ºæ¨¡æŠ€å·§ï¼‰&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://www.luogu.or
      
    
    </summary>
    
      <category term="é¢˜ç›®åˆ—è¡¨" scheme="https://tth37.cn/categories/%E9%A2%98%E7%9B%AE%E5%88%97%E8%A1%A8/"/>
    
    
  </entry>
  
  <entry>
    <title>å…¬å‘Š 2019-03-24</title>
    <link href="https://tth37.cn/2019/03/24/bulletin-2019-3-24/"/>
    <id>https://tth37.cn/2019/03/24/bulletin-2019-3-24/</id>
    <published>2019-03-24T05:13:13.000Z</published>
    <updated>2019-04-08T15:47:56.942Z</updated>
    
    <content type="html"><![CDATA[<p>2019/3/24ï¼Œtth37æ­å»ºäº†è¿™ä¸ªgithubåšå®¢ã€‚</p><p>tth37å¸Œæœ›åœ¨è¿™ä¸ªåšå®¢é‡Œè®°å½•ä¸€äº›è‡ªå·±å­¦ä¹ OIçš„å¿ƒå¾—ï¼Œå¹¶å‘å¸ƒä¸€äº›é¢˜è§£ï¼Œè´´å‡ºå­¦ä¹ è§„åˆ’ã€‚</p><p>ä½†tth37å®åœ¨æ˜¯å¤ªå¼±äº†ï¼Œå› æ­¤ä»–ä¼šæ›´æ–°å¾—ååˆ†ç¼“æ…¢ã€‚</p><p>å¦å¤–ï¼Œè¿˜è¯·shiwtå·¨ä½¬å¤šå¤šæŒ‡æ•™ã€‚</p><blockquote><p>ä»»ä½•ä¸€ä¸ªä¼Ÿå¤§çš„æ€æƒ³ï¼Œéƒ½æœ‰ä¸€ä¸ªå¾®ä¸è¶³é“çš„å¼€å§‹ã€‚</p></blockquote><p>p.s. å¯èƒ½ä¼šå°†æ´›è°·åšå®¢ä¸Šçš„æ–‡ç« æ¬è¿è¿‡æ¥ï¼Œæ‰€ä»¥æœ‰äº›æ–‡ç« çš„å‘å¸ƒæ—¶é—´å¯èƒ½åœ¨æ­¤ä¹‹å‰ï¼Œè¯·åˆ«è§æ€ªã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;2019/3/24ï¼Œtth37æ­å»ºäº†è¿™ä¸ªgithubåšå®¢ã€‚&lt;/p&gt;
&lt;p&gt;tth37å¸Œæœ›åœ¨è¿™ä¸ªåšå®¢é‡Œè®°å½•ä¸€äº›è‡ªå·±å­¦ä¹ OIçš„å¿ƒå¾—ï¼Œå¹¶å‘å¸ƒä¸€äº›é¢˜è§£ï¼Œè´´å‡ºå­¦ä¹ è§„åˆ’ã€‚&lt;/p&gt;
&lt;p&gt;ä½†tth37å®åœ¨æ˜¯å¤ªå¼±äº†ï¼Œå› æ­¤ä»–ä¼šæ›´æ–°å¾—ååˆ†ç¼“æ…¢ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œè¿˜è¯·shiwtå·¨ä½¬å¤šå¤šæŒ‡æ•™ã€‚
      
    
    </summary>
    
      <category term="å…¬å‘Š" scheme="https://tth37.cn/categories/%E5%85%AC%E5%91%8A/"/>
    
    
  </entry>
  
  <entry>
    <title>é¢˜ç›®åˆ—è¡¨-åŠ¨æ€è§„åˆ’</title>
    <link href="https://tth37.cn/2019/03/20/list-dp/"/>
    <id>https://tth37.cn/2019/03/20/list-dp/</id>
    <published>2019-03-20T11:24:57.000Z</published>
    <updated>2019-05-12T11:10:50.859Z</updated>
    
    <content type="html"><![CDATA[<ol><li><h5 id="ä»»åŠ¡å®‰æ’ï¼ˆæ–œç‡ä¼˜åŒ–-è´¹ç”¨æå‰è®¡ç®—ï¼‰"><a href="#ä»»åŠ¡å®‰æ’ï¼ˆæ–œç‡ä¼˜åŒ–-è´¹ç”¨æå‰è®¡ç®—ï¼‰" class="headerlink" title="ä»»åŠ¡å®‰æ’ï¼ˆæ–œç‡ä¼˜åŒ–+è´¹ç”¨æå‰è®¡ç®—ï¼‰"></a><a href="https://loj.ac/problem/10185" target="_blank" rel="noopener">ä»»åŠ¡å®‰æ’</a>ï¼ˆæ–œç‡ä¼˜åŒ–+è´¹ç”¨æå‰è®¡ç®—ï¼‰</h5><script type="math/tex; mode=display">f[i]=min_{0\le j<i}\{f[j]-(S+T[i])\*C[i]+T[i]\*C[i]+S\*C[N]\}</script></li></ol><hr><ol><li><h5 id="ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰"><a href="#ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰" class="headerlink" title="ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰"></a><a href="https://www.luogu.org/problemnew/show/P3628" target="_blank" rel="noopener">ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿ</a>ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰</h5><script type="math/tex; mode=display">f[i]=max_{0\le j<i}\{f[j]+A\*(S[i]-S[j])^2+B\*(S[i]-S[j])+C\}</script></li></ol><hr><ol><li><h5 id="ç©å…·è£…ç®±ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰"><a href="#ç©å…·è£…ç®±ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰" class="headerlink" title="ç©å…·è£…ç®±ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰"></a><a href="https://www.luogu.org/problemnew/show/P3195" target="_blank" rel="noopener">ç©å…·è£…ç®±</a>ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰</h5><script type="math/tex; mode=display">f[i]=min_{0\le j<i}\{f[j]+(A[i]-A[j]-L-1)^2\}</script><p>æ–œç‡ä¼˜åŒ–çš„é€‚ç”¨èŒƒå›´æ˜¯åªæœ‰ä¸€ä¸ªè‡ªå˜é‡ã€‚</p><p>å½¢å¦‚è¿™æ ·çš„è½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">f[i]=min_{0\le j<i}\{f[j]+(i-j+S[i]-S[j]-L-1)^2\}</script><p>æ“ä½œéš¾åº¦è¾ƒå¤§ï¼Œå¯ä»¥å°†$S[i]+i$å­˜åœ¨$A$æ•°ç»„ä¸­ï¼Œå³å¯å…¨éƒ¨åŒ–ä¸ºä¸€ä¸ªè‡ªå˜é‡ã€‚</p></li></ol><hr><ol><li><h5 id="é”¯æœ¨å‚é€‰å€ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰"><a href="#é”¯æœ¨å‚é€‰å€ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰" class="headerlink" title="é”¯æœ¨å‚é€‰å€ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰"></a><a href="https://www.luogu.org/problemnew/show/P4360" target="_blank" rel="noopener">é”¯æœ¨å‚é€‰å€</a>ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰</h5><script type="math/tex; mode=display">f[i]=min_{1\le j<i}\{C[i-1]-W[j]*(D[i]-D[j])\}</script></li></ol><hr><ol><li><h5 id="æ‰“å°æ–‡ç« ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰"><a href="#æ‰“å°æ–‡ç« ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰" class="headerlink" title="æ‰“å°æ–‡ç« ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰"></a><a href="https://loj.ac/problem/10191" target="_blank" rel="noopener">æ‰“å°æ–‡ç« </a>ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰</h5><script type="math/tex; mode=display">f[i]=min_{0\le j<i}\{f[j]+(S[i]-S[j])^2+M\}</script>è°ƒåˆ°å¿ƒæ€çˆ†ç‚¸â€¦â€¦getKå‡½æ•°ä¸­å¦‚æœé™¤æ•°ä¸º0åˆ™è¦è¿”å›1e100</li></ol><hr><ol><li><h5 id="åºåˆ—åˆ†å‰²ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰"><a href="#åºåˆ—åˆ†å‰²ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰" class="headerlink" title="åºåˆ—åˆ†å‰²ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰"></a><a href="https://www.luogu.org/problemnew/show/P3648" target="_blank" rel="noopener">åºåˆ—åˆ†å‰²</a>ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰</h5><script type="math/tex; mode=display">f[i][j]=max_{0 \le k<j}\{f[i-1][k]+S[k]*(S[j]-S[k])\}</script><p>ä¸å¼€long longè§ç¥–å®—ã€‚é¢˜ç›®ä¸­å¦‚æœè¯´â€œéè´Ÿæ•´æ•°â€ä¸€å®šè®°å¾—åˆ¤æ–­é™¤æ•°æ˜¯å¦ä¸º0ã€‚</p><p>å¯¹äºè½¬ç§»æ–¹ç¨‹ä¸­çš„ç¬¬ä¸€ç»´ï¼Œç¨åŠ è§‚å¯Ÿå°±ä¼šå‘ç°å¯ä»¥ä½¿ç”¨æ»šåŠ¨æ•°ç»„ã€‚ï¼ˆè™½ç„¶ä¹Ÿéœ€è¦ä¸€äº›é¢å¤–çš„æ•°ç»„è®°å½•çŠ¶æ€ï¼‰</p></li></ol><hr><ol><li><h5 id="ç»¿è‰²é€šé“ï¼ˆäºŒåˆ†ç­”æ¡ˆ-å•è°ƒé˜Ÿåˆ—ï¼‰"><a href="#ç»¿è‰²é€šé“ï¼ˆäºŒåˆ†ç­”æ¡ˆ-å•è°ƒé˜Ÿåˆ—ï¼‰" class="headerlink" title="ç»¿è‰²é€šé“ï¼ˆäºŒåˆ†ç­”æ¡ˆ+å•è°ƒé˜Ÿåˆ—ï¼‰"></a><a href="https://loj.ac/problem/10181" target="_blank" rel="noopener">ç»¿è‰²é€šé“</a>ï¼ˆäºŒåˆ†ç­”æ¡ˆ+å•è°ƒé˜Ÿåˆ—ï¼‰</h5><script type="math/tex; mode=display">f[i]=min_{i-M-1 \le j <i}\{f[j]+a[i]\}</script></li></ol><p>   äºŒåˆ†å‘æ€’ç¨‹åº¦$M$ï¼Œ$f$æ•°ç»„ä¸­å­˜å‚¨é€‰æ‹©å½“å‰é¢˜ç›®æœ€å°‘å¤šå°‘ä½“åŠ›ã€‚ç»Ÿè®¡æœ€ç»ˆç­”æ¡ˆåªéœ€æ£€éªŒæœ€å$M$ä¸ªçŠ¶æ€å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> ans=INF;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=N-M;i&lt;=N;++i) ans=min(ans,f[i]);</span><br></pre></td></tr></table></figure><hr><ol><li><h5 id="è‚¡ç¥¨äº¤æ˜“ï¼ˆå•è°ƒé˜Ÿåˆ—-å¾ˆå¤šæ¡ä»¶ï¼‰"><a href="#è‚¡ç¥¨äº¤æ˜“ï¼ˆå•è°ƒé˜Ÿåˆ—-å¾ˆå¤šæ¡ä»¶ï¼‰" class="headerlink" title="è‚¡ç¥¨äº¤æ˜“ï¼ˆå•è°ƒé˜Ÿåˆ—+å¾ˆå¤šæ¡ä»¶ï¼‰"></a><a href="https://www.luogu.org/problemnew/show/P2569" target="_blank" rel="noopener">è‚¡ç¥¨äº¤æ˜“</a>ï¼ˆå•è°ƒé˜Ÿåˆ—+å¾ˆå¤šæ¡ä»¶ï¼‰</h5><script type="math/tex; mode=display">f[i][j]=-AP[i]*j(0 \le j \le AS[i])</script><script type="math/tex; mode=display">f[i][j]=max\{f[i][j],f[i-1][j]\}(0 \le j \le M)</script><script type="math/tex; mode=display">f[i][j]=max_{j-AS[i] \le k<j}\{f[i-W-1][k]-(j-k)*AP[i]\}(0 \le j \le M)</script><script type="math/tex; mode=display">f[i][j]=max_{j<k \le j+BS[i]}\{f[i-W-1][k]+(k-j)*BP[i]\}(0 \le j \le M)</script><p>æ¡ä»¶ç‰¹åˆ«å¤šï¼Œéœ€è¦ä»”ç»†åˆ†æé¢˜æ„å¹¶ä¸”åˆ—å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€‚å…ˆè¿›è¡Œè¾ƒç®€å•çš„è½¬ç§»ï¼Œå†åˆ©ç”¨å•è°ƒé˜Ÿåˆ—è¿›è¡Œå¤æ‚è½¬ç§»ã€‚æ³¨æ„ç¬¬å››ç§çŠ¶æ€è½¬ç§»è¦ä½¿ç”¨é€†åºå¾ªç¯ã€‚</p><p><del>å¦‚æ­¤æ¶å¿ƒçš„çŠ¶æ€è½¬ç§»è®©æˆ‘ä¸ç¦æƒ³èµ·<a href="https://www.luogu.org/problemnew/show/P1941" target="_blank" rel="noopener">é£æ‰¬çš„å°é¸Ÿ</a></del></p></li></ol><hr><ol><li><h5 id="æ½œå…¥è¡ŒåŠ¨ï¼ˆèƒŒåŒ…ç±»æ ‘å½¢dpï¼‰"><a href="#æ½œå…¥è¡ŒåŠ¨ï¼ˆèƒŒåŒ…ç±»æ ‘å½¢dpï¼‰" class="headerlink" title="æ½œå…¥è¡ŒåŠ¨ï¼ˆèƒŒåŒ…ç±»æ ‘å½¢dpï¼‰"></a><a href="https://www.luogu.org/problemnew/show/P4516" target="_blank" rel="noopener">æ½œå…¥è¡ŒåŠ¨</a>ï¼ˆèƒŒåŒ…ç±»æ ‘å½¢dpï¼‰</h5><script type="math/tex; mode=display">f[u][i+j][0][0]=\sum f[u][i][0][0]*f[v][j][0][1]</script><script type="math/tex; mode=display">f[u][i+j][1][0]=\sum f[u][i][1][0]*(f[v][j][0][0]+f[v][j][0][1])</script><script type="math/tex; mode=display">f[u][i+j][0][1]=\sum (f[u][i][0][1]\*(f[v][j][0][1]+f[v][j][1][1])+f[u][i][0][0]\*f[v][j][1][1]</script><script type="math/tex; mode=display">f[u][i+j][1][1]=\sum (f[u][i][1][0]\*(f[v][j][1][0]+f[v][j][1][1])+f[u][i][1][1]\*(f[v][j][0][0]+f[v][j][0][1]+f[v][j][1][0]+f[v][j][1][1]))</script><p><a href="https://tth37.cn/2019/03/28/solution-luogu-p4516/">é¢˜è§£é“¾æ¥</a></p><p>ç‰¹åˆ«æ³¨æ„ç©ºé—´é—®é¢˜ï¼Œä¸­é—´è¿ç®—è½¬<code>long long</code>ï¼Œä¿å­˜æ—¶å†è½¬<code>int</code></p></li></ol><hr><ol><li><h5 id="å­ä¸²ï¼ˆçº¿æ€§dp-æ»šåŠ¨æ•°ç»„ï¼‰"><a href="#å­ä¸²ï¼ˆçº¿æ€§dp-æ»šåŠ¨æ•°ç»„ï¼‰" class="headerlink" title="å­ä¸²ï¼ˆçº¿æ€§dp+æ»šåŠ¨æ•°ç»„ï¼‰"></a><a href="https://www.luogu.org/fe/problem/P2679" target="_blank" rel="noopener">å­ä¸²</a>ï¼ˆçº¿æ€§dp+æ»šåŠ¨æ•°ç»„ï¼‰</h5><script type="math/tex; mode=display">f[i][0][0][0]=1</script><script type="math/tex; mode=display">f[i][j][k][0]=f[i-1][j][k][0]+f[i-1][j][k][1]</script><script type="math/tex; mode=display">a[i]=b[j]:f[i][j][k][1]=f[i-1][j-1][k][1]+f[i-1][j-1][k-1][0]+f[i-1][j-1][k-1][1]</script><script type="math/tex; mode=display">a[i] \ne b[j]:f[i][j][k][1]=0</script><p>æ»šåŠ¨æ•°ç»„æ³¨æ„ç‚¹ï¼š</p><ul><li>çŠ¶æ€è½¬ç§»æ–¹ç¨‹åªä¾èµ–å‰ä¸€ç»´æˆ–å‰ä¸¤ç»´çŠ¶æ€</li><li>çŠ¶æ€æ•°ç»„è¦è¢«æ»šåŠ¨çš„ä¸€ç»´åªå¼€1æˆ–2</li><li>å¯¹äº0/1æ»šåŠ¨æ•°ç»„ï¼Œå¯ä»¥ç»“åˆä½è¿ç®—<code>&amp;</code>å’Œ<code>^</code>è¿›è¡Œåˆ¤æ–­å¥‡å¶æ€§å’Œå‡ä¸€æ“ä½œ</li></ul></li></ol><hr><ol><li><h5 id="æ¢æ•™å®¤ï¼ˆæœŸæœ›dpï¼‰"><a href="#æ¢æ•™å®¤ï¼ˆæœŸæœ›dpï¼‰" class="headerlink" title="æ¢æ•™å®¤ï¼ˆæœŸæœ›dpï¼‰"></a><a href="https://www.luogu.org/fe/problem/P1850" target="_blank" rel="noopener">æ¢æ•™å®¤</a>ï¼ˆæœŸæœ›dpï¼‰</h5><script type="math/tex; mode=display">f[i][j][0]=min\{f[i-1][j][0]+dis[C[i-1]][C[i]],f[i-1][j][1]+K[i-1]\*dis[D[i-1]][C[i]]+(1-K[i-1])\*dis[C[i-1]][C[i]]\}</script><script type="math/tex; mode=display">f[i][j][1]=min\{f[i-1][j-1][0]+K[i]\*dis[C[i-1]][D[i]]+(1-K[i])\*dis[C[i-1]][C[i]],f[i-1][j-1][1]+K[i-1]\*K[i]\*dis[D[i-1]][D[i]]+K[i-1]\*(1-K[i])\*dis[D[i-1]][C[i]]+(1-K[i-1])\*K[i]\*dis[C[i-1]][D[i]]+(1-K[i-1])\*(1-K[i])\*dis[C[i-1]][C[i]]\}</script><p>æœŸæœ›dpå¯ä»¥å•ç‹¬å¼€ä¸€ç»´è¡¨ç¤ºçŠ¶æ€ï¼Œä»¥ä¾¿äºåˆ—ä¸¾å‡ºæ‰€æœ‰æƒ…å†µã€‚æœ¬é¢˜çš„è½¬ç§»æ–¹ç¨‹æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚<del>å¦‚æœtth37å¼€å¿ƒçš„è¯ï¼ŒTaå¯èƒ½ä¼šå†™ä¸€ç¯‡æ•°å­¦æœŸæœ›ä¸“é¢˜å…·ä½“è®²è§£æ­¤ç±»é¢˜ç›®ã€‚</del></p></li></ol><hr><ol><li><h5 id="è¿‡æ²³ï¼ˆçº¿æ€§dp-ç„å­¦ç¦»æ•£åŒ–ï¼‰"><a href="#è¿‡æ²³ï¼ˆçº¿æ€§dp-ç„å­¦ç¦»æ•£åŒ–ï¼‰" class="headerlink" title="è¿‡æ²³ï¼ˆçº¿æ€§dp+ç„å­¦ç¦»æ•£åŒ–ï¼‰"></a><a href="https://www.luogu.org/problemnew/show/P1052" target="_blank" rel="noopener">è¿‡æ²³</a>ï¼ˆçº¿æ€§dp+ç„å­¦ç¦»æ•£åŒ–ï¼‰</h5><script type="math/tex; mode=display">f[i]=min_{S \le j \le T}\{f[i-j]+flag[i]\}</script><p>ç”±äºméå¸¸å°ï¼Œå› æ­¤é‡‡ç”¨2520ç¼©ç‚¹ï¼Œå³ä¸¤ç‚¹ä¹‹é—´è·ç¦»è¶…è¿‡2520çš„ï¼Œå¯ä»¥å°†è·ç¦»æ”¹ä¸º$dis % 2520$ï¼Œä»è€Œç¦»æ•£åŒ–ã€‚</p></li></ol><hr><ol><li><h5 id="ç»Ÿè®¡å•è¯ä¸ªæ•°ï¼ˆçº¿æ€§dp-å­—ç¬¦ä¸²ï¼‰"><a href="#ç»Ÿè®¡å•è¯ä¸ªæ•°ï¼ˆçº¿æ€§dp-å­—ç¬¦ä¸²ï¼‰" class="headerlink" title="ç»Ÿè®¡å•è¯ä¸ªæ•°ï¼ˆçº¿æ€§dp+å­—ç¬¦ä¸²ï¼‰"></a><a href="https://www.luogu.org/problemnew/show/P1026" target="_blank" rel="noopener">ç»Ÿè®¡å•è¯ä¸ªæ•°</a>ï¼ˆçº¿æ€§dp+å­—ç¬¦ä¸²ï¼‰</h5><script type="math/tex; mode=display">f[i][j]=max\{f[i][j],f[r][j-1]+g[r+1][i]\}</script><p>å­—ç¬¦ä¸²å¤„ç†ä½¿ç”¨stringç±»findå‡½æ•°ã€‚</p><p>çº¿æ€§dpæ—¶å†æ¬¡å¼ºè°ƒï¼Œéœ€è¦åˆ†æ¸…é˜¶æ®µã€çŠ¶æ€å’Œå†³ç­–å˜é‡ï¼›é˜¶æ®µåœ¨æœ€å¤–å±‚å¾ªç¯ï¼Œå†³ç­–åœ¨æœ€å†…å±‚ã€‚åœ¨å¯»æ‰¾å…³ç³»æ—¶å¯ä»¥ä»æ¨å¯¼æˆ–å®šä¹‰è§’åº¦è¾¨æï¼Œä¹Ÿå¯ä»¥æ ¹æ®è½¬ç§»æ–¹ç¨‹è¿›è¡Œè¯†åˆ«ã€‚</p></li></ol><hr><ol><li><h5 id="æœ‰çº¿ç”µè§†ç½‘ï¼ˆèƒŒåŒ…ç±»æ ‘å½¢dpï¼‰"><a href="#æœ‰çº¿ç”µè§†ç½‘ï¼ˆèƒŒåŒ…ç±»æ ‘å½¢dpï¼‰" class="headerlink" title="æœ‰çº¿ç”µè§†ç½‘ï¼ˆèƒŒåŒ…ç±»æ ‘å½¢dpï¼‰"></a><a href="https://www.luogu.org/fe/problem/P1273" target="_blank" rel="noopener">æœ‰çº¿ç”µè§†ç½‘</a>ï¼ˆèƒŒåŒ…ç±»æ ‘å½¢dpï¼‰</h5><script type="math/tex; mode=display">f[u][i]=max_{v\in son(u)}\{f[u][i-j]+f[v][j]-w\}</script><p><a href="https://tth37.cn/2019/04/25/solution-luogu-p1273/">é¢˜è§£é“¾æ¥</a></p></li></ol><hr><ol><li><h5 id="æ£‹ç›˜åˆ¶ä½œï¼ˆå•è°ƒæ ˆï¼‰"><a href="#æ£‹ç›˜åˆ¶ä½œï¼ˆå•è°ƒæ ˆï¼‰" class="headerlink" title="æ£‹ç›˜åˆ¶ä½œï¼ˆå•è°ƒæ ˆï¼‰"></a><a href="https://www.luogu.org/problemnew/show/P1169" target="_blank" rel="noopener">æ£‹ç›˜åˆ¶ä½œ</a>ï¼ˆå•è°ƒæ ˆï¼‰</h5><p>ä¼¼ä¹æ²¡æœ‰è½¬ç§»æ–¹ç¨‹</p><p>æ³¨æ„å•è°ƒæ ˆçš„å¤„ç†æ–¹å¼ï¼ˆç„å­¦æ–¹æ³•æˆ–é€šç”¨æ–¹æ³•ï¼‰ï¼Œåœ¨é€€æ ˆæ—¶åŠ¡å¿…é€€å¹²å‡€ã€‚</p></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç„å­¦æ–¹æ³•ï¼š</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N+<span class="number">1</span>;++i)&#123;</span><br><span class="line">    <span class="keyword">while</span>(cnt&gt;<span class="number">0</span>&amp;&amp;a[s[cnt]]&gt;=a[i])&#123;</span><br><span class="line">        ans=max(ans,(i-s[cnt<span class="number">-1</span>]<span class="number">-1</span>)*a[s[cnt]]);</span><br><span class="line">        cnt--;</span><br><span class="line">    &#125;</span><br><span class="line">    s[++cnt]=i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//é€šç”¨æ–¹æ³•ï¼š</span></span><br><span class="line">å…ˆå¤„ç†å‡ºæ¯ä¸ªä½ç½®å·¦è¾¹ç¬¬ä¸€ä¸ªæ¯”å®ƒå°çš„ï¼Œå†å¤„ç†å‡ºå³è¾¹ç¬¬ä¸€ä¸ªæ¯”å®ƒå°çš„ï¼Œæœ€åæšä¸¾</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ol&gt;
&lt;li&gt;&lt;h5 id=&quot;ä»»åŠ¡å®‰æ’ï¼ˆæ–œç‡ä¼˜åŒ–-è´¹ç”¨æå‰è®¡ç®—ï¼‰&quot;&gt;&lt;a href=&quot;#ä»»åŠ¡å®‰æ’ï¼ˆæ–œç‡ä¼˜åŒ–-è´¹ç”¨æå‰è®¡ç®—ï¼‰&quot; class=&quot;headerlink&quot; title=&quot;ä»»åŠ¡å®‰æ’ï¼ˆæ–œç‡ä¼˜åŒ–+è´¹ç”¨æå‰è®¡ç®—ï¼‰&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://loj.ac/pr
      
    
    </summary>
    
      <category term="é¢˜ç›®åˆ—è¡¨" scheme="https://tth37.cn/categories/%E9%A2%98%E7%9B%AE%E5%88%97%E8%A1%A8/"/>
    
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p1080å›½ç‹æ¸¸æˆ</title>
    <link href="https://tth37.cn/2019/01/26/solution-luogu-p1080/"/>
    <id>https://tth37.cn/2019/01/26/solution-luogu-p1080/</id>
    <published>2019-01-26T02:58:39.000Z</published>
    <updated>2019-05-12T13:00:29.465Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/P1080" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p></blockquote><p>é«˜ç²¾åº¦æ€èƒ½å°‘äº†Python3é¢˜è§£ã€‚ã€‚ã€‚</p><p>è´ªå¿ƒç­–ç•¥ä¸€æ¥¼dalaoå·²ç»è®²å¾—å¾ˆæ¸…æ¥šäº†ï¼Œä¸Šä¸€å‘è¶…çŸ­ä»£ç ï¼ˆå­¦Pythonå°±æ˜¯ä¸ºäº†æ°´é«˜ç²¾ï¼‰</p><a id="more"></a><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">N=int(input())</span><br><span class="line">s=input().split()</span><br><span class="line">S=int(s[<span class="number">0</span>])</span><br><span class="line">T=int(s[<span class="number">1</span>])</span><br><span class="line">a=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,N+<span class="number">1</span>):</span><br><span class="line">    k=input().split()</span><br><span class="line">    a.append((int(k[<span class="number">0</span>]),int(k[<span class="number">1</span>])))</span><br><span class="line">a.sort(key=<span class="keyword">lambda</span> x:x[<span class="number">0</span>]*x[<span class="number">1</span>])</span><br><span class="line">ans=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,N):</span><br><span class="line">    <span class="keyword">if</span>(S//(a[i])[<span class="number">1</span>]&gt;ans):</span><br><span class="line">        ans=S//(a[i])[<span class="number">1</span>]</span><br><span class="line">    S*=(a[i])[<span class="number">0</span>]</span><br><span class="line">print(ans)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/P1080&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é«˜ç²¾åº¦æ€èƒ½å°‘äº†Python3é¢˜è§£ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;è´ªå¿ƒç­–ç•¥ä¸€æ¥¼dalaoå·²ç»è®²å¾—å¾ˆæ¸…æ¥šäº†ï¼Œä¸Šä¸€å‘è¶…çŸ­ä»£ç ï¼ˆå­¦Pythonå°±æ˜¯ä¸ºäº†æ°´é«˜ç²¾ï¼‰&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="python" scheme="https://tth37.cn/tags/python/"/>
    
      <category term="è´ªå¿ƒ" scheme="https://tth37.cn/tags/%E8%B4%AA%E5%BF%83/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p1022è®¡ç®—å™¨çš„æ”¹è‰¯</title>
    <link href="https://tth37.cn/2018/12/19/solution-luogu-p1022/"/>
    <id>https://tth37.cn/2018/12/19/solution-luogu-p1022/</id>
    <published>2018-12-19T06:14:46.000Z</published>
    <updated>2019-07-18T14:47:45.284Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.luogu.org/problemnew/show/P1022" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p></blockquote><p>æœ¬é¢˜æ˜¯ä¸€é“éå¸¸æ¼‚äº®çš„æ¨¡æ‹Ÿã€‚åªè¦èƒ½ç†æ¸…æ€è·¯ï¼Œä»£ç å¹¶ä¸ä¼šç‰¹åˆ«å¤æ‚ã€‚</p><p>é¦–å…ˆåˆ†æé¢˜ç›®ã€‚è§£ä¸€å…ƒä¸€æ¬¡æ–¹ç¨‹æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ç§»é¡¹ï¼ŒæŠŠå¸¸æ•°ç§»åˆ°ç­‰å·å³ä¾§ï¼ŒæŠŠä¸€æ¬¡é¡¹ç³»æ•°ç§»åˆ°ç­‰å·å·¦ä¾§ï¼Œç”¨å¸¸æ•°é™¤ä»¥ç³»æ•°å³ä¸ºç­”æ¡ˆã€‚é‚£ä¹ˆåœ¨è¯»å…¥å­—ç¬¦ä¸²çš„è¿‡ç¨‹ä¸­ï¼Œä¾¿å¯ä»¥è¿›è¡Œæ“ä½œã€‚</p><p>å¯¹äºå­—ç¬¦ä¸²ä¸­çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç±»ä¼¼å¿«è¯»çš„æ–¹æ³•è¯»å…¥ã€‚ç„¶è€Œï¼Œè¦åˆ¤æ–­è¿™äº›æ•°æ®ä»å“ªé‡Œæ¥ï¼Œåˆ°å“ªé‡Œå»ï¼Œä¾¿æ˜¯æœ¬é¢˜çš„å…³é”®æ‰€åœ¨ã€‚</p><p>å¯¹äºæ¯ä¸ªæ•°æ®ï¼Œè¦æƒ³æ¸…æ¥šåœ°è¾¨åˆ«å®ƒçš„èº«ä»½ï¼Œæˆ‘ä»¬åªéœ€è§£å†³<strong>ä¸‰ä¸ªé—®é¢˜</strong>ï¼š</p><p><strong>1.è¯¥æ•°æ®æ˜¯æ­£æ•°è¿˜æ˜¯è´Ÿæ•°ï¼Ÿ</strong></p><p><strong>3.è¯¥æ•°æ®åœ¨ç­‰å·å·¦ä¾§è¿˜æ˜¯åœ¨ç­‰å·å³ä¾§ï¼Ÿ</strong></p><p><strong>2.è¯¥æ•°æ®æ˜¯å¸¸æ•°è¿˜æ˜¯ç³»æ•°ï¼Ÿ</strong></p><p>ç¬¬ä¸€ä¸ªé—®é¢˜çœ‹ä¼¼ååˆ†æ— è„‘ï¼Œç”¨ä¸€ä¸ªå˜é‡f1æ¥å­˜å‚¨ç¬¦å·å³å¯ï¼ˆå°†f1èµ‹å€¼ä¸º1æˆ–-1ï¼Œåœ¨è¯»å…¥æ•°æ®ç»“æŸæ—¶å°†å¾—åˆ°çš„æ•°æ®ä¹˜ä»¥f1ï¼‰ã€‚ä½†éœ€<strong>ç‰¹åˆ«æ³¨æ„</strong>ï¼Œåœ¨ä¸€ä¸ªè¡¨è¾¾å¼çš„å¼€å¤´ï¼ˆç­‰å·å·¦ä¾§å’Œç­‰å·å³ä¾§çš„è¡¨è¾¾å¼ï¼‰ä¸ä¼šæœ‰â€˜+â€™ã€â€˜-â€™ç¬¦å·ï¼Œæ‰€ä»¥åœ¨ç¨‹åºçš„å¼€å¤´å’Œè¯»å…¥â€˜=â€™å·æ˜¯ï¼Œè¦å°†f1èµ‹å€¼ä¸º1ã€‚</p><p>ç¬¬äºŒä¸ªé—®é¢˜ä¹Ÿéå¸¸ç®€å•ï¼Œå¯ä»¥ç”¨å˜é‡f2æ¥å­˜å‚¨ã€‚å› ä¸ºè¿™ä¸ªé—®é¢˜ä¸ç§»é¡¹è¿ç®—çš„ç¬¦å·æœ‰å…³ï¼Œå› æ­¤ä¹Ÿå¯ä»¥å°†f2èµ‹å€¼ä¸º1æˆ–-1ï¼Œå¹¶çº¦å®šåœ¨ç­‰å·å·¦ä¾§æ—¶f2ä¸º1ï¼Œåœ¨ç­‰å·å³ä¾§æ—¶f2ä¸º-1ã€‚ï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥åç€çº¦å®šï¼‰</p><p>ç¬¬ä¸‰ä¸ªé—®é¢˜åŒæ ·ä¸éš¾è§£å†³ã€‚åœ¨è¯»å…¥æ•°æ®ç»“æŸåï¼ˆ<strong>å³è¯»å…¥äº†ä¸€ä¸ªç¬¦å·</strong>ï¼‰ï¼Œåˆ¤æ–­è¿™ä¸ªç¬¦å·æ˜¯è¿ç®—ç¬¦è¿˜æ˜¯å­—æ¯å³å¯ã€‚å¦‚æœæ˜¯å­—æ¯ï¼Œåˆ™å°†å¾—åˆ°çš„æ•°æ®ç§»åˆ°ç­‰å·å³ä¾§ï¼Œå¦åˆ™å°†æ•°æ®ç§»åˆ°ç­‰å·å·¦ä¾§ã€‚ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ª<strong>æ³¨æ„ç‚¹</strong>ï¼šå¦‚æœä¸€ä¸ªæœªçŸ¥æ•°çš„ç³»æ•°ä¸º1ï¼Œæˆ‘ä»¬ä¼šå°†ç³»æ•°çœç•¥ã€‚å› æ­¤åœ¨è¯»å…¥æ•°æ®ä¸º0æ—¶ï¼Œæˆ‘ä»¬è¦å°†å…¶æ›´æ”¹ä¸º1ã€‚</p><p>ç»è¿‡åˆ†æï¼Œä½ ä¼šå‘ç°æœ¬é¢˜ä¸€ç‚¹ä¹Ÿä¸éš¾å®ç°ã€‚å…¶å…³é”®åœ¨äºå¯¹æ•°æ®çŠ¶æ€çš„å‡†ç¡®æè¿°ã€‚ç”¨æ¸…æ™°ã€ç®€æ´çš„å˜é‡æè¿°çŠ¶æ€ï¼Œæ ¹æ®ä¸åŒçš„çŠ¶æ€é‡‡å–ä¸åŒçš„æªæ–½ï¼Œè¿™ä¾¿æ˜¯ç¼–ç¨‹å­¦ä¹ çš„ä¸€å¤§åŸºæœ¬ç´ å…»ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><a id="more"></a><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> l,r;<span class="comment">//lä»£è¡¨ç³»æ•°ï¼Œrä»£è¡¨å¸¸æ•° </span></span><br><span class="line"><span class="keyword">char</span> x; <span class="comment">//ç”¨xå­˜å‚¨å­—æ¯ </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> c;</span><br><span class="line">    <span class="keyword">int</span> f1=<span class="number">1</span>,f2=<span class="number">1</span>,tmp=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%c"</span>,&amp;c))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>)<span class="comment">//ç±»ä¼¼å¿«è¯»çš„è¯»å…¥æ–¹å¼ </span></span><br><span class="line">        &#123;</span><br><span class="line">            tmp*=<span class="number">10</span>;</span><br><span class="line">            tmp+=c-<span class="string">'0'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(c&gt;=<span class="string">'a'</span>&amp;&amp;c&lt;=<span class="string">'z'</span>) l+=(tmp==<span class="number">0</span>)?f2*f1:tmp*f2*f1,x=c;<span class="comment">//åˆ¤æ–­ç³»æ•°æ˜¯å¦ä¸º1 </span></span><br><span class="line">            <span class="keyword">else</span> r+=tmp*(-f2)*f1;</span><br><span class="line">            tmp=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(c==<span class="string">'+'</span>) &#123;f1=<span class="number">1</span>;<span class="keyword">continue</span>;&#125;</span><br><span class="line">        <span class="keyword">if</span>(c==<span class="string">'-'</span>) &#123;f1=<span class="number">-1</span>;<span class="keyword">continue</span>;&#125;</span><br><span class="line">        <span class="keyword">if</span>(c==<span class="string">'='</span>) &#123;f2=<span class="number">-1</span>;f1=<span class="number">1</span>;<span class="keyword">continue</span>;&#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    solve(); </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%c=%0.3f"</span>,x,(<span class="keyword">float</span>)r/l==<span class="number">0</span>?<span class="built_in">abs</span>((<span class="keyword">float</span>)r/l):(<span class="keyword">float</span>)r/l);</span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.org/problemnew/show/P1022&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æœ¬é¢˜æ˜¯ä¸€é“éå¸¸æ¼‚äº®çš„æ¨¡æ‹Ÿã€‚åªè¦èƒ½ç†æ¸…æ€è·¯ï¼Œä»£ç å¹¶ä¸ä¼šç‰¹åˆ«å¤æ‚ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆåˆ†æé¢˜ç›®ã€‚è§£ä¸€å…ƒä¸€æ¬¡æ–¹ç¨‹æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ç§»é¡¹ï¼ŒæŠŠå¸¸æ•°ç§»åˆ°ç­‰å·å³ä¾§ï¼ŒæŠŠä¸€æ¬¡é¡¹ç³»æ•°ç§»åˆ°ç­‰å·å·¦ä¾§ï¼Œç”¨å¸¸æ•°é™¤ä»¥ç³»æ•°å³ä¸ºç­”æ¡ˆã€‚é‚£ä¹ˆåœ¨è¯»å…¥å­—ç¬¦ä¸²çš„è¿‡ç¨‹ä¸­ï¼Œä¾¿å¯ä»¥è¿›è¡Œæ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºå­—ç¬¦ä¸²ä¸­çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç±»ä¼¼å¿«è¯»çš„æ–¹æ³•è¯»å…¥ã€‚ç„¶è€Œï¼Œè¦åˆ¤æ–­è¿™äº›æ•°æ®ä»å“ªé‡Œæ¥ï¼Œåˆ°å“ªé‡Œå»ï¼Œä¾¿æ˜¯æœ¬é¢˜çš„å…³é”®æ‰€åœ¨ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºæ¯ä¸ªæ•°æ®ï¼Œè¦æƒ³æ¸…æ¥šåœ°è¾¨åˆ«å®ƒçš„èº«ä»½ï¼Œæˆ‘ä»¬åªéœ€è§£å†³&lt;strong&gt;ä¸‰ä¸ªé—®é¢˜&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1.è¯¥æ•°æ®æ˜¯æ­£æ•°è¿˜æ˜¯è´Ÿæ•°ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3.è¯¥æ•°æ®åœ¨ç­‰å·å·¦ä¾§è¿˜æ˜¯åœ¨ç­‰å·å³ä¾§ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2.è¯¥æ•°æ®æ˜¯å¸¸æ•°è¿˜æ˜¯ç³»æ•°ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªé—®é¢˜çœ‹ä¼¼ååˆ†æ— è„‘ï¼Œç”¨ä¸€ä¸ªå˜é‡f1æ¥å­˜å‚¨ç¬¦å·å³å¯ï¼ˆå°†f1èµ‹å€¼ä¸º1æˆ–-1ï¼Œåœ¨è¯»å…¥æ•°æ®ç»“æŸæ—¶å°†å¾—åˆ°çš„æ•°æ®ä¹˜ä»¥f1ï¼‰ã€‚ä½†éœ€&lt;strong&gt;ç‰¹åˆ«æ³¨æ„&lt;/strong&gt;ï¼Œåœ¨ä¸€ä¸ªè¡¨è¾¾å¼çš„å¼€å¤´ï¼ˆç­‰å·å·¦ä¾§å’Œç­‰å·å³ä¾§çš„è¡¨è¾¾å¼ï¼‰ä¸ä¼šæœ‰â€˜+â€™ã€â€˜-â€™ç¬¦å·ï¼Œæ‰€ä»¥åœ¨ç¨‹åºçš„å¼€å¤´å’Œè¯»å…¥â€˜=â€™å·æ˜¯ï¼Œè¦å°†f1èµ‹å€¼ä¸º1ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒä¸ªé—®é¢˜ä¹Ÿéå¸¸ç®€å•ï¼Œå¯ä»¥ç”¨å˜é‡f2æ¥å­˜å‚¨ã€‚å› ä¸ºè¿™ä¸ªé—®é¢˜ä¸ç§»é¡¹è¿ç®—çš„ç¬¦å·æœ‰å…³ï¼Œå› æ­¤ä¹Ÿå¯ä»¥å°†f2èµ‹å€¼ä¸º1æˆ–-1ï¼Œå¹¶çº¦å®šåœ¨ç­‰å·å·¦ä¾§æ—¶f2ä¸º1ï¼Œåœ¨ç­‰å·å³ä¾§æ—¶f2ä¸º-1ã€‚ï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥åç€çº¦å®šï¼‰&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰ä¸ªé—®é¢˜åŒæ ·ä¸éš¾è§£å†³ã€‚åœ¨è¯»å…¥æ•°æ®ç»“æŸåï¼ˆ&lt;strong&gt;å³è¯»å…¥äº†ä¸€ä¸ªç¬¦å·&lt;/strong&gt;ï¼‰ï¼Œåˆ¤æ–­è¿™ä¸ªç¬¦å·æ˜¯è¿ç®—ç¬¦è¿˜æ˜¯å­—æ¯å³å¯ã€‚å¦‚æœæ˜¯å­—æ¯ï¼Œåˆ™å°†å¾—åˆ°çš„æ•°æ®ç§»åˆ°ç­‰å·å³ä¾§ï¼Œå¦åˆ™å°†æ•°æ®ç§»åˆ°ç­‰å·å·¦ä¾§ã€‚ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ª&lt;strong&gt;æ³¨æ„ç‚¹&lt;/strong&gt;ï¼šå¦‚æœä¸€ä¸ªæœªçŸ¥æ•°çš„ç³»æ•°ä¸º1ï¼Œæˆ‘ä»¬ä¼šå°†ç³»æ•°çœç•¥ã€‚å› æ­¤åœ¨è¯»å…¥æ•°æ®ä¸º0æ—¶ï¼Œæˆ‘ä»¬è¦å°†å…¶æ›´æ”¹ä¸º1ã€‚&lt;/p&gt;
&lt;p&gt;ç»è¿‡åˆ†æï¼Œä½ ä¼šå‘ç°æœ¬é¢˜ä¸€ç‚¹ä¹Ÿä¸éš¾å®ç°ã€‚å…¶å…³é”®åœ¨äºå¯¹æ•°æ®çŠ¶æ€çš„å‡†ç¡®æè¿°ã€‚ç”¨æ¸…æ™°ã€ç®€æ´çš„å˜é‡æè¿°çŠ¶æ€ï¼Œæ ¹æ®ä¸åŒçš„çŠ¶æ€é‡‡å–ä¸åŒçš„æªæ–½ï¼Œè¿™ä¾¿æ˜¯ç¼–ç¨‹å­¦ä¹ çš„ä¸€å¤§åŸºæœ¬ç´ å…»ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="æ•°å­¦" scheme="https://tth37.cn/tags/%E6%95%B0%E5%AD%A6/"/>
    
      <category term="å­—ç¬¦ä¸²" scheme="https://tth37.cn/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£-luogu-p1204æŒ¤ç‰›å¥¶</title>
    <link href="https://tth37.cn/2018/12/15/solution-luogu-p1204/"/>
    <id>https://tth37.cn/2018/12/15/solution-luogu-p1204/</id>
    <published>2018-12-15T06:51:52.000Z</published>
    <updated>2019-05-12T13:00:14.587Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href>é¢˜ç›®é“¾æ¥</a></p></blockquote><p>ä»‹ç»ä¸€ç§æœ¬é¢˜çš„è´ªå¿ƒè§£æ³•ã€‚</p><p>æœ¬é¢˜è¦æ±‚è¯»å…¥ä¸€äº›æŒ¤ç‰›å¥¶çš„æ—¶é—´æ®µï¼Œæ±‚æœ€é•¿è‡³å°‘æœ‰ä¸€äººåœ¨æŒ¤ç‰›å¥¶çš„æ—¶é—´æ®µå’Œæœ€é•¿æ²¡æœ‰äººåœ¨æŒ¤ç‰›å¥¶çš„æ—¶é—´æ®µã€‚æŠŠè¯»å…¥çš„åŒºé—´è§†ä½œçº¿æ®µï¼Œåˆ™é¢˜æ„è½¬å˜ä¸º<strong>æ±‚è‡³å°‘æœ‰ä¸€æ¡çº¿æ®µè¦†ç›–çš„æœ€å¤§åŒºé—´å’Œæ²¡æœ‰çº¿æ®µè¦†ç›–çš„åŒºé—´</strong>ã€‚</p><p>å‡è®¾è¯»å…¥æ•°æ®å¦‚ä¸‹ï¼š<br><img src="https://cdn.luogu.org/upload/pic/46260.png" alt="fig"></p><p>é¦–å…ˆæŒ‰ç…§4æ¡çº¿æ®µçš„èµ·ç‚¹ä½ç½®æ’åºï¼ˆå…·ä½“åŸå› åé¢è§£é‡Šï¼‰ã€‚å°†beginè®¾ç½®ä¸ºç¬¬ä¸€æ¡çº¿æ®µçš„èµ·ç‚¹ï¼Œå°†endè®¾ç½®ä¸ºç¬¬ä¸€æ¡çº¿æ®µçš„ç»ˆç‚¹ã€‚</p><p>ç„¶åä»ç¬¬äºŒæ¡çº¿æ®µå¼€å§‹åˆ¤æ–­ã€‚å¦‚æœè¯¥çº¿æ®µçš„èµ·ç‚¹å°äºendï¼Œåˆ™è¯´æ˜è¿™ä¸¤æ¡çº¿æ®µæœ‰é‡åˆéƒ¨åˆ†ï¼Œå°†endæ›´æ–°ä¸ºmax{end,è¯¥çº¿æ®µçš„ç»ˆç‚¹ä½ç½®}ã€‚å¦‚æœè¯¥çº¿æ®µçš„èµ·ç‚¹å¤§äºendï¼Œåˆ™è¯´æ˜è¯¥çº¿æ®µåŠä»¥åçš„çº¿æ®µå†ä¹Ÿä¸ä¼šä¸å‰é¢çš„çº¿æ®µäº§ç”Ÿä»»ä½•é‡åˆéƒ¨åˆ†ï¼ˆè¿™ä¹Ÿå°±æ˜¯æ’åºçš„ä½œç”¨ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥æ›´æ–°ans1å’Œans2çš„å€¼ï¼šans1æ›´æ–°ä¸ºmax{ans1,end-begin},ans2æ›´æ–°ä¸ºmax{ans2,è¯¥çº¿æ®µçš„èµ·ç‚¹ä½ç½®-end}ã€‚å…·ä½“å‚è§å›¾ä¸­ç¬¬4æ¡çº¿æ®µï¼Œans1è¢«æ›´æ–°ä¸º1200-0ï¼Œans2è¢«æ›´æ–°ä¸º1400-1200ã€‚</p><p>ç¨‹åºå·²ç»åŸºæœ¬æˆå‹ï¼Œä½†è¦æ³¨æ„åœ¨è¾“å‡ºç­”æ¡ˆå‰æ›´æ–°ä¸€éans1çš„å€¼ï¼Œè¿™æ˜¯ä¸ºäº†é¿å…æ‰€æœ‰çº¿æ®µå‡æœ‰é‡åˆéƒ¨åˆ†è€Œæ— æ³•åˆ¤æ–­çš„æƒ…å†µã€‚å¦å¤–ï¼Œans1å’Œans2è¦åˆå§‹åŒ–ä¸º0ã€‚</p><p>ç¨‹åºå¦‚ä¸‹ï¼š</p><a id="more"></a><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N; </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> begin,end;</span><br><span class="line">&#125;m[<span class="number">5005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node a,node b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a.begin&lt;b.begin;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;N);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;m[i].begin,&amp;m[i].end);</span><br><span class="line">sort(m+<span class="number">1</span>,m+<span class="number">1</span>+N,cmp);</span><br><span class="line"><span class="keyword">int</span> begin=m[<span class="number">1</span>].begin;</span><br><span class="line"><span class="keyword">int</span> end=m[<span class="number">1</span>].end;</span><br><span class="line"><span class="keyword">int</span> ans1=<span class="number">0</span>,ans2=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=N;++i)&#123;</span><br><span class="line"><span class="keyword">if</span>(m[i].begin&lt;=end)</span><br><span class="line">end=max(end,m[i].end);</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">ans1=max(ans1,end-begin);</span><br><span class="line">ans2=max(ans2,m[i].begin-end);</span><br><span class="line">begin=m[i].begin;</span><br><span class="line">end=m[i].end;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">ans1=max(ans1,end-begin);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d %d"</span>,ans1,ans2);</span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href&gt;é¢˜ç›®é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä»‹ç»ä¸€ç§æœ¬é¢˜çš„è´ªå¿ƒè§£æ³•ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬é¢˜è¦æ±‚è¯»å…¥ä¸€äº›æŒ¤ç‰›å¥¶çš„æ—¶é—´æ®µï¼Œæ±‚æœ€é•¿è‡³å°‘æœ‰ä¸€äººåœ¨æŒ¤ç‰›å¥¶çš„æ—¶é—´æ®µå’Œæœ€é•¿æ²¡æœ‰äººåœ¨æŒ¤ç‰›å¥¶çš„æ—¶é—´æ®µã€‚æŠŠè¯»å…¥çš„åŒºé—´è§†ä½œçº¿æ®µï¼Œåˆ™é¢˜æ„è½¬å˜ä¸º&lt;strong&gt;æ±‚è‡³å°‘æœ‰ä¸€æ¡çº¿æ®µè¦†ç›–çš„æœ€å¤§åŒºé—´å’Œæ²¡æœ‰çº¿æ®µè¦†ç›–çš„åŒºé—´&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾è¯»å…¥æ•°æ®å¦‚ä¸‹ï¼š&lt;br&gt;&lt;img src=&quot;https://cdn.luogu.org/upload/pic/46260.png&quot; alt=&quot;fig&quot;&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæŒ‰ç…§4æ¡çº¿æ®µçš„èµ·ç‚¹ä½ç½®æ’åºï¼ˆå…·ä½“åŸå› åé¢è§£é‡Šï¼‰ã€‚å°†beginè®¾ç½®ä¸ºç¬¬ä¸€æ¡çº¿æ®µçš„èµ·ç‚¹ï¼Œå°†endè®¾ç½®ä¸ºç¬¬ä¸€æ¡çº¿æ®µçš„ç»ˆç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åä»ç¬¬äºŒæ¡çº¿æ®µå¼€å§‹åˆ¤æ–­ã€‚å¦‚æœè¯¥çº¿æ®µçš„èµ·ç‚¹å°äºendï¼Œåˆ™è¯´æ˜è¿™ä¸¤æ¡çº¿æ®µæœ‰é‡åˆéƒ¨åˆ†ï¼Œå°†endæ›´æ–°ä¸ºmax{end,è¯¥çº¿æ®µçš„ç»ˆç‚¹ä½ç½®}ã€‚å¦‚æœè¯¥çº¿æ®µçš„èµ·ç‚¹å¤§äºendï¼Œåˆ™è¯´æ˜è¯¥çº¿æ®µåŠä»¥åçš„çº¿æ®µå†ä¹Ÿä¸ä¼šä¸å‰é¢çš„çº¿æ®µäº§ç”Ÿä»»ä½•é‡åˆéƒ¨åˆ†ï¼ˆè¿™ä¹Ÿå°±æ˜¯æ’åºçš„ä½œç”¨ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥æ›´æ–°ans1å’Œans2çš„å€¼ï¼šans1æ›´æ–°ä¸ºmax{ans1,end-begin},ans2æ›´æ–°ä¸ºmax{ans2,è¯¥çº¿æ®µçš„èµ·ç‚¹ä½ç½®-end}ã€‚å…·ä½“å‚è§å›¾ä¸­ç¬¬4æ¡çº¿æ®µï¼Œans1è¢«æ›´æ–°ä¸º1200-0ï¼Œans2è¢«æ›´æ–°ä¸º1400-1200ã€‚&lt;/p&gt;
&lt;p&gt;ç¨‹åºå·²ç»åŸºæœ¬æˆå‹ï¼Œä½†è¦æ³¨æ„åœ¨è¾“å‡ºç­”æ¡ˆå‰æ›´æ–°ä¸€éans1çš„å€¼ï¼Œè¿™æ˜¯ä¸ºäº†é¿å…æ‰€æœ‰çº¿æ®µå‡æœ‰é‡åˆéƒ¨åˆ†è€Œæ— æ³•åˆ¤æ–­çš„æƒ…å†µã€‚å¦å¤–ï¼Œans1å’Œans2è¦åˆå§‹åŒ–ä¸º0ã€‚&lt;/p&gt;
&lt;p&gt;ç¨‹åºå¦‚ä¸‹ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="è´ªå¿ƒ" scheme="https://tth37.cn/tags/%E8%B4%AA%E5%BF%83/"/>
    
      <category term="æ’åº" scheme="https://tth37.cn/tags/%E6%8E%92%E5%BA%8F/"/>
    
  </entry>
  
</feed>
