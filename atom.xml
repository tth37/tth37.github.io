<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>tth37&#39;s Blog</title>
  
  <subtitle>Think twice, Code once</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://tth37.cn/"/>
  <updated>2019-12-01T17:30:21.054Z</updated>
  <id>https://tth37.cn/</id>
  
  <author>
    <name>tth37</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>「NOI2014」动物园</title>
    <link href="https://tth37.cn/2019/12/02/solution-loj-2246/"/>
    <id>https://tth37.cn/2019/12/02/solution-loj-2246/</id>
    <published>2019-12-01T17:15:35.000Z</published>
    <updated>2019-12-01T17:30:21.054Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://loj.ac/problem/2246" target="_blank" rel="noopener">#2246. 「NOI2014」动物园</a></p><h3 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h3><p>题目概括征集中~</p><a id="more"></a><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>回顾一下我们在 <a href="https://tth37.cn/2019/12/01/algorithm-exkmp/">扩展 KMP</a> 算法中求出的 $\text{next}$ 函数：$\text{next}[i]$ 表示后缀 $i$ 即 $T[i..|T|]$ 与 $T$ 的最长公共前缀。 </p><p>如果我们对读入的字符串已经求出了 $\text{next}$ 数组，那么这题就迎刃而解了。</p><p>首先，我们不考虑 <em>前后缀不可重叠</em> 的限制，尝试计算 $\text{num}$ 数组。观察字符串 $S$ 的每一个后缀 $i$，不难发现这些后缀将对 $\text{num}[i..i+\text{next}[i]-1]$ 产生贡献。</p><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0 1 2 3 4</span><br><span class="line">a b a b a</span><br><span class="line"></span><br><span class="line">a    a b    a b a</span><br><span class="line">|    | |    | | |</span><br><span class="line">a    a b    a b a</span><br></pre></td></tr></table></figure><p>如果考虑 <em>前后缀不可重叠</em> 的限制条件，可以发现后缀 $i$ 不会对 $i\times 2$ 及以后的 $\text{num}$ 产生贡献。</p><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0 1 2 3 4</span><br><span class="line">a b a b a</span><br><span class="line"></span><br><span class="line">a    a b    a b a</span><br><span class="line">|    | |    X X X</span><br><span class="line">a    a b    a b a</span><br></pre></td></tr></table></figure><p>只需对 $\text{num}$ 数组进行差分即可。</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> next next233</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">1e6</span> + <span class="hljs-number">5</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MOD = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> next[MAXN], num[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">exKMP_pre</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *T)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">int</span> n = <span class="hljs-built_in">strlen</span>(T);</span><br><span class="line">    next[<span class="hljs-number">0</span>] = n;</span><br><span class="line">    <span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> (p + <span class="hljs-number">1</span> &lt; n &amp;&amp; T[p] == T[p + <span class="hljs-number">1</span>]) p++;</span><br><span class="line">    next[<span class="hljs-number">1</span>] = p;</span><br><span class="line">    <span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> x = <span class="hljs-number">2</span>; x &lt; n; ++x) &#123;</span><br><span class="line">        p = k + next[k] - <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">int</span> l = next[x - k];</span><br><span class="line">        <span class="hljs-keyword">if</span> (x + l &lt;= p) next[x] = l;</span><br><span class="line">        <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> j = p - x + <span class="hljs-number">1</span>;</span><br><span class="line">            <span class="hljs-keyword">if</span> (j &lt; <span class="hljs-number">0</span>) j = <span class="hljs-number">0</span>;</span><br><span class="line">            <span class="hljs-keyword">while</span> (x + j &lt; n &amp;&amp; T[x + j] == T[j]) j++;</span><br><span class="line">            next[x] = j;</span><br><span class="line">            k = x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> T, ans;</span><br><span class="line"><span class="hljs-keyword">char</span> a[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="hljs-keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="hljs-built_in">memset</span>(next, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(next));</span><br><span class="line">        <span class="hljs-built_in">memset</span>(num, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(num));</span><br><span class="line">        <span class="hljs-built_in">cin</span> &gt;&gt; a;</span><br><span class="line">        exKMP_pre(a);</span><br><span class="line">        <span class="hljs-keyword">int</span> n = <span class="hljs-built_in">strlen</span>(a);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="hljs-keyword">if</span> (next[i]) &#123;</span><br><span class="line">                num[i] ++;</span><br><span class="line">                num[min(i + next[i], i &lt;&lt; <span class="hljs-number">1</span>)]--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ans = <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            num[i] += num[i - <span class="hljs-number">1</span>];</span><br><span class="line">            ans = <span class="hljs-number">1l</span>l * ans * (num[i] + <span class="hljs-number">1</span>) % MOD;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://loj.ac/problem/2246&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;#2246. 「NOI2014」动物园&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h3&gt;&lt;p&gt;题目概括征集中~&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
    
      <category term="KMP" scheme="https://tth37.cn/tags/KMP/"/>
    
      <category term="差分" scheme="https://tth37.cn/tags/%E5%B7%AE%E5%88%86/"/>
    
  </entry>
  
  <entry>
    <title>扩展 KMP</title>
    <link href="https://tth37.cn/2019/12/01/algorithm-exkmp/"/>
    <id>https://tth37.cn/2019/12/01/algorithm-exkmp/</id>
    <published>2019-12-01T15:43:05.000Z</published>
    <updated>2019-12-01T16:41:14.378Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>本文源自计蒜客课件，<strong>切勿外传！</strong></p></blockquote><p>扩展 KMP 能在 $O(|S|+|T|)$ 时间复杂度内处理出字符串 $S$ 的所有后缀与字符串 $T$ 的最长公共前缀。</p><p>之所以称为扩展 KMP，是因为其思想和 KMP 算法很类似。</p><a id="more"></a><h3 id="text-next-函数"><a href="#text-next-函数" class="headerlink" title="$\text{next}$ 函数"></a>$\text{next}$ 函数</h3><p>记 $\text{next}[i]$ 表示后缀 $i$ 即 $T[i..|T|]$ 与 $T$ 的最长公共前缀。 </p><p>例如：</p><table><thead><tr><th align="center">数组索引</th><th align="center">0</th><th align="center">1</th><th align="center">2</th><th align="center">3</th><th align="center">4</th><th align="center">5</th><th align="center">6</th><th align="center">7</th><th align="center">8</th></tr></thead><tbody><tr><td align="center">字符串数组</td><td align="center">a</td><td align="center">a</td><td align="center">a</td><td align="center">b</td><td align="center">a</td><td align="center">a</td><td align="center">a</td><td align="center">a</td><td align="center">b</td></tr><tr><td align="center">$\text{next}$ 数组</td><td align="center">9</td><td align="center">2</td><td align="center">1</td><td align="center">0</td><td align="center">3</td><td align="center">4</td><td align="center">2</td><td align="center">1</td><td align="center">0</td></tr></tbody></table><p>注意 $\text{next}$ 数组是对于 <strong>模式串 $T$</strong> 构建的。</p><h3 id="如何获取-text-next-函数"><a href="#如何获取-text-next-函数" class="headerlink" title="如何获取 $\text{next}$ 函数"></a>如何获取 $\text{next}$ 函数</h3><p>假设 $\text{next}[i](0\le i&lt;x)$ 的值都已经求出，现在要求 $\text{next}[x]$。</p><p>假设 $p=\max\lbrace i+\text{next}[i]-1\rbrace$ 对于所有 $0&lt; i &lt; x$，我们找到 $i+next[i]-1$ 的最大值，令 $k$ 为这个最大值对应的 $i$，令 $p$ 为 $k+\text{next}[k]-1$，$p$ 就是我们目前已知的匹配到的最远位置。</p><p>根据定义我们可以得到： $T[k..p]=T[0..\text{next}[k]-1]$，如下图所示蓝色部分：</p><p><img src="https://res.jisuanke.com/img/upload/20180516/6cb6bc2387e42ba0a7ee4dcfe9332b9eb0b58f37.png" alt></p><p>现在我们要求 $T[x..n-1]$ 与 $T[0..n-1]$ 的最长公共前缀。</p><p>由 $T[k..p]=T[0..\text{next}[k]-1]$ 得：</p><p>$T[x..p]=T[x-k..\text{next}[k]-1]$，如下图所示红色部分：</p><p><img src="https://res.jisuanke.com/img/upload/20180516/0dd52d39385ff16ee85cc915742fc3d1c62ae173.png" alt></p><p>设 $l=\text{next}[x-k]$，根据下图，可以得到：</p><p>$T[0..l-1]=T[x-k..x-k+l-1]=T[x..x+l-1]$，如下图所示黄色部分：</p><p><img src="https://res.jisuanke.com/img/upload/20180516/d9cb7344732ed21100f545c2b38119074d6bf7d2.png" alt></p><p>也就是说，如果图中黄色部分小于红色部分，也就是 $l&lt;p-x+1$ 即 $x+l\le p$，那么我们可以确定 $\text{next}[x]=l$。否则，我们从 $p-x+1$ 和 $p+1$ 位置开始逐一比较，求出 $\text{next}[x]$ 的值。</p><p>由于在这个过程中， $p$ 满足不下降性质，因此总体时间复杂度为 $O(n)$。</p><h3 id="获取-text-next-函数的代码实现"><a href="#获取-text-next-函数的代码实现" class="headerlink" title="获取 $\text{next}$ 函数的代码实现"></a>获取 $\text{next}$ 函数的代码实现</h3><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">exKMP_pre</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *T)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">int</span> n = <span class="hljs-built_in">strlen</span>(T);</span><br><span class="line">    next[<span class="hljs-number">0</span>] = n;</span><br><span class="line">    <span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> (p + <span class="hljs-number">1</span> &lt; n &amp;&amp; T[p] == T[p + <span class="hljs-number">1</span>]) p++;</span><br><span class="line">    next[<span class="hljs-number">1</span>] = p;</span><br><span class="line">    <span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> x = <span class="hljs-number">2</span>; x &lt; n; ++x) &#123;</span><br><span class="line">        p = k + next[k] - <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">int</span> l = next[x - k];</span><br><span class="line">        <span class="hljs-keyword">if</span> (x + l &lt;= p) next[x] = l;</span><br><span class="line">        <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> j = p - x + <span class="hljs-number">1</span>;</span><br><span class="line">            <span class="hljs-keyword">if</span> (j &lt; <span class="hljs-number">0</span>) j = <span class="hljs-number">0</span>;</span><br><span class="line">            <span class="hljs-keyword">while</span> (x + j &lt; n &amp;&amp; T[x + j] == T[j]) j++;</span><br><span class="line">            next[x] = j;</span><br><span class="line">            k = x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="解决原问题"><a href="#解决原问题" class="headerlink" title="解决原问题"></a>解决原问题</h3><p>记 $\text{extend}[i]$ 表示字符串 $S$ 的第 $i$ 个后缀和 $T$ 的最长公共前缀。假设 $\text{extend}[i](0\le i&lt;x)$ 已经求出，现在需要计算 $\text{extend}[x]$。</p><p>已知：$S[k..p]=T[0..\text{extend}[k]]$，求 $S[x..n]$ 与 $T[0..m]$ 的最长公共前缀。解法与计算 $\text{next}$ 的方法类似，记录 $p=i+\text{extend[i]}-1$ 的最大值。</p><p><img src="https://res.jisuanke.com/img/upload/20180516/761b7f45f24395bab2e469d658b7353672480a4e.png" alt></p><p>根据红色部分的等价，我们可以利用 $\text{next}[x-k]$ 得到黄色部分等价性，剩下的分析就和求 $\text{next}$ 的过程一样了。</p><h3 id="获取-text-extend-函数的代码实现"><a href="#获取-text-extend-函数的代码实现" class="headerlink" title="获取 $\text{extend}$ 函数的代码实现"></a>获取 $\text{extend}$ 函数的代码实现</h3><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">exKMP</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *S, <span class="hljs-keyword">char</span> *T)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">int</span> n = <span class="hljs-built_in">strlen</span>(T), m = <span class="hljs-built_in">strlen</span>(S);</span><br><span class="line">    <span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> (p &lt; m &amp;&amp; p &lt; n &amp;&amp; S[p] == T[p]) p++;</span><br><span class="line">    extend[<span class="hljs-number">0</span>] = p;</span><br><span class="line">    <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> x = <span class="hljs-number">1</span>; x &lt; m; ++x) &#123;</span><br><span class="line">        p = k + extend[k] - <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">int</span> l = next[x - k];</span><br><span class="line">        <span class="hljs-keyword">if</span> (x + l &lt;= p) extend[x] = l;</span><br><span class="line">        <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> j = p - x + <span class="hljs-number">1</span>;</span><br><span class="line">            <span class="hljs-keyword">if</span> (j &lt; <span class="hljs-number">0</span>) j = <span class="hljs-number">0</span>;</span><br><span class="line">            <span class="hljs-keyword">while</span> (x + j &lt; m &amp;&amp; j &lt; n &amp;&amp; S[x + j] == T[j]) j++;</span><br><span class="line">            extend[x] = j;</span><br><span class="line">            k = x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;本文源自计蒜客课件，&lt;strong&gt;切勿外传！&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;扩展 KMP 能在 $O(|S|+|T|)$ 时间复杂度内处理出字符串 $S$ 的所有后缀与字符串 $T$ 的最长公共前缀。&lt;/p&gt;
&lt;p&gt;之所以称为扩展 KMP，是因为其思想和 KMP 算法很类似。&lt;/p&gt;
    
    </summary>
    
      <category term="算法学习" scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="字符串" scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    
    
      <category term="KMP" scheme="https://tth37.cn/tags/KMP/"/>
    
  </entry>
  
  <entry>
    <title>「CEOI2018」云计算</title>
    <link href="https://tth37.cn/2019/11/23/solution-loj-3182/"/>
    <id>https://tth37.cn/2019/11/23/solution-loj-3182/</id>
    <published>2019-11-23T14:52:04.000Z</published>
    <updated>2019-11-24T15:34:08.088Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://loj.ac/problem/3182" target="_blank" rel="noopener">#3182. 「CEOI2018」云计算</a></p><h3 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h3><p>题目概括征集中~ 球球你再帮我写几篇吧 TAT @oykz2333</p><a id="more"></a><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><blockquote><p>这题也太巧妙了叭！ ——tth37</p></blockquote><p>考虑<strong>类似背包</strong>的动态规划。记 $f[i]$ 表示满足订单后恰好剩余 $i$ 个核心的最大利润。</p><p>先不考虑时钟频率的限制条件，则问题可以转化为普通背包问题：将计算机的价格视为负数，将订单的核心数视为负数，采用背包问题的状态转移即可。</p><p>如果考虑到时钟频率的限制，则需要满足：在将每个订单放入背包之前，必须将所有时钟频率大于等于该订单的计算机放入背包中。</p><p>将计算机和订单按照时钟频率排序后，依次加入背包即可。</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">2005</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Node</span> &#123;</span></span><br><span class="line">    <span class="hljs-keyword">int</span> c, f, v;</span><br><span class="line">    <span class="hljs-keyword">bool</span> type;</span><br><span class="line">&#125;a[MAXN * <span class="hljs-number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(Node a, Node b)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (a.f != b.f) <span class="hljs-keyword">return</span> a.f &gt; b.f;</span><br><span class="line">    <span class="hljs-keyword">return</span> a.type &lt; b.type;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> n, m, tot;</span><br><span class="line">ll f[MAXN * <span class="hljs-number">50</span>];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d"</span>, &amp;a[i].c, &amp;a[i].f, &amp;a[i].v), a[i].type = <span class="hljs-number">0</span>, tot += a[i].c;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;m);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d"</span>, &amp;a[n + i].c, &amp;a[n + i].f, &amp;a[n + i].v), a[n + i].type = <span class="hljs-number">1</span>;</span><br><span class="line">    sort(a + <span class="hljs-number">1</span>, a + n + m + <span class="hljs-number">1</span>, cmp);</span><br><span class="line">    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0xcf</span>, <span class="hljs-keyword">sizeof</span>(f));</span><br><span class="line">    f[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n + m; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">if</span> (a[i].type == <span class="hljs-number">0</span>) &#123;</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = tot; j &gt;= a[i].c; --j)</span><br><span class="line">                f[j] = max(f[j], f[j - a[i].c] - a[i].v);</span><br><span class="line">        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= tot - a[i].c; ++j)</span><br><span class="line">                f[j] = max(f[j], f[j + a[i].c] + a[i].v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= tot; ++i)</span><br><span class="line">        ans = max(ans, f[i]);</span><br><span class="line">    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%lld"</span>, ans);</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://loj.ac/problem/3182&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;#3182. 「CEOI2018」云计算&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h3&gt;&lt;p&gt;题目概括征集中~ 球球你再帮我写几篇吧 TAT @oykz2333&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
    
      <category term="动态规划" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="背包" scheme="https://tth37.cn/tags/%E8%83%8C%E5%8C%85/"/>
    
  </entry>
  
  <entry>
    <title>「雅礼集训 2018 Day4」Magic</title>
    <link href="https://tth37.cn/2019/11/23/solution-loj-6503/"/>
    <id>https://tth37.cn/2019/11/23/solution-loj-6503/</id>
    <published>2019-11-22T17:43:34.000Z</published>
    <updated>2019-11-26T16:45:05.966Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://loj.ac/problem/6503" target="_blank" rel="noopener">#6503. 「雅礼集训 2018 Day4」Magic</a></p><h3 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h3><p>题目概括征集中~</p><a id="more"></a><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>由于题意中<strong>本质不同的方案</strong>不是特别好处理，我们可以在每张卡片上标号，将计算出的答案乘上 $\prod_{i=1}^m\frac{1}{a_i!}$ 即可。</p><p>考虑容斥。记 $f[i]$ 为<strong>至少有 $i$ 个魔法对</strong>的方案数，则答案为 $\sum_{i=k}^n(-1)^{i-k}\times{i\choose k}\times f[i]$。</p><p>注意：<a href="https://tth37.cn/2019/11/22/solution-loj-3106/">「TJOI2019」唱、跳、rap 和篮球</a> 即为本题 $k=0$ 的特例。</p><p>考虑如何计算 $f[i]$。设第一种颜色至少有 $i_1$ 个魔法对，第二种颜色至少有 $i_2$ 个魔法对……以此类推。考虑以下构造序列的方法：第 $j$ 种颜色保留 $i_j$ 张卡片作为预留卡片，将剩余的卡片任意排列，然后依次将所有预留的卡片插入到原序列中<strong>与之颜色相同的卡片的后面</strong>。不难发现，按照该方法构造序列的方案数为 $(n-k)!\times\prod_{j=1}^m{a_j\choose i_j}\times \frac{(a_j-1)!}{(a_j-i_j-1)!}$，并且该序列中至少有 $\sum_{j=1}^mi_j$ 个魔法对。</p><p>因此，得到 $f[i]$ 的计算方法：<br>$$<br>f[i]=\sum_{i_1=0}^{a_1-1}\sum_{i_2=0}^{a_2-1}…\sum_{i_m=0}^{a_m-1}[i_1+i_2+…+i_m=i] (n-i)!\times\prod_{j=1}^m{a_j\choose i_j}\times \frac{(a_j-1)!}{(a_j-i_j-1)!}<br>$$<br>注意到这是一个 $m$ 维卷积的形式，但是如果用暴力生成函数 + NTT 计算，复杂度为 $O(mn\log n)$，不能通过本题。我们可以用类似<strong>启发式合并</strong>的策略，交换多项式乘法运算顺序，每次将两个<strong>阶数最小</strong>的多项式相乘，即可将复杂度控制在 $O(m\log^2 n)$。</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">100005</span>, MAXM = <span class="hljs-number">20005</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> ll MOD = <span class="hljs-number">998244353</span>, G = <span class="hljs-number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> ll <span class="hljs-title">qpow</span><span class="hljs-params">(ll a, ll k)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> (k) &#123;</span><br><span class="line">        <span class="hljs-keyword">if</span> (k &amp; <span class="hljs-number">1</span>) ret = ret * a % MOD;</span><br><span class="line">        a = a * a % MOD;</span><br><span class="line">        k &gt;&gt;= <span class="hljs-number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">namespace</span> FFT &#123;</span><br><span class="line">    <span class="hljs-keyword">int</span> n, r[MAXN &lt;&lt; <span class="hljs-number">1</span>];</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">NTT</span><span class="hljs-params">(ll *a, <span class="hljs-keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (; (<span class="hljs-number">1</span> &lt;&lt; k) &lt; n; ++k);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            r[i] = r[i &gt;&gt; <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">1</span> | (i &amp; <span class="hljs-number">1</span>) &lt;&lt; (k - <span class="hljs-number">1</span>);</span><br><span class="line">            <span class="hljs-keyword">if</span> (i &lt; r[i]) swap(a[i], a[r[i]]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> l = <span class="hljs-number">2</span>; l &lt;= n; l &lt;&lt;= <span class="hljs-number">1</span>) &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> m = l &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">            ll w = qpow(G, (MOD - <span class="hljs-number">1</span>) / l);</span><br><span class="line">            <span class="hljs-keyword">if</span> (op == <span class="hljs-number">-1</span>) w = qpow(w, MOD - <span class="hljs-number">2</span>);</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i += l) &#123;</span><br><span class="line">                ll wk = <span class="hljs-number">1</span>;</span><br><span class="line">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; m; ++j, wk = wk * w % MOD) &#123;</span><br><span class="line">                    ll p = a[i + j], q = wk * a[i + j + m] % MOD;</span><br><span class="line">                    a[i + j] = (p + q) % MOD;</span><br><span class="line">                    a[i + j + m] = (p - q + MOD) % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">DFT</span><span class="hljs-params">(ll *a)</span> </span>&#123;</span><br><span class="line">        NTT(a, <span class="hljs-number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">IDFT</span><span class="hljs-params">(ll *a)</span> </span>&#123;</span><br><span class="line">        NTT(a, <span class="hljs-number">-1</span>);</span><br><span class="line">        ll inv = qpow(n, MOD - <span class="hljs-number">2</span>);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i)</span><br><span class="line">            a[i] = a[i] * inv % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> m, n, k;</span><br><span class="line"><span class="hljs-keyword">int</span> a[MAXM];</span><br><span class="line"><span class="hljs-built_in">vector</span>&lt;ll&gt; b[MAXM &lt;&lt; <span class="hljs-number">1</span>];</span><br><span class="line">priority_queue&lt;pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt; &gt; q;</span><br><span class="line">ll x[MAXN &lt;&lt; <span class="hljs-number">1</span>], y[MAXN &lt;&lt; <span class="hljs-number">1</span>], ans;</span><br><span class="line">ll fac[MAXN], inv[MAXN], facinv[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> ll <span class="hljs-title">C</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n, <span class="hljs-keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> fac[n] * facinv[k] % MOD * facinv[n - k] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d"</span>, &amp;m, &amp;n, &amp;k);</span><br><span class="line">    fac[<span class="hljs-number">0</span>] = facinv[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    fac[<span class="hljs-number">1</span>] = inv[<span class="hljs-number">1</span>] = facinv[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        fac[i] = fac[i - <span class="hljs-number">1</span>] * i % MOD;</span><br><span class="line">        inv[i] = (MOD - MOD / i) * inv[MOD % i] % MOD;</span><br><span class="line">        facinv[i] = facinv[i - <span class="hljs-number">1</span>] * inv[i] % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;a[i]);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; a[i]; ++j)</span><br><span class="line">            b[i].push_back(C(a[i], j) * fac[a[i] - <span class="hljs-number">1</span>] % MOD * facinv[a[i] - j - <span class="hljs-number">1</span>] % MOD);</span><br><span class="line">        q.push(make_pair(-b[i].size(), i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">int</span> cnt = m;</span><br><span class="line">    <span class="hljs-keyword">while</span> (q.size() &gt; <span class="hljs-number">1</span>) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> id1 = q.top().second, sz1 = -q.top().first;</span><br><span class="line">        q.pop();</span><br><span class="line">        <span class="hljs-keyword">int</span> id2 = q.top().second, sz2 = -q.top().first;</span><br><span class="line">        q.pop();</span><br><span class="line">        FFT::n = <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">while</span> (FFT::n &lt;= sz1 + sz2) FFT::n &lt;&lt;= <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= FFT::n; ++i) x[i] = y[i] = <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; sz1; ++i) x[i] = b[id1][i];</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; sz2; ++i) y[i] = b[id2][i];</span><br><span class="line">        FFT::DFT(x), FFT::DFT(y);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= FFT::n; ++i) x[i] = x[i] * y[i] % MOD;</span><br><span class="line">        FFT::IDFT(x);</span><br><span class="line">        cnt++;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= sz1 + sz2 - <span class="hljs-number">2</span>; ++i)</span><br><span class="line">            b[cnt].push_back(x[i]);</span><br><span class="line">        q.push(make_pair(-b[cnt].size(), cnt));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">int</span> id = q.top().second, sz = -q.top().first;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = k; i &lt; sz; ++i) &#123;</span><br><span class="line">        ll tmp = C(i, k) * fac[n - i] % MOD * b[id][i] % MOD;</span><br><span class="line">        <span class="hljs-keyword">if</span> ((i - k) &amp; <span class="hljs-number">1</span>) ans = (ans - tmp + MOD) % MOD;</span><br><span class="line">        <span class="hljs-keyword">else</span> ans = (ans + tmp) % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        ans = ans * qpow(fac[a[i]], MOD - <span class="hljs-number">2</span>) % MOD;</span><br><span class="line">    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%lld"</span>, ans);</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://loj.ac/problem/6503&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;#6503. 「雅礼集训 2018 Day4」Magic&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h3&gt;&lt;p&gt;题目概括征集中~&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
      <category term="雅礼集训" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/%E9%9B%85%E7%A4%BC%E9%9B%86%E8%AE%AD/"/>
    
    
      <category term="FFT/NTT" scheme="https://tth37.cn/tags/FFT-NTT/"/>
    
      <category term="生成函数" scheme="https://tth37.cn/tags/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/"/>
    
      <category term="组合计数" scheme="https://tth37.cn/tags/%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0/"/>
    
      <category term="启发式合并" scheme="https://tth37.cn/tags/%E5%90%AF%E5%8F%91%E5%BC%8F%E5%90%88%E5%B9%B6/"/>
    
      <category term="容斥原理" scheme="https://tth37.cn/tags/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>「TJOI2019」唱、跳、rap 和篮球</title>
    <link href="https://tth37.cn/2019/11/22/solution-loj-3106/"/>
    <id>https://tth37.cn/2019/11/22/solution-loj-3106/</id>
    <published>2019-11-21T16:21:51.000Z</published>
    <updated>2019-11-28T15:39:30.512Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://loj.ac/problem/3106" target="_blank" rel="noopener">#3106. 「TJOI2019」唱、跳、rap 和篮球</a></p><h3 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h3><p>有 $n$ 个蔡徐坤，有 $m$ 个世界上最帅的欧阳，求总共有多少人。</p><p>$n,m\le1000000$</p><a id="more"></a><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>记连续的 4 个学生分别喜欢唱、跳、rap 和篮球为一组。考虑容斥，记 $f[i]$ 为保证至少存在 $i$ 组的序列方案数。根据题意，在此序列中最多只会存在 $m=\min\lbrace a,b,c,\lfloor\frac{n}{4}\rfloor\rbrace$ 组。最终答案即为 $\sum_{i=0}^{m}(-1)^{i}\times f[i]$。</p><p>考虑 $f[i]$ 的计算。由于保证至少存在 $i$ 组，可以将 $i$ 组随机插入到序列中，然后在剩下的位置插入任意学生并统计答案。</p><p>将 $i$ 个长度为 4 的组插入到长度为 $n$ 的序列中，共有 ${n-3i\choose i}$ 种方案。</p><p>将 $i_1$ 个喜欢唱、$i_2$ 个喜欢跳、$i_3$ 个喜欢 rap、$i_4$ 个喜欢篮球的学生放置在长度为 $n-4i$ 的序列中，如果保证 $i_1+i_2+i_3+i_4=n-4i$，则方案数为 $\frac{(n-4i)!}{i_1!\times i_2!\times i_3\times i_4!}$。</p><p>然而题目不保证剩余的 $a-i$、$b-i$、$c-i$、$d-i$ 个学生之和恰好为 $n-4i$，因此该部分的答案为：</p><p>$$<br>\sum_{i_1=0}^{a-i}\sum_{i_2=0}^{b-i}\sum_{i_3=0}^{c-i}\sum_{i_4=0}^{d-i}[i_1+i_2+i_3+i_4=n-4i]\frac{(n-4i)!}{i_1!\times i_2!\times i_3\times i_4!}<br>$$</p><p>注意到这是一个四元卷积的形式，可以用生成函数 + NTT 暴力求解。</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> ll MOD = <span class="hljs-number">998244353</span>, G = <span class="hljs-number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> ll <span class="hljs-title">qpow</span><span class="hljs-params">(ll a, ll k)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> (k) &#123;</span><br><span class="line">        <span class="hljs-keyword">if</span> (k &amp; <span class="hljs-number">1</span>) ret = ret * a % MOD;</span><br><span class="line">        a = a * a % MOD;</span><br><span class="line">        k &gt;&gt;= <span class="hljs-number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">namespace</span> FFT &#123;</span><br><span class="line">    <span class="hljs-keyword">int</span> n, r[<span class="hljs-number">10005</span>];</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">NTT</span><span class="hljs-params">(ll *a, <span class="hljs-keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (; (<span class="hljs-number">1</span> &lt;&lt; k) &lt; n; ++k);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            r[i] = r[i &gt;&gt; <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">1</span> | (i &amp; <span class="hljs-number">1</span>) &lt;&lt; (k - <span class="hljs-number">1</span>);</span><br><span class="line">            <span class="hljs-keyword">if</span> (i &lt; r[i]) swap(a[i], a[r[i]]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> l = <span class="hljs-number">2</span>; l &lt;= n; l &lt;&lt;= <span class="hljs-number">1</span>) &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> m = l &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">            ll w = qpow(G, (MOD - <span class="hljs-number">1</span>) / l);</span><br><span class="line">            <span class="hljs-keyword">if</span> (op == <span class="hljs-number">-1</span>) w = qpow(w, MOD - <span class="hljs-number">2</span>);</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i += l) &#123;</span><br><span class="line">                ll wk = <span class="hljs-number">1</span>;</span><br><span class="line">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; m; ++j, wk = wk * w % MOD) &#123;</span><br><span class="line">                    ll p = a[i + j], q = wk * a[i + j + m] % MOD;</span><br><span class="line">                    a[i + j] = (p + q) % MOD;</span><br><span class="line">                    a[i + j + m] = (p - q + MOD) % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">DFT</span><span class="hljs-params">(ll *a)</span> </span>&#123;</span><br><span class="line">        NTT(a, <span class="hljs-number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">IDFT</span><span class="hljs-params">(ll *a)</span> </span>&#123;</span><br><span class="line">        NTT(a, <span class="hljs-number">-1</span>);</span><br><span class="line">        ll inv = qpow(n, MOD - <span class="hljs-number">2</span>);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i)</span><br><span class="line">            a[i] = a[i] * inv % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ll f[<span class="hljs-number">1005</span>];</span><br><span class="line">ll fac[<span class="hljs-number">4005</span>], inv[<span class="hljs-number">4005</span>], facinv[<span class="hljs-number">4005</span>];</span><br><span class="line">ll x[<span class="hljs-number">4005</span>], y[<span class="hljs-number">4005</span>], z[<span class="hljs-number">4005</span>], w[<span class="hljs-number">4005</span>];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function">ll <span class="hljs-title">C</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n, <span class="hljs-keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> fac[n] * facinv[k] % MOD * facinv[n - k] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> n, a, b, c, d, m;</span><br><span class="line">ll ans = <span class="hljs-number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    fac[<span class="hljs-number">0</span>] = facinv[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    fac[<span class="hljs-number">1</span>] = inv[<span class="hljs-number">1</span>] = facinv[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= <span class="hljs-number">4000</span>; ++i) &#123;</span><br><span class="line">        fac[i] = fac[i - <span class="hljs-number">1</span>] * <span class="hljs-number">1l</span>l * i % MOD;</span><br><span class="line">        inv[i] = (MOD - MOD / i) * inv[MOD % i] % MOD;</span><br><span class="line">        facinv[i] = facinv[i - <span class="hljs-number">1</span>] * inv[i] % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d%d%d"</span>, &amp;n, &amp;a, &amp;b, &amp;c, &amp;d);</span><br><span class="line">    m = min(min(min(min(n / <span class="hljs-number">4</span>, a), b), c), d);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="hljs-built_in">memset</span>(x, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(x));</span><br><span class="line">        <span class="hljs-built_in">memset</span>(y, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(y));</span><br><span class="line">        <span class="hljs-built_in">memset</span>(z, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(z));</span><br><span class="line">        <span class="hljs-built_in">memset</span>(w, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(w));</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= a - i; ++j) x[j] = facinv[j];</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= b - i; ++j) y[j] = facinv[j];</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= c - i; ++j) z[j] = facinv[j];</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= d - i; ++j) w[j] = facinv[j];</span><br><span class="line">        FFT::n = <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">while</span> (FFT::n &lt;= a + b + c + d - <span class="hljs-number">4</span> * i) FFT::n &lt;&lt;= <span class="hljs-number">1</span>;</span><br><span class="line">        FFT::DFT(x), FFT::DFT(y), FFT::DFT(z), FFT::DFT(w);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; FFT::n; ++j)</span><br><span class="line">            x[j] = x[j] * y[j] % MOD * z[j] % MOD * w[j] % MOD;</span><br><span class="line">        FFT::IDFT(x);</span><br><span class="line">        f[i] = C(n - <span class="hljs-number">3</span> * i, i) * fac[n - <span class="hljs-number">4</span> * i] % MOD * x[n - <span class="hljs-number">4</span> * i] % MOD;</span><br><span class="line">        <span class="hljs-keyword">if</span> (i &amp; <span class="hljs-number">1</span>) ans = (ans - f[i] + MOD) % MOD;</span><br><span class="line">        <span class="hljs-keyword">else</span> ans = (ans + f[i]) % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%lld"</span>, ans);</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://loj.ac/problem/3106&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;#3106. 「TJOI2019」唱、跳、rap 和篮球&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h3&gt;&lt;p&gt;有 $n$ 个蔡徐坤，有 $m$ 个世界上最帅的欧阳，求总共有多少人。&lt;/p&gt;
&lt;p&gt;$n,m\le1000000$&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
    
      <category term="FFT/NTT" scheme="https://tth37.cn/tags/FFT-NTT/"/>
    
      <category term="生成函数" scheme="https://tth37.cn/tags/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/"/>
    
      <category term="组合计数" scheme="https://tth37.cn/tags/%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0/"/>
    
  </entry>
  
  <entry>
    <title>快速傅里叶变换（FFT）快速数论变换（NTT）</title>
    <link href="https://tth37.cn/2019/11/20/algorithm-fftntt/"/>
    <id>https://tth37.cn/2019/11/20/algorithm-fftntt/</id>
    <published>2019-11-20T15:38:26.000Z</published>
    <updated>2019-11-24T15:37:42.474Z</updated>
    
    <content type="html"><![CDATA[<p>离散傅里叶变换（Discrete Fourier Transform，缩写为 DFT），是傅里叶变换在时域和频域上都呈离散的形式，将信号的时域采样变换为其 DTFT 的频域采样。</p><p>FFT 是一种 DFT 的高效算法，称为快速傅立叶变换（Fast Fourier transform）。</p><p> 快速数论变换 (NTT) 是快速傅里叶变换（FFT）在数论基础上的实现。 </p><a id="more"></a><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">5000005</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> ll MOD = <span class="hljs-number">998244353</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> ll G = <span class="hljs-number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> ll <span class="hljs-title">qpow</span><span class="hljs-params">(ll a, ll k)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> (k) &#123;</span><br><span class="line">        <span class="hljs-keyword">if</span> (k &amp; <span class="hljs-number">1</span>) ret = ret * a % MOD;</span><br><span class="line">        a = a * a % MOD;</span><br><span class="line">        k &gt;&gt;= <span class="hljs-number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> ll <span class="hljs-title">inv</span><span class="hljs-params">(ll a)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> qpow(a, MOD - <span class="hljs-number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">namespace</span> FFT &#123;</span><br><span class="line">    <span class="hljs-keyword">int</span> n, r[MAXN];</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">NTT</span><span class="hljs-params">(ll *a, <span class="hljs-keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (; (<span class="hljs-number">1</span> &lt;&lt; k) &lt; n; ++k);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            r[i] = r[i &gt;&gt; <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">1</span> | (i &amp; <span class="hljs-number">1</span>) &lt;&lt; (k - <span class="hljs-number">1</span>);</span><br><span class="line">            <span class="hljs-keyword">if</span> (i &lt; r[i]) swap(a[i], a[r[i]]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> l = <span class="hljs-number">2</span>; l &lt;= n; l &lt;&lt;= <span class="hljs-number">1</span>) &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> m = l &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">            ll w = qpow(G, (MOD - <span class="hljs-number">1</span>) / l);</span><br><span class="line">            <span class="hljs-keyword">if</span> (op == <span class="hljs-number">-1</span>) w = inv(w);</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i += l) &#123;</span><br><span class="line">                ll wk = <span class="hljs-number">1</span>;</span><br><span class="line">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; m; ++j, wk = wk * w % MOD) &#123;</span><br><span class="line">                    ll p = a[i + j], q = wk * a[i + j + m] % MOD;</span><br><span class="line">                    a[i + j] = (p + q) % MOD;</span><br><span class="line">                    a[i + j + m] = (p - q + MOD) % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">DFT</span><span class="hljs-params">(ll *a)</span> </span>&#123;</span><br><span class="line">        NTT(a, <span class="hljs-number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">IDFT</span><span class="hljs-params">(ll *a)</span> </span>&#123;</span><br><span class="line">        NTT(a, <span class="hljs-number">-1</span>);</span><br><span class="line">        ll inv = qpow(n, MOD - <span class="hljs-number">2</span>);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i)</span><br><span class="line">            a[i] = a[i] * inv % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;离散傅里叶变换（Discrete Fourier Transform，缩写为 DFT），是傅里叶变换在时域和频域上都呈离散的形式，将信号的时域采样变换为其 DTFT 的频域采样。&lt;/p&gt;
&lt;p&gt;FFT 是一种 DFT 的高效算法，称为快速傅立叶变换（Fast Fourier transform）。&lt;/p&gt;
&lt;p&gt; 快速数论变换 (NTT) 是快速傅里叶变换（FFT）在数论基础上的实现。 &lt;/p&gt;
    
    </summary>
    
      <category term="算法学习" scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="FFT/NTT" scheme="https://tth37.cn/tags/FFT-NTT/"/>
    
  </entry>
  
  <entry>
    <title>「雅礼集训 2017 Day7」蛐蛐国的修墙方案</title>
    <link href="https://tth37.cn/2019/11/14/solution-loj-6043/"/>
    <id>https://tth37.cn/2019/11/14/solution-loj-6043/</id>
    <published>2019-11-14T14:46:15.000Z</published>
    <updated>2019-11-24T15:39:41.131Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://loj.ac/problem/6043" target="_blank" rel="noopener">#6043. 「雅礼集训 2017 Day7」蛐蛐国的修墙方案</a></p><h3 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h3><p>题目概括征集中~</p><a id="more"></a><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>CSP-S RP++!</p><p>赛前再做几个搜索 / 模拟，<del>为暴力骗分做准备，</del>顺便填一下雅礼集训的坑。</p><h4 id="Part1-暴搜"><a href="#Part1-暴搜" class="headerlink" title="Part1: 暴搜"></a>Part1: 暴搜</h4><p>观察题意得出，第 $i$ 个位置和第 $P_i$ 个位置上，必须填一个左括号和一个右括号。从左向右填写，每次判断是否可以填左 / 右括号即可。</p><p>得分 81 pts 。</p><h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> n;</span><br><span class="line"><span class="hljs-keyword">int</span> ans[<span class="hljs-number">105</span>];</span><br><span class="line"><span class="hljs-keyword">int</span> p[<span class="hljs-number">105</span>];</span><br><span class="line"><span class="hljs-keyword">bool</span> force_right[<span class="hljs-number">105</span>];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> dep, <span class="hljs-keyword">int</span> cnt)</span> </span>&#123;</span><br><span class="line"><span class="hljs-keyword">if</span> (dep == n + <span class="hljs-number">1</span>) &#123;</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) </span><br><span class="line"><span class="hljs-built_in">putchar</span>(<span class="hljs-string">'('</span> + ans[i]);</span><br><span class="line"><span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">if</span> (cnt &lt; n / <span class="hljs-number">2</span>) &#123;</span><br><span class="line"><span class="hljs-keyword">if</span> (force_right[dep] == <span class="hljs-number">0</span>) &#123;</span><br><span class="line"><span class="hljs-keyword">if</span> (p[dep] &lt; dep) &#123;</span><br><span class="line"><span class="hljs-keyword">if</span> (ans[p[dep]] == <span class="hljs-number">1</span>) &#123;</span><br><span class="line">ans[dep] = <span class="hljs-number">0</span>;</span><br><span class="line">dfs(dep + <span class="hljs-number">1</span>, cnt + <span class="hljs-number">1</span>);</span><br><span class="line">ans[dep] = <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">force_right[p[dep]] = <span class="hljs-number">1</span>;</span><br><span class="line">dfs(dep + <span class="hljs-number">1</span>, cnt + <span class="hljs-number">1</span>);</span><br><span class="line">force_right[p[dep]] = <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="hljs-keyword">if</span> (dep - cnt &lt;= cnt) &#123;</span><br><span class="line">ans[dep] = <span class="hljs-number">1</span>;</span><br><span class="line">dfs(dep + <span class="hljs-number">1</span>, cnt);</span><br><span class="line">ans[dep] = <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line"><span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;n);</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;p[i]);</span><br><span class="line">dfs(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>);</span><br><span class="line"><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Part2-观察性质"><a href="#Part2-观察性质" class="headerlink" title="Part2: 观察性质"></a>Part2: 观察性质</h4><p>将排列 $P$ 视作置换函数，则 $P$ 必定可以分解为若干个长度为偶数的循环。（若不然，必定无解）对于每个循环都只有 2 种填法，即 0,1,0,1… 或 1,0,1,0…。特判长度为 2 的循环，则剩余的循环最多有 $100 / 4 = 25$ 个。复杂度约为 $2^{25}$ 级别。</p><p>得分 100 pts。</p><h4 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> n, p[<span class="hljs-number">105</span>];</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; circ[<span class="hljs-number">105</span>];</span><br><span class="line"><span class="hljs-keyword">bool</span> vis[<span class="hljs-number">105</span>], ans[<span class="hljs-number">105</span>];</span><br><span class="line"><span class="hljs-keyword">int</span> cnt = <span class="hljs-number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">check</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line"><span class="hljs-keyword">int</span> cnt1 = <span class="hljs-number">0</span>, cnt2 = <span class="hljs-number">0</span>;</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">cnt1 += (ans[i] == <span class="hljs-number">0</span>), cnt2 += ans[i];</span><br><span class="line"><span class="hljs-keyword">if</span> (cnt1 &lt; cnt2) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;</span><br><span class="line"><span class="hljs-keyword">if</span> (u == cnt + <span class="hljs-number">1</span>) &#123;</span><br><span class="line"><span class="hljs-keyword">if</span> (check()) &#123;</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="hljs-built_in">putchar</span>(<span class="hljs-string">'('</span> + ans[i]);</span><br><span class="line"><span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">int</span> len = circ[u].size();</span><br><span class="line"><span class="hljs-keyword">if</span> (!(len ^ <span class="hljs-number">2</span>)) &#123;</span><br><span class="line">ans[circ[u][<span class="hljs-number">0</span>]] = <span class="hljs-number">0</span>, ans[circ[u][<span class="hljs-number">1</span>]] = <span class="hljs-number">1</span>;</span><br><span class="line">dfs(u + <span class="hljs-number">1</span>);</span><br><span class="line">&#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i ^ len; ++i) ans[circ[u][i]] = i &amp; <span class="hljs-number">1</span>;</span><br><span class="line">dfs(u + <span class="hljs-number">1</span>);</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i ^ len; ++i) ans[circ[u][i]] = !(i &amp; <span class="hljs-number">1</span>);</span><br><span class="line">dfs(u + <span class="hljs-number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line"><span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;n);</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) </span><br><span class="line"><span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;p[i]);</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line"><span class="hljs-keyword">if</span> (vis[i] == <span class="hljs-number">0</span>) &#123;</span><br><span class="line">cnt += <span class="hljs-number">1</span>;</span><br><span class="line"><span class="hljs-keyword">int</span> cur = i;</span><br><span class="line"><span class="hljs-keyword">do</span> &#123;</span><br><span class="line">circ[cnt].push_back(cur);</span><br><span class="line">vis[cur] = <span class="hljs-number">1</span>;</span><br><span class="line">cur = p[cur];</span><br><span class="line">&#125; <span class="hljs-keyword">while</span> (cur != i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">dfs(<span class="hljs-number">1</span>);</span><br><span class="line"><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://loj.ac/problem/6043&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;#6043. 「雅礼集训 2017 Day7」蛐蛐国的修墙方案&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h3&gt;&lt;p&gt;题目概括征集中~&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
      <category term="雅礼集训" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/%E9%9B%85%E7%A4%BC%E9%9B%86%E8%AE%AD/"/>
    
    
      <category term="搜索" scheme="https://tth37.cn/tags/%E6%90%9C%E7%B4%A2/"/>
    
  </entry>
  
  <entry>
    <title>咕咕树</title>
    <link href="https://tth37.cn/2019/11/04/solution-jsk-4596B/"/>
    <id>https://tth37.cn/2019/11/04/solution-jsk-4596B/</id>
    <published>2019-11-04T14:19:03.000Z</published>
    <updated>2019-11-25T15:59:25.169Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://nanti.jisuanke.com/t/42087" target="_blank" rel="noopener">4596B 咕咕树</a></p><h3 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h3><p>题目概括咕咕</p><a id="more"></a><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>高压下的代码实现能力堪忧。比赛 1 小时没敲出来，订正 10 分钟满分。</p><p>官方题解给的是树形背包，但并不是特别好实现。</p><p>定义状态 $f[u][i]$ 表示以 $u$ 为根的子树，有一条以 $u$ 为起点且长度恰好为 $i$ 的链，最少花费的代价。</p><p>考虑状态转移： $f[u][0]$ 显然是切断当前节点后，再将每个子树切断；$f[u][1]$ 即为切出一条长度为 $i$ 的链，对其余子树的链长度进行讨论。<br>$$<br>f[u][0]=a[u]+\sum_{v\in son(u)}\min_{j=0}^{l-1}\lbrace f[v][j]\rbrace\<br>f[u][1]=f[s][i-1]+\sum_{v\in son(u),v\not= s}\min_{j=0}^{\min(i-1,l-i-1)}\lbrace f[v][j]\rbrace<br>$$<br>考虑优化。对所有 $f[u][0..l-1]$ 做前缀最小值，并记 $g[u][i]=\sum_{v\in son(u)}f[v][j]$，则转移方程简化为：<br>$$<br>f[u][0]=a[u]+g[u][l-1]\<br>f[u][1]=f[s][i-1]-f[s][\min(i-1,l-i-1)]+g[u][\min(i-1,l-i-1)]<br>$$<br>注意叶节点的 $f[u][1]$ 应赋值为 $0$。</p><p>时间复杂度 $O(n^2)$。</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">5005</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> n, l;</span><br><span class="line"><span class="hljs-keyword">int</span> a[MAXN];</span><br><span class="line"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; G[MAXN];</span><br><span class="line"><span class="hljs-keyword">int</span> f[MAXN][MAXN];</span><br><span class="line"><span class="hljs-keyword">int</span> g[MAXN][MAXN];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> v = *it;</span><br><span class="line">        <span class="hljs-keyword">if</span> (v == fa) <span class="hljs-keyword">continue</span>;</span><br><span class="line">        dfs(v, u);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; l; ++i)</span><br><span class="line">            g[u][i] += f[v][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> v = *it;</span><br><span class="line">        <span class="hljs-keyword">if</span> (v == fa) <span class="hljs-keyword">continue</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; l; ++i) &#123;</span><br><span class="line">            f[u][i] = min(f[u][i], g[u][min(i - <span class="hljs-number">1</span>, l - i - <span class="hljs-number">1</span>)] - f[v][min(i - <span class="hljs-number">1</span>, l - i - <span class="hljs-number">1</span>)] + f[v][i - <span class="hljs-number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    f[u][<span class="hljs-number">0</span>] = a[u] + g[u][l - <span class="hljs-number">1</span>];</span><br><span class="line">    <span class="hljs-keyword">if</span> (u != <span class="hljs-number">1</span> &amp;&amp; G[u].size() == <span class="hljs-number">1</span>) f[u][<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; l; ++i)</span><br><span class="line">        f[u][i] = min(f[u][i], f[u][i - <span class="hljs-number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span>(f));</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d"</span>, &amp;n, &amp;l);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;a[i]), sum += a[i];</span><br><span class="line">    <span class="hljs-keyword">if</span> (l == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d"</span>, sum), <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> u, v;</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d"</span>, &amp;u, &amp;v);</span><br><span class="line">        G[u].push_back(v), G[v].push_back(u);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>);</span><br><span class="line">    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d"</span>, f[<span class="hljs-number">1</span>][l - <span class="hljs-number">1</span>]);</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://nanti.jisuanke.com/t/42087&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;4596B 咕咕树&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h3&gt;&lt;p&gt;题目概括咕咕&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="计蒜客" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/%E8%AE%A1%E8%92%9C%E5%AE%A2/"/>
    
    
      <category term="动态规划" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="背包" scheme="https://tth37.cn/tags/%E8%83%8C%E5%8C%85/"/>
    
      <category term="树形dp" scheme="https://tth37.cn/tags/%E6%A0%91%E5%BD%A2dp/"/>
    
  </entry>
  
  <entry>
    <title>高斯消元</title>
    <link href="https://tth37.cn/2019/10/31/algorithm-gauss/"/>
    <id>https://tth37.cn/2019/10/31/algorithm-gauss/</id>
    <published>2019-10-31T13:44:46.000Z</published>
    <updated>2019-11-25T15:55:47.293Z</updated>
    
    <content type="html"><![CDATA[<p>高斯消元法（Gauss-Jordan elimination）是求解线性方程组的经典算法，它在当代数学中有着重要的地位和价值，是线性代数课程教学的重要组成部分。</p><p>高斯消元法除了用于线性方程组求解外，还可以用于行列式计算、求矩阵的逆，以及其他计算机和工程方面。</p><p>夏建明等人之前提出了应用图形处理器 (GPU) 加速求解线性方程组的高斯消元法，所提出的算法与基于 CPU 的算法相比较取得更快的运算速度。二是提出各种变异高斯消元法以满足特定工作的需要。</p><blockquote><p>本文绝大部分内容转载自 <a href="https://oi-wiki.org/math/gauss/#_6" target="_blank" rel="noopener">OI-WIKI</a></p></blockquote><a id="more"></a><h4 id="高斯消元五步骤法"><a href="#高斯消元五步骤法" class="headerlink" title="高斯消元五步骤法"></a>高斯消元五步骤法</h4><p>高斯消元法在将增广矩阵化为最简形后对于自由未知量的赋值，需要掌握线性相关知识，且赋值存在人工经验的因素，使得在学习过程中有一定的困难，将高斯消元法划分为五步骤，从而提出五步骤法，内容如下：</p><ol><li><p>增广矩阵行初等行变换为行最简形；</p></li><li><p>还原线性方程组；</p></li><li><p>求解第一个变量；</p></li><li><p>补充自由未知量；</p></li><li><p>列表示方程组通解。</p></li></ol><p>利用实例进一步说明该算法的运作情况。</p><p>例二：利用高斯消元法五步骤法求解线性方程组：</p><p>$$<br>\left{\begin{aligned}<br>2x_1+5x_3+6x_4&amp;=9 \notag \<br>x_3+x_4&amp;=-4 \notag \<br>2x_3+2x_4&amp;=-8 \notag<br>\end{aligned}\right.<br>$$</p><h4 id="增广矩阵行（初等）变换为行最简形"><a href="#增广矩阵行（初等）变换为行最简形" class="headerlink" title="增广矩阵行（初等）变换为行最简形"></a>增广矩阵行（初等）变换为行最简形</h4><p>所谓增广矩阵，即为方程组系数矩阵 $A$ 与常数列 $b$ 的并生成的新矩阵，即 $(A | b)$ ，增广矩阵行初等变换化为行最简形，即是利用了高斯消元法的思想理念，省略了变量而用变量的系数位置表示变量，增广矩阵中用竖线隔开了系数矩阵和常数列，代表了等于符号。</p><p>$$<br>\left(\begin{matrix}<br>2 &amp; 0 &amp; 5 &amp; 6 \<br>0 &amp; 0 &amp; 1 &amp; 1 \<br>0 &amp; 0 &amp; 2 &amp; 2<br>\end{matrix} \middle|<br>\begin{matrix}<br>9 \<br>-4 \<br>-8<br>\end{matrix} \right)<br>$$</p><p>$$<br>\xrightarrow{r_3-2r_2}<br>\left(\begin{matrix}<br>2 &amp; 0 &amp; 5 &amp; 6 \<br>0 &amp; 0 &amp; 1 &amp; 1 \<br>0 &amp; 0 &amp; 0 &amp; 0<br>\end{matrix} \middle|<br>\begin{matrix}<br>9 \<br>-4 \<br>0<br>\end{matrix} \right)<br>$$</p><p>化为行阶梯形</p><p>$$<br>\xrightarrow{\frac{r_1}{2}}<br>\left(\begin{matrix}<br>1 &amp; 0 &amp; 2.5 &amp; 3 \<br>0 &amp; 0 &amp; 1 &amp; 1 \<br>0 &amp; 0 &amp; 0 &amp; 0<br>\end{matrix} \middle|<br>\begin{matrix}<br>4.5 \<br>-4 \<br>0<br>\end{matrix} \right)<br>$$</p><p>$$<br>\xrightarrow{r_1-r_2 \times 2.5}<br>\left(\begin{matrix}<br>1 &amp; 0 &amp; 0 &amp; 0.5 \<br>0 &amp; 0 &amp; 1 &amp; 1 \<br>0 &amp; 0 &amp; 0 &amp; 0<br>\end{matrix} \middle|<br>\begin{matrix}<br>14.5 \<br>-4 \<br>0<br>\end{matrix} \right)<br>$$</p><p>化为最简形</p><h4 id="还原线性方程组"><a href="#还原线性方程组" class="headerlink" title="还原线性方程组"></a>还原线性方程组</h4><p>$$<br>\left{\begin{aligned}<br>x_1+0.5x_4 &amp;= 14.5 \notag\<br>x_3+x_4 &amp;= -4 \notag \<br>\end{aligned}\right.<br>$$</p><p>解释</p><blockquote><p>所谓的还原线性方程组，即是在行最简形的基础上，将之重新书写为线性方程组的形式，即将行最简形中各位置的系数重新赋予变量，中间的竖线还原为等号。</p></blockquote><h4 id="求解第一个变量"><a href="#求解第一个变量" class="headerlink" title="求解第一个变量"></a>求解第一个变量</h4><p>$$<br>\left{\begin{aligned}<br>x_1 &amp;= -0.5x_4+14.5\notag \<br>x_3 &amp;= -x_4-4\notag<br>\end{aligned}\right.<br>$$</p><p>解释</p><blockquote><p>即是对于所还原的线性方程组而言，将方程组中每个方程的第一个变量，用其他量表达出来。如方程组两方程中的第一个变量 $x_1$ 和 $x_3$ </p></blockquote><h4 id="补充自由未知量"><a href="#补充自由未知量" class="headerlink" title="补充自由未知量"></a>补充自由未知量</h4><p>$$<br>\left{\begin{aligned}<br>x_1 &amp;= -0.5x_4+14.5 \notag \<br>x_2 &amp;= x_2 \notag \<br>x_3 &amp;= -x_4-4 \notag \<br>x_4 &amp;= x_4 \notag<br>\end{aligned}\right.<br>$$</p><p>解释</p><blockquote><p>第 3 步中，求解出变量 $x_1$ 和 $x_3$ ，从而说明了方程剩余的变量 $x_2$ 和 $x_4$ 不受方程组的约束，是自由未知量，可以取任意值，所以需要在第 3 步骤解得基础上进行解得补充，补充的方法为 $x_2 = x_2,x_4 = x_4$ ，这种解得补充方式符合自由未知量定义，并易于理解，因为是自由未知量而不受约束，所以只能自己等于自己。</p></blockquote><h4 id="列表示方程组的通解"><a href="#列表示方程组的通解" class="headerlink" title="列表示方程组的通解"></a>列表示方程组的通解</h4><p>$$<br>\begin{aligned}<br>\begin{pmatrix} x_1 \ x_2 \ x_3 \ x_4 \end{pmatrix} &amp;=<br>\begin{pmatrix} 0 \ 1 \ 0 \ 0 \end{pmatrix} x_2+<br>\begin{pmatrix} -0.5 \ 0 \ -1 \ 1 \end{pmatrix} x_4 +<br>\begin{pmatrix} 14.5 \ 0 \ -4 \ 0 \end{pmatrix} \notag \<br>&amp;= \begin{pmatrix} 0 \ 1 \ 0 \ 0 \end{pmatrix} C_1+<br>\begin{pmatrix} -0.5 \ 0 \ -1 \ 1 \end{pmatrix} C_2 +<br>\begin{pmatrix} 14.5 \ 0 \ -4 \ 0 \end{pmatrix} \notag<br>\end{aligned}<br>$$</p><p>其中 $C_1$ 和 $C_2$ 为任意常数。</p><p>解释</p><blockquote><p>即在第 4 步的基础上，将解表达为列向量组合的表示形式，同时由于 $x_2$ 和 $x_4$ 是自由未知量，可以取任意值，所以在解得右边，令二者分别为任意常数 $C_1$ 和 $C_2$ ，即实现了对方程组的求解。</p></blockquote><h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><p>其实可以根据自己解方程的习惯写代码……实现非常简单，基本不需要理论知识</p><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Gauss</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">bool</span> flag = <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i; j &lt;= n; ++j) &#123;</span><br><span class="line">            <span class="hljs-keyword">if</span> (a[j][i] != <span class="hljs-number">0</span>) &#123;</span><br><span class="line">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = i; k &lt;= n + <span class="hljs-number">1</span>; ++k)</span><br><span class="line">                    swap(a[i][k], a[j][k]);</span><br><span class="line">                flag = <span class="hljs-number">1</span>;</span><br><span class="line">                <span class="hljs-keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">if</span> (flag == <span class="hljs-number">0</span>) &#123;</span><br><span class="line">            <span class="hljs-built_in">puts</span>(<span class="hljs-string">"No Solution"</span>);</span><br><span class="line">            <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">double</span> tmp = a[i][i];</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = i; k &lt;= n + <span class="hljs-number">1</span>; ++k)</span><br><span class="line">            a[i][k] /= tmp;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i + <span class="hljs-number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            tmp = a[j][i];</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = i; k &lt;= n + <span class="hljs-number">1</span>; ++k)</span><br><span class="line">                a[j][k] -= tmp * a[i][k];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n; i &gt;= <span class="hljs-number">1</span>; --i) &#123;</span><br><span class="line">        <span class="hljs-keyword">double</span> x = <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i + <span class="hljs-number">1</span>; j &lt;= n; ++j)</span><br><span class="line">            x += ans[j] * a[i][j];</span><br><span class="line">        ans[i] = a[i][n + <span class="hljs-number">1</span>] - x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;高斯消元法（Gauss-Jordan elimination）是求解线性方程组的经典算法，它在当代数学中有着重要的地位和价值，是线性代数课程教学的重要组成部分。&lt;/p&gt;
&lt;p&gt;高斯消元法除了用于线性方程组求解外，还可以用于行列式计算、求矩阵的逆，以及其他计算机和工程方面。&lt;/p&gt;
&lt;p&gt;夏建明等人之前提出了应用图形处理器 (GPU) 加速求解线性方程组的高斯消元法，所提出的算法与基于 CPU 的算法相比较取得更快的运算速度。二是提出各种变异高斯消元法以满足特定工作的需要。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;本文绝大部分内容转载自 &lt;a href=&quot;https://oi-wiki.org/math/gauss/#_6&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;OI-WIKI&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="算法学习" scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="数论专题" scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/%E6%95%B0%E8%AE%BA%E4%B8%93%E9%A2%98/"/>
    
    
      <category term="高斯消元" scheme="https://tth37.cn/tags/%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83/"/>
    
  </entry>
  
  <entry>
    <title>「BJOI2019」光线</title>
    <link href="https://tth37.cn/2019/10/31/solution-loj-3093/"/>
    <id>https://tth37.cn/2019/10/31/solution-loj-3093/</id>
    <published>2019-10-31T13:35:11.000Z</published>
    <updated>2019-11-25T15:55:30.382Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://loj.ac/problem/3093" target="_blank" rel="noopener">#3093. 「BJOI2019」光线</a></p><h3 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h3><p>题目概括征集中~</p><a id="more"></a><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>一开始愣是套高斯消元想了半天……后来发现是普通 DP 秒出</p><h4 id="Part1-高斯消元-O-n-3"><a href="#Part1-高斯消元-O-n-3" class="headerlink" title="Part1: 高斯消元 $O(n^3)$"></a>Part1: 高斯消元 $O(n^3)$</h4><p>记 $f[i]$ 表示第 $i$ 片玻璃向下的光线总数，$g[i]$ 表示第 $i$ 片玻璃向上的光线总数。</p><p>显然地：<br>$$<br>f[i]=f[i-1]\times a[i]+g[i+1]\times b[i]\<br>g[i]=f[i-1]\times b[i]+g[i+1]\times a[i]<br>$$</p><p>$$<br>f[i]=f[i-1]\times a[i]+g[i+1]\times b[i]\<br>g[i]=f[i-1]\times b[i]+g[i+1]\times a[i]<br>\<br>x_i=x_{i-1}\times a[i] + x_{n+i+1}\times b[i]\<br>x_{n+i}=x_{i-1}\times b[i]+x_{n+i+1}\times a[i]<br>$$</p><p>共有 $2n$  个未知数和 $2n$ 个等式，暴力求解方程即可。</p><p>期望得分：50 pts</p><p>$$<br>f[i]=f[i-1]\times a[i]+f[i-1]\times b[i]\times g[i-1]\times a[i]+…<br>$$</p><p>$$<br>f[i]=f[i-1]\times a[i]\times\sum_{j=0}^{+\infty}(b[i]\times g[i-1])^j\<br>f[i]=f[i-1]\times a[i]\times<br>$$</p><p>$$<br>g[i]=b[i]+a[i]\times g[i-1]\times a[i]+a[i]\times g[i-1]\times b[i]\times g[i-1]\times a[i]<br>$$</p><p>$$<br>g[i]=b[i]+a[i]^2\times g[i-1]\times\sum_{j=0}^{+\infty}(b[i]\times g[i-1])^j<br>$$</p><p>$$<br>{a_n}\<br>a_n=a_{n-1}\times q\ \   (0&lt;q&lt;1)\<br>\sum_{j=0}^{+\infty}=a_1/(1-q)<br>$$</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://loj.ac/problem/3093&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;#3093. 「BJOI2019」光线&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h3&gt;&lt;p&gt;题目概括征集中~&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
    
      <category term="高斯消元" scheme="https://tth37.cn/tags/%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83/"/>
    
      <category term="动态规划" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="概率" scheme="https://tth37.cn/tags/%E6%A6%82%E7%8E%87/"/>
    
  </entry>
  
  <entry>
    <title>「雅礼集训 2018 Day1」图</title>
    <link href="https://tth37.cn/2019/10/30/solution-loj-6497/"/>
    <id>https://tth37.cn/2019/10/30/solution-loj-6497/</id>
    <published>2019-10-30T14:11:17.000Z</published>
    <updated>2019-11-25T15:57:02.509Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://loj.ac/problem/6497" target="_blank" rel="noopener">#6497. 「雅礼集训 2018 Day1」图</a></p><h3 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h3><p>题目概括征集中~</p><a id="more"></a><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>特别屌的一个计数 DP。</p><p>记 $g(i)$ 表示以 $i$ 节点结尾的交错路径条数。</p><p>定义状态：$f[i][k][x][y]$ 表示考虑前 $i$ 个节点，奇偶性为 $k=0/1$； $x=0/1$ 表示是否存在 $g()$ 为奇数的黑色节点， $y=0/1$ 表示是否存在 $g()$ 为奇数的白色节点。</p><p>考虑转移：假设已经求出 $f[i][k][x][y]$。枚举第 $i+1$ 个节点的颜色。</p><p>当第 $i+1$ 个节点为白色时：</p><p>如果 $x=0$，即不存在 $g()$ 为奇数的黑色节点，那么无论如何连边，总的原方案的奇偶性一定会发生改变。考虑如果有黑色节点向 $i+1$ 连边，则交错路径会增加偶数条（即增加 $g()$）；如果有白色节点向其连边，则交错路径数不变；第 $i+1$ 个节点单独作为一条路径，因此交错路径增加了奇数条，奇偶性发生改变。</p><p>转移方程：<br>$$<br>f[i+1][k\oplus1][x][1]=f[i+1][k\oplus1][x][1]+2^i\times f[i][k][x][y]<br>$$<br>如果 $x=1$，那么情况会略微复杂；注意到如果有偶数个 $g()$ 为奇数的黑色节点向 $i+1$ 连边，则奇偶性一定改变；如果有奇数个 $g()$ 为奇数的黑色节点向 $i+1$ 连边，则奇偶性不会改变。假设 $g()$ 为奇数的黑色节点共有 $t$ 个。那么转移方程如下：<br>$$<br>f[i+1][k\oplus1][x][1]=f[i+1][k\oplus1][x][1]+({t\choose0}+{t\choose2}+..+{t\choose 2m})\times 2^{i-t}\times f[i][k][x][y]<br>$$</p><p>$$<br>f[i+1][k][x][y]=f[i+1][k][x][y]+({t\choose1}+{t\choose3}+..+{t\choose 2m+1})\times 2^{i-t}\times f[i][k][x][y]<br>$$</p><p>可以证明：<br>$$<br>{t\choose0}+{t\choose2}+..+{t\choose 2m}={t\choose1}+{t\choose3}+..+{t\choose 2m+1}=2^{t-1}<br>$$<br>因此转移方程可以简化为：<br>$$<br>f[i+1][k\oplus1][x][1]=f[i+1][k\oplus1][x][1]+2^{i-1}\times f[i][k][x][y]<br>$$</p><p>$$<br>f[i+1][k][x][y]=f[i+1][k][x][y]+2^{i-1}\times f[i][k][x][y]<br>$$</p><p>当第 $i+1$ 个节点为黑色时，情况类似。</p><p>代码实现非常简单，不再赘述。</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">200005</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MOD = <span class="hljs-number">998244353</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> n, p;</span><br><span class="line"><span class="hljs-keyword">int</span> f[MAXN][<span class="hljs-number">2</span>][<span class="hljs-number">2</span>][<span class="hljs-number">2</span>];</span><br><span class="line"><span class="hljs-keyword">int</span> c[MAXN];</span><br><span class="line"><span class="hljs-keyword">int</span> pow2[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d"</span>, &amp;n, &amp;p);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;c[i]);</span><br><span class="line">    pow2[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        pow2[i] = pow2[i - <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">if</span> (pow2[i] &gt; MOD) pow2[i] -= MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    f[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt;= <span class="hljs-number">1</span>; ++k)</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>; x &lt;= <span class="hljs-number">1</span>; ++x)</span><br><span class="line">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> y = <span class="hljs-number">0</span>; y &lt;= <span class="hljs-number">1</span>; ++y) &#123;</span><br><span class="line">                    <span class="hljs-keyword">int</span> cur = f[i][k][x][y];</span><br><span class="line">                    <span class="hljs-keyword">if</span> (c[i + <span class="hljs-number">1</span>] == <span class="hljs-number">-1</span> || c[i + <span class="hljs-number">1</span>] == <span class="hljs-number">0</span>) &#123;</span><br><span class="line">                        <span class="hljs-keyword">if</span> (x == <span class="hljs-number">0</span>)</span><br><span class="line">                            f[i + <span class="hljs-number">1</span>][k ^ <span class="hljs-number">1</span>][x][<span class="hljs-number">1</span>] =</span><br><span class="line">                                (f[i + <span class="hljs-number">1</span>][k ^ <span class="hljs-number">1</span>][x][<span class="hljs-number">1</span>] + <span class="hljs-number">1l</span>l * pow2[i] * cur) % MOD;</span><br><span class="line">                        <span class="hljs-keyword">else</span></span><br><span class="line">                            f[i + <span class="hljs-number">1</span>][k ^ <span class="hljs-number">1</span>][x][<span class="hljs-number">1</span>] =</span><br><span class="line">                                (f[i + <span class="hljs-number">1</span>][k ^ <span class="hljs-number">1</span>][x][<span class="hljs-number">1</span>] + <span class="hljs-number">1l</span>l * pow2[i - <span class="hljs-number">1</span>] * cur) % MOD,</span><br><span class="line">                            f[i + <span class="hljs-number">1</span>][k][x][y] =</span><br><span class="line">                                (f[i + <span class="hljs-number">1</span>][k][x][y] + <span class="hljs-number">1l</span>l * pow2[i - <span class="hljs-number">1</span>] * cur) % MOD;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="hljs-keyword">if</span> (c[i + <span class="hljs-number">1</span>] == <span class="hljs-number">-1</span> || c[i + <span class="hljs-number">1</span>] == <span class="hljs-number">1</span>) &#123;</span><br><span class="line">                        <span class="hljs-keyword">if</span> (y == <span class="hljs-number">0</span>)</span><br><span class="line">                            f[i + <span class="hljs-number">1</span>][k ^ <span class="hljs-number">1</span>][<span class="hljs-number">1</span>][y] =</span><br><span class="line">                                (f[i + <span class="hljs-number">1</span>][k ^ <span class="hljs-number">1</span>][<span class="hljs-number">1</span>][y] + <span class="hljs-number">1l</span>l * pow2[i] * cur) % MOD;</span><br><span class="line">                        <span class="hljs-keyword">else</span></span><br><span class="line">                            f[i + <span class="hljs-number">1</span>][k ^ <span class="hljs-number">1</span>][<span class="hljs-number">1</span>][y] =</span><br><span class="line">                                (f[i + <span class="hljs-number">1</span>][k ^ <span class="hljs-number">1</span>][<span class="hljs-number">1</span>][y] + <span class="hljs-number">1l</span>l * pow2[i - <span class="hljs-number">1</span>] * cur) % MOD,</span><br><span class="line">                            f[i + <span class="hljs-number">1</span>][k][x][y] =</span><br><span class="line">                                (f[i + <span class="hljs-number">1</span>][k][x][y] + <span class="hljs-number">1l</span>l * pow2[i - <span class="hljs-number">1</span>] * cur) % MOD;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d"</span>, (f[n][p][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] + f[n][p][<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] + f[n][p][<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] + f[n][p][<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]) % MOD);</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://loj.ac/problem/6497&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;#6497. 「雅礼集训 2018 Day1」图&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h3&gt;&lt;p&gt;题目概括征集中~&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
    
      <category term="动态规划" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="数学" scheme="https://tth37.cn/tags/%E6%95%B0%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>Sometimes Naive</title>
    <link href="https://tth37.cn/2019/10/28/solution-jsk-4594C/"/>
    <id>https://tth37.cn/2019/10/28/solution-jsk-4594C/</id>
    <published>2019-10-28T14:33:25.000Z</published>
    <updated>2019-11-25T16:00:22.685Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://nanti.jisuanke.com/t/41979" target="_blank" rel="noopener">4594C Sometimes Naive</a></p><h3 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h3><p>题目概括征集中~</p><a id="more"></a><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>神 仙 题</p><p>虽然做完后想想不是很难……但哪道题不是如此呢TAT</p><p>易得每次询问中 $c$ 个人的集合点为 $\text{lca}(v_1,v_2,..,v_c)$ 。每个人到集合点的路径上所经过的特产看作一个集合。可以采用倍增和 <code>bitset</code> 优化求出所有的集合，由于本题卡空间，倍增需要使用滚动数组。代码实现非常致郁。</p><p>在预处理出集合信息后，考虑如何回答询问。不妨二分答案 $ans$，构造二分图 $G$：二分图左侧有 $c\times ans$ 个节点，表示共 $c$ 个人，每人购买 $ans$ 个物品；右侧有 $m$ 个节点，表示所有特产。如果某个人可以购买特产 $k$ （即 $k$ 在此人到集合点的路径上），则在对应节点间连边。不难发现，如果存在使左侧节点全部匹配的<strong>完备匹配</strong>，则 $ans$ 合法。</p><p>考虑优化。</p><blockquote><p>Hall 定理：</p><p>记 $M(X)$ 表示与点集 $X$ 直接相连的点集。</p><p>如果二分图 $G$ 中，$\forall X\in U,|X|\le |M(X)|$  则二分图 $G$ 存在完备匹配。</p></blockquote><p>因此我们只需枚举二分图点集中的所有子集，即可判断 $ans$ 是否合法。</p><p>进一步观察可以发现，$M(U)$ 与二分出的 $ans$ 无关，而 $|X|=|U|\times ans$。也就是说，我们需要找到一个最大的 $ans$，使得 $|U|\times ans\le |M(U)|$ 恒成立。因此不必二分答案，直接求解 $ans=\min\lbrace|M(U)|/|U|\rbrace$ 即可。</p><p>代码虽不长却极端致郁。</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">300005</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXQ = <span class="hljs-number">50005</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> INF = <span class="hljs-number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> n, m, q;</span><br><span class="line"><span class="hljs-keyword">int</span> f[MAXN][<span class="hljs-number">21</span>], dep[MAXN];</span><br><span class="line"><span class="hljs-keyword">int</span> h[MAXQ][<span class="hljs-number">6</span>], c[MAXN], a[MAXQ][<span class="hljs-number">6</span>], t[MAXN][<span class="hljs-number">21</span>];</span><br><span class="line"><span class="hljs-built_in">bitset</span>&lt;1005&gt; g[MAXN]; </span><br><span class="line"><span class="hljs-built_in">bitset</span>&lt;1005&gt; s[MAXQ][<span class="hljs-number">6</span>]; </span><br><span class="line"><span class="hljs-built_in">bitset</span>&lt;1005&gt; x[<span class="hljs-number">35</span>]; </span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">Lca</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (dep[u] &lt; dep[v]) swap(u, v);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">19</span>; i &gt;= <span class="hljs-number">0</span>; --i)</span><br><span class="line">        <span class="hljs-keyword">if</span> (dep[f[u][i]] &gt;= dep[v]) u = f[u][i];</span><br><span class="line">    <span class="hljs-keyword">if</span> (u == v) <span class="hljs-keyword">return</span> u;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">19</span>; i &gt;= <span class="hljs-number">0</span>; --i)</span><br><span class="line">        <span class="hljs-keyword">if</span> (f[u][i] != f[v][i]) u = f[u][i], v = f[v][i];</span><br><span class="line">    <span class="hljs-keyword">return</span> f[u][<span class="hljs-number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d"</span>, &amp;n, &amp;m, &amp;q);</span><br><span class="line">    dep[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;f[i][<span class="hljs-number">0</span>]), dep[i] = dep[f[i][<span class="hljs-number">0</span>]] + <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= <span class="hljs-number">19</span>; ++j)</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            f[i][j] = f[f[i][j - <span class="hljs-number">1</span>]][j - <span class="hljs-number">1</span>];</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> tmp;</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;tmp);</span><br><span class="line">        g[i][tmp] = <span class="hljs-number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= q; ++i) &#123;</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;c[i]);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= c[i]; ++j) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;a[i][j]), s[i][j] = g[a[i][j]];</span><br><span class="line">        <span class="hljs-keyword">int</span> lca = a[i][<span class="hljs-number">1</span>];</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">2</span>; j &lt;= c[i]; ++j) lca = Lca(lca, a[i][j]);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= c[i]; ++j) h[i][j] = dep[a[i][j]] - dep[lca];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n; i &gt;= <span class="hljs-number">1</span>; --i) g[i] |= g[f[i][<span class="hljs-number">0</span>]];</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">19</span>; ++j) &#123;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= q; ++i) </span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= c[i]; ++k)</span><br><span class="line">                <span class="hljs-keyword">if</span> (h[i][k] &amp; (<span class="hljs-number">1</span> &lt;&lt; j)) s[i][k] |= g[a[i][k]], a[i][k] = f[a[i][k]][j];</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n; i &gt;= <span class="hljs-number">1</span>; --i) g[i] = (g[i] | g[f[i][j]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= q; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> ans = INF;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt; (<span class="hljs-number">1</span> &lt;&lt; c[i]); ++k) &#123;</span><br><span class="line">            x[k].reset();</span><br><span class="line">            <span class="hljs-keyword">int</span> tmp = <span class="hljs-number">0</span>;</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= c[i]; ++j) </span><br><span class="line">                <span class="hljs-keyword">if</span> (k &amp; (<span class="hljs-number">1</span> &lt;&lt; (j - <span class="hljs-number">1</span>))) </span><br><span class="line">                    tmp++, x[k] |= s[i][j];</span><br><span class="line">            ans = min(ans, (<span class="hljs-keyword">int</span>)x[k].count() / tmp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, ans * c[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://nanti.jisuanke.com/t/41979&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;4594C Sometimes Naive&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h3&gt;&lt;p&gt;题目概括征集中~&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="计蒜客" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/%E8%AE%A1%E8%92%9C%E5%AE%A2/"/>
    
    
      <category term="最近公共祖先" scheme="https://tth37.cn/tags/%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88/"/>
    
      <category term="二分图匹配" scheme="https://tth37.cn/tags/%E4%BA%8C%E5%88%86%E5%9B%BE%E5%8C%B9%E9%85%8D/"/>
    
  </entry>
  
  <entry>
    <title>题解-计蒜客-4594B Too Simple</title>
    <link href="https://tth37.cn/2019/10/28/solution-jsk-4594B/"/>
    <id>https://tth37.cn/2019/10/28/solution-jsk-4594B/</id>
    <published>2019-10-28T14:33:19.000Z</published>
    <updated>2019-10-28T15:08:09.089Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here.">    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="cb6e03f1f6a09d393f6acf0eded1c65b298a6c4d46cd91290659be8f324324a1">c03f3060c9f1ae8757f4c8372012c368774e30d6fe06dac815065efdcaee0a7aa0a4588fa8d267641961ae1523b6e9a24447a40288df714d1def8bc0029614f97cc352528f082061e01922a0af014d0554ea2c0c1d77bd935c11400f9d7721c7314ee735935fd0bafc40575a0c294ef1e5b59463948084333c5a6598e621c5ab9fe7957ec79acb5a17206081cfa8161f0e1015a22769032993866d7439707fa33d8c0927c4561146950cdedce84358861db382f8ad8d14977a4b9b26ba058a04ea592955c6171fddd66b33bee5ac14f1a5907e954862af358518ae1ccead5ee03bfb2ef23cd592fe0be05aa7a61ea418b444f2ce83500ad25c85eb4180abcdaca943abacdfa251d5c4050377584f81dcece93f3141b1b15bef7ec4661b3fc48800eb3b4fa9d18c327b92693e6b1de6c4e9c72cf82d1ff58e889f2e7f2a78f138c29534220d75a12706b6ede122905007d4738f1a0f29520ebb621662ae907e270b55bc858c8168b775e6ecec7a7ed66be05c64cacd26ba32969334a5cef6beace936c08b6507d97abc3a6f30870ccff781ea86e240cc8dcb8a25208b0c7b84231c2afb963fc81c9cbedb284b16cdf2edafafd020d762e64f497fccac05054efbbdb59b9d1cb4a971aa5d8c1ada0aab5fb74aa936253dabc696439d36633733603984afb7a372071f6a85718fa27d37499c7f7c850df96f5ebbcc98097272705b25240208847bb703b84e5f29a368065b1307db5b04979f7b8ad4104b09d39051b6aa36473f4e882c44afcc2bfb5ca319cb6f4a521560950873e65ca3bbc9c62c4630e9fedf4d99092ac3d67340872a708f5169add5a945948bf92193487f4ba3ec7172941a98398727d48ffb062e4c4369c100245b67469a9478267e4eb65357f809f6599845ccb1369847d11410fcf3093db77802a1da36b0e19635a097f05c647def00f9d906a947a7168953a9ed554689e628b13428107b7c6fd886fad28c9e5c1eef8530efcba09535e5bced01b1b0ad93c4be063fe421a062e14b522cb06903727116f00d9bf87302e140e52e0c87595082aceff156301618fdf145ecc1dbb2597b83005d06e16d1aa3a5f4b1e09b2844fe3e15d58c16201ece8a6434db3003910c6621fc5179f4ade9d71891ad7abd645a158e00b4c9aab732ae18ca2aaa3e50826258ccc7b3692c2d7db0871eb23d36f2157b55e7ee383bc62ec3dbff191a5359f48ca988dd464500dad5035e37b6e86d8269948adb9168fdaf700ae7e0ddab99d41f4d28a3c7d80cbb4006fc16c588d3ea7dac775e4fc316e7f6c6bd4730ca3d35fcecf426995d75bcb6f1ca0de4774af7bdd5ebf140597254f18273313e3f07f68fee17a5ffdd61ce55514980e541892c453f84a7045e1541297293043e1e7f86bc8a01d29d69711f21dda19530e12593b20c3b64aa104613a785102b52aa6b71a0bd591cdc8b7cf48ad6a132c30e011d0ae724f05101af3c41f6d9fbc0a115d0cf0fb502586befdda429251b5630525d8ebcc807cd5cefda0d826592e73286af146586ab37fe94045e5fc65836bb5198e3f39b992ae8caf3730fc31f48679078face28a5701958516c3cce1f6c45c45f6bd362ce8c4ac14c4d655b12c7abe97dca964169f4cb18c8d5112197fbb2731117975e80af262770c699d9d99f319832f2822aefe12b52810652f08116b2db5a62dc54a476e97c73d648df21095d6ea7e10fea546772165d85f87279c60e10b90065e70d08bebd31f965dc75d5355d714c66c7dd0cd2c151154ea366d08607a377c2197bab1a71105ccc3c5bef98f2d9838e539ee3f3ae38f8b313c7575c67ceba503f7fe7b2e1a6fbb51cc40893559ccb14fafcf8d2e4e55a3f32354a98c88fa8c72db2fb7b32d655918a51f73f4f264fb8d15ff4e8fc2b04169b636ee28d222eaa1e511001033d9df7b774b210f368ca25470ffe84ac9a216aff1c9a7f0d611ec33192cce891b4fe6a2a52282b9b2249e4f7b6f1f520afffa88324117d2f42174b10382bd0994c92f43357456747066c50f42b18a40b60251b4d918cd361d771313cdedc1f705f7d01ff454679a701ba75ebb8e554f789b6a1c1bddb00301d54359057a4e94c4aaeaad263cd97e3e309b9348250286773ef89c4c1692b79e98250e8ffd3db648b92a1e4056df235ef861f0bd233c37bd90ff6c7a07e612b6df0853a27294951b824cf2ac8bd6161f0240f1b38d3a5c1de0fd721caa35cd8cc93f5aeb6b02063a86165c44d724a9bab0e623f6d7968973ab7f3a55e5d5ea5f3ce877706a509a3f383e1027e459cd1f5b78409486102fafee10efff3e8ef2dade2688e732cecd00ed1b998dcefca2d6f97029c6c0ff726cdc1ccf732f433d9a46d1823c63c0f0cf490ce6df2005f4ea5e991f9736f1c521405a16f70299cca979f67b5ecb0a722c56f4466e3b2cb465903a6e7bfed7e069d632e9204cee327e5b69344a7e3cee9093606ea21867f39ab64dee73d08dd087eca658a5592d958158260f48992ce29d1da318be4b6a5d596b07a6038979cbf27e58ac8aa991f364149651a7c044cc0dd392dbf6212b0516e3f8601a04bff30846128fdda6620f18ed2d238573301a2b128c3b150e11a5f718f5581eba140159fc4cf2c211580675ade7b4b0a1458eee58683b316c8c91e2e7346f53f6965a5142a4f3c4ab4c63da4385b2e0646a83e6fdded66e178b40c9e084c80b096d9616bc3d539ed7c4440178ac20dcff904935b098137aaf458cbaf08857e5972ac69408ae30151f7087bd8f12d019019ac7add94466e968b6a570beb330fed3c91eabe66c73791aa3f3a1a47bf2d22be31f30ab185bbe3e3e0dc960d2a97171474ac223de744f95f3eac378ad1830b74a32c52964e9d23171fc8ca70321479d9037a10c0223b9131784054b661a2d80cf577b0ceb1deea1ef5ca604d8cf56e223fa7b04d3a8e8b037adddf927f75d5e379226f3cde8f7b8f9567f2ba30feb00f2496536cbf2c98852bb10f9f43340e2f0b57311115e27f9b3bd5add1f20ec5503b06be22a2f7e491c9d1dd810bfafdb398695d70070797330d98bfd0bcd065e68a5fcc56576b50dd0bfbccbc566b01bef1102ad544c28c8f4c859ed80d15db6e83fb12cd6983ddb5d5e58bacecdf4cec906997e2818f092a078424606c1e152e1da3494b1bba17337473edefe59c736a59110242b59ce244e80cc2563e13d15ebec7e10831c6533b958e5efad5aa287df84598b30c1c8d1e5b35924743b7368a9a30a32a7fbe3d9ca068fa4c1600f34a4980d99ac6995cfb459c2a5eab4a2f6a61b691371ce8babf651ffb964f5c56c09add9af5025b40d4ce1be36bb24a7f6c68b3c8d892138095f82a7b4fc013bba6e71900cc4f801d6934edb2a8ee899e61760b61ab2512913a90c47f272a4aa60ad2b632fb456bccc6eb89678e437861cb45f7237f853d939a58de93a5e4a66cb58458b607039068bae27b7a0c241b7bc0dfe2f3a5191c903fedb72d74fbddcc96ce960fc6f0a74d435a34860d89e475c7e38f1bae454b1417be408320b348cd81495eceaf1316967380a95ef4c7296f960c2c50146641aed4b3a8294dbbef4f300723543445ad6344e73d0ff7b04876de827c469be925d16b38285054020f66d9220f9ec3d5b58c9736e2a176cb0cb75e82b50f1b4105ecb19ea62584ae8510663576300f7e0146de756e7eeadd796d2821136f4e0dca354401245ed40e44a069913d55903804821ec24553c810ba3c238484dd324a5dad7c3ce430fe39cc6eaa36e792f07eb27ae5a38b9b5bb8aeeb3f180744872fcd033362a3365bf34f5460932f2c2e4fd705bc82a59f7912b23766d7db60fa5cf5e20ef2253ad525a7f730de147d38335042c45cb7fe4a1add4248ddb19ea01fe62450594a7c6a85ede1a1581a1108af3c1ae4e6d1d9a9bf3a73bb43d2b0e0543f0e9fbad94a4ae178de54cb60e9401dc6fa56cfaab689aef30b1ee926edf668692d584b865cbf9c0f813a89eb1fdec2676fc5ba0ab22e66727e00ffa736ae791ff6a6757edb17251a946c2aa8b85d8a1b7aa581930acfc192e53ff4e1e8febb3cfba81d2e888eaba49ce7c20338ce4e9c3af3082efc2a2a74c71b5aa86eefe826fe0b90c8e96cb94a43a381b967be8818ded63729144e0709f79b0973fd8d6acdff17aabcbf2aff58b665a7495b1a88bc83431ac7c69f410d591257791c3fe28d05ee8e784cbcbeb2d3fa2ae5a3c9d3743d416046c14ac4672997f46cde8b3b357e7f6e2b538bdcad9ae3254147222406b10c81b4bf88c9b51687e38e073fb8401c30b79886b7d5b70de0a228729f16edfce5420c4cbe35df69e3999f7d9951202a24ff9a988a87d6341914078380b023ad5eae3ecedcf51dec11163bf1f87398c8b7ea00b18628e312f667d48c13defdcb931f89531a3fa73694f2452e392bb59cd28bbb806e0d551a5d0512f7c4969c6fdb200e14be112ba93cb3dd5b87d79d9da40c006d95e47d8c955666e79c71aa5e03bcb8a453ed0d2dcb5688aec1c7443eba122ce782674f7cbd6b6860214eb3dc2c56454826a1d1455ad1eec2271be5e1f470c68cc7aadbca77bfcbda09b7abce76b21440aed23c0399b9d018dc4916f6092cd53414d846af1304b0b38342ca1f511144d6b9622527ef891c3dd02e528d56c4fcef28ee8bead70ded07658a1077dbe2eff39bd5f7b86a12cd9ca20badc322ca3686fab7ed9fd722536a08366cb8b9cefa45b13d4faf0beae5a5cba7944a894302b56eea4595cd5b591cd26a51eaa3ca2880f48c9f2c55b377fc6874be4026d56bc5cef5099fe3e0112b44ba2a13a044f0abd31569a8040b0ea5fdb5607871a95c85361729ae672e2db2eecbdfc5277fc1c48f9e5a72584d70787571f65f903604c533e2ca02a349f8e4c1f2c438f68c3c49539c188358876d0e6de5dc284d85bc25de014cd3af7a8f3456cb5c618c56977f0b223cf4cb4b6cd2441fb36aa950a11208c280ccd4c75af1da9f5b581414f02ee0303ac42b236c5981cb48ad6fd1ae0ebf6ed44bd7f7437dc7f6eb799d959ff4cba1ac10dbbd3b376700954a170657cc536353a7c7000a7fee409f0484ac6b8b621a65f9f4befa57bd5ddfa795dda80d91b7d7fe12d47c9d3f0f319cf983ddbcb90d767861d17a327083e6844bb1ddb64053d3b5a217a083ba0bde5c01ef88e65be4a4e524a4534b44f299cfbbab8ffa88f3c69c8840c37e3b3a1d9dc5ad507350f27f8199d80ce664f7d4887e60c09c0b57243849b2521a1358bb4ffb25cdbae12c780722137a4cb5d30fa82d3cf58df598beca3e47b04d82686127166064b86fba8991d32c2eac69e5243b5c5958b7df6e0dbacde27aef549f8f0b1b650ce960cba8ba1bea69fdca9eff56f21dfb64f840a94af5631d02dc033186bc52f89a49a8666e352e60c1ace589c1fe1d3862508dd01d4f69381378a62806a8ed175c32eb96f3843e640dfc213c4c6606e5eeaf5a3ae2565c5a5c0bbf736f043d763bfe9c3df50ca7f6d54118260502458f1309a9b1f68256b708d4e155de1bcc631a0c809c2c20a3d731942942a08b1e67859eb31de67cadb6ef11a8ca97a2125a839eb40c1ba72af930c0ad0c81f7d04961638f46537b735ccba3b478436104989d556095dfa88891d3c31a7de618105f8447c90cb4039fc8e5c20cb7f97beb6a38b73195813d0f49e9d94131d528c4316f84e486c23be9c4d6157824b9f2f746f9bdd36b0d6f92a35fb11526053b67873085d8cda8226c8a224e691f2d3a75257ee28b5a3fdb63aa790f5cc7531329e44a0aff8fbf9c84cf35037bc88b06c47039583d007a0c5d1805ae6085d15d9bd23334bd9535939f7824a59f798ab4eadeb16cb9aef2a8b5aa988d31e87b713cb57bec3bafe33d40c00b096d5b4334e72c52d258d3a054cb56a158c76c80c6635f0b66f477245212df524038e7d87fe8c137d514c025344f0e97fc4b67a412e7e353c3e0c20aa470fe95f6254751c6a4903c2a808d2bcbc5a5aee5c6fa8298b5dcd2c4c95199a029ac4debe8f490a908ef2ee5f81ce9d1f3e8f4427e9cd7f9f8a63d601a6d05dfde29948011850fdf9872e37aab6a65b6acbbc5cb8911340aa184fbdb83d2cc6040700ce296be7e9508e4afb7561d3977a2e3e9d634a1b02a5768da5ca1b3dca9124a2f4ea1841de4caff036741ba894081565107942e7d17ef6a599b327f3cb446c0d16abc79aff491ee14ab1826454d31f66d1fc59c9ce892cbf206913ec8db97ce1eb82c05708b8c04cb017127d8dc92d409b289906f4d6a2b36b51b35c4f7513ec8374796fdce6328887ed3c7d6da15e2c8ee8f00f556bb5c64126980391cf58c2b0c15f8df9a74b8e789084dd1f806546871cfc4436638f02ab806037ef3963af1c9dbead32959ae40b6dd5593e10944f5086066e42bfd74ac98635905ab1468b34cf37a4e1ddc30ad2754b7e736efcac49e01ccb9856ccc2eacb4bd2000b2736bbe3b784862daee79de3ef032668118e31ee2b53ddc1ac241136e092bef9c05d713aa51eafbb48ea2cf327d8ff6c7e7b9e8b99afb365226c899229afdaf0c1923346ccc026f8b78d50e98be2708b8029abf06ccf4a10fe1db742ee704e73e1e15355a66e52f59afbacd76464cc22cb45aef3a68db0271373df1504af2d2a78a95e2ae0f9f06db06fdbda8e789f12d3db89344e4bff4f2464539b81c03fd6f7c0da690442a985a360dd3e0d7fdf662eb8a2c395814dbf93ebdac40285d67c64120dc2b4a1cb0f95d2c99002dd951fece4e7d8c6ecde759b58c0b4bee10d3b4fd604c2e79a511b5c6129a3f6419907dd753301fc389fab20d107be5ae3696ff0a1796a15257c7002c61fb9ca256535aedbd4e087884a36c88348132b05c366d9c09213a14d7d78a4060f2cd2a06800ef49a0ffca95542b2c9936b679f8eac026923e13f5bcbfa502e784adc9e3018ef0bc0f2d3f207e50ff361a07b25bf9f951b7d1473cecd7fc21a12334116c67ef732f92019b3e565d0cd67de21db7b21efe1d5f75a26c13411b20404d889c1073378b08c3667e6e607876865110a7c0205b8ac6077725c9c16f477174ef79fb27c552ca63107cbc415bafae2cfdf1ccb71d773b058829c23fffb9cd8975115eff3eb862607befd4cea59fde6ba1c0e04be81579a630b8fa3d9a0a2f15f5c261adb9dc2f2ecd47f57dc741a57411155003ffa8fbf0afe239d0af56334e3797608c61fbb81e1a775a539b366dcb06f6fb0a4a9fcc0905498c165c507f1c46ac54f813716315ab157a8720f01a487781e285a637f4901ed991fff3c0d6b155f1da7860e9090e53f158d142d4d0cf016c1e2496bb74a9d31a0d2b22862230e89bcb264f0533bd5224906fd51867df9c357a51b262d570dc887fb2ee8dd5655ed249c1eb71951fc0685ccae6ffec45558a235c849253bf766f033759c0be107082fd65a4c7aa792a91c6005c293a213565bcc8f01c1e7896c05d0cae70f7d09494f0efec680b3e8ca6b1d7452f1d8d8eaa3575b571b1f4b65e5f2f325f86dd4b1d35808bc0e3d12334262e0109a34744d75a6e93d1f0f14ce506abd6dca6f722eccc85451aff309fc791fdff04ef66b49a512b9d45b28a92e79d7ce487b1bb40a201a7e37b65681304025360756aa60beaad6b86d14173577a66d6b1c1013648500b102843d5779dcb5ca17c62383ebb1110b9e75e432af2bec516d398041c3564bb3811083c8e879bf5dbce12c830a81ccadded7adf108603e0ac39a160ad6ba7c3bc7f1dbc86c79b93d66b9f33b16beac3ad8737879ce7f037ce2bb7bc23c1177812ecbbe496bd5eb7f55169f3a509a595d79df44e4e43bb0ccdc8517b21e174a10b8b783a67bb68c10c5391cda0e8d76e3c04c86dc97571f5d1110790f77608cf86c778895016f49614d0b7150076babef8673370df7bfd9b660188651979f6866500bed162f9bf6b1b9c135f9c09539f20cfd9f22f7e938cbdacca4efd37db5b95b72211f3e2315e318d3914933591e147d60b8c24c2b4e790aaf312af1831ef678470ac828e701999979e01a7d66f66595333a9a4169205810607977e21f5890dd1c2dfd67043c6e2e3b23bdc4fa96381ed351cae287da931770341d9c4ee4303986ae8344a40faa2cf5527cb3ca6247912e5720e2e9a16e1a926976379455242f984c285cbf635e1100eaab3d2e21c2e38f7d959b3f55fef3688b8a7288c9c7cb124976d30d23f8548f513545a41bbfddf7b60a4c3019b407b9d73236f8d82f729acd37a3c82de157f9a2f211cc044dec041a640942e636c18eff2da88b838262d8d3cb22f96e0fbe5baa8093cc1c44cebb2f9ee5db570c6eab460d32fd3be341d217fa863905eefb48fcf5056949d814193a2aa72be717e72e01f1bb88813e1fd172dfdefb5d9f86c98ba702bb321d97065d71405e7b3f4900fedc7736cb641591f75ca4dc5569bf85f5c16600623b143e06d34f03285cf72523c3c0ef6a20d23a57a0d14b99e1ebeb8555940852dc7b672b9e85f52226f7584c1114bdca6e6be593fa5b1fdc22efaef26bc7380c0a7d102108372909a00bba63ce6037d23f1bbd6cab06d596b6e85f51a5061830d3b58aa43a47a8e45b1782722bbfd23b23269f7e0360a2fa055c13945820ce066adc12abcf269e1501d699bfbc80e36e5cdbe8042ada7340f089deab2315b5298fb9f1faabe1cbd6cd585a06ad14151eb5146743fc3b1999a831a9a9be8d65c4b21d664ddf2782688641923156c0e38848597487297e441e17bcc38f9e334c3de9e08a657995e4df67c6b8570eb65c1fd895c48d9539fee4749f0d61770fa2268e7269124e3182cabae7b1a7e754505b83a2f7d7c36b4d2205559ec524fce31d7571ee758ac454e842c265b60105a0e90a0f4f395cc5d819cdbe2e8e4a89e6a63ba85741bed88468a04e094f02423c131685b2de72972864a3eae0491a6f0649c2921c86c048c54987347451864d33435460badf78e8c368fcd91bc4b4cfa47991f626353e3b35d851701222da040b75465ae27230e09b80d8aa9775d90151de97284b50c477bcfcd241b6cde7a63968d628a7e1b89d604a67e6226c3af0a1fe8c80e854f53d7d744a96fba5e5343ef38bc74eebb0c48f066fd01a20be58c6c263a5fbf2f9fdf9580f49045d93e6712cc96e38bb06e041d736e0190cd176209d16341f2d1779a754e621fb3aac7a34acb3ec060af943c1f68bb90fb78885e2e6e13263f8e2691e3217b3eb05d43271193115cec60249993c3079cba4599320843a6a56effccc1eabadf871c97987f2a54f8026a1055c897428d1fc23043e8c07ad3ade4df19a4ce3b77c9cc29686b4f2fc6714689b1ecd3a2c05c60f633ccfd1cfad66e5053b2155c98dfbe614e892f0b08541f8db8d047cb3022d80a37fa795493d1d8770557e589360d785f2ee630b217a2111af5b312dc75f33c97c48be4467d668e03fe7e2ea81dad92f14ba5cd01cfa683f11695e238941fdad53533f462cd41ef6bfaa35</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      暂不公开
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="数学" scheme="https://tth37.cn/tags/%E6%95%B0%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>题解-计蒜客-4594A Too Young</title>
    <link href="https://tth37.cn/2019/10/28/solution-jsk-4594A/"/>
    <id>https://tth37.cn/2019/10/28/solution-jsk-4594A/</id>
    <published>2019-10-28T14:33:11.000Z</published>
    <updated>2019-10-28T14:45:14.828Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here.">    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="1da9317495994d03310bdd38199f4133a90d78254af77684964a52124fc21fb8">c03f3060c9f1ae8757f4c8372012c368774e30d6fe06dac815065efdcaee0a7aa0a4588fa8d267641961ae1523b6e9a24447a40288df714d1def8bc0029614f91c73da50c019c28980acbe2c606c9bee741dface7794a4f2e9b74ad92591440cef739e0ee856985a0dedbfebd07c4bdaebf77d959a025af221d18d729294b6251438a7572888c58882cce47a97625c3e4330ba068031a30a9ff05ac61e0cf033fb5b9582161cdce3fbb381c80fe5ed8a6a50000d93c75be8760af50a7be158155a2105a68dfb0c19b314cf9aab1e64ad95b2a20aafc9fed0e4cc561866e2516c5f62de9d65048c3961137f22aa72bacd18dc36ab4947299d00906836b230f407eb7a60138526d63cb070e5f9454b2264f47dac8574d5ab13867180ba2883607bbff3caa4d21d4bb4a8bfe69d3a7033b79beb35d45e561a60978e35b9d0b3a3d7274c0d2b2ac14f7966de7b2814e89f47e8f135fff36e0856a34fcba27d15b2d2c80600d1def663071a02279c3f2319c76a599a3ca7e974a20195d5e50b962aff158c541e87d1a99f706fbb037b2acbb487ef60bff782790bd58a0fa69529a409f95e087297ee1b7b92b008c6fbc60fe53eebc7b7756a5b4a7491c3706967c2df17aca849cfdcb77f88e01783f640f0ed2e6d8a691fdb25f94883578c7f9559e2d92cdc65091eb0adaa82f28dcba4ece2bea1cb6e72893eb243e7d9920dce7ab4b7b6b83561dc61b6b9e1e25496d9c9b02460bf07f25169da390518be358afaa7b63ae744e45076e56af017f067848eec006ffce8c13c359efc0e2ded31bcbece6341f4de8a07a14ff3f0740e0853c10db9bb18b566ce053e9dc4938a0ef03b8e2fd6bb375ef06bdc88bf24b3bf79815431b8e01be19b0ce4830082c5821e540ddfd84f9241194de28ead5f0715bb0a084afc886388b841852f3ae69668f0d442b2df05273d91b8422a4083591963506dbc8770db6ad6c0faa59d71ae467ba680a7ee98d79fdade3fc86b284b6b4a2d004619bad96a890f1ea08134af16ee8861f3d335508fa7cb2868ddf6cb7eb345543120bd34a740442aaa197473b3ac977dc0def67ea2d0d868f4756c47de54ae8103089067e9e88b70c9ffc344a602c5f84f80566480f8f404fbc9766fe0af95228473a3d6241739175b15ae4edd3e2ffb071b73743619e1d8743ab9bb40e1868b1cc5556373e570bbd2ed64e47f66c53a584766d55809bf1a55ff998079cdb25242d4f3f58f1d35165690e6c9726779e65444f6a95389f39e053850aa064febac25e727629b3d64122d9b52dfc252f941e53ddb1c061d80fdf2bf46c54abfd5c32c55c92080df67906028f4701eb488b6c81b24eabf87e48d1def3e6c42219359fe316ccbbc175b61d258201cf04982c8e32b3e2c84223d9952434c0e31ba3239c8c434a8ff8dee3c430add6d1385e63246ef4bdd8f0fb4cca99d1faffec26e71c8ceb289caaa1b93a360af896e7f78b1437ac1b6ceef825616057756916b663d935068d6239940a84e10838bb344271b54a8a02e7597baf88ba25a8f72c584e1f3f457c71557ddf7da3f7c6b8e2153f9c258759dac477e084d7975f2f93e440ed388faf776ec837504ae55281b9ca0aec45e31e6e1cdf70ef8fdaa279f2e9205fff3692ba28ccba8b9ba0a0597fe5a7b63399b5fce0851c0c5674a0e0474787262d1b7c7a552eb0753b08c8f034be9e57ea737eb8eef0b03902ae10662eafefe0397650e2c42674994ca5c0a46d12413e2c9a14b649fc4605e4b45925f292710c7a236bd98d92122f1fc9e64d86aaaab203671ec77a2692325c04ca0b3443076f089595dec0b1143ff8f038e543003df140c15db72c2a46a889b15a011468d190aed4351efa9939523d7eeed9a7eaa3b61eafe72ad4187ac37c111f19012692d0dd2f838f66e025bb766f971829ce6ea500130219f857ecaf4d8c1720d04c6efdabce96685af20d9e5fba9daf05ac73087f5b0a5104d80017246340ac45b7d04d0deb1baca046ed8ea38d30b6eeeac8b661b9a814cb09c42d84daf85f09d5106729e044b253a257f35c70abd0263be931c588ca7e4f8dd6b28a7a2e1da76cb01bfda84c80d30e4ca77ba627ff481c141d0067c906835bfe7c2946925ff41108f768e9af0b749f86d75218a65775258c3c4c556445c5dce99bae2e688a59bca1aa79d909fc25415152eade9a283cee32ccf2d66e9fec5c0ab1fb89c63ac43ee6642328c52368ad5f0991aacec4a993d73e72856ebbcdda86537af3831608fa646ffbd0934e657705092febda43eab07ef5854c928440d27b92d523dc57ea8237e60e1352db9a30d8bb5519f121ae55e72dbd6040180c5169aae90958351ca778c4ecf7b20247a68cd08157e69a75e0c004c099088eba95901ba2b2a762343c5f427951ed3e9e09219612010917a48568d239f1e0d16441e9e251cbcd58bad45d514a23a8dcce249ffa484faff72fac1b925d54d2ffa521d22237faa8e085c58c9256ab7cd1948f5c92a699db442f86a9c8804e272cf6ec82b45d3192fe6a1378d228c579a2c316a0682fa145a27c2c270434fd535e5d0305591e20c7c74000d2e4e9c93839c97a6e310569dc3902ecac01b841d1b4f3f8f5b6ed871e844409eae05271737178baf3984826af7ffd1b617ae64721c7cf49113560c70304c7fd1fec431a43528d036e8f7f8bf3cdccf6d9d67040b724ac81598a2f0175290a81e8fa5a0f52704945f5e5d9cf1292757cd537f45e0199e112f24868aa5f85f49c429d334998650661a8dfff4e48b001146a67a4a8afd76ba9bb8362bb2cf070ce7db290887057dd05efd6b58666f6f2f0beace6c9c831fbd46900679cc79d024513a289f93cfad0d111927bc3c0cd900aa852c99e4f5c4e8c9c09fb8afdb18ce857ab40fb033edfcbce7bba6126ba2be710dbb167c314e64cb874d90f95e333d5ac24e0f2130c0fad0d9c2dfaf081770f122aa9b80429c74deeb8516028d1ef2b0556169ed83e0407f52596d33acf39cbcecec0946e6918b50a35c0b9a052daa1d1d61f083bb982f850b9cdf435659718b0791086f1aca331baffdf67fe2d5171fc51c9fbdf509554fbcb095fccd6832250b4f47b2f71c8d293d9dd27b69539636cbb801f0c8dae16fb050a1cf5dfaf3c31bac53aed9a70cdfa2a521b27e6e143dd54c1b31740a547cfdd5a1f0b3120b450c709cc28d70f51d4890abdee88f919d6850fde3c071e34901d6c906481592f3187b3fc69ff1553e6ce06c5becc84b50f0d4b400e3537e68123f70f8c66fa651a50697b53f095d589be1492d43003e70a18d69a8d6d403b29ec53f306e1805fd8e9cd59125b7972123b65a5641e24645f01bec146cf47555f08f6fd51b4508f5b877aa2e3af514bbfba29a8cba958c1a92f9c9ab14d728277680b5b9ed93729112e1b55dcface7cb2e908c0117f085ddbecd30ff9b0c76cdad87545b96916b500b39487018cf02b7940bbb0a6fc77192bda7fab61a03e66a50c33f0628cd5359f16e1c73d7059cb4293afb72dce17f3390f21b97f8bd4f2cc966622d8d567b664c24bf6298418517a651e81d870e043b3235fd754d2d55bd7b9a3f22780be1dd5252e4f13a456d23cd517af3f794584553532c9de80c1e52540d9ddc3b3b4a4f1f0abe1dc30a8897fab9c6a3677e770b0a75b9bbc3550e4af9e28ac3c1d0f1b3813fad18f59f9f712932f8ee713d0bfe5e6542d46a55821e11751081385f601493af8b5ef0bb607173eb95f7c98ba76c74290a6ecdb4131887321504781d05018de2ff92b01b390144b37ebe0b62a4b147337d484170e2100a630f9cbc8a2d7bbc85c56c84a6c029e6603c9de11861dbdb13f35f5016b9628b8de89e5f715072c943028b37b1505aa283ad1c72a7f9929a890e44453ca2129e9cc6c66250c6cc6dbb52d910f553bb13cc9627a83c73554903b2ff4d18cd1014d37f8756034dabce94d0f67bee18433209eca73220e62fa61406d9c47baeb903a34bb18a057105790f63ae4bb465699300f9d8698308263e5ac221b38d3df7cc372e8c5c613f7ce59c3eec349ece3cbdb6a68efc4bbdf48251fa6abe3174ea98b4a533574a55646b4bb00a64f5f7312ca9aeaf6c9caa6849d55219489c3519b5aaa54a392eaf969fd478e7d4ac2705037cf9030bfab7e148f70e1bf5a1a00f497db27d8043053491d356a15dbac354183d333e48a12017ab7c980273681b0d9a949edd9f29502d8bdd63b6bd382200f5d2551c9b632287aba2ef9f806f71972986fba58ac11350333f3c617499a7846f689100bfb9575a5480e585e5ac6198145662d746a68c3f6987d56d76e557881e54126a6337596435701e2cbadf4bee8bbc4dd727ca68d2b0688f30c2d4635b1f8980e139ce04d91fb37df5cf11904ed1e131d5540108228f0c223d84d52a8efd43022f9a4d490047c6b3aa5240edf0b2faace39c9604ac709242ba07e63d5354a27bfa69f7532c83c1097106c882be9cad0378c7fb8f0c30b0d30e80c01c4570a39276111a821624d21bd212e8608f08bde75411d61b77f6502893a1e998adb0b21f04bd3df6e970ecdf7ee0f383b076da0ddc83dd174c8687ee44c0f829e3d7ffd2caea6b0c22bc4dd3afa62c440c5d1c504c09e3da5d1e2712a0c9e1152cfb71850dab60b9c2d909df97b6477b1843850c7f6272897acb9f5c42617925f41d22ff560650f6969c66949715c85b0886179ff4e743edc7243a501579a8f8cc881c211042d586253277dd7d35d9299e57d06256b04ea5e452fee34a01e8df172a88a738b2a1fa369959f38f820334e39fbd92c95b95d330b656404892fa74dd4309afb046f69e01688b74205a36f188db0c7ce699c186a55ef0fdbfb785a231c51d88b525a18ac4c7f3b7d47f4c61035e5f3136aaac51d9d2624a36df7e92bff256e62b9d18fc22daba219fb579a401b607984f45b5086420563ecdf57c015b49dc628d75f1ce8f230f028bea6edb29ac068a1260e291814d6f96ca5064bf73fcb8e5fc87597bcbc54c290a77bec3bf65958fd02819812cb431ce24fca5670c4393d861361e007af5bf2375ba2042c1558435fe6e8b5bf2ba6f8442ec6829a97526606410d49149d299d32669d86757839759ec5c0059cef8434daa1d15b35dd3aad7a7f86c31360b8f6be04706d5f2c120bb93d2472edc45cfed4484b9a715dbaba05a847f81a7d3c3cb3ffc03446e238c4687e777a65c54a33abf5e0478959c8d0a7d96ef85434847a581445b669bf8a6cf6d1e7d7e820ef7335b830182ae7580f7a2af1980d62d03cea92043fbd4d894f7bad38a04eadf68f64da52ae218e944a790e3cff34ead8a80e6122056064e989feeaf37f613efc0075c0d66c8ac3d40e6e851b7b09219a605745d57d219128f9d8757a4fe74354fd1c996f96102b7bfb0d74f969fe61e5d6592a19e7a3f52957574f0fd947d0787f232b646229f033fd8e9588764eaac246268c1aec199def1a343fcefc121c2d298af0f15a7d03f88d602a490a5cae44bd1e048eb9fa263d259eb1622a8b65aaccbd585eb0dfc957b624a18f0e2ee8b07411be931047b6e8ea4cb33acbccbdd75822328eee377de8814126a0d2abbdbecfa86e016fee936acd3005c0be1e7167bc2de89f5cc6463528b02a2d554b324f0718295cc931e0cfe418a393465b5532841292306cf07f2605bf9128400e228706f347fb0953bc9873106d841b4e68a6dec5a9246e3b3ff5b8dd40253fd9d7605e95c34ce0cf0c957d7753d469c785bbb7214d910db2d67514e40d7c55bc1474abcbba03bb2ea27d37f2d95a76d1ae4db9beaa665f5f30e043f12eca32542a6154a9b79ad4b9764ea7812fc516f28984cbd4ee0d8950e8303fdcea5324866254b503fb176e22d982f0b4682ce383be6a2af2797ec7ad193a53145856e6f2844cfd07527ef127d3e7532c1d6a1389b649dff7b5d5d68710d2d85478bcdcc80cccffd9e7bea830c0b6fd501d9d5f3ed59f52b251ca1251f90697ac062d9dccb64d90222fd33961e572c6fe5dc0bd4c4e9e8f75b9d21927a39b81ed9c1c860f14a45ea9b260c26a931fdd8d29ba2aeac5440f8f0506217e41948456d691d98225322005bf33ced5d5d8b8ccf77760eb3d66663bbe74bee4e571dafd4e7c8ac010f00a18b2d92bf59d48b698373f2f3ac83dd680c8a1dafad05682b8eee67988f0a44e82aa4170321f2b95b9eec805e0168054ea4e2b1e422328d967f7795c26996905c958050c91e8218cb8675b17a7aba3237031c1ba4f92e387c981cc2546e7d31991ed137021aab98f89ab35ecddd48e398f89279906cde6856df3520891362c0d2fb5d8c72db0d7e53b6c8a865a21f0a073ff6e4ccf95598f66d9e9f14c6282beeb817b31bea96e18b07dc0e1ece9e5f41db8a5bae612705398ea4582c4e0459f8dfb807e567295d8570901c53c947a8a059a202453c87fb4a340f86c44ad0a5fee48248aa4dca6ee444b65340afbbf5896bfe68b40f6081e614646bc3650ef954d97c2c07b67b30b535566998e670546950c64db491051cdf4d502dd72b5b6db66bca9b709b67b752ac0095ca0d80e3772ae1620e2f1331dd4a7e11e51f73f5bf88cac88a844e48b518bc70823d649e9d361903ba4e1c33f4c8c4d58456458ec1a509b8b737a398b65162db1c3b6859be8c3217853d867e1af38f3cc65149b802b00cb25fceb6c835987cb449dd2b7e0543587749699fb364124d468b9e5dac56b445a4f964584503ce6dc814a73c27a2a600ae17f0d01752ebec6d7a269863179d469606b6545476d81ef62b805621c442f4b42f5938f150a861fa3877a2ae6a3d55bbd1cc6f68593a81d1793f160265c810d7242bb71c1d8f0afe5c8a423c5193879c72067cb4a0228a5658b92c5864faf2ed201737e3d4a94af727f34ce1d9bc1666f2f2daaf0afa81995baff202f59012643e32033efd2587e30261a565d6ee906e80ce0329327894b43a1f0f8712df95ea9e17683fe657cf71e41f8205822e3214e7e046d8e6b17dc470cf84312adaced4d666cf44a2838881966e70f4f6203d7edffcd89ac6f9639373fc00557db30d470309441791be17c10e6dc064bd4515d52f117248cabe608f7cd9951673274623b705d94039754b608a540064976b3a4e0a76232f74dec086e761c783809d10b4e5a85ddebb283347c3cae12255c17cd6ec0c533929562ecf741aeddde203911381c45dfc23967c3ba86d69595f4de4ab2935ad6a7d933ec0197fb50c5d4abf0bd2c09fa1941c4e3fdcfd8b6065891ddbb6a604c74b0bb79ef494c5111e99576180056232fe360e55731b3c2db6866256ccc9dde5a55bbe833cd4654130ace539aac566d3383bc49b915f8bb29dd4d5150d930ebd556533992db75eb5f72f201115301b1254c17a63f377dca8aab30a050f116fa1d68feb5619edfab9745710d21034ad3d34d9ec3b072442dda4c2e12ab65aeaccdeece36cef902097654425f0b929173c41ab7ffd0a9d14630d41646d0ec54e17201eecfc0269e00b61e271e5f77dcace9828d335591dbbf7d3bc34b4b003dcfe485593bbd027b1e09fd3e04eb195759831d4c515785d404bd0e55ee6a19661ba55e53c322edf31b624734c1a9d1c345d7cb0491d41def3d72d83a856136332da062cd5b1f69e1148d6b7eadaad8b2c64d05e1ae2667b9b3acd254e6b8508641099712e46b40d51be15619b4237002aa3aedab22e3b4ba7848276a8c9070e553a48b625c9b2fba11a7846093ac0121c74373cdb7855a522ed41e87a1337ed2a3d04700bbed644e79f90e2b40cce02063d2bac7d2f1a20de9662081d28988605cdc5e7631f18c8a4b8655aa4ee04582860eca7b5c70ab8a57e05632260e7124dabf7f3799cbbc68a5a179970961f28d54118e876466fa50be1563c47a57fe206d238b95ea5a301520e2696b201485bd580065c4cfb543ca542a8bf596349fc093d66b86da38eaf4c</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      暂不公开
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="动态规划" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="背包" scheme="https://tth37.cn/tags/%E8%83%8C%E5%8C%85/"/>
    
  </entry>
  
  <entry>
    <title>题解-计蒜客-4593C会和</title>
    <link href="https://tth37.cn/2019/10/27/solution-jsk-4593C/"/>
    <id>https://tth37.cn/2019/10/27/solution-jsk-4593C/</id>
    <published>2019-10-26T16:06:17.000Z</published>
    <updated>2019-10-26T16:16:59.282Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here.">    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="66bae9f25fab7808d334584ec2cc48162ecd3b11581a4106f7003155ff13354d">c03f3060c9f1ae8757f4c8372012c368774e30d6fe06dac815065efdcaee0a7aa0a4588fa8d267641961ae1523b6e9a24447a40288df714d1def8bc0029614f9ff306467dbeeb790c4eb6ad49a9af9ad6d37a528dcdea544b2beb068c185adb5f448d2a7a0f83d92576a208f74bfeac7c537ddf7e8d72b4b551efee70bfe3592b10e87c7d4867c88463a3383836349c6b6394f8802ff883089c18134f8a68d40f702c766291f184b2f082e2318047b2457e1ee086d48b9fec45d324eba85c0adba9336c4936a4419bf8d59b7afb6013d2da9a29efee23f1a1262db8cf5aae72db3eb3d10c965a57bce2637f32469d764394d4cd484174ca92aab7facc98896592f39115b4a05bab11395a2c7ec951fb5c4ecb43e77eeb08750b9a941d7a5356708d134820a7742ae1f1a7285fca7d228d4b4e8083569cd95fc7c60a3c2789af3c8671245090be3fa7cc559f0f3d01ca828c1d302e4a1ee24405e0d311dd6393ddb66ce57bfe84c500b9c7689290306beb2443ee268b5b0e387dea9ccfd8c9f90bc794115e9e2bb48a5e69bc7afa4d065dc27104204f6362d523d6453078e13b7ef43745dfd95c3f86081d2c86aeb5e18982a3035975a161ec0f641784319e1df0ce53d271fff7d4ba7fee9159798e0075591aa4d9603f77819afc88ab17b2b6cf1b1d9af1ac465aaacb0e4130dfa49ec2f1a7e9e904cb20ea9a12ed07c29a3bb072d03a64f45a7460324367843370b8b64ba29c4d52b43cc15f067ace6e0a763de03d3dcb08b3e29c1cb084543a4980bfaad90259954ca8519e0319913ce6ab1f38ac64b3619cd0178e5f5c61ae6d196898fb546257e0593e6d8ad039fb5dcdba90c6230a087d2f69e3b4868572835e6dad7bbd7d66c48f6c551f95ecacdb6d85713c27149e67a7acc076111e6f9e82d0b415941fb35f14bb83cd2eb40f55de9c0a9e40368974a5c2565a1612a9182dd36b13b5b5356618cb67243ed3fc7b704bba3edc3f7cd1f35dba7d0dbcf2e775d034f0fe1856193cdb49e4ba00370808c09302ae3b54fd17c8ffc614c9b4caf42d1842c943660f9c6119ce930111e28606d48c8f0e652c851153a87a969dde0363765b707c4539f42b6b2d7df133300ac372bccb36e3ea3c355d42886e15037a4944b06f6952567e8768156005b1ab42eed37fc9a42e5104780ba22eadeecbda2f5f2d203ffa08eea21500f9c27029422eba82df40d708b5a596ad7de95e0153499f95e9551c64b516d2831536cd942ca7b6241e97f2c1e007a8aba29e5812b0b71810031088df687f930dc6b868fdc27dd680cbd23431fc24b0fc1b0e1561e9dc5d6ff32c322f2e9d2336d28b5a043e0ace8589c0761cfefc5791120585fe56fc86ef45a55d1bf4d201f7bc7691b9733f4e60a2f9c7a66584007ee76cbea0f47d11e1e303886095a9c4004a17b032befc57b17a8918300756230ef67052364f65e387f79bc510a21c51297d11395479714bf4d740d801849817ee697c50780f31803728727cef0b3c1efd6237ee5cddf3f3f923cba8741efb336c27766c43beb3d9c4b1fce6acf0bb2ad1d847795b0b6252fda507737dc97225ed8aceb63e625f502d83b65cc76ba7bb0285056f6a11002f9395f33f1c08e5b274a6d62ee175fab4294e73e95abd1392c0364830344cbc83accdd0c0c8d5c20a77fc90fc1a5e2bf93d26f3c2580d7ce3bc7beb12c6436119f3cb9441e40f38bf5f475ebd67f998002fcb2e5eb8873fdd7e07f319a7f4929cd35739cafa13dfdf1d996aeb1fb62b45fa881bfe64844526886d59447c49923f871962ecf8aa6621fc469c4450c00e5117ce2985ec8cc3042aa196370f45fe779f78f068d7212b31b49dd87b07bab9c85389c77aa49dd965b03e08d2229dbe171c9e5c936981190f9ee1163f85ef5a660b9a894f6af93c8c7b0cb5b3c729d3d585a34dc98323bd13f63a56ed9024b8267c993863308f001f6ec33cbcb40b13a2686ff86711f385d6fa379bddb57fe7f3bc1b2d830971b276d797085ee40158bcf61cc7a54f9b0896ae5a14dec64e9b0037b4515a6a19eb89a991f76be727cba8f90674a3ae59be9043645120cbb5a0426bd73cfb3478749e3e528e2c5912067adb2454ca65ccedee7a3a04f44c995dfd94c1348eda37f7cebf04767cfab25a4dd33bcb68f7fb707a4e43468148fa5017388025ed8bf9402ed641c8ee71f5b4f7d9924ce19c5d6f4332071a42e732211ef1f9dd31f31dff6504505274c0d84e83c8b985a02285b910017d0f29f8f9add68a11b6304db78fe9f17d3118572b6f2abe217dbd726bb2c49e69ee4a5505de5d9ee092a7db7532ae0062af28d669b453d3b9f7803561100c896c885cf92f6165c655acab39401cfb0e616960d35d0cd55bb9f17695d7381c3edc9352e2eabb5d0ab50fad323bb2d330ff3a6da877519d7cece3586b1e812401351ec2889c70f5ca7b88b22ce149cd0a82ab5b11c542689939fcc1931d92ea46b5819200bb022767d2f6cbf129d6c5205e373fc129643ca4a627f8fd979456a6260ce6beb22f54c9fa3a90247711a9cd7b2e3db92672ad491b83271446aacf73def694d6bf65dce93e6a58179d6f2b26ca3f2727a401428e6e1b4167887f4f3c2475aae8b49d2c0579645356a10976c89fea35a4672a0fa99e474877b4055f1821ab3f151c8856334b790a572686a55d6932f15008bf0385543cb144615772704d0b113b61136c6fe6719cfc369587ffdcb01ad3ec7de502a08e2decad36ae35d9257c158bc0431a0109da27a13fd0db5ce5a13ab8a3adbda6cf3b4c592102de47eb9facc855aa22fff098f7a25acd66898ff9c2da3f6da3a216aa5d29b4ce82e7b20d33359f2b47a087965934294673cdd1c6a737e6403b0720a080bb0beac61d7c37f662e915e3e45960fdbe3cd328fbd6f55ca4ad4bf3d278e02e3ee9b31030bf6a061d3a3bc9273d854ae9e2c2fd629543413e185fd3f329452c9d8807056e038ebe189f9290e4b3d52f306eb0e628315ebe567cb0529785c5493a1a8d3504ceeda7d79a00fc30f0637074ecef7e3733bcdd51031ad84411871900bd0a72293b3bc72875b8ce90f9719dfe6d53f2f3bce898d5f39e26e2b936d80cfa9b7a03d65aec50ec07fc6915bb4cebb8fb6b15050eeb25ee6702247e9022e92996d41d5ce6ab410b1d273df9c194a4334814956a78498dd274cd7cd0a3907a5e9fffbbae8950df3d4b342481271b280274b3b1c6d0c0708f0b728b23b3112fec4e92ef714ae949dbaa340cf234bfd85671f022b77571e39b9ca530389093f34d113be7c5f43f239162ef833d122b2af18396d9e9da35485c1e32b17c29da8ba799e2feadcf428c340735768d862eb39b82df1055ea052d412084f4e659c0261c1c164dbdc718650ead47f179ce319883044364c03da7a798b7f7db3e37c4ddade325a48d45dcfad4ac351f61136593532e73a905e3fce476cd8b8109a7588edea7143d2ff6d7aa13266c58d1c68a4ccae66b2f7846cc32292759cf382ec1c90d3678d359e3a3ef9be82b7343daedc420a57f46b0abd7621f66113ee707ab04601b5f35796e0429e360ad5c9524c0ea2b10e45686b962289dfef9f7d4ed38546da73c72898f02ec76eebfdc0cdbfb4dea0c7086eb86689fa464db4cd1e29d135fa8fec1c5cc37acccfb51d91aff8a0674a954c0ec5e4fbd7c00e66687e11963eadd1dde34bfda4513ec1b4c18c47899fe8af6fa1d8330486b7b8934d0e5256d7c87e3cd9dd8ea93b17f0d870ae4deb3b90ccbc38405cb60b5e768a965b0b4383badfe4d305a2cd4e7fe6c12b1261b2aaac45a7c5d0491d12dca76022aa2baa2f6b9b444d7531e701a46ca70559cc011462b194e3a4dc784f21d0974f45521e4525dd2ea53715172702006dea9158fc67cf34fb6f192709646768031c6d2fe2d2e282b2dd7b943c6eb9aa130f4cd5930d0eb85a6436f5b9f7864f1ff3b7ecea732320a0ebf727b0d4af19317da5d617c1588175930959fff833dc806d2446c2d72562ba61c40879ec82eb2fea51d5204dcdf7a588463f467d34608ba065ae0514c09658662da0c95759af2c6c23bf4181d3030cad233b6ab2299f7e5b8118b8e34274699d68f1190813db233af3944cff2da855295b3171793b1d02ff0110c97e851a28b9f6b960d05b09374efe9b8e34ea4c644c9d63c5fa14b63be9e24736198fabf5d65158cd3f6ab0fed63a6c108391a05238bf737a7ea3600a1b6642bbea60a247617da5493af445f57fc45edf8cc70d7cad57b2753ee6d34f3d29e555fd9f48008c355efa2c8eea5d3cc77170015eb7ce505117152538d221caab32b136c01c1dfe3a2261d8ba4c96f7dd89f114fc623fe2ba2c4a6335b4e818969c3342abc18894000058e29cea291517c422b0ad40e668aab2b24f752dde7d5bacd04ac92bfc211173ef2d61f3c900eae7abe11ad39f3d1a548ea5170d694412835f8da4f0c4e4769a7ff18472a95ac5d2ec4113e2551cd1e62b55b5856c2f816dfd91f8adb032e3b5f03ae0ce1555ba7819aaee9e691debb7699e3091838e8cea2cab35518ede6b568eaa15ae36a4b20b669186013ba02a5e84103f4a00031c4dffab3093ade5856d13ce9366007a1a10ef7d7e866d70fd0ae7810aae22eaf7b64e5ad068ff085fc0919b28c686985ea177022f05490afeb3587a3ab95f53646e29b5ed26a04a81ba3bc373c9057bc9ef27fb6444a5f0ea1edb94b66fe6ec38359c460cf6550f6ed79c8676c3f09f921342a5eea1f699bdfcf6dc9fc66f6700dc626317f04212d383eefbdaf704fe6d0339bb00fda45315093c62b4d51eb029c7f43a8a659c019c8e0b4e7e07cf9ecfcb111fa020845ede002437845ffd392be50480d3ce68718d28b1b936ec2756a3af0505e161268e523fc9f95c7abe0177cc91b05faacc572985678117040eb58bd496e4bdcd8d8fcdef9f74351c991277bac0f9c83058f22163b0f809ebbf8e7ff7e12bea3f874b2f253cef6bc96838bf053cd674e5bbbf087f78cdec72a2735daed924ecc57dda4102ec5b23ec01be8b1df87a92a3bf5bad6190389f4b8c0b9c0c698a715cff9d167d754024a0acec7596275adc631784ac6eb4d4bc80f9f66a8db514da709e5edb5d2ea60d09105afe4e3ece9590bd0326c52803c22a89e64aa222363b5c73f5b61ffcd2bd915216d4a05a9f71f5db71dcba0f64e71a2a2e7d0e052ccf84c59b6e8f0d33f212bd148505608a637b4765a6cf68daaf2fd2251b11a787178fb310079dad42409b614c9d9a645936d87e44b0165e7d874ac85935af61375f026dceef8bcfe88245f0e88d107d3304c779ccf926d4b3ef92d41e206e0ecd96c428937ce7c5eb103e31a60e34fc5213c656e5ecd84abf453532d388172d183c497da70b3625b57891db2b024a1c54cfe37d1673d8d124e1bf61f2f471bfde572040fafe412c0a6a21de2e3d099b776e3050e1a91938dbba7e45ee6156b1422b80a816b16cb4d9b74b4641025127e53ad74ef2da1d87651c30441b4228c9fa3dd274039cfe6899bcf9d7d5ed3857249d640195b2eae683fe4851ac65e13fc862cd944def9116ec461f05883305967715867c515c48bfb6090a3ae77d00fc41ff0c1d143710491f91cd60aef0be107812406b9447723465865640995a947a46af433943ab6a937a3c9bad429c97d04e0c7ac6a84d9d10689493a4a4192d9aeff8e1bfa45f65ef2c3545d4bc28927bec8650f9c6db49f0edf4cfabe9338d2a3307383e483ae20a1697ed685d35d76488c3db4b6207136df0ddf5649541c3a2efd33123435446afe1cab3d3ad8a6f5caf1d85adae7c537786863128c9dfe5054702c144d1a12ded97538259e02c36382e4f36ff6965ccb929cef24bc2171a38e6d32ee39abce31bd336840f6d584efebd0a61158e116e4731756f46061feda1c8fa0c85bc0da7a02d591adb7366a919eaae61f5b2ce4bb7d0aee0675568d78a00f35dc9762c90dce5ee5d474ff439ee2f85af5b7c9d16b7cb3e8806c724dfa1d42d6780b53bd6c10e6cf6f33f24e0455899e45dcb4b984c36e6d0bd7e75c4d0043f017c177cf30ecbed8b88ed29d1f141a41a7addab304cf59e3bba53f1058cfb0d678c4dd40e25accb771387bea91f3a3f04ef2e96cefbd996ce7e7025864042c44b71d4cd7a470f12ed8f52e09d0702402f3072d9e0aec2af7fe4b64186ee9fd680fee6dbf59c0f4148c752e79bc90f9cda0611d902fe096602a042d04816e41d2a7a1732d98bc22e4358af3bc4df3b8d45dc0cf0d5d1c2bdc760e9c042af130ca2695adc406df9c20bd93469883e8458f12f4575fd6d28b7a55901569441c5e6ab2e181ca7e87480553ff7c8b292646da3bb0e873be8ca0f1371eabe9ba2472c829ec1750c583e73a1067b1adbc43455638fdbd6b7fd1ac8ef2f08be2d19c4ec09a4b2ffcc0df74bee1ae2f9cca51d03d8f812e0c2a2da824f7ce07469a4989ec72e250d753d630dfe803ee4e737f9294d4f32a8acfaa90d3871fe56ec71fb8e6088fce0c02fcd3cbae60006a5099a6eb65514608cfa256597abc4706af9cdafe6e30612f350b04a0879bce55ddd0dd64e95720ea8e0619d747f77941f040a3acffb812c483a9b8066910a9172f670b4971d28df9c865ce815d147f9e210d7808e0a4949ba6fcc1a62fc015630a9b2f09cf10ba61ef9975d42cdb3b4b8731e8fd489923e9742768c5fbe0a9ded5dab2ad7bba4dd41a2bb365496791bee54fbbf3522c4669fe4806bb68d016293aad269e97a4560a341913525a6a72f09bb8ba28e6f6d0460f4a5cc6e27c27c6e30a60e3f7adbc72188af019acf7de61890ae40e7b4cd9f525e95fdc6338a94eb27644b27d0584f5ce732476befe059dfc4eb54635204fc8c284b0eb817de57676ebae01462cd3c8cf93c45b9e0e726f6ff90286f0452b3d8ae380fb7376145a805cea2e559e602716b56ee1d992461682ddebddd9994ce5f25bac220156daabb1fcae65ede2328d1465391c5eb463d8332aaa5e3f872b368eca19339ec6390285505cb05efa0ea5500153313be07c0e6c24011da0ae876cf2a832ba0aac00cdb2ae772bc9e340e32d9b78d585eb20cac9bc8aa0e6f4b34b68fba16ac2f10335968bae690dda81b486a95608a684a8692d48f58a3dd11e162bc9b100f5f4e6852cd02d8ef991edfe9c288e51a3ecba202bbe3a9dfdcc8d60eaba05084988e4c9f260edbf5d0da629d028f3a1e816866d07bf4055195b26e06c964b0d66e4a8cbbcfcdc326ee05c2c57d094ef6326b6d00482365a25dc2d5ce92547f9585ed9769ad267919f99f51d71535a40f8a48329695105ce9bef33cf39d4775b733ed60d7e96e6970033a04e5c324361e2ee98abd50409387ba3f91413a8799a28c173eddcef6ad06623b5465494999d980004ca6814530fe030d4ea183ec8d0a0a95c288fe8bb49560d091f9915607c60eb52125fbe860fdfad41d2a35b5c9f09ba3f0e6493e001eebeba9a0d1ca66bf95eb23282c4bc6db67074580c2e94fbe94ab6cf1aea799d6ce75ccb4d9be91de1a55ecfbc8a013fd25d78dcdc673542a2d6edd39c2e4ec096cfcc2ac0d17ded4e81392fb1ef7b3c733781417729dfa5a20de8412ca6b49b4f183c748b2bff99a77f2c321f1e36c78a9c37b59d8ff7286b1cfeaf662855c3d52dcd4cb0030437ef470ff8662b52f72bc6f5246648ae2f9753c9e731995ffcb22d3bf6f78ae6541c8209a8bfbcfbb9532f2276800390641bf13216ee4a9b26fcf5652fd2934770e1a452957a9d6ca2043a6db69385f888a2f11ca74ab7d4ad3b1eeb0654d59b62928eb81922851f73cb2bb25c50d4fe8acfa75375f2fb7b6a6d90cfc82cb275b0cc71b90dfbac5f20cbc445a9f38f9b6f49e045c2c74cb047ac4608bc1d7292039bc8c8d2e95023f5aa1e082136e09c982cfb5d2f9d178ef2901f4605f128a528f2181ab0a7fb4a48239b3c20f086c40577bbb543765bada7a1b7e73a7db012884e09ce8ba5f4b3a5ff8828efbe66c7a09de1a3b7ed3d0dfce2778641748323e39c5f450757df0ead29c4b5613fed80af6c083c87ceabb547bc26f9e549c700ef8d9344845661e977be58464b356497f6fc26567086f0452a62da2c3c76862e37a0374f38ad4b18fe144268d37d2d5018653ddf58b99b23fd1297ea4a2fe148fe900acf1d62099e2259fae8a127dfe6c094a49dde3a7a400a517c2c0a2644175f633870fa09bf071253ccefd24677ffe6fe181a75f0ff4cb47f3e5b183b0100844a1be6840e95c66b4b87e792350083ddc132289b6c3c2e77c037ab69241447516ff6977b9849e18dc251b71217d6646f6bcfc7faec6ed499e88f84dc4aba94495bea0776cc228a259c8965e16090b968bcc7e3323fd4b389f8f61bc8910200356b0fc59321e1552fdce51e1a811dc9619cae8fbf5fc59142829c8836f6575d6123fb15211a51e565d4ec462ef5bcf56b4afde25df1f75bf02deddff77df25ba9881c902077ceb5406d975d16f9c5f4299710487daf62d3f09285773aeaa05256d20d73ed1a7920fea3828506030179b0d9a6bb371aa50635e3e2b7fa722bbdc697913f099e58b1477b045bbdc401f44b25dfd165cc3f4e9556a5b0811fff0c88b1bc0531aaf00676418120080525a1dd9c62153c88dd78af7d3b996fc21b22209ee7255f2918b53ed35a697a89e6e19c2eeaa5a1a4c98de83c543327b6f90360622fc751743392479fa41996cf655c6dbd66bae200c8ea81e62e8e6d97276a66ae01c9cb5a8c1890a7994a7dc600926c6b616aff06c69e80afd0371f4587f08e17eca88e1f4c7d05196a2342a45f44777fd1254ef4367b95b7f63bba28b4390e2c97100019a43c9837e28f0adf7cc33776517cf5d40254bfe4e0909b107241ba6edb8cac77b7593678341088ae5a530b70062d967e51778f63e25c9bc381d334584727881ec9dbbe9d7696a6838154566365b5610a54e2fd7e37dc5ae42c0ea19b552b7da1c43f6bda77dc900b01f5bda147093f65c053921438c7f2c73b79e53ba932c7147fe974d55f34c849e5e06f861bb0c52a9560f79a2a32c5cc0fff36bceb4156a9e626fff5404e5298efa7071ef1903ac49674022e684c69987e58d273bbd2b13391f77abaeaa85b0bed46bd249315f78e5385e73bc83d1261bad822fc193347f1c92e5850bab8498cd48453dfed7dbe3ff9ffe5ae551ae5aeb5b891ef7f765db24a4d14f5d3b3b67a45eadaf9451b800b536bec8e72bf1a7139419b54dec749e2b9d11e18c9e0d816cce8c1ef447ffaec8432dd86f6cabc7a803644ef37c57954097745e310cbad88305258e061c31cd2a2f9e5bda5fdf413c1061961f4fa9415b07f5b529712d423edc5d500b18ffe6bc2f93ae417cb7a3d02cae6b6b37962eafca2bd7688857928580014cf2e9ea489893dfb05f13f9dadb2ad15b8190ab6c9404468a57e8d4e81af0532ec70b4bf861311f35deef30ef0576a84e5f61d42f970d39bd9d70b8ef8fdc3789dc4dabedaa272d2602e80e0dd3b24459fabb958219e381ab91f91138ae4338774a3ef563855a6fa27f0ee54ceccab8cca63c86fc7569815a4709dc5b30de4f594111eee34eaa6450939070895e7084ec9db7ba5413798e88d02658dba5941786a1c65be0b0b71ae1eb1336abd4b084cc0d0b3ada20ffc922f0b24ae46f42afb5d0042bb94449e4e80d8a3747493c7f2143bbbd0d83d25e1162d7e0fdb82e44e0ae07902223bfc66ccdae2d94960e89721d0dfef2693465da8b96efd7b09fd29d7057ae381403177b6b2035e20ff8b6d4a5b27eabc06edbca1b6491296d37851640f7c79f0c8352684627bd03f8d8a9862cded81a1a4ba72a56638c64942a1f576166cd2df1b4f14a33a66420968962c8faec8724cef65f4e802274f6b318164eadf19241f791370baac4c85240e1c6c6920464b974eef2366717526e1d829e2c97c1041d31f5a764624d9ad123bf714b2a70be6c3f5305cacc689352ddf91a32ee8b5a0c1434c648c4029158aacf0a35a58381c0f5f2954fec3771a3634305d3b229515c3453acd6f86823518619213327fb5e9506750347488403fb99e15b5af4bcfd207f2214ffe115af140ea6ba2eaf0c6dd6560855b652dd0a0964119a31170466337ba103e9b0a0d261890949f6fc72655d8a6888cfda759b5405bed38eddf0fbb3b971e5ce311611bbd7f8aae3452e0de9bc1b3127a6cd3b92f502e9cd4afdd545314bf1d7df46d164032c418f4f89ba0a1e41b6d6bfcd250f39ebfe5b4a576abc4007bc75b6cf1271f7d23ae14797c2e444c418b1988436a7f336309ea856262c2669c9d511e8d59b6cd308d6c7f3f456e7de54d5214b7fdddbf0bb959853b8e27a4a8b2e035dfea4626e9ed3a2642ec78883b045340f0b2c80da7691b140ce067a59ab1f88278bb35d2fcbfb9e73a27b34d10f4c5fda7ca530f43932303eb4d42f8c88f5a9e96ac108cb7db1816af2c1aac8d3666f375c8add79b8bfd507d19f7db6880eef81a0b5c95d965c94d4e69b1e0a9242a5d22744ceea10019c10f9c3232082b1e73e8b5d7868ee2455bc63df3187a3d693fd00aa7f7e679fa7533f47e745391ed2de1c544e9ee28224ce3d4a97cc8d0d91f59cbf0f1887948e85df6e44c58e9c40094ef67f44c8fc6ff1e10fef72b2f2ac20873ba8b3ee6c8c84aab930e71789553fbeb5b45b2cedbeffe061cf3ea9c0ed3a095f2a3b7d78bad72004933c42096b1a05194cff61a6f5bbc2f6260da9bbf8a3ee890f19eca99801b3602a52d5e7dd3e6783830afbf5cf9a7bcbf71750acb57ce6ef15cf0ae790686fab517b8d119e54c3406092b03e4d7d7a2d5be70cb0100d0578aad2318b69f66198878206f0e2bcadc4907f670bb4730a671adce8c368822278a15b66c446a362ef27ac532d6e813a957bb1a3ff6c424a8b0fea22a2eff249fdc6b3fd592b4b680340b6f265485521f2597d3bad3f54bfac059c7608449bd3d8c98d685cda4d62f39419f9cc00f9442b3ed828aa9b9fdfb22d59056176c98bf365a7f67ea14675000f199a663ee5761fd62678f4df1ca742e1d0af103041994ae5d264019955dfac5426a32587534bb36b2f73e88d592113a83c2f6041eb411a296c916e1e73fedbcb44023579065801739581136701e3bc92b7700b477108637c34ccf33663c01ee4c01572a5658d79e2f40e721aaedc37123466d229942cdd54f4d593641129bc6a8e2152451a1d9259e70fafeed0338606d762548ffa1416187ccab3b66b21016e80021e1c136dd6afba8795f3c847171a654c991b0eb855bda1c6c33ebbdfffa1c0f7c7d3cf1e980796b6913486816634f125ddfeb1c0c5bc5a9c47a19a4e2476026f63aea6b5946f1f4f58cccb1af91ea1607b6ce1aaecee8439a3299e0e3510ea0954fd03ea19f9551e058d9a9a4b16d8a0f04db84b9c6a5eb499f1eb8002c41e2e696704e4faadd806eb50fbd70d723e65b547500cc7c4100e1e5bbf5fa0bfc59d1eb07733be4d03af2e5ab1c20d892866bf2ececa4e953fbf0033f78a9df9ebc4cacafeabd9ca91f0fc8f007b539a04641af3e646c21706165df9486fdd63a8dea88880a76386cca5242302b3222acd2a3b58b84e38bd690f610f207f56663876eace2ee63a86c80215dd178f367f693f0bff59abed7716ad9eaca1ef9f2a894cf356c890edef21b4b39870b3bf1d8754f88c24a5262379f642579e5700d949ebb4fa7c02b457e944c79599705f15e061bc66ed6eddf7d0d2d9497361fc38bbc18c283c3d73a4f926eebb4cb51f29786731810af61ba2100ba70eb692dc95b00347db825a9d79e972a7b9721106e2164199c444fb287ee418dbdce5a43d6fed7903c600a24fa0c9ad656ab6bc90f1796a5e1f22cd816617731717582c4e7f01c86ee72a5293e853009e27dd43aa5c00edda57db472c818d193f00516ff360319fb0be3c0d4888514a4da810de8287f33305dfff6d3da8f0cfd7f0305f6075d5626fbf2941df3d0ea1925cae50061c810afa49d8840eba21c6dbf23af2dffe99929b2e0f02cc2eecbc7d695e3b08ec0ca51c06c037ece9d93d09c43143dd9a169b37da978ac5b1f0292fd87abab3a4b820ffac872382f04c2d7cbcdd1bd91bda3e9e3e261134efe49c71e54594a28a34c8c29866db59aab1323eb521d297877bf6a0a599ab0f3edf98b21c7197ed6b1db73816aac7c28d284f56edf6b7f70487af90a1439652a12c02a7050cc5b6bbdd8d72095bdc81ba9b04a22dba142151d8348c53219d97bd934f9394b3826301a118ce50230b529e43de86b725753c06894ca20a69052539e0198bd2c2a0f653302b90bbba9679b10a45cdb4ead677d72362712ecc8123550df16e66edbce730bb51b9f8497720a90aeec58eec099d53392a007ffebd73fe582988789150dd266447f9e1a1337dc81cb960fd92e95650f518922662deb77ce275704bd7229d7e3eb3ef91dee42496278c634a8cf303b198fe52ab95aa1404ba0befff01693614c341034173530588a6f1f52921f4cad4a99d0bc17b422f97de08dbcfdc7322e8855c50cbba228c8e818b77013b8174d22ad713b586694757cc67dfaf27a986778223988f16a18061d9e861ea194b2d4b2cc2d0768e4c4e73b32dc374095281eb8c632d3d0808b9dd727e0ffd39195108b007babbabc883325b2431c930823cf8cd4769411d54f2ed5a918db23ff1f0548ea643eea3c35cdfaab8ac9d3744bed50122e686559da99a59a1f72003d8365562abda93bf22f6a72799cda0aa7f0e4f523c09ea1d06d7fce566bd574bdf2927b09efa0f4f866ae4118c778bda652f533daf182b596f552389f5a4dcaa495f5a640f1b2c183d59cc713ff4cc1a6e9acba083b06875c3e50aaad290b39c50a3baf089ad5b8ece46b36af9fd5bb85cb82ad16383cb79ecca9c2a6ca2a20078c423a7b0f2bae2c7af6ae177d5b84c5175364da6049e205c632966b8b069f7234a5e945c90435ba542a0d2b4e0136a42fa6107c6c008bd361fa390d963dca5b2cd2acf07c34c87d7df13d081d722ae3d7e281205ef4ea5e0a059503a0e69abf577322cd2479bd9e10d698869e1b09b44e0ed1300aa2619910082789e0581f4f8506e0e81aa695806d5ef651c434db781b56af28941e5ba2464d85c487f8daacda6b538a61a222678abc647c8a0bf9449511b9b5c05c83bc372a1e6e4acf8c893b8e2d68d6d3a5b5e13cdc0f7acffb17e94338e786b5d03217ebe07e42ae38ae816276f9890b8cfe11bb9dcbaaf188cbd4ace2834eb6ec5bb536ffb3d11b9de2ee2776cc9b71db2b5022a25362bd796f9726277a4e9f5ac8b233de2a2063c06fda62561ce6c1af07e6d32c1811a5e5e7dc9c097ef092da1600fca803dde9c14be53447f534759e71f85da79e67456141c284fd75acd362157727396ffbb236c42ef1ce0c1dbc52897095bbe1ca675e8e02d70a0a4c2ad16ef4adbb6a965b432a9797bbf870b9f2fa6ca26e51141e059fbfc41c3e7883f7d57889e3ee86c445a8248ff6aa5b3b164bbe3280804906a99d0b4e8acb11eb3652a5c18798ff22a166904169fc1f34ce07930df34166946351815947ffda3698639d71dcf8ddfec4477800cc2d79cd0646c1fe80b678e1a8626670578ef4e5f78a99fb087fcea6774600692b363ad90ab73199e25b73bf06a8dea6f7aea0a5578c7c951a10ebbc28dcb51cc43f3802c69333087007ab99bc78f177a95adb63ca5efe757205bbd77f585b86c3903d9a2f417d469427fc614b297e67352efed67d2375f15f901cbbe1442eb4e1e62685b6971e527096abef0572d032760021c9b8f43aa0cf79d3cfdf1ec2c7d6b491881ccf50a0d71cc560964960c7d30984f3f68adf8e3f5700422e50ec03e6d011fa955352381f3968a69ab264bfeebc670404755a13d47ea15f465d8c5defab3a2bf603b479c6bf93d2aa99c32210e2569e28a63c255988072be3a16ad1817a9dde65d0e1ae61c94b36343945bac3cd520a825cda9ecb5157a414568b2b1eb0f7c808faf4a8515648914812f1beb1d99a0a7c3540d6c59cdca7f2a6e107e0f6e70fb668a1e758aa50e5f29ed225bdc85aaae03c56e38a77ce4a60a473a6fc12d71558a062b6f65f1c8ae44697d2fe9d6172ba1bef886ee264c134505d7e6b1beccc542b6b24cfe244730a28158d56f413bb5e1f08cb037bca9320dc53acc0bc4ab890fbe75a8cc9ea545936419b50119bac9dd25debdc5a6398f977b9aa69714f6bd6a3fcd496c7b6f733afbb3dda6b87fd2b3275fdf0a2f022c5f05cb35b30b612c766bc5422eca06a2b1ac5f57610c4028ea18f54a5cf3f04618c7044fe28f99664a81f9a8fd2d54b3df5818f1a794bd151ee18e0f01e3400750a67c598bea0d1ebfa27f2de2ab4533ebb09cceed5729a28e3d5091266003a28c0c7f878f6f75fe8f9d1db4c3ceef89625625f9f735d79d2b56aa89e4c3df0b7a0d59ad499eed4f11ead9ce0ac852d7ad696f9ac99c313bf2b9c041a801d0a821dc27b523a108fd7c5bc76b832f47304b7de101f1b84f753bd1aa55bc8b3b1b0b0cab4f10f8c97877db1d483bf50dfe948af9910b7eaa7c9c5e40e4ed19e7d22ba476a4d8f264cb1adf728d19b86a0e39d32746c13ad2d253193fb1071cc29c88edf0dabf8824e9994c1d9db58c391945d08b084e6f4342f3ffba277a0cf3b268cef7dc741028d542ecc56a47c2b3b442998190b658b90cfd79e1196c95b8b8a8bb06997e7a917e0279e6f9929c3146f07a74c8696415e830e1aa19ab8efcaa1067f2e7cefbb3b275d048e3437b5e07a99f7e3f1898a766a455c7521d435c15699ce6111772b1b2a098124de1cbc53e46797c323c528c5649296ab71fdc736c2e6e2a221759d96de8ffa49ae3c3ff76eca6c4217472061be83c319152a86c9dbcfb0913dedb8d0aa0f6ee57d4d4528e4ac4311e39c7080302e330ccfbdba6c6972f3495585345fd596d546438983c8a304c2a355af6ceaa9c61b9af188ded1cb23877918439cc487b5da932643c3e8e3cc1e639e6fdbdaa0624c2c75a8305b1851ea9339d09fe236c6f12da9e1a605ccf5e69aa23da2872b5a6c186b4e3836a038c3f9a47cb72dda234250269cfee1f891e506fb8dd84fe74464316d2dbf02bf3d86105a7f0ebf3c93173941e043881c1079566ed26558112f21af4f59ae5e2b6eeb718102bf678c44b1d25ed454bac2fcf59f774ae4ade69b2edbfab51e67289221658dc85787cce831e8e39b1fa432b477055775ee2ed957a668a7c343302841861a837a714596f681a2321533958a07aee873593e9cd9c7d66a16bcc211f7bf6ccffcdf075e1e823ce08599f5929f6beb6d8c728e788da456ddf5151e8a874366fb37dfa04389fffb6530806678ca399a86bda0411849eba84fbdad1847b069edbf18a13f1dd3ce6b323fc5045ab99cf15f8a15f70dde2fcf07b7aced220261065611e96699eb5d88f0724a5d782c953d68a9d5e5458527fc90d3072912a121310352342f4ca18c988e171e0bca83dea58db11ff2e4697b2f8350a606c339f2f196b866e664b51e0775d2e54abaf0d92856bcd8e61ab152444a59f2cb8e97cf33d4153827cf37074d71eca94b32c54708be74bc11cf74845f7b2fcf50db54a2de9fc7e57e772b4701551279ad09ed4430f479ac245acee5536145e376bbabfc931eee6611d509559fc1b774ba98033f145934b30076a1daeb728c2d2709d404a4cf14355289b79f4e9159faafd7a77f35edb71fb2686eeee38f49af88e4d8e1cd9dea85ec1526271ccc96c66b14b4fab9e7503d2c9eb1f72daebd1d979bb43a659270a2c3087a0e1cd2ecc3928cae80be6edf494fc5be71fbd67cf175dee0fe66e877f538d2053b31ea1bcc7de71fa2a336a72378f13eec600fc9cb4e1098182ff20b614ec632c8f2f581692a022e9772d3e42f2adb5ccd5eee2056d64b1bcacdf8064f07384fddbe4d4450ab70bc815fcce3cbc8300ffb7a04efe617549ff3f47563ccbeb03a78d192925594cd1eebeaa55403c3eb228c140f95c2dd5c259625127794b85577dc0bfe147750f4d588f505b8fc60327d3fbf95195239ad36b09024cc2701aed0571fd7eac694b5a8089e88790886ae2683d62f09ebffba56b5c5bfa94acaae9b72a3e081f9179f95530486fde32e8cfc8d023d97592f6368802f8a1a977dde4b744e626fece114bf63fbc6fe85153de56fa8d218fdde9e99e97ab7dac315fe471853307c189c51edd8c480b8f2ff3dc94aeae76309bc37d91abf231cb7459d4234343847bbec9611eba6c72d054f0583b85d5e8b29a681c0eb0e60b1b9c9c59114cddf9330cc4d78809b3702d9c14ce48f5972985d3ec9eee3e0071cc971adc1677b42892baa4f364e13a33c2e52cb8e118c542fe999dca57adb5f3d694ab480b7087fb84a90fced433923749237e71990326269216f516f980d2b30f1b53cd9f9a6df0dab5a5de4035bf094987313a9c5151697febaf3210f73ce4b8ed199fb28b0ff6a0f51c173038a22b89d8e1d967ff31f27149f5721efaaebd8d5fcc2ae8f058b85600d93e80106c581ec62a877e62582017173d83cd36f71ee386d0d06d530c0cf03d98de63ffe8cd6ff0458699577c22e7b8d3b5139a9f2694e9c7010fb9e02522a064492f9a50c0eae491b776daa19459737a9b48aa23e942be00d774ee4188604bf875c95e59d9ebdf7c1867d5dfd81053a9adb63c9faa367a19018cc83c6705a56217de6f123c467cfb3f557d5bb2637f2eef2b49d771faa9788a642493ac3897a971cfbd4afc97cfae69967020c606957490989f97e262c0bba8577fc217e6b171a08ba5c11c16616f4855289bc1ec1a6fa0907f6690249809f735909100cc2f2251240d2ea1ae6e259c5891393f00a18e490ac94991279b140deb64477de31ad7c9f6c9bee8f8bf132074a15cebcd3a0e377670ad8d014f489cff51a1c17d1e284b2734c5b2c0423c34dccfc232dfe1bfbe97bb43fab6a49d1069ffa3066e7ba55d2c52b0b5342d275fcf812ad817eee0d703fdb72c152f2b0d81ad1313bbb4981efa32ea439b6151e0e63690625836089eed97065f00914d6f7d91b9c24423d969e9ae26cc88974a623ca039e48392ffb7148637a4cb8fed69adb1fcf70efd54e7eccbf60607b452086f951e141bb6315970f1f66257b9a12fa4d154a98a6cbfb8950432d82d88363aaad2f49c72408c73e93fc3c564922c2158d8ed4130278b8af55cbe1a0d6447c7796432bb4c3b13ea01eece911b76d790ea8a6ad65490300ca132670663babe0da26878fb17166daff78f3120c477ee4262a948a3a5da4a9c7b9a42b13ca0fed2594a94b078ddffe8440969c41b80615a5f6d4a3d7ca5700c007f1e55f10f8409e026c115c6a51576efc9635bbadb57f82926b5292b318cdecfa49c1a8abe700c01c39149cb9acfae80162bd71c09bd6c757f34e1fb9d052ce1a4b1631c95b084ef9358b3d676122c722891f24b7bc6bd815ebf88bd325b3a1f9fecf174ac0aa5ceddda1c83a69d8121e5a60cc51183c40376f4738b63c4452b3919c5f3bb5d20b7f74b35591e420d3626e23a757ff9127f829833ce0f85b04796c0a3d31946aa3c407faccd60a6694d63c10ed3556e14e47de51d167cb3a75f5c48a63962e79be6546d5d6b75248015349379a3b18cdc99d69d76a37171314db565f70db8990826d08b384f688ebd29133b037541ee672becbd04d33669bd95a371970df0b2561414aa8f050e67b292b3cbf360b1ff79c914c059c25a779db112c3b2249ad23a5332eb806bf8d96c08656c13a885a54907f1761b1f724994e257b81ca204e97510bf714e5b9a3fc046ae89206c9fbc898c8fceeabb2e9b3272d4264ce4a07d7e66ee0df751649a174e56ecb46762fac44065c1621b0b23075a715ad38f601bff8570126c619d22f81013ddd17f7db2857aed2a280009acc2a50d91882ba95a43c295cf32670424e4e5c1e3bf79856c2f250a7db36aa521bf449d3b1c82fde6fe7ef22cbde0192b4fcead7158c24f9c06fddcdfd982</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      暂不公开
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="主席树" scheme="https://tth37.cn/tags/%E4%B8%BB%E5%B8%AD%E6%A0%91/"/>
    
      <category term="dfs序" scheme="https://tth37.cn/tags/dfs%E5%BA%8F/"/>
    
      <category term="最近公共祖先" scheme="https://tth37.cn/tags/%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88/"/>
    
      <category term="栈" scheme="https://tth37.cn/tags/%E6%A0%88/"/>
    
  </entry>
  
  <entry>
    <title>题解-LibreOJ-6033「雅礼集训 2017 Day2」棋盘游戏</title>
    <link href="https://tth37.cn/2019/10/25/solution-loj-6033/"/>
    <id>https://tth37.cn/2019/10/25/solution-loj-6033/</id>
    <published>2019-10-24T16:26:37.000Z</published>
    <updated>2019-11-24T15:50:27.702Z</updated>
    
    <content type="html"><![CDATA[<div class="note info"><p><a href="https://loj.ac/problem/6033" target="_blank" rel="noopener">题目链接(LibreOJ)</a></p></div><blockquote><p>弱弱的征集题目概括</p></blockquote><a id="more"></a><p>二分图博弈。首先是个人都能看出来将棋盘黑白染色、建二分图。</p><p>假设二分图存在完美匹配，则无论起点在哪，Bob 必胜。显然 Bob 可以一直沿匹配边走，Alice 只能走非匹配边直到无路可走。</p><p>假设二分图不存在完美匹配，则如果起点为<strong>二分图最大匹配的必配点</strong>，则 Bob 必胜；反之 Alice 必胜。</p><div class="note danger"><p> 证明？</p><p>如何求解某个点是否为二分图最大匹配的必配点？</p><p>考虑找到二分图上所有<strong>非必配点</strong>。先求解出一个二分图最大匹配。显然，不在该最大匹配中的点均为非必配点。</p><p>对于该最大匹配中的点，考虑如果能以之为起点、找到以非匹配点为终点的交错轨，则该点为非必配点。</p><p>根据 <a href="https://www.cnblogs.com/zwfymqz/p/10538538.html" target="_blank" rel="noopener">这篇博客</a> 中的思路，可以将不在最大匹配中的点作为起点，找到的所有交错轨上的点均为非必配点。</p><p>将非必配点输出即可。</p><div class="note warning"><p> 建图很关键，不要犯傻；否则调都调不出来</p><p>代码如下：</p><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> nx[] = &#123;<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;;</span><br><span class="line"><span class="hljs-keyword">int</span> ny[] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> N, M;</span><br><span class="line"><span class="hljs-keyword">int</span> a[<span class="hljs-number">105</span>][<span class="hljs-number">105</span>];</span><br><span class="line"><span class="hljs-keyword">int</span> c[<span class="hljs-number">105</span>][<span class="hljs-number">105</span>];</span><br><span class="line"><span class="hljs-keyword">int</span> cnt1, cnt2;</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; G[<span class="hljs-number">20005</span>];</span><br><span class="line"><span class="hljs-keyword">bool</span> vis[<span class="hljs-number">20005</span>];</span><br><span class="line"><span class="hljs-keyword">int</span> m[<span class="hljs-number">20005</span>];</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">bool</span> tag[<span class="hljs-number">20005</span>];</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">vector</span>&lt;pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt; &gt; Out;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (vis[u]) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">    vis[u] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> v = *it;</span><br><span class="line">        <span class="hljs-keyword">if</span> (m[v] == <span class="hljs-number">0</span> || find(m[v])) &#123;</span><br><span class="line">            m[u] = v, m[v] = u;</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (vis[u]) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">    vis[u] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">if</span> (m[u] == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;::iterator it = G[m[u]].begin(); it != G[m[u]].end(); it++) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> v = *it;</span><br><span class="line">        <span class="hljs-keyword">if</span> (dfs(v)) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">cin</span> &gt;&gt; N &gt;&gt; M;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= M; ++j) &#123;</span><br><span class="line">            <span class="hljs-keyword">char</span> ch;</span><br><span class="line">            <span class="hljs-built_in">cin</span> &gt;&gt; ch;</span><br><span class="line">            <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">'#'</span>) <span class="hljs-keyword">continue</span>;</span><br><span class="line">            <span class="hljs-keyword">if</span> ((i + j) &amp; <span class="hljs-number">1</span>) c[i][j] = ++cnt1;</span><br><span class="line">            <span class="hljs-keyword">else</span> c[i][j] = ++cnt2 + <span class="hljs-number">10000</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= M; ++j) &#123;</span><br><span class="line">            <span class="hljs-keyword">if</span> (c[i][j] == <span class="hljs-number">0</span>) <span class="hljs-keyword">continue</span>;</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">4</span>; ++k) &#123;</span><br><span class="line">                <span class="hljs-keyword">int</span> ti = i + nx[k], tj = j + ny[k];</span><br><span class="line">                <span class="hljs-keyword">if</span> (ti &gt;= <span class="hljs-number">1</span> &amp;&amp; ti &lt;= N &amp;&amp; tj &gt;= <span class="hljs-number">1</span> &amp;&amp; tj &lt;= M) &#123;</span><br><span class="line">                    <span class="hljs-keyword">if</span> (c[ti][tj]) G[c[i][j]].push_back(c[ti][tj]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= cnt1; ++i) &#123;</span><br><span class="line">        <span class="hljs-built_in">memset</span>(vis, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(vis));</span><br><span class="line">        find(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= M; ++j) &#123;</span><br><span class="line">            <span class="hljs-keyword">if</span> (c[i][j] == <span class="hljs-number">0</span>) <span class="hljs-keyword">continue</span>;</span><br><span class="line">            <span class="hljs-built_in">memset</span>(vis, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(vis));</span><br><span class="line">            <span class="hljs-keyword">if</span> (dfs(c[i][j])) &#123;</span><br><span class="line">                Out.push_back(make_pair(i, j));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, Out.size());</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; (<span class="hljs-keyword">int</span>)Out.size(); ++i)</span><br><span class="line">        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d %d\n"</span>, Out[i].first, Out[i].second);</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;note info&quot;&gt;&lt;p&gt;
&lt;a href=&quot;https://loj.ac/problem/6033&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;题目链接(LibreOJ)&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;弱弱的征集题目概括&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
    
      <category term="二分图匹配" scheme="https://tth37.cn/tags/%E4%BA%8C%E5%88%86%E5%9B%BE%E5%8C%B9%E9%85%8D/"/>
    
      <category term="博弈论" scheme="https://tth37.cn/tags/%E5%8D%9A%E5%BC%88%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title>题解-LibreOJ-2255炸弹</title>
    <link href="https://tth37.cn/2019/10/22/solution-loj-2255/"/>
    <id>https://tth37.cn/2019/10/22/solution-loj-2255/</id>
    <published>2019-10-22T15:00:21.000Z</published>
    <updated>2019-10-22T15:15:32.984Z</updated>
    
    <content type="html"><![CDATA[<div class="note info"><p><a href="https://www.luogu.org/problem/P5025" target="_blank" rel="noopener">题目链接(Luogu)</a><br><a href="https://loj.ac/problem/2255" target="_blank" rel="noopener">题目链接(LibreOJ)</a></p></div><blockquote><p>在一条直线上有 $n$ 个炸弹，每个炸弹给定其坐标和爆炸半径；求出引爆每个炸弹时，共有多少炸弹被连锁引爆。</p><p>$n\le 500000$</p><p>我感谢我自己</p></blockquote><a id="more"></a><p>很巧妙的建模方法，是作者在学校 yy 出来的。</p><p>考虑朴素做法。将每个炸弹向其能引爆的炸弹连边，求出强连通分量后缩点，在 DAG 上乱搞得到答案。</p><p>然而这种解法的边数在 $n^2$ 级别。考虑优化。</p><p>注意到一个性质：每个炸弹能引爆的所有炸弹必然属于属于一段<strong>连续区间</strong>。</p><p>在原炸弹序列上建一棵<strong>线段树</strong>，线段树上的所有父节点向儿子连边。对于一个节点向一段区间内节点的连边操作，我们可以将这些边连到区间的父节点上（好比线段树的区间操作）。边数被控制在 $n\log n$ 级别。</p><p>缩点并得到 DAG 后，发现不能简单地进行答案统计；因为会产生<strong>重复</strong>的状态转移。</p><p>观察到本题的一个特殊性质：被连锁反应引爆的范围一定仍然是一段<strong>连续区间</strong>。我们只需维护区间的<strong>最小值和最大值</strong>，并以此进行状态转移即可。</p><div class="note danger"><p> 是否存在此类问题通解？</p><div class="note danger"><p> 是否存在不用建图的解法？</p><div class="note warning"><p> ge(x) 表示大于等于 x 的最小坐标，le(x) 表示小于等于 x 的最大坐标</p><p>实现极为简单。代码如下：</p><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> lson(u) node[u].l</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> rson(u) node[u].r</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ge(x) (lower_bound(a + 1, a + N + 1, x) - a)</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> le(x) (upper_bound(a + 1, a + N + 1, x) - a - 1)</span></span><br><span class="line"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> maxn = <span class="hljs-number">1000005</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> mod = <span class="hljs-number">1000000007</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> inf = <span class="hljs-number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Node</span> &#123;</span></span><br><span class="line">    <span class="hljs-keyword">int</span> l, r;</span><br><span class="line">&#125;node[maxn &lt;&lt; <span class="hljs-number">1</span>];</span><br><span class="line"><span class="hljs-keyword">int</span> cnt;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> N, R, ans;</span><br><span class="line">ll a[maxn], r[maxn];</span><br><span class="line"><span class="hljs-keyword">int</span> num[maxn], range[maxn][<span class="hljs-number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; G[maxn], SCC[maxn];</span><br><span class="line"><span class="hljs-keyword">int</span> w[maxn], dfn[maxn], low[maxn], dfn_idx;</span><br><span class="line"><span class="hljs-keyword">int</span> scc[maxn], scc_cnt;</span><br><span class="line"><span class="hljs-keyword">bool</span> ins[maxn];</span><br><span class="line"><span class="hljs-built_in">stack</span>&lt;<span class="hljs-keyword">int</span>&gt; s;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> f[maxn][<span class="hljs-number">2</span>];</span><br><span class="line"><span class="hljs-keyword">bool</span> vis[maxn];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">build</span><span class="hljs-params">(<span class="hljs-keyword">int</span>&amp; u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    u = ++cnt;</span><br><span class="line">    range[u][<span class="hljs-number">0</span>] = l, range[u][<span class="hljs-number">1</span>] = r;</span><br><span class="line">    <span class="hljs-keyword">if</span> (l == r) &#123;</span><br><span class="line">        num[l] = u;</span><br><span class="line">        w[u] = <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">    build(lson(u), l, mid), build(rson(u), mid + <span class="hljs-number">1</span>, r);</span><br><span class="line">    G[u].push_back(lson(u)), G[u].push_back(rson(u));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add_edge_range</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r, <span class="hljs-keyword">int</span> qu, <span class="hljs-keyword">int</span> ql, <span class="hljs-keyword">int</span> qr)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) &#123;</span><br><span class="line">        G[qu].push_back(u);</span><br><span class="line">        <span class="hljs-keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= mid) add_edge_range(lson(u), l, mid, qu, ql, qr);</span><br><span class="line">    <span class="hljs-keyword">if</span> (mid &lt; qr) add_edge_range(rson(u), mid + <span class="hljs-number">1</span>, r, qu, ql, qr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">tarjan</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    low[u] = dfn[u] = ++dfn_idx;</span><br><span class="line">    ins[u] = <span class="hljs-number">1</span>;</span><br><span class="line">    s.push(u);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> v = *it;</span><br><span class="line">        <span class="hljs-keyword">if</span> (dfn[v] == <span class="hljs-number">0</span>) &#123;</span><br><span class="line">            tarjan(v);</span><br><span class="line">            low[u] = min(low[u], low[v]);</span><br><span class="line">        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ins[v]) &#123;</span><br><span class="line">            low[u] = min(low[u], dfn[v]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">if</span> (low[u] == dfn[u]) &#123;</span><br><span class="line">        scc_cnt++;</span><br><span class="line">        f[scc_cnt][<span class="hljs-number">0</span>] = inf, f[scc_cnt][<span class="hljs-number">1</span>] = -inf;</span><br><span class="line">        <span class="hljs-keyword">while</span> (ins[u]) &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> t = s.top();</span><br><span class="line">            s.pop();</span><br><span class="line">            ins[t] = <span class="hljs-number">0</span>;</span><br><span class="line">            scc[t] = scc_cnt;</span><br><span class="line">            f[scc_cnt][<span class="hljs-number">0</span>] = min(f[scc_cnt][<span class="hljs-number">0</span>], range[t][<span class="hljs-number">0</span>]);</span><br><span class="line">            f[scc_cnt][<span class="hljs-number">1</span>] = max(f[scc_cnt][<span class="hljs-number">1</span>], range[t][<span class="hljs-number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dp</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (vis[u]) <span class="hljs-keyword">return</span>;</span><br><span class="line">    vis[u] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;::iterator it = SCC[u].begin(); it != SCC[u].end(); it++) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> v = *it;</span><br><span class="line">        dp(v);</span><br><span class="line">        f[u][<span class="hljs-number">0</span>] = min(f[u][<span class="hljs-number">0</span>], f[v][<span class="hljs-number">0</span>]);</span><br><span class="line">        f[u][<span class="hljs-number">1</span>] = max(f[u][<span class="hljs-number">1</span>], f[v][<span class="hljs-number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;N);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= N; ++i)</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%lld%lld"</span>, &amp;a[i], &amp;r[i]);</span><br><span class="line">    build(R, <span class="hljs-number">1</span>, N);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= N; ++i)</span><br><span class="line">        add_edge_range(R, <span class="hljs-number">1</span>, N, num[i], ge(a[i] - r[i]), le(a[i] + r[i]));</span><br><span class="line">    tarjan(<span class="hljs-number">1</span>);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> u = <span class="hljs-number">1</span>; u &lt;= N; ++u) &#123;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> v = *it;</span><br><span class="line">            <span class="hljs-keyword">if</span> (scc[u] != scc[v])</span><br><span class="line">                SCC[scc[u]].push_back(scc[v]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= scc_cnt; ++i)</span><br><span class="line">        dp(i);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">        ans = (ans + <span class="hljs-number">1l</span>l * i * (f[scc[num[i]]][<span class="hljs-number">1</span>] - f[scc[num[i]]][<span class="hljs-number">0</span>] + <span class="hljs-number">1</span>)) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d"</span>, ans);</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;note info&quot;&gt;&lt;p&gt;
&lt;a href=&quot;https://www.luogu.org/problem/P5025&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;题目链接(Luogu)&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;https://loj.ac/problem/2255&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;题目链接(LibreOJ)&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;在一条直线上有 $n$ 个炸弹，每个炸弹给定其坐标和爆炸半径；求出引爆每个炸弹时，共有多少炸弹被连锁引爆。&lt;/p&gt;
&lt;p&gt;$n\le 500000$&lt;/p&gt;
&lt;p&gt;我感谢我自己&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="线段树" scheme="https://tth37.cn/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
      <category term="强连通分量" scheme="https://tth37.cn/tags/%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/"/>
    
  </entry>
  
  <entry>
    <title>题解-LibreOJ-6029「雅礼集训 2017 Day1」市场</title>
    <link href="https://tth37.cn/2019/10/21/solution-loj-6029/"/>
    <id>https://tth37.cn/2019/10/21/solution-loj-6029/</id>
    <published>2019-10-21T15:49:35.000Z</published>
    <updated>2019-11-24T15:50:35.133Z</updated>
    
    <content type="html"><![CDATA[<div class="note info"><p><a href="https://loj.ac/problem/6029" target="_blank" rel="noopener">题目链接(LibreOJ)</a></p></div><blockquote><p>维护一个数据结构，支持区间加减、区间除法（下取整）、区间查询最值、区间查询总和操作。</p><p>$n \le 100000, q \le 100000$</p></blockquote><a id="more"></a><p>线段树区间除法模板题。可以玄学分析复杂度。</p><p>观察到对某个区间进行除法操作后，其区间内的权值<strong>整体减小某个值</strong>，当且仅当该区间的<strong>最大元素与最小元素减小的值相等</strong>。因此区间除法可以转化为区间减法，只需判断是否满足区间减的条件即可。</p><div class="note warning"><p>注意 '/' 运算符对数字进行向零取整，并不是向下取整</p><p>实现非常简单。代码如下：</p><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;</span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> lson(u) node[u].l</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> rson(u) node[u].r</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> tag(u) node[u].tag</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> maxx(u) node[u].maxx</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> minn(u) node[u].minn</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> sum(u) node[u].sum</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> maxn = <span class="hljs-number">100005</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> inf = <span class="hljs-number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Node</span> &#123;</span></span><br><span class="line">    <span class="hljs-keyword">int</span> l, r, tag, minn, maxx;</span><br><span class="line">    ll sum;</span><br><span class="line">&#125;node[maxn &lt;&lt; <span class="hljs-number">1</span>];</span><br><span class="line"><span class="hljs-keyword">int</span> cnt;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> N, Q, R;</span><br><span class="line"><span class="hljs-keyword">int</span> a[maxn];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pushdown</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (tag(u)) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">int</span> llen = mid - l + <span class="hljs-number">1</span>, rlen = r - mid;</span><br><span class="line">        sum(lson(u)) += <span class="hljs-number">1l</span>l * tag(u) * llen, sum(rson(u)) += <span class="hljs-number">1l</span>l * tag(u) * rlen;</span><br><span class="line">        minn(lson(u)) += tag(u), minn(rson(u)) += tag(u);</span><br><span class="line">        maxx(lson(u)) += tag(u), maxx(rson(u)) += tag(u);</span><br><span class="line">        tag(lson(u)) += tag(u), tag(rson(u)) += tag(u);</span><br><span class="line">        tag(u) = <span class="hljs-number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pushup</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    sum(u) = sum(lson(u)) + sum(rson(u));</span><br><span class="line">    minn(u) = min(minn(lson(u)), minn(rson(u)));</span><br><span class="line">    maxx(u) = max(maxx(lson(u)), maxx(rson(u)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">build</span><span class="hljs-params">(<span class="hljs-keyword">int</span>&amp; u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    u = ++cnt;</span><br><span class="line">    sum(u) = <span class="hljs-number">0</span>, minn(u) = inf, maxx(u) = -inf;</span><br><span class="line">    <span class="hljs-keyword">if</span> (l == r) &#123;</span><br><span class="line">        sum(u) = minn(u) = maxx(u) = a[l];</span><br><span class="line">        <span class="hljs-keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">    build(lson(u), l, mid), build(rson(u), mid + <span class="hljs-number">1</span>, r);</span><br><span class="line">    pushup(u);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">modify_range_add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r, <span class="hljs-keyword">int</span> ql, <span class="hljs-keyword">int</span> qr, <span class="hljs-keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) &#123;</span><br><span class="line">        tag(u) += val;</span><br><span class="line">        sum(u) += <span class="hljs-number">1l</span>l * val * (r - l + <span class="hljs-number">1</span>);</span><br><span class="line">        minn(u) += val;</span><br><span class="line">        maxx(u) += val;</span><br><span class="line">        <span class="hljs-keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(u, l, r);</span><br><span class="line">    <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= mid) modify_range_add(lson(u), l, mid, ql, qr, val);</span><br><span class="line">    <span class="hljs-keyword">if</span> (mid &lt; qr) modify_range_add(rson(u), mid + <span class="hljs-number">1</span>, r, ql, qr, val);</span><br><span class="line">    pushup(u);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">modify_range_divide</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r, <span class="hljs-keyword">int</span> ql, <span class="hljs-keyword">int</span> qr, <span class="hljs-keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> dmin = minn(u) - <span class="hljs-built_in">floor</span>(<span class="hljs-number">1.0</span> * minn(u) / val), dmax = maxx(u) - <span class="hljs-built_in">floor</span>(<span class="hljs-number">1.0</span> * maxx(u) / val);</span><br><span class="line">        <span class="hljs-keyword">if</span> (dmin == dmax) &#123;</span><br><span class="line">            tag(u) -= dmin;</span><br><span class="line">            sum(u) -= <span class="hljs-number">1l</span>l * dmin * (r - l + <span class="hljs-number">1</span>);</span><br><span class="line">            minn(u) -= dmin;</span><br><span class="line">            maxx(u) -= dmin;</span><br><span class="line">            <span class="hljs-keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(u, l, r);</span><br><span class="line">    <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= mid) modify_range_divide(lson(u), l, mid, ql, qr, val);</span><br><span class="line">    <span class="hljs-keyword">if</span> (mid &lt; qr) modify_range_divide(rson(u), mid + <span class="hljs-number">1</span>, r, ql, qr, val);</span><br><span class="line">    pushup(u);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">query_range_min</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r, <span class="hljs-keyword">int</span> ql, <span class="hljs-keyword">int</span> qr)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) <span class="hljs-keyword">return</span> minn(u);</span><br><span class="line">    pushdown(u, l, r);</span><br><span class="line">    <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>, ret = inf;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= mid) ret = min(ret, query_range_min(lson(u), l, mid, ql, qr));</span><br><span class="line">    <span class="hljs-keyword">if</span> (mid &lt; qr) ret = min(ret, query_range_min(rson(u), mid + <span class="hljs-number">1</span>, r, ql, qr));</span><br><span class="line">    <span class="hljs-keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function">ll <span class="hljs-title">query_range_sum</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r, <span class="hljs-keyword">int</span> ql, <span class="hljs-keyword">int</span> qr)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) <span class="hljs-keyword">return</span> sum(u);</span><br><span class="line">    pushdown(u, l, r);</span><br><span class="line">    <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>; ll ret = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= mid) ret += query_range_sum(lson(u), l, mid, ql, qr);</span><br><span class="line">    <span class="hljs-keyword">if</span> (mid &lt; qr) ret += query_range_sum(rson(u), mid + <span class="hljs-number">1</span>, r, ql, qr);</span><br><span class="line">    <span class="hljs-keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d"</span>, &amp;N, &amp;Q);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; N; ++i) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;a[i]);</span><br><span class="line">    build(R, <span class="hljs-number">0</span>, N - <span class="hljs-number">1</span>);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= Q; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> op, l, r, x;</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d"</span>, &amp;op, &amp;l, &amp;r);</span><br><span class="line">        <span class="hljs-keyword">if</span> (op == <span class="hljs-number">1</span>) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;x), modify_range_add(R, <span class="hljs-number">0</span>, N - <span class="hljs-number">1</span>, l, r, x);</span><br><span class="line">        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-number">2</span>) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;x), modify_range_divide(R, <span class="hljs-number">0</span>, N - <span class="hljs-number">1</span>, l, r, x);</span><br><span class="line">        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-number">3</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, query_range_min(R, <span class="hljs-number">0</span>, N - <span class="hljs-number">1</span>, l, r));</span><br><span class="line">        <span class="hljs-keyword">else</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%lld\n"</span>, query_range_sum(R, <span class="hljs-number">0</span>, N - <span class="hljs-number">1</span>, l, r));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;note info&quot;&gt;&lt;p&gt;
&lt;a href=&quot;https://loj.ac/problem/6029&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;题目链接(LibreOJ)&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;维护一个数据结构，支持区间加减、区间除法（下取整）、区间查询最值、区间查询总和操作。&lt;/p&gt;
&lt;p&gt;$n \le 100000, q \le 100000$&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
    
      <category term="线段树" scheme="https://tth37.cn/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>2019CSP-S复习计划</title>
    <link href="https://tth37.cn/2019/10/21/schedule-2019-CSP/"/>
    <id>https://tth37.cn/2019/10/21/schedule-2019-CSP/</id>
    <published>2019-10-21T14:09:24.000Z</published>
    <updated>2019-11-20T15:41:14.973Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here.">    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="da80f6bcb81ef7b4b9be8b0eb3d62c6df65c7690a41113a584dd607aacb5711b">196ffd93c2eb511d907d1250bbad7b244cfc7e5f54de813a221544db5cee153c561665681fddcf94359c724b2dd5e524df2b3305c77d30d33f91cde1278a6fdb61014e146ae0aed0eb9e8c97dadd1ea40f990420163cf344460f9bd2176cfee5a112345d0c001d437253a962335d92b3ee6d39c1022d52c9ddb38fbdb05034efbd065ad1f133bb1b5d8e802c70c4be718dd8a1a78e47f6180790adc33b3cc3a771d89c8932b545ab5cddf481f9d9e540fa633772505e6fc289a46c127a6f277ba37d19d02427170d24542f1b1f1070ff35569b5c2af19ab9d894fcf24595d1fe15d79022dce34d4be963ba7f69945b34b07d62fc9d0a6bb7b112e09eca28c182907c78475a7c031e8c588bd609159b23b56ec7f05f88fc6cc0a7e52891a013e5c3e932622c0c9c56b086631b901df017884623defc9c97f20f12d28d3ca4ea894198e8eccbad168b2111ae48efd1f419f9d2bb334b509b46c10008ac3d4d3035c1346f07119c1840a9baf0671504108bdd067679bca4c98009bf678fb1e3083a5ded9c6b09f98de91130a3a99037c93a6f5670fa2ecec5c5ff12f526b31396a69e6d1e085eaa7f662d8fb6f74ed9b0bfadfd31fd8be763f2a073945105206119a5b459ed969298f475c7e8274dad5ba4c2e9760f84d77767c6ba5b6e8bdb06fdc593b17e7d3a368882798b9443e57ff3dd32be3ef170809a15efd30e43f9799f8298dd8aa211fd6139508a46a8a2ffc15900c4106761ea3064aecdce353f325d1565510d1c16e0b26d876c795ff4bb64da26e6725eb941b2a9a1d7644ee5576d0ac6c22dbaee67e97899515e7ca4dd1032b56d5d6ac31c9c81a2b08deff2f54bc6828a54b7048ed5956ee650a1248b455f948a0c88761e949e685298d64e983037ca7dfd5fbea86f16dc4fab5bd1269c3503164fbdc1e033997cf3488a1b5ec8cf4306c1a51acdaab620645b54302ced0c523e38f0be3b79f48bdf464c5c716d58e5525f7e01d32440029644fbfd673292e3b8130ed3f215e4bb5431012202d5ecebf7a11f61b0d28b4b3badf8363bff62e3a95e19185bd4dc4dd35a4fbecda73fb0f30d3a59d2bd2b445ae613242f5c343a08c2118320a92ea430999a0be1c34ab5bf57845c19370e16143fe82ba3b2c83cf0a211f7a78064a088fa8a0c183b075861b3d1cb63d099b93aa20e9a1519b249ac5b7c928660354648c1146caac0a4d627cb75f304d103a01141f624cfd826f5423c5fcdaf63668074a77f0e2f80177118ce29ea5761cbb28b54971d7ee4eca8c268acad5b1bd123d51fc6af577c1cd72dd3e844ff39c60e8fc76bc12ab158adec1b29ff3d81fe631e981e011f96d1d4de76d8e15aaef49e2a712a292b0455e0f9f1274f0aa5cd5a899012449e81c95dc54e4f6e7f3a40d3089daf1e5e9208116366f7cfb9b653ef9b332213eb9c03fd423c900a8249b512613428496580ceb967eebb4cf8d7900245848c3d33a4503492b1cec58b1021e40052607b338ca43be705dab5e34115822e748dea16acd35164ac06acf4b66f6865d4d29184faaff8ef4904aba6a8b460662c50167550a124d4a67312a49539c71b23af38145962500f40ecb8fa5baa15dfae10485ade2006f730bbd81ce4780ede11a992401c9d599ed10781fe120ceb41dbef00f15f6aab41c0cd1a397d108dcc94008ee513541a40204617c4f7790cd15517744ecd4c4b357725ec218693117e92d96d715c623a0771b44d0c209c5aa94b3bf5232ed58faab3dc8cd9a26a344fb7e53955038272a59325b1432e25bdbf91761dcd99df01ec1ba018f57626b49f19748b13614ad897ba0451acab82d9496a0725e32425a6e9136aa0d056238bd30e6210810d0d7097b50eb1e04720d9997801298691bd46f9367c30702669f8e8f9bb1bace3f2d0c3b0beabae5e9a3af4d81cf431d5bddadf588bf6d59154891bbb708da242268830754f19d5a0fefd82240462d68f882864be707d4ec0dd6b224a9ff848b842a2e97767cbfcc95b5ea5d8d55496f37aa45d97289ff8e9dbde5f0bfd92b6bfebbd2b1a3c700722c6df58a8e36aef84d0854a169e9830dfe0569721ab9c5911395045ce9701202a8f3ba5540ca98c826679a0835064890b86dc1aa91f7e406904e0a2e966f8556d0bc755dcd386e4a10121e139b549cbb95e590aaebde074f7f587f6716eda4c8c711087286fdde79d55e5d157e932c37aa035fbfb0443e71adbcb42ebd9c9e3fe3aa6301584d04af68c3d7935388087785aac633073b915444eda35e866d408ece21903f07222c2d29717b89c04675d3c10c0554fb25bce8af8162080a7dc91c682bc714940d79fe230c6f75dc53558e63b6fd661fb82c6c530697af3f4fc2f2522d5d683ef90fdd7c59e9a00497f2bc545866f63444e10f5be66c16c641c0aaa8b697123f183809f8f8a3124fd91ab9e39344391ff339bca3fd3146f277812119681ced27ed885fcaaa3ec5b9a57475369c3e6aa5cfa48277e5a63ec93bfea56f741aab686c148fe1d57070a6d172bebb74e3dc025585009ee40ed02516d0c608a3fd6ca5849c83303ffb4c688e691322423e297880dfeea397e6ac5284edd7174c6e439c1db39b5a68a562c7903fc5d4e2e7bb408be222352c3500cf34c3ab93f33c79a705f8e5fecd0aa8109ecf7d234c7a341822ca099273dd6fd22b0d4c4fbd509f1cdc285bc15fcb7d60002ed4347589311a723a17504e4490177ab83a511a0351b9ed0149a452bc3ef016084cd49c4d43fc6dd88c6dfdab0e9f78d40a5a8a2e395ddc9edac3dbfacc6eb899c3785762806e5881024106ed63e9cad1960dfddc9dd55e9f43e8e505b90e8f51d8a5c4e9da4f420701cc5ca144dd8e55ee1daebf9761f7e70773ec30a836e149a934e1e1113716fd59a851bd474fa65d6dc2aaac1480d26f95f7e0d48d9e491d804fb02f2cf715e51db20814c5f696181b5018cf4b69b6b564a0c75401f7c2ccc05dacfa7ec831c030d8f5af36eb46897ec736aabc1f9f9c2c32d0ebe6ba1e1b49df2b5ca712dada664b92620d3ba06a81b63a32eef5898e6a49d077339cefbddc9cc1c0b142ed4d2f1e5d7dd82eb4ce41f088f47e4d04e459fe7e6cb67f57c375a72a91c085ef3730d8d90946aefa886edc66917c8564ba87bb0cbc8f2a866c3c88693d98560e5550c771c2fab2d62699a1f576021700b0c07e8e4f665cecc8bb49b48581ba8a68bd189b406a6c077fb89e72ae8b5a6018d5a3bd1cd39d587f00fc630e129211c1d70efd596b34e9c75518261f2ad427031645630ca823d232ad0045cc6892fb4624ed169bc56b8fee7bc41d2a616ee4e87f1587b8e105843d443026aa864503a8aca0ea4ada37e50c0ce090e6b470e0c12f03677c71800546ef00c2505ec5af2f4e060d3046b3696e13370abfa7a16cf0516c6add1669c9a9617ed1972b5de9983a80a13ee81966d34290b571b1147937987d13102545f3a0a0bb0f40d253e5126cf16e31471ecf2e113026144a3a8cbbaf28f224911973dc4a8b2ccd69d5839af9bbd99d5c757cc630b2d90617311a9cc7d5c4517298ebc8342064daa3822a2d33a3f948b1236f3ffd31a56654721f493246b1b20d4f8251e995f33706d9ef73375212aee9bbaa471f75187c810049d48a8b365fefb06a44ffda54ec44ded7694a0d74431e1dd8aeb2d0ad179b1539e811276f87391bfde7a1f2fb11b54b60f1ea23bd16fdd6808e9d34949dff543efd31789509297195da0972a8399388b4f39bc07ee81b4697a786b3604ae7cff07935555ba0c5022b2d4c95c94d8cf5497485771933ac85a85ed3d72c784fc2135bbe38c8b9785b1835cca01bfb0425be139b93ac0321dfa34ea10a2536b7e8b7122128e8e165a4214af8d5266dd65754cd8b0dd9475530132bdaaadb75659b7952356fe7382966a85c2be76cd03d03ba029bf95632e94c61c4c5c6e862d0c6d3eed9f7961b9ef87ac673e8bbf8b2d6a6e02cc6e1e0082ad72369a5a2e9ee3e5b5bd9880ae46d660565cceca2e468dd02f14a7deec8304d7bc13a3dfd6b28de218a9613180659eda29a7669c4d2796b017a39f7947d25277a3cd9935894ab42ef26c159e985dcbb84c38038c4fad55c8481c742aa73d619f97f65897b211589d7979e0</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      复习计划！自用
    
    </summary>
    
      <category term="计划" scheme="https://tth37.cn/categories/%E8%AE%A1%E5%88%92/"/>
    
    
  </entry>
  
  <entry>
    <title>题解-LibreOJ-6495「雅礼集训 2018 Day1」树</title>
    <link href="https://tth37.cn/2019/10/19/solution-loj-6495/"/>
    <id>https://tth37.cn/2019/10/19/solution-loj-6495/</id>
    <published>2019-10-19T14:21:29.000Z</published>
    <updated>2019-11-24T15:50:43.724Z</updated>
    
    <content type="html"><![CDATA[<div class="note info"><p><a href="https://loj.ac/problem/6495" target="_blank" rel="noopener">题目链接(LibreOJ)</a></p></div><blockquote><p>题目概括征集中~</p><p><strong>重金（5 RMB）征集状压 dp 解法~</strong> <a href>@所有人</a></p></blockquote><div class="note default"><p>这题也太巧妙了叭！ ——Mr.G</p><a id="more"></a><h4 id="Solution-1-O-n-4"><a href="#Solution-1-O-n-4" class="headerlink" title="Solution 1 : $O(n^4)$"></a>Solution 1 : $O(n^4)$</h4><p>注意到节点 2 的父节点一定为 1；因此可以将以 2 为根的子树与剩余部分分开讨论。</p><p>定义状态 $f[i][j]$ 表示有 $i$ 个节点，深度为 $j$ 的方案数。</p><p>设以 2 为根的子树中共有 $x$ 个节点。情况一：子树 2 的深度恰好为 $j-1$，剩余部分的深度任意；情况二：子树 2 的深度任意，剩余部分的深度恰好为 $j$。</p><p>由于两棵子树的节点编号为 $3…i$ 间的任意整数，所以求出方案数之后需乘上标号的方案数。<br>$$<br>f[i][j]=\sum_{x=1}^{i-1}[\sum_{k=1}^{j}f[x][j-1]\times f[i-x][k]\times {i-2\choose x-1}+\sum_{k=1}^{j-2}f[x][k]\times f[i-x][j]\times{i-2\choose x-1}]<br>$$<br>对于期望，只需将 $\sum_{i=1}^n f[n][i]\times i$ 除以 $(n-1)!$ 即可。</p><p>对于四舍五入，可打表。（正经）</p><p>代码如下：</p><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> maxn = <span class="hljs-number">30</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> tb[] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>&#125;;</span><br><span class="line"></span><br><span class="line">ll n, p;</span><br><span class="line">ll fac[maxn], inv[maxn], facinv[maxn];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">C</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n, <span class="hljs-keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> fac[n] * facinv[n - m] % p * facinv[m] % p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll f[maxn][maxn];</span><br><span class="line">ll ans = <span class="hljs-number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; p;</span><br><span class="line">    fac[<span class="hljs-number">0</span>] = fac[<span class="hljs-number">1</span>] = inv[<span class="hljs-number">1</span>] = facinv[<span class="hljs-number">0</span>] = facinv[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        inv[i] = (p - p / i) * inv[p % i] % p;</span><br><span class="line">        fac[i] = fac[i - <span class="hljs-number">1</span>] * i % p;</span><br><span class="line">        facinv[i] = facinv[i - <span class="hljs-number">1</span>] * inv[i] % p;</span><br><span class="line">    &#125;</span><br><span class="line">    f[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>, f[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">3</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> x = <span class="hljs-number">1</span>; x &lt;= i - <span class="hljs-number">1</span>; ++x) &#123;</span><br><span class="line">                <span class="hljs-keyword">int</span> t1 = <span class="hljs-number">0</span>, t2 = <span class="hljs-number">0</span>;</span><br><span class="line">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= j; ++k)</span><br><span class="line">                    t1 = (t1 + f[x][j - <span class="hljs-number">1</span>] * f[i - x][k] % p * C(i - <span class="hljs-number">2</span>, x - <span class="hljs-number">1</span>) % p) % p;</span><br><span class="line">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= j - <span class="hljs-number">2</span>; ++k)</span><br><span class="line">                    t2 = (t2 + f[x][k] * f[i - x][j] % p * C(i - <span class="hljs-number">2</span>, x - <span class="hljs-number">1</span>) % p) % p;</span><br><span class="line">                f[i][j] = (f[i][j] + t1 + t2) % p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        ans = (ans + f[n][i] * i) % p;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n - <span class="hljs-number">1</span>; ++i)</span><br><span class="line">        ans = (ans * inv[i]) % p;</span><br><span class="line">    <span class="hljs-built_in">cout</span> &lt;&lt; tb[n] &lt;&lt; <span class="hljs-built_in">endl</span> &lt;&lt; ans;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Solution-2-O-2-n-n-2"><a href="#Solution-2-O-2-n-n-2" class="headerlink" title="Solution 2 : $O(2^n*n^2)$"></a>Solution 2 : $O(2^n*n^2)$</h4><div class="note primary"><p>状压 dp 解法 </p></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;note info&quot;&gt;&lt;p&gt;
&lt;a href=&quot;https://loj.ac/problem/6495&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;题目链接(LibreOJ)&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;题目概括征集中~&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;重金（5 RMB）征集状压 dp 解法~&lt;/strong&gt; &lt;a href&gt;@所有人&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;note default&quot;&gt;&lt;p&gt;这题也太巧妙了叭！ ——Mr.G&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
    
      <category term="数学" scheme="https://tth37.cn/tags/%E6%95%B0%E5%AD%A6/"/>
    
      <category term="计数dp" scheme="https://tth37.cn/tags/%E8%AE%A1%E6%95%B0dp/"/>
    
      <category term="数学期望" scheme="https://tth37.cn/tags/%E6%95%B0%E5%AD%A6%E6%9C%9F%E6%9C%9B/"/>
    
  </entry>
  
</feed>
