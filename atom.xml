<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>tth37&#39;s Blog</title>
  
  <subtitle>Think twice, Code once</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://tth37.cn/"/>
  <updated>2019-12-01T16:34:24.174Z</updated>
  <id>https://tth37.cn/</id>
  
  <author>
    <name>tth37</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>扩展 KMP</title>
    <link href="https://tth37.cn/2019/12/01/algorithm-exkmp/"/>
    <id>https://tth37.cn/2019/12/01/algorithm-exkmp/</id>
    <published>2019-12-01T15:43:05.000Z</published>
    <updated>2019-12-01T16:34:24.174Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>本文源自计蒜客课件，<strong>切勿外传！</strong></p></blockquote><p>扩展 KMP 能在 $O(|S|+|T|)$ 时间复杂度内处理出字符串 $S$ 的所有后缀与字符串 $T$ 的最长公共前缀。</p><p>之所以称为扩展 KMP，是因为其思想和 KMP 算法很类似。</p><a id="more"></a><h3 id="text-next-函数"><a href="#text-next-函数" class="headerlink" title="$\text{next}$ 函数"></a>$\text{next}$ 函数</h3><p>记 $\text{next}[i]$ 表示后缀 $i$ 即 $T[i..|T|]$ 与 $T$ 的最长公共前缀。 </p><p>例如：</p><div class="table-container"><table><thead><tr><th style="text-align:center">数组索引</th><th style="text-align:center">0</th><th style="text-align:center">1</th><th style="text-align:center">2</th><th style="text-align:center">3</th><th style="text-align:center">4</th><th style="text-align:center">5</th><th style="text-align:center">6</th><th style="text-align:center">7</th><th style="text-align:center">8</th></tr></thead><tbody><tr><td style="text-align:center">字符串数组</td><td style="text-align:center">a</td><td style="text-align:center">a</td><td style="text-align:center">a</td><td style="text-align:center">b</td><td style="text-align:center">a</td><td style="text-align:center">a</td><td style="text-align:center">a</td><td style="text-align:center">a</td><td style="text-align:center">b</td></tr><tr><td style="text-align:center">$\text{next}$ 数组</td><td style="text-align:center">9</td><td style="text-align:center">2</td><td style="text-align:center">1</td><td style="text-align:center">0</td><td style="text-align:center">3</td><td style="text-align:center">4</td><td style="text-align:center">2</td><td style="text-align:center">1</td><td style="text-align:center">0</td></tr></tbody></table></div><p>注意 $\text{next}$ 数组是对于 <strong>模式串 $T$</strong> 构建的。</p><h3 id="如何获取-text-next-函数"><a href="#如何获取-text-next-函数" class="headerlink" title="如何获取 $\text{next}$ 函数"></a>如何获取 $\text{next}$ 函数</h3><p>假设 $\text{next}<a href="0\le i&lt;x">i</a>$ 的值都已经求出，现在要求 $\text{next}[x]$。</p><p>假设 $p=\max\lbrace i+\text{next}[i]-1\rbrace$ 对于所有 $0\&lt; i &lt; x$，我们找到 $i+next[i]-1$ 的最大值，令 $k$ 为这个最大值对应的 $i$，令 $p$ 为 $k+\text{next}[k]-1$，$p$ 就是我们目前已知的匹配到的最远位置。</p><p>根据定义我们可以得到： $T[k..p]=T[0..\text{next}[k]-1]$，如下图所示蓝色部分：</p><p><img src="https://res.jisuanke.com/img/upload/20180516/6cb6bc2387e42ba0a7ee4dcfe9332b9eb0b58f37.png" alt></p><p>现在我们要求 $T[x..n-1]$ 与 $T[0..n-1]$ 的最长公共前缀。</p><p>由 $T[k..p]=T[0..\text{next}[k]-1]$ 得：</p><p>$T[x..p]=T[x-k..\text{next}[k]-1]$，如下图所示红色部分：</p><p><img src="https://res.jisuanke.com/img/upload/20180516/0dd52d39385ff16ee85cc915742fc3d1c62ae173.png" alt></p><p>设 $l=\text{next}[x-k]$，根据下图，可以得到：</p><p>$T[0..l-1]=T[x-k..x-k+l-1]=T[x..x+l-1]$，如下图所示黄色部分：</p><p><img src="https://res.jisuanke.com/img/upload/20180516/d9cb7344732ed21100f545c2b38119074d6bf7d2.png" alt></p><p>也就是说，如果图中黄色部分小于红色部分，也就是 $l&lt;p-x+1$ 即 $x+l\le p$，那么我们可以确定 $\text{next}[x]=l$。否则，我们从 $p-x+1$ 和 $p+1$ 位置开始逐一比较，求出 $\text{next}[x]$ 的值。</p><p>由于在这个过程中， $p$ 满足不下降性质，因此总体时间复杂度为 $O(n)$。</p><h3 id="获取-text-next-函数的代码实现"><a href="#获取-text-next-函数的代码实现" class="headerlink" title="获取 $\text{next}$ 函数的代码实现"></a>获取 $\text{next}$ 函数的代码实现</h3><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">exKMP_pre</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *T)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">int</span> n = <span class="hljs-built_in">strlen</span>(T);</span><br><span class="line">    next[<span class="hljs-number">0</span>] = n;</span><br><span class="line">    <span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> (p + <span class="hljs-number">1</span> &lt; n &amp;&amp; T[p] == T[p + <span class="hljs-number">1</span>]) p++;</span><br><span class="line">    next[<span class="hljs-number">1</span>] = p;</span><br><span class="line">    <span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> x = <span class="hljs-number">2</span>; x &lt; n; ++x) &#123;</span><br><span class="line">        p = k + next[k] - <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">int</span> l = next[x - k];</span><br><span class="line">        <span class="hljs-keyword">if</span> (i + l &lt;= p) next[x] = l;</span><br><span class="line">        <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> j = p - i + <span class="hljs-number">1</span>;</span><br><span class="line">            <span class="hljs-keyword">if</span> (j &lt; <span class="hljs-number">0</span>) j = <span class="hljs-number">0</span>;</span><br><span class="line">            <span class="hljs-keyword">while</span> (i + j &lt; n &amp;&amp; T[i + j] == T[j]) j++;</span><br><span class="line">            next[x] = j;</span><br><span class="line">            k = x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="解决原问题"><a href="#解决原问题" class="headerlink" title="解决原问题"></a>解决原问题</h3><p>记 $\text{extend}[i]$ 表示字符串 $S$ 的第 $i$ 个后缀和 $T$ 的最长公共前缀。假设 $\text{extend}<a href="0\le i&lt;x">i</a>$ 已经求出，现在需要计算 $\text{extend}[x]$。</p><p>已知：$S[k..p]=T[0..\text{extend}[k]]$，求 $S[x..n]$ 与 $T[0..m]$ 的最长公共前缀。解法与计算 $\text{next}$ 的方法类似，记录 $p=i+\text{extend[i]}-1$ 的最大值。</p><p><img src="https://res.jisuanke.com/img/upload/20180516/761b7f45f24395bab2e469d658b7353672480a4e.png" alt></p><p>根据红色部分的等价，我们可以利用 $\text{next}[x-k]$ 得到黄色部分等价性，剩下的分析就和求 $\text{next}$ 的过程一样了。</p><h3 id="获取-text-extend-函数的代码实现"><a href="#获取-text-extend-函数的代码实现" class="headerlink" title="获取 $\text{extend}$ 函数的代码实现"></a>获取 $\text{extend}$ 函数的代码实现</h3><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">exKMP</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *S, <span class="hljs-keyword">char</span> *T)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">int</span> n = <span class="hljs-built_in">strlen</span>(T), m = <span class="hljs-built_in">strlen</span>(S);</span><br><span class="line">    <span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> (p &lt; m &amp;&amp; p &lt; n &amp;&amp; S[p] == T[p]) p++;</span><br><span class="line">    extend[<span class="hljs-number">0</span>] = p;</span><br><span class="line">    <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> x = <span class="hljs-number">1</span>; x &lt; m; ++x) &#123;</span><br><span class="line">        p = k + extend[k] - <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">int</span> l = next[x - k];</span><br><span class="line">        <span class="hljs-keyword">if</span> (i + l &lt;= p) extend[x] = l;</span><br><span class="line">        <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> j = p - x + <span class="hljs-number">1</span>;</span><br><span class="line">            <span class="hljs-keyword">if</span> (j &lt; <span class="hljs-number">0</span>) j = <span class="hljs-number">0</span>;</span><br><span class="line">            <span class="hljs-keyword">while</span> (i + j &lt; m &amp;&amp; j &lt; n &amp;&amp; S[i + j] == T[j]) j++;</span><br><span class="line">            extend[x] = j;</span><br><span class="line">            k = x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;本文源自计蒜客课件，&lt;strong&gt;切勿外传！&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;扩展 KMP 能在 $O(|S|+|T|)$ 时间复杂度内处理出字符串 $S$ 的所有后缀与字符串 $T$ 的最长公共前缀。&lt;/p&gt;
&lt;p&gt;之所以称为扩展 KMP，是因为其思想和 KMP 算法很类似。&lt;/p&gt;
    
    </summary>
    
      <category term="算法学习" scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="字符串" scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    
    
      <category term="KMP" scheme="https://tth37.cn/tags/KMP/"/>
    
  </entry>
  
  <entry>
    <title>「CEOI2018」云计算</title>
    <link href="https://tth37.cn/2019/11/23/solution-loj-3182/"/>
    <id>https://tth37.cn/2019/11/23/solution-loj-3182/</id>
    <published>2019-11-23T14:52:04.000Z</published>
    <updated>2019-11-24T15:34:08.088Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://loj.ac/problem/3182" target="_blank" rel="noopener">#3182. 「CEOI2018」云计算</a></p><h3 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h3><p>题目概括征集中~ 球球你再帮我写几篇吧 TAT @oykz2333</p><a id="more"></a><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><blockquote><p>这题也太巧妙了叭！ ——tth37</p></blockquote><p>考虑<strong>类似背包</strong>的动态规划。记 $f[i]$ 表示满足订单后恰好剩余 $i$ 个核心的最大利润。</p><p>先不考虑时钟频率的限制条件，则问题可以转化为普通背包问题：将计算机的价格视为负数，将订单的核心数视为负数，采用背包问题的状态转移即可。</p><p>如果考虑到时钟频率的限制，则需要满足：在将每个订单放入背包之前，必须将所有时钟频率大于等于该订单的计算机放入背包中。</p><p>将计算机和订单按照时钟频率排序后，依次加入背包即可。</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">2005</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Node</span> &#123;</span></span><br><span class="line">    <span class="hljs-keyword">int</span> c, f, v;</span><br><span class="line">    <span class="hljs-keyword">bool</span> type;</span><br><span class="line">&#125;a[MAXN * <span class="hljs-number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(Node a, Node b)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (a.f != b.f) <span class="hljs-keyword">return</span> a.f &gt; b.f;</span><br><span class="line">    <span class="hljs-keyword">return</span> a.type &lt; b.type;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> n, m, tot;</span><br><span class="line">ll f[MAXN * <span class="hljs-number">50</span>];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d"</span>, &amp;a[i].c, &amp;a[i].f, &amp;a[i].v), a[i].type = <span class="hljs-number">0</span>, tot += a[i].c;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;m);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d"</span>, &amp;a[n + i].c, &amp;a[n + i].f, &amp;a[n + i].v), a[n + i].type = <span class="hljs-number">1</span>;</span><br><span class="line">    sort(a + <span class="hljs-number">1</span>, a + n + m + <span class="hljs-number">1</span>, cmp);</span><br><span class="line">    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0xcf</span>, <span class="hljs-keyword">sizeof</span>(f));</span><br><span class="line">    f[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n + m; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">if</span> (a[i].type == <span class="hljs-number">0</span>) &#123;</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = tot; j &gt;= a[i].c; --j)</span><br><span class="line">                f[j] = max(f[j], f[j - a[i].c] - a[i].v);</span><br><span class="line">        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= tot - a[i].c; ++j)</span><br><span class="line">                f[j] = max(f[j], f[j + a[i].c] + a[i].v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= tot; ++i)</span><br><span class="line">        ans = max(ans, f[i]);</span><br><span class="line">    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%lld"</span>, ans);</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://loj.ac/problem/3182&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;#3182. 「CEOI2018」云计算&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h3&gt;&lt;p&gt;题目概括征集中~ 球球你再帮我写几篇吧 TAT @oykz2333&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
    
      <category term="动态规划" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="背包" scheme="https://tth37.cn/tags/%E8%83%8C%E5%8C%85/"/>
    
  </entry>
  
  <entry>
    <title>「雅礼集训 2018 Day4」Magic</title>
    <link href="https://tth37.cn/2019/11/23/solution-loj-6503/"/>
    <id>https://tth37.cn/2019/11/23/solution-loj-6503/</id>
    <published>2019-11-22T17:43:34.000Z</published>
    <updated>2019-11-26T16:45:05.966Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://loj.ac/problem/6503" target="_blank" rel="noopener">#6503. 「雅礼集训 2018 Day4」Magic</a></p><h3 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h3><p>题目概括征集中~</p><a id="more"></a><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>由于题意中<strong>本质不同的方案</strong>不是特别好处理，我们可以在每张卡片上标号，将计算出的答案乘上 $\prod_{i=1}^m\frac{1}{a_i!}$ 即可。</p><p>考虑容斥。记 $f[i]$ 为<strong>至少有 $i$ 个魔法对</strong>的方案数，则答案为 $\sum_{i=k}^n(-1)^{i-k}\times{i\choose k}\times f[i]$。</p><p>注意：<a href="https://tth37.cn/2019/11/22/solution-loj-3106/">「TJOI2019」唱、跳、rap 和篮球</a> 即为本题 $k=0$ 的特例。</p><p>考虑如何计算 $f[i]$。设第一种颜色至少有 $i_1$ 个魔法对，第二种颜色至少有 $i_2$ 个魔法对……以此类推。考虑以下构造序列的方法：第 $j$ 种颜色保留 $i_j$ 张卡片作为预留卡片，将剩余的卡片任意排列，然后依次将所有预留的卡片插入到原序列中<strong>与之颜色相同的卡片的后面</strong>。不难发现，按照该方法构造序列的方案数为 $(n-k)!\times\prod_{j=1}^m{a_j\choose i_j}\times \frac{(a_j-1)!}{(a_j-i_j-1)!}$，并且该序列中至少有 $\sum_{j=1}^mi_j$ 个魔法对。</p><p>因此，得到 $f[i]$ 的计算方法：</p><script type="math/tex; mode=display">f[i]=\sum_{i_1=0}^{a_1-1}\sum_{i_2=0}^{a_2-1}...\sum_{i_m=0}^{a_m-1}[i_1+i_2+...+i_m=i] (n-i)!\times\prod_{j=1}^m{a_j\choose i_j}\times \frac{(a_j-1)!}{(a_j-i_j-1)!}</script><p>注意到这是一个 $m$ 维卷积的形式，但是如果用暴力生成函数 + NTT 计算，复杂度为 $O(mn\log n)$，不能通过本题。我们可以用类似<strong>启发式合并</strong>的策略，交换多项式乘法运算顺序，每次将两个<strong>阶数最小</strong>的多项式相乘，即可将复杂度控制在 $O(m\log^2 n)$。</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">100005</span>, MAXM = <span class="hljs-number">20005</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> ll MOD = <span class="hljs-number">998244353</span>, G = <span class="hljs-number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> ll <span class="hljs-title">qpow</span><span class="hljs-params">(ll a, ll k)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> (k) &#123;</span><br><span class="line">        <span class="hljs-keyword">if</span> (k &amp; <span class="hljs-number">1</span>) ret = ret * a % MOD;</span><br><span class="line">        a = a * a % MOD;</span><br><span class="line">        k &gt;&gt;= <span class="hljs-number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">namespace</span> FFT &#123;</span><br><span class="line">    <span class="hljs-keyword">int</span> n, r[MAXN &lt;&lt; <span class="hljs-number">1</span>];</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">NTT</span><span class="hljs-params">(ll *a, <span class="hljs-keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (; (<span class="hljs-number">1</span> &lt;&lt; k) &lt; n; ++k);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            r[i] = r[i &gt;&gt; <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">1</span> | (i &amp; <span class="hljs-number">1</span>) &lt;&lt; (k - <span class="hljs-number">1</span>);</span><br><span class="line">            <span class="hljs-keyword">if</span> (i &lt; r[i]) swap(a[i], a[r[i]]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> l = <span class="hljs-number">2</span>; l &lt;= n; l &lt;&lt;= <span class="hljs-number">1</span>) &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> m = l &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">            ll w = qpow(G, (MOD - <span class="hljs-number">1</span>) / l);</span><br><span class="line">            <span class="hljs-keyword">if</span> (op == <span class="hljs-number">-1</span>) w = qpow(w, MOD - <span class="hljs-number">2</span>);</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i += l) &#123;</span><br><span class="line">                ll wk = <span class="hljs-number">1</span>;</span><br><span class="line">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; m; ++j, wk = wk * w % MOD) &#123;</span><br><span class="line">                    ll p = a[i + j], q = wk * a[i + j + m] % MOD;</span><br><span class="line">                    a[i + j] = (p + q) % MOD;</span><br><span class="line">                    a[i + j + m] = (p - q + MOD) % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">DFT</span><span class="hljs-params">(ll *a)</span> </span>&#123;</span><br><span class="line">        NTT(a, <span class="hljs-number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">IDFT</span><span class="hljs-params">(ll *a)</span> </span>&#123;</span><br><span class="line">        NTT(a, <span class="hljs-number">-1</span>);</span><br><span class="line">        ll inv = qpow(n, MOD - <span class="hljs-number">2</span>);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i)</span><br><span class="line">            a[i] = a[i] * inv % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> m, n, k;</span><br><span class="line"><span class="hljs-keyword">int</span> a[MAXM];</span><br><span class="line"><span class="hljs-built_in">vector</span>&lt;ll&gt; b[MAXM &lt;&lt; <span class="hljs-number">1</span>];</span><br><span class="line">priority_queue&lt;pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt; &gt; q;</span><br><span class="line">ll x[MAXN &lt;&lt; <span class="hljs-number">1</span>], y[MAXN &lt;&lt; <span class="hljs-number">1</span>], ans;</span><br><span class="line">ll fac[MAXN], inv[MAXN], facinv[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> ll <span class="hljs-title">C</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n, <span class="hljs-keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> fac[n] * facinv[k] % MOD * facinv[n - k] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d"</span>, &amp;m, &amp;n, &amp;k);</span><br><span class="line">    fac[<span class="hljs-number">0</span>] = facinv[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    fac[<span class="hljs-number">1</span>] = inv[<span class="hljs-number">1</span>] = facinv[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        fac[i] = fac[i - <span class="hljs-number">1</span>] * i % MOD;</span><br><span class="line">        inv[i] = (MOD - MOD / i) * inv[MOD % i] % MOD;</span><br><span class="line">        facinv[i] = facinv[i - <span class="hljs-number">1</span>] * inv[i] % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;a[i]);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; a[i]; ++j)</span><br><span class="line">            b[i].push_back(C(a[i], j) * fac[a[i] - <span class="hljs-number">1</span>] % MOD * facinv[a[i] - j - <span class="hljs-number">1</span>] % MOD);</span><br><span class="line">        q.push(make_pair(-b[i].size(), i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">int</span> cnt = m;</span><br><span class="line">    <span class="hljs-keyword">while</span> (q.size() &gt; <span class="hljs-number">1</span>) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> id1 = q.top().second, sz1 = -q.top().first;</span><br><span class="line">        q.pop();</span><br><span class="line">        <span class="hljs-keyword">int</span> id2 = q.top().second, sz2 = -q.top().first;</span><br><span class="line">        q.pop();</span><br><span class="line">        FFT::n = <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">while</span> (FFT::n &lt;= sz1 + sz2) FFT::n &lt;&lt;= <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= FFT::n; ++i) x[i] = y[i] = <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; sz1; ++i) x[i] = b[id1][i];</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; sz2; ++i) y[i] = b[id2][i];</span><br><span class="line">        FFT::DFT(x), FFT::DFT(y);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= FFT::n; ++i) x[i] = x[i] * y[i] % MOD;</span><br><span class="line">        FFT::IDFT(x);</span><br><span class="line">        cnt++;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= sz1 + sz2 - <span class="hljs-number">2</span>; ++i)</span><br><span class="line">            b[cnt].push_back(x[i]);</span><br><span class="line">        q.push(make_pair(-b[cnt].size(), cnt));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">int</span> id = q.top().second, sz = -q.top().first;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = k; i &lt; sz; ++i) &#123;</span><br><span class="line">        ll tmp = C(i, k) * fac[n - i] % MOD * b[id][i] % MOD;</span><br><span class="line">        <span class="hljs-keyword">if</span> ((i - k) &amp; <span class="hljs-number">1</span>) ans = (ans - tmp + MOD) % MOD;</span><br><span class="line">        <span class="hljs-keyword">else</span> ans = (ans + tmp) % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        ans = ans * qpow(fac[a[i]], MOD - <span class="hljs-number">2</span>) % MOD;</span><br><span class="line">    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%lld"</span>, ans);</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://loj.ac/problem/6503&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;#6503. 「雅礼集训 2018 Day4」Magic&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h3&gt;&lt;p&gt;题目概括征集中~&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
      <category term="雅礼集训" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/%E9%9B%85%E7%A4%BC%E9%9B%86%E8%AE%AD/"/>
    
    
      <category term="FFT/NTT" scheme="https://tth37.cn/tags/FFT-NTT/"/>
    
      <category term="生成函数" scheme="https://tth37.cn/tags/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/"/>
    
      <category term="组合计数" scheme="https://tth37.cn/tags/%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0/"/>
    
      <category term="启发式合并" scheme="https://tth37.cn/tags/%E5%90%AF%E5%8F%91%E5%BC%8F%E5%90%88%E5%B9%B6/"/>
    
      <category term="容斥原理" scheme="https://tth37.cn/tags/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>「TJOI2019」唱、跳、rap 和篮球</title>
    <link href="https://tth37.cn/2019/11/22/solution-loj-3106/"/>
    <id>https://tth37.cn/2019/11/22/solution-loj-3106/</id>
    <published>2019-11-21T16:21:51.000Z</published>
    <updated>2019-11-28T15:39:30.512Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://loj.ac/problem/3106" target="_blank" rel="noopener">#3106. 「TJOI2019」唱、跳、rap 和篮球</a></p><h3 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h3><p>有 $n$ 个蔡徐坤，有 $m$ 个世界上最帅的欧阳，求总共有多少人。</p><p>$n,m\le1000000$</p><a id="more"></a><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>记连续的 4 个学生分别喜欢唱、跳、rap 和篮球为一组。考虑容斥，记 $f[i]$ 为保证至少存在 $i$ 组的序列方案数。根据题意，在此序列中最多只会存在 $m=\min\lbrace a,b,c,\lfloor\frac{n}{4}\rfloor\rbrace$ 组。最终答案即为 $\sum_{i=0}^{m}(-1)^{i}\times f[i]$。</p><p>考虑 $f[i]$ 的计算。由于保证至少存在 $i$ 组，可以将 $i$ 组随机插入到序列中，然后在剩下的位置插入任意学生并统计答案。</p><p>将 $i$ 个长度为 4 的组插入到长度为 $n$ 的序列中，共有 ${n-3i\choose i}$ 种方案。</p><p>将 $i_1$ 个喜欢唱、$i_2$ 个喜欢跳、$i_3$ 个喜欢 rap、$i_4$ 个喜欢篮球的学生放置在长度为 $n-4i$ 的序列中，如果保证 $i_1+i_2+i_3+i_4=n-4i$，则方案数为 $\frac{(n-4i)!}{i_1!\times i_2!\times i_3\times i_4!}$。</p><p>然而题目不保证剩余的 $a-i$、$b-i$、$c-i$、$d-i$ 个学生之和恰好为 $n-4i$，因此该部分的答案为：</p><script type="math/tex; mode=display">\sum_{i_1=0}^{a-i}\sum_{i_2=0}^{b-i}\sum_{i_3=0}^{c-i}\sum_{i_4=0}^{d-i}[i_1+i_2+i_3+i_4=n-4i]\frac{(n-4i)!}{i_1!\times i_2!\times i_3\times i_4!}</script><p>注意到这是一个四元卷积的形式，可以用生成函数 + NTT 暴力求解。</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> ll MOD = <span class="hljs-number">998244353</span>, G = <span class="hljs-number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> ll <span class="hljs-title">qpow</span><span class="hljs-params">(ll a, ll k)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> (k) &#123;</span><br><span class="line">        <span class="hljs-keyword">if</span> (k &amp; <span class="hljs-number">1</span>) ret = ret * a % MOD;</span><br><span class="line">        a = a * a % MOD;</span><br><span class="line">        k &gt;&gt;= <span class="hljs-number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">namespace</span> FFT &#123;</span><br><span class="line">    <span class="hljs-keyword">int</span> n, r[<span class="hljs-number">10005</span>];</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">NTT</span><span class="hljs-params">(ll *a, <span class="hljs-keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (; (<span class="hljs-number">1</span> &lt;&lt; k) &lt; n; ++k);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            r[i] = r[i &gt;&gt; <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">1</span> | (i &amp; <span class="hljs-number">1</span>) &lt;&lt; (k - <span class="hljs-number">1</span>);</span><br><span class="line">            <span class="hljs-keyword">if</span> (i &lt; r[i]) swap(a[i], a[r[i]]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> l = <span class="hljs-number">2</span>; l &lt;= n; l &lt;&lt;= <span class="hljs-number">1</span>) &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> m = l &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">            ll w = qpow(G, (MOD - <span class="hljs-number">1</span>) / l);</span><br><span class="line">            <span class="hljs-keyword">if</span> (op == <span class="hljs-number">-1</span>) w = qpow(w, MOD - <span class="hljs-number">2</span>);</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i += l) &#123;</span><br><span class="line">                ll wk = <span class="hljs-number">1</span>;</span><br><span class="line">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; m; ++j, wk = wk * w % MOD) &#123;</span><br><span class="line">                    ll p = a[i + j], q = wk * a[i + j + m] % MOD;</span><br><span class="line">                    a[i + j] = (p + q) % MOD;</span><br><span class="line">                    a[i + j + m] = (p - q + MOD) % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">DFT</span><span class="hljs-params">(ll *a)</span> </span>&#123;</span><br><span class="line">        NTT(a, <span class="hljs-number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">IDFT</span><span class="hljs-params">(ll *a)</span> </span>&#123;</span><br><span class="line">        NTT(a, <span class="hljs-number">-1</span>);</span><br><span class="line">        ll inv = qpow(n, MOD - <span class="hljs-number">2</span>);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i)</span><br><span class="line">            a[i] = a[i] * inv % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ll f[<span class="hljs-number">1005</span>];</span><br><span class="line">ll fac[<span class="hljs-number">4005</span>], inv[<span class="hljs-number">4005</span>], facinv[<span class="hljs-number">4005</span>];</span><br><span class="line">ll x[<span class="hljs-number">4005</span>], y[<span class="hljs-number">4005</span>], z[<span class="hljs-number">4005</span>], w[<span class="hljs-number">4005</span>];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function">ll <span class="hljs-title">C</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n, <span class="hljs-keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> fac[n] * facinv[k] % MOD * facinv[n - k] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> n, a, b, c, d, m;</span><br><span class="line">ll ans = <span class="hljs-number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    fac[<span class="hljs-number">0</span>] = facinv[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    fac[<span class="hljs-number">1</span>] = inv[<span class="hljs-number">1</span>] = facinv[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= <span class="hljs-number">4000</span>; ++i) &#123;</span><br><span class="line">        fac[i] = fac[i - <span class="hljs-number">1</span>] * <span class="hljs-number">1l</span>l * i % MOD;</span><br><span class="line">        inv[i] = (MOD - MOD / i) * inv[MOD % i] % MOD;</span><br><span class="line">        facinv[i] = facinv[i - <span class="hljs-number">1</span>] * inv[i] % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d%d%d"</span>, &amp;n, &amp;a, &amp;b, &amp;c, &amp;d);</span><br><span class="line">    m = min(min(min(min(n / <span class="hljs-number">4</span>, a), b), c), d);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="hljs-built_in">memset</span>(x, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(x));</span><br><span class="line">        <span class="hljs-built_in">memset</span>(y, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(y));</span><br><span class="line">        <span class="hljs-built_in">memset</span>(z, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(z));</span><br><span class="line">        <span class="hljs-built_in">memset</span>(w, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(w));</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= a - i; ++j) x[j] = facinv[j];</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= b - i; ++j) y[j] = facinv[j];</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= c - i; ++j) z[j] = facinv[j];</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= d - i; ++j) w[j] = facinv[j];</span><br><span class="line">        FFT::n = <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">while</span> (FFT::n &lt;= a + b + c + d - <span class="hljs-number">4</span> * i) FFT::n &lt;&lt;= <span class="hljs-number">1</span>;</span><br><span class="line">        FFT::DFT(x), FFT::DFT(y), FFT::DFT(z), FFT::DFT(w);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; FFT::n; ++j)</span><br><span class="line">            x[j] = x[j] * y[j] % MOD * z[j] % MOD * w[j] % MOD;</span><br><span class="line">        FFT::IDFT(x);</span><br><span class="line">        f[i] = C(n - <span class="hljs-number">3</span> * i, i) * fac[n - <span class="hljs-number">4</span> * i] % MOD * x[n - <span class="hljs-number">4</span> * i] % MOD;</span><br><span class="line">        <span class="hljs-keyword">if</span> (i &amp; <span class="hljs-number">1</span>) ans = (ans - f[i] + MOD) % MOD;</span><br><span class="line">        <span class="hljs-keyword">else</span> ans = (ans + f[i]) % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%lld"</span>, ans);</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://loj.ac/problem/3106&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;#3106. 「TJOI2019」唱、跳、rap 和篮球&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h3&gt;&lt;p&gt;有 $n$ 个蔡徐坤，有 $m$ 个世界上最帅的欧阳，求总共有多少人。&lt;/p&gt;
&lt;p&gt;$n,m\le1000000$&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
    
      <category term="FFT/NTT" scheme="https://tth37.cn/tags/FFT-NTT/"/>
    
      <category term="生成函数" scheme="https://tth37.cn/tags/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/"/>
    
      <category term="组合计数" scheme="https://tth37.cn/tags/%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0/"/>
    
  </entry>
  
  <entry>
    <title>快速傅里叶变换（FFT）快速数论变换（NTT）</title>
    <link href="https://tth37.cn/2019/11/20/algorithm-fftntt/"/>
    <id>https://tth37.cn/2019/11/20/algorithm-fftntt/</id>
    <published>2019-11-20T15:38:26.000Z</published>
    <updated>2019-11-24T15:37:42.474Z</updated>
    
    <content type="html"><![CDATA[<p>离散傅里叶变换（Discrete Fourier Transform，缩写为 DFT），是傅里叶变换在时域和频域上都呈离散的形式，将信号的时域采样变换为其 DTFT 的频域采样。</p><p>FFT 是一种 DFT 的高效算法，称为快速傅立叶变换（Fast Fourier transform）。</p><p> 快速数论变换 (NTT) 是快速傅里叶变换（FFT）在数论基础上的实现。 </p><a id="more"></a><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">5000005</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> ll MOD = <span class="hljs-number">998244353</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> ll G = <span class="hljs-number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> ll <span class="hljs-title">qpow</span><span class="hljs-params">(ll a, ll k)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> (k) &#123;</span><br><span class="line">        <span class="hljs-keyword">if</span> (k &amp; <span class="hljs-number">1</span>) ret = ret * a % MOD;</span><br><span class="line">        a = a * a % MOD;</span><br><span class="line">        k &gt;&gt;= <span class="hljs-number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> ll <span class="hljs-title">inv</span><span class="hljs-params">(ll a)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> qpow(a, MOD - <span class="hljs-number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">namespace</span> FFT &#123;</span><br><span class="line">    <span class="hljs-keyword">int</span> n, r[MAXN];</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">NTT</span><span class="hljs-params">(ll *a, <span class="hljs-keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (; (<span class="hljs-number">1</span> &lt;&lt; k) &lt; n; ++k);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            r[i] = r[i &gt;&gt; <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">1</span> | (i &amp; <span class="hljs-number">1</span>) &lt;&lt; (k - <span class="hljs-number">1</span>);</span><br><span class="line">            <span class="hljs-keyword">if</span> (i &lt; r[i]) swap(a[i], a[r[i]]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> l = <span class="hljs-number">2</span>; l &lt;= n; l &lt;&lt;= <span class="hljs-number">1</span>) &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> m = l &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">            ll w = qpow(G, (MOD - <span class="hljs-number">1</span>) / l);</span><br><span class="line">            <span class="hljs-keyword">if</span> (op == <span class="hljs-number">-1</span>) w = inv(w);</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i += l) &#123;</span><br><span class="line">                ll wk = <span class="hljs-number">1</span>;</span><br><span class="line">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; m; ++j, wk = wk * w % MOD) &#123;</span><br><span class="line">                    ll p = a[i + j], q = wk * a[i + j + m] % MOD;</span><br><span class="line">                    a[i + j] = (p + q) % MOD;</span><br><span class="line">                    a[i + j + m] = (p - q + MOD) % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">DFT</span><span class="hljs-params">(ll *a)</span> </span>&#123;</span><br><span class="line">        NTT(a, <span class="hljs-number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">IDFT</span><span class="hljs-params">(ll *a)</span> </span>&#123;</span><br><span class="line">        NTT(a, <span class="hljs-number">-1</span>);</span><br><span class="line">        ll inv = qpow(n, MOD - <span class="hljs-number">2</span>);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i)</span><br><span class="line">            a[i] = a[i] * inv % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;离散傅里叶变换（Discrete Fourier Transform，缩写为 DFT），是傅里叶变换在时域和频域上都呈离散的形式，将信号的时域采样变换为其 DTFT 的频域采样。&lt;/p&gt;
&lt;p&gt;FFT 是一种 DFT 的高效算法，称为快速傅立叶变换（Fast Fourier transform）。&lt;/p&gt;
&lt;p&gt; 快速数论变换 (NTT) 是快速傅里叶变换（FFT）在数论基础上的实现。 &lt;/p&gt;
    
    </summary>
    
      <category term="算法学习" scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="FFT/NTT" scheme="https://tth37.cn/tags/FFT-NTT/"/>
    
  </entry>
  
  <entry>
    <title>「雅礼集训 2017 Day7」蛐蛐国的修墙方案</title>
    <link href="https://tth37.cn/2019/11/14/solution-loj-6043/"/>
    <id>https://tth37.cn/2019/11/14/solution-loj-6043/</id>
    <published>2019-11-14T14:46:15.000Z</published>
    <updated>2019-11-24T15:39:41.131Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://loj.ac/problem/6043" target="_blank" rel="noopener">#6043. 「雅礼集训 2017 Day7」蛐蛐国的修墙方案</a></p><h3 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h3><p>题目概括征集中~</p><a id="more"></a><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>CSP-S RP++!</p><p>赛前再做几个搜索 / 模拟，<del>为暴力骗分做准备，</del>顺便填一下雅礼集训的坑。</p><h4 id="Part1-暴搜"><a href="#Part1-暴搜" class="headerlink" title="Part1: 暴搜"></a>Part1: 暴搜</h4><p>观察题意得出，第 $i$ 个位置和第 $P_i$ 个位置上，必须填一个左括号和一个右括号。从左向右填写，每次判断是否可以填左 / 右括号即可。</p><p>得分 81 pts 。</p><h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> n;</span><br><span class="line"><span class="hljs-keyword">int</span> ans[<span class="hljs-number">105</span>];</span><br><span class="line"><span class="hljs-keyword">int</span> p[<span class="hljs-number">105</span>];</span><br><span class="line"><span class="hljs-keyword">bool</span> force_right[<span class="hljs-number">105</span>];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> dep, <span class="hljs-keyword">int</span> cnt)</span> </span>&#123;</span><br><span class="line"><span class="hljs-keyword">if</span> (dep == n + <span class="hljs-number">1</span>) &#123;</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) </span><br><span class="line"><span class="hljs-built_in">putchar</span>(<span class="hljs-string">'('</span> + ans[i]);</span><br><span class="line"><span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">if</span> (cnt &lt; n / <span class="hljs-number">2</span>) &#123;</span><br><span class="line"><span class="hljs-keyword">if</span> (force_right[dep] == <span class="hljs-number">0</span>) &#123;</span><br><span class="line"><span class="hljs-keyword">if</span> (p[dep] &lt; dep) &#123;</span><br><span class="line"><span class="hljs-keyword">if</span> (ans[p[dep]] == <span class="hljs-number">1</span>) &#123;</span><br><span class="line">ans[dep] = <span class="hljs-number">0</span>;</span><br><span class="line">dfs(dep + <span class="hljs-number">1</span>, cnt + <span class="hljs-number">1</span>);</span><br><span class="line">ans[dep] = <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">force_right[p[dep]] = <span class="hljs-number">1</span>;</span><br><span class="line">dfs(dep + <span class="hljs-number">1</span>, cnt + <span class="hljs-number">1</span>);</span><br><span class="line">force_right[p[dep]] = <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="hljs-keyword">if</span> (dep - cnt &lt;= cnt) &#123;</span><br><span class="line">ans[dep] = <span class="hljs-number">1</span>;</span><br><span class="line">dfs(dep + <span class="hljs-number">1</span>, cnt);</span><br><span class="line">ans[dep] = <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line"><span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;n);</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;p[i]);</span><br><span class="line">dfs(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>);</span><br><span class="line"><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Part2-观察性质"><a href="#Part2-观察性质" class="headerlink" title="Part2: 观察性质"></a>Part2: 观察性质</h4><p>将排列 $P$ 视作置换函数，则 $P$ 必定可以分解为若干个长度为偶数的循环。（若不然，必定无解）对于每个循环都只有 2 种填法，即 0,1,0,1… 或 1,0,1,0…。特判长度为 2 的循环，则剩余的循环最多有 $100 / 4 = 25$ 个。复杂度约为 $2^{25}$ 级别。</p><p>得分 100 pts。</p><h4 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> n, p[<span class="hljs-number">105</span>];</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; circ[<span class="hljs-number">105</span>];</span><br><span class="line"><span class="hljs-keyword">bool</span> vis[<span class="hljs-number">105</span>], ans[<span class="hljs-number">105</span>];</span><br><span class="line"><span class="hljs-keyword">int</span> cnt = <span class="hljs-number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">check</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line"><span class="hljs-keyword">int</span> cnt1 = <span class="hljs-number">0</span>, cnt2 = <span class="hljs-number">0</span>;</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">cnt1 += (ans[i] == <span class="hljs-number">0</span>), cnt2 += ans[i];</span><br><span class="line"><span class="hljs-keyword">if</span> (cnt1 &lt; cnt2) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;</span><br><span class="line"><span class="hljs-keyword">if</span> (u == cnt + <span class="hljs-number">1</span>) &#123;</span><br><span class="line"><span class="hljs-keyword">if</span> (check()) &#123;</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="hljs-built_in">putchar</span>(<span class="hljs-string">'('</span> + ans[i]);</span><br><span class="line"><span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">int</span> len = circ[u].size();</span><br><span class="line"><span class="hljs-keyword">if</span> (!(len ^ <span class="hljs-number">2</span>)) &#123;</span><br><span class="line">ans[circ[u][<span class="hljs-number">0</span>]] = <span class="hljs-number">0</span>, ans[circ[u][<span class="hljs-number">1</span>]] = <span class="hljs-number">1</span>;</span><br><span class="line">dfs(u + <span class="hljs-number">1</span>);</span><br><span class="line">&#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i ^ len; ++i) ans[circ[u][i]] = i &amp; <span class="hljs-number">1</span>;</span><br><span class="line">dfs(u + <span class="hljs-number">1</span>);</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i ^ len; ++i) ans[circ[u][i]] = !(i &amp; <span class="hljs-number">1</span>);</span><br><span class="line">dfs(u + <span class="hljs-number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line"><span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;n);</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) </span><br><span class="line"><span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;p[i]);</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line"><span class="hljs-keyword">if</span> (vis[i] == <span class="hljs-number">0</span>) &#123;</span><br><span class="line">cnt += <span class="hljs-number">1</span>;</span><br><span class="line"><span class="hljs-keyword">int</span> cur = i;</span><br><span class="line"><span class="hljs-keyword">do</span> &#123;</span><br><span class="line">circ[cnt].push_back(cur);</span><br><span class="line">vis[cur] = <span class="hljs-number">1</span>;</span><br><span class="line">cur = p[cur];</span><br><span class="line">&#125; <span class="hljs-keyword">while</span> (cur != i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">dfs(<span class="hljs-number">1</span>);</span><br><span class="line"><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://loj.ac/problem/6043&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;#6043. 「雅礼集训 2017 Day7」蛐蛐国的修墙方案&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h3&gt;&lt;p&gt;题目概括征集中~&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
      <category term="雅礼集训" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/%E9%9B%85%E7%A4%BC%E9%9B%86%E8%AE%AD/"/>
    
    
      <category term="搜索" scheme="https://tth37.cn/tags/%E6%90%9C%E7%B4%A2/"/>
    
  </entry>
  
  <entry>
    <title>咕咕树</title>
    <link href="https://tth37.cn/2019/11/04/solution-jsk-4596B/"/>
    <id>https://tth37.cn/2019/11/04/solution-jsk-4596B/</id>
    <published>2019-11-04T14:19:03.000Z</published>
    <updated>2019-11-25T15:59:25.169Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://nanti.jisuanke.com/t/42087" target="_blank" rel="noopener">4596B 咕咕树</a></p><h3 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h3><p>题目概括咕咕</p><a id="more"></a><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>高压下的代码实现能力堪忧。比赛 1 小时没敲出来，订正 10 分钟满分。</p><p>官方题解给的是树形背包，但并不是特别好实现。</p><p>定义状态 $f[u][i]$ 表示以 $u$ 为根的子树，有一条以 $u$ 为起点且长度恰好为 $i$ 的链，最少花费的代价。</p><p>考虑状态转移： $f[u][0]$ 显然是切断当前节点后，再将每个子树切断；$f[u][1]$ 即为切出一条长度为 $i$ 的链，对其余子树的链长度进行讨论。</p><script type="math/tex; mode=display">f[u][0]=a[u]+\sum_{v\in son(u)}\min_{j=0}^{l-1}\lbrace f[v][j]\rbrace\\f[u][1]=f[s][i-1]+\sum_{v\in son(u),v\not= s}\min_{j=0}^{\min(i-1,l-i-1)}\lbrace f[v][j]\rbrace</script><p>考虑优化。对所有 $f[u][0..l-1]$ 做前缀最小值，并记 $g[u][i]=\sum_{v\in son(u)}f[v][j]$，则转移方程简化为：</p><script type="math/tex; mode=display">f[u][0]=a[u]+g[u][l-1]\\f[u][1]=f[s][i-1]-f[s][\min(i-1,l-i-1)]+g[u][\min(i-1,l-i-1)]</script><p>注意叶节点的 $f[u][1]$ 应赋值为 $0$。</p><p>时间复杂度 $O(n^2)$。</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">5005</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> n, l;</span><br><span class="line"><span class="hljs-keyword">int</span> a[MAXN];</span><br><span class="line"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; G[MAXN];</span><br><span class="line"><span class="hljs-keyword">int</span> f[MAXN][MAXN];</span><br><span class="line"><span class="hljs-keyword">int</span> g[MAXN][MAXN];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> v = *it;</span><br><span class="line">        <span class="hljs-keyword">if</span> (v == fa) <span class="hljs-keyword">continue</span>;</span><br><span class="line">        dfs(v, u);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; l; ++i)</span><br><span class="line">            g[u][i] += f[v][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> v = *it;</span><br><span class="line">        <span class="hljs-keyword">if</span> (v == fa) <span class="hljs-keyword">continue</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; l; ++i) &#123;</span><br><span class="line">            f[u][i] = min(f[u][i], g[u][min(i - <span class="hljs-number">1</span>, l - i - <span class="hljs-number">1</span>)] - f[v][min(i - <span class="hljs-number">1</span>, l - i - <span class="hljs-number">1</span>)] + f[v][i - <span class="hljs-number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    f[u][<span class="hljs-number">0</span>] = a[u] + g[u][l - <span class="hljs-number">1</span>];</span><br><span class="line">    <span class="hljs-keyword">if</span> (u != <span class="hljs-number">1</span> &amp;&amp; G[u].size() == <span class="hljs-number">1</span>) f[u][<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; l; ++i)</span><br><span class="line">        f[u][i] = min(f[u][i], f[u][i - <span class="hljs-number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span>(f));</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d"</span>, &amp;n, &amp;l);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;a[i]), sum += a[i];</span><br><span class="line">    <span class="hljs-keyword">if</span> (l == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d"</span>, sum), <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> u, v;</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d"</span>, &amp;u, &amp;v);</span><br><span class="line">        G[u].push_back(v), G[v].push_back(u);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>);</span><br><span class="line">    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d"</span>, f[<span class="hljs-number">1</span>][l - <span class="hljs-number">1</span>]);</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://nanti.jisuanke.com/t/42087&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;4596B 咕咕树&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h3&gt;&lt;p&gt;题目概括咕咕&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="计蒜客" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/%E8%AE%A1%E8%92%9C%E5%AE%A2/"/>
    
    
      <category term="动态规划" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="背包" scheme="https://tth37.cn/tags/%E8%83%8C%E5%8C%85/"/>
    
      <category term="树形dp" scheme="https://tth37.cn/tags/%E6%A0%91%E5%BD%A2dp/"/>
    
  </entry>
  
  <entry>
    <title>高斯消元</title>
    <link href="https://tth37.cn/2019/10/31/algorithm-gauss/"/>
    <id>https://tth37.cn/2019/10/31/algorithm-gauss/</id>
    <published>2019-10-31T13:44:46.000Z</published>
    <updated>2019-11-25T15:55:47.293Z</updated>
    
    <content type="html"><![CDATA[<p>高斯消元法（Gauss-Jordan elimination）是求解线性方程组的经典算法，它在当代数学中有着重要的地位和价值，是线性代数课程教学的重要组成部分。</p><p>高斯消元法除了用于线性方程组求解外，还可以用于行列式计算、求矩阵的逆，以及其他计算机和工程方面。</p><p>夏建明等人之前提出了应用图形处理器 (GPU) 加速求解线性方程组的高斯消元法，所提出的算法与基于 CPU 的算法相比较取得更快的运算速度。二是提出各种变异高斯消元法以满足特定工作的需要。</p><blockquote><p>本文绝大部分内容转载自 <a href="https://oi-wiki.org/math/gauss/#_6" target="_blank" rel="noopener">OI-WIKI</a></p></blockquote><a id="more"></a><h4 id="高斯消元五步骤法"><a href="#高斯消元五步骤法" class="headerlink" title="高斯消元五步骤法"></a>高斯消元五步骤法</h4><p>高斯消元法在将增广矩阵化为最简形后对于自由未知量的赋值，需要掌握线性相关知识，且赋值存在人工经验的因素，使得在学习过程中有一定的困难，将高斯消元法划分为五步骤，从而提出五步骤法，内容如下：</p><ol><li><p>增广矩阵行初等行变换为行最简形；</p></li><li><p>还原线性方程组；</p></li><li><p>求解第一个变量；</p></li><li><p>补充自由未知量；</p></li><li><p>列表示方程组通解。</p></li></ol><p>利用实例进一步说明该算法的运作情况。</p><p>例二：利用高斯消元法五步骤法求解线性方程组：</p><script type="math/tex; mode=display">\left\{\begin{aligned}2x_1+5x_3+6x_4&=9 \notag \\x_3+x_4&=-4 \notag \\2x_3+2x_4&=-8 \notag\end{aligned}\right.</script><h4 id="增广矩阵行（初等）变换为行最简形"><a href="#增广矩阵行（初等）变换为行最简形" class="headerlink" title="增广矩阵行（初等）变换为行最简形"></a>增广矩阵行（初等）变换为行最简形</h4><p>所谓增广矩阵，即为方程组系数矩阵 $A$ 与常数列 $b$ 的并生成的新矩阵，即 $(A | b)$ ，增广矩阵行初等变换化为行最简形，即是利用了高斯消元法的思想理念，省略了变量而用变量的系数位置表示变量，增广矩阵中用竖线隔开了系数矩阵和常数列，代表了等于符号。</p><script type="math/tex; mode=display">\left(\begin{matrix}2 & 0 & 5 & 6 \\0 & 0 & 1 & 1 \\0 & 0 & 2 & 2\end{matrix} \middle|\begin{matrix}9 \\-4 \\-8\end{matrix} \right)</script><script type="math/tex; mode=display">\xrightarrow{r_3-2r_2}\left(\begin{matrix}2 & 0 & 5 & 6 \\0 & 0 & 1 & 1 \\0 & 0 & 0 & 0\end{matrix} \middle|\begin{matrix}9 \\-4 \\0\end{matrix} \right)</script><p>化为行阶梯形</p><script type="math/tex; mode=display">\xrightarrow{\frac{r_1}{2}}\left(\begin{matrix}1 & 0 & 2.5 & 3 \\0 & 0 & 1 & 1 \\0 & 0 & 0 & 0\end{matrix} \middle|\begin{matrix}4.5 \\-4 \\0\end{matrix} \right)</script><script type="math/tex; mode=display">\xrightarrow{r_1-r_2 \times 2.5}\left(\begin{matrix}1 & 0 & 0 & 0.5 \\0 & 0 & 1 & 1 \\0 & 0 & 0 & 0\end{matrix} \middle|\begin{matrix}14.5 \\-4 \\0\end{matrix} \right)</script><p>化为最简形</p><h4 id="还原线性方程组"><a href="#还原线性方程组" class="headerlink" title="还原线性方程组"></a>还原线性方程组</h4><script type="math/tex; mode=display">\left\{\begin{aligned}x_1+0.5x_4 &= 14.5 \notag\\x_3+x_4 &= -4 \notag \\\end{aligned}\right.</script><p>解释</p><blockquote><p>所谓的还原线性方程组，即是在行最简形的基础上，将之重新书写为线性方程组的形式，即将行最简形中各位置的系数重新赋予变量，中间的竖线还原为等号。</p></blockquote><h4 id="求解第一个变量"><a href="#求解第一个变量" class="headerlink" title="求解第一个变量"></a>求解第一个变量</h4><script type="math/tex; mode=display">\left\{\begin{aligned}x_1 &= -0.5x_4+14.5\notag \\x_3 &= -x_4-4\notag\end{aligned}\right.</script><p>解释</p><blockquote><p>即是对于所还原的线性方程组而言，将方程组中每个方程的第一个变量，用其他量表达出来。如方程组两方程中的第一个变量 $x_1$ 和 $x_3$ </p></blockquote><h4 id="补充自由未知量"><a href="#补充自由未知量" class="headerlink" title="补充自由未知量"></a>补充自由未知量</h4><script type="math/tex; mode=display">\left\{\begin{aligned}x_1 &= -0.5x_4+14.5 \notag \\x_2 &= x_2 \notag \\x_3 &= -x_4-4 \notag \\x_4 &= x_4 \notag\end{aligned}\right.</script><p>解释</p><blockquote><p>第 3 步中，求解出变量 $x_1$ 和 $x_3$ ，从而说明了方程剩余的变量 $x_2$ 和 $x_4$ 不受方程组的约束，是自由未知量，可以取任意值，所以需要在第 3 步骤解得基础上进行解得补充，补充的方法为 $x_2 = x_2,x_4 = x_4$ ，这种解得补充方式符合自由未知量定义，并易于理解，因为是自由未知量而不受约束，所以只能自己等于自己。</p></blockquote><h4 id="列表示方程组的通解"><a href="#列表示方程组的通解" class="headerlink" title="列表示方程组的通解"></a>列表示方程组的通解</h4><script type="math/tex; mode=display">\begin{aligned}\begin{pmatrix} x_1 \\ x_2 \\ x_3 \\ x_4 \end{pmatrix} &=\begin{pmatrix} 0 \\ 1 \\ 0 \\ 0 \end{pmatrix} x_2+\begin{pmatrix} -0.5 \\ 0 \\ -1 \\ 1 \end{pmatrix} x_4 +\begin{pmatrix} 14.5 \\ 0 \\ -4 \\ 0 \end{pmatrix} \notag \\&= \begin{pmatrix} 0 \\ 1 \\ 0 \\ 0 \end{pmatrix} C_1+\begin{pmatrix} -0.5 \\ 0 \\ -1 \\ 1 \end{pmatrix} C_2 +\begin{pmatrix} 14.5 \\ 0 \\ -4 \\ 0 \end{pmatrix} \notag\end{aligned}</script><p>其中 $C_1$ 和 $C_2$ 为任意常数。</p><p>解释</p><blockquote><p>即在第 4 步的基础上，将解表达为列向量组合的表示形式，同时由于 $x_2$ 和 $x_4$ 是自由未知量，可以取任意值，所以在解得右边，令二者分别为任意常数 $C_1$ 和 $C_2$ ，即实现了对方程组的求解。</p></blockquote><h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><p>其实可以根据自己解方程的习惯写代码……实现非常简单，基本不需要理论知识</p><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Gauss</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">bool</span> flag = <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i; j &lt;= n; ++j) &#123;</span><br><span class="line">            <span class="hljs-keyword">if</span> (a[j][i] != <span class="hljs-number">0</span>) &#123;</span><br><span class="line">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = i; k &lt;= n + <span class="hljs-number">1</span>; ++k)</span><br><span class="line">                    swap(a[i][k], a[j][k]);</span><br><span class="line">                flag = <span class="hljs-number">1</span>;</span><br><span class="line">                <span class="hljs-keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">if</span> (flag == <span class="hljs-number">0</span>) &#123;</span><br><span class="line">            <span class="hljs-built_in">puts</span>(<span class="hljs-string">"No Solution"</span>);</span><br><span class="line">            <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">double</span> tmp = a[i][i];</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = i; k &lt;= n + <span class="hljs-number">1</span>; ++k)</span><br><span class="line">            a[i][k] /= tmp;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i + <span class="hljs-number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            tmp = a[j][i];</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = i; k &lt;= n + <span class="hljs-number">1</span>; ++k)</span><br><span class="line">                a[j][k] -= tmp * a[i][k];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n; i &gt;= <span class="hljs-number">1</span>; --i) &#123;</span><br><span class="line">        <span class="hljs-keyword">double</span> x = <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i + <span class="hljs-number">1</span>; j &lt;= n; ++j)</span><br><span class="line">            x += ans[j] * a[i][j];</span><br><span class="line">        ans[i] = a[i][n + <span class="hljs-number">1</span>] - x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;高斯消元法（Gauss-Jordan elimination）是求解线性方程组的经典算法，它在当代数学中有着重要的地位和价值，是线性代数课程教学的重要组成部分。&lt;/p&gt;
&lt;p&gt;高斯消元法除了用于线性方程组求解外，还可以用于行列式计算、求矩阵的逆，以及其他计算机和工程方面。&lt;/p&gt;
&lt;p&gt;夏建明等人之前提出了应用图形处理器 (GPU) 加速求解线性方程组的高斯消元法，所提出的算法与基于 CPU 的算法相比较取得更快的运算速度。二是提出各种变异高斯消元法以满足特定工作的需要。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;本文绝大部分内容转载自 &lt;a href=&quot;https://oi-wiki.org/math/gauss/#_6&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;OI-WIKI&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="算法学习" scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="数论专题" scheme="https://tth37.cn/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/%E6%95%B0%E8%AE%BA%E4%B8%93%E9%A2%98/"/>
    
    
      <category term="高斯消元" scheme="https://tth37.cn/tags/%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83/"/>
    
  </entry>
  
  <entry>
    <title>「BJOI2019」光线</title>
    <link href="https://tth37.cn/2019/10/31/solution-loj-3093/"/>
    <id>https://tth37.cn/2019/10/31/solution-loj-3093/</id>
    <published>2019-10-31T13:35:11.000Z</published>
    <updated>2019-11-25T15:55:30.382Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://loj.ac/problem/3093" target="_blank" rel="noopener">#3093. 「BJOI2019」光线</a></p><h3 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h3><p>题目概括征集中~</p><a id="more"></a><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>一开始愣是套高斯消元想了半天……后来发现是普通 DP 秒出</p><h4 id="Part1-高斯消元-O-n-3"><a href="#Part1-高斯消元-O-n-3" class="headerlink" title="Part1: 高斯消元 $O(n^3)$"></a>Part1: 高斯消元 $O(n^3)$</h4><p>记 $f[i]$ 表示第 $i$ 片玻璃向下的光线总数，$g[i]$ 表示第 $i$ 片玻璃向上的光线总数。</p><p>显然地：</p><script type="math/tex; mode=display">f[i]=f[i-1]\times a[i]+g[i+1]\times b[i]\\g[i]=f[i-1]\times b[i]+g[i+1]\times a[i]</script><script type="math/tex; mode=display">f[i]=f[i-1]\times a[i]+g[i+1]\times b[i]\\g[i]=f[i-1]\times b[i]+g[i+1]\times a[i]\\x_i=x_{i-1}\times a[i] + x_{n+i+1}\times b[i]\\x_{n+i}=x_{i-1}\times b[i]+x_{n+i+1}\times a[i]</script><p>共有 $2n$  个未知数和 $2n$ 个等式，暴力求解方程即可。</p><p>期望得分：50 pts</p><script type="math/tex; mode=display">f[i]=f[i-1]\times a[i]+f[i-1]\times b[i]\times g[i-1]\times a[i]+...</script><script type="math/tex; mode=display">f[i]=f[i-1]\times a[i]\times\sum_{j=0}^{+\infty}(b[i]\times g[i-1])^j\\f[i]=f[i-1]\times a[i]\times</script><script type="math/tex; mode=display">g[i]=b[i]+a[i]\times g[i-1]\times a[i]+a[i]\times g[i-1]\times b[i]\times g[i-1]\times a[i]</script><script type="math/tex; mode=display">g[i]=b[i]+a[i]^2\times g[i-1]\times\sum_{j=0}^{+\infty}(b[i]\times g[i-1])^j</script><script type="math/tex; mode=display">\{a_n\}\\a_n=a_{n-1}\times q\ \   (0<q<1)\\\sum_{j=0}^{+\infty}=a_1/(1-q)</script>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://loj.ac/problem/3093&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;#3093. 「BJOI2019」光线&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h3&gt;&lt;p&gt;题目概括征集中~&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
    
      <category term="高斯消元" scheme="https://tth37.cn/tags/%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83/"/>
    
      <category term="动态规划" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="概率" scheme="https://tth37.cn/tags/%E6%A6%82%E7%8E%87/"/>
    
  </entry>
  
  <entry>
    <title>「雅礼集训 2018 Day1」图</title>
    <link href="https://tth37.cn/2019/10/30/solution-loj-6497/"/>
    <id>https://tth37.cn/2019/10/30/solution-loj-6497/</id>
    <published>2019-10-30T14:11:17.000Z</published>
    <updated>2019-11-25T15:57:02.509Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://loj.ac/problem/6497" target="_blank" rel="noopener">#6497. 「雅礼集训 2018 Day1」图</a></p><h3 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h3><p>题目概括征集中~</p><a id="more"></a><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>特别屌的一个计数 DP。</p><p>记 $g(i)$ 表示以 $i$ 节点结尾的交错路径条数。</p><p>定义状态：$f[i][k][x][y]$ 表示考虑前 $i$ 个节点，奇偶性为 $k=0/1$； $x=0/1$ 表示是否存在 $g()$ 为奇数的黑色节点， $y=0/1$ 表示是否存在 $g()$ 为奇数的白色节点。</p><p>考虑转移：假设已经求出 $f[i][k][x][y]$。枚举第 $i+1$ 个节点的颜色。</p><p>当第 $i+1$ 个节点为白色时：</p><p>如果 $x=0$，即不存在 $g()$ 为奇数的黑色节点，那么无论如何连边，总的原方案的奇偶性一定会发生改变。考虑如果有黑色节点向 $i+1$ 连边，则交错路径会增加偶数条（即增加 $g()$）；如果有白色节点向其连边，则交错路径数不变；第 $i+1$ 个节点单独作为一条路径，因此交错路径增加了奇数条，奇偶性发生改变。</p><p>转移方程：</p><script type="math/tex; mode=display">f[i+1][k\oplus1][x][1]=f[i+1][k\oplus1][x][1]+2^i\times f[i][k][x][y]</script><p>如果 $x=1$，那么情况会略微复杂；注意到如果有偶数个 $g()$ 为奇数的黑色节点向 $i+1$ 连边，则奇偶性一定改变；如果有奇数个 $g()$ 为奇数的黑色节点向 $i+1$ 连边，则奇偶性不会改变。假设 $g()$ 为奇数的黑色节点共有 $t$ 个。那么转移方程如下：</p><script type="math/tex; mode=display">f[i+1][k\oplus1][x][1]=f[i+1][k\oplus1][x][1]+({t\choose0}+{t\choose2}+..+{t\choose 2m})\times 2^{i-t}\times f[i][k][x][y]</script><script type="math/tex; mode=display">f[i+1][k][x][y]=f[i+1][k][x][y]+({t\choose1}+{t\choose3}+..+{t\choose 2m+1})\times 2^{i-t}\times f[i][k][x][y]</script><p>可以证明：</p><script type="math/tex; mode=display">{t\choose0}+{t\choose2}+..+{t\choose 2m}={t\choose1}+{t\choose3}+..+{t\choose 2m+1}=2^{t-1}</script><p>因此转移方程可以简化为：</p><script type="math/tex; mode=display">f[i+1][k\oplus1][x][1]=f[i+1][k\oplus1][x][1]+2^{i-1}\times f[i][k][x][y]</script><script type="math/tex; mode=display">f[i+1][k][x][y]=f[i+1][k][x][y]+2^{i-1}\times f[i][k][x][y]</script><p>当第 $i+1$ 个节点为黑色时，情况类似。</p><p>代码实现非常简单，不再赘述。</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">200005</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MOD = <span class="hljs-number">998244353</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> n, p;</span><br><span class="line"><span class="hljs-keyword">int</span> f[MAXN][<span class="hljs-number">2</span>][<span class="hljs-number">2</span>][<span class="hljs-number">2</span>];</span><br><span class="line"><span class="hljs-keyword">int</span> c[MAXN];</span><br><span class="line"><span class="hljs-keyword">int</span> pow2[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d"</span>, &amp;n, &amp;p);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;c[i]);</span><br><span class="line">    pow2[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        pow2[i] = pow2[i - <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">if</span> (pow2[i] &gt; MOD) pow2[i] -= MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    f[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt;= <span class="hljs-number">1</span>; ++k)</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>; x &lt;= <span class="hljs-number">1</span>; ++x)</span><br><span class="line">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> y = <span class="hljs-number">0</span>; y &lt;= <span class="hljs-number">1</span>; ++y) &#123;</span><br><span class="line">                    <span class="hljs-keyword">int</span> cur = f[i][k][x][y];</span><br><span class="line">                    <span class="hljs-keyword">if</span> (c[i + <span class="hljs-number">1</span>] == <span class="hljs-number">-1</span> || c[i + <span class="hljs-number">1</span>] == <span class="hljs-number">0</span>) &#123;</span><br><span class="line">                        <span class="hljs-keyword">if</span> (x == <span class="hljs-number">0</span>)</span><br><span class="line">                            f[i + <span class="hljs-number">1</span>][k ^ <span class="hljs-number">1</span>][x][<span class="hljs-number">1</span>] =</span><br><span class="line">                                (f[i + <span class="hljs-number">1</span>][k ^ <span class="hljs-number">1</span>][x][<span class="hljs-number">1</span>] + <span class="hljs-number">1l</span>l * pow2[i] * cur) % MOD;</span><br><span class="line">                        <span class="hljs-keyword">else</span></span><br><span class="line">                            f[i + <span class="hljs-number">1</span>][k ^ <span class="hljs-number">1</span>][x][<span class="hljs-number">1</span>] =</span><br><span class="line">                                (f[i + <span class="hljs-number">1</span>][k ^ <span class="hljs-number">1</span>][x][<span class="hljs-number">1</span>] + <span class="hljs-number">1l</span>l * pow2[i - <span class="hljs-number">1</span>] * cur) % MOD,</span><br><span class="line">                            f[i + <span class="hljs-number">1</span>][k][x][y] =</span><br><span class="line">                                (f[i + <span class="hljs-number">1</span>][k][x][y] + <span class="hljs-number">1l</span>l * pow2[i - <span class="hljs-number">1</span>] * cur) % MOD;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="hljs-keyword">if</span> (c[i + <span class="hljs-number">1</span>] == <span class="hljs-number">-1</span> || c[i + <span class="hljs-number">1</span>] == <span class="hljs-number">1</span>) &#123;</span><br><span class="line">                        <span class="hljs-keyword">if</span> (y == <span class="hljs-number">0</span>)</span><br><span class="line">                            f[i + <span class="hljs-number">1</span>][k ^ <span class="hljs-number">1</span>][<span class="hljs-number">1</span>][y] =</span><br><span class="line">                                (f[i + <span class="hljs-number">1</span>][k ^ <span class="hljs-number">1</span>][<span class="hljs-number">1</span>][y] + <span class="hljs-number">1l</span>l * pow2[i] * cur) % MOD;</span><br><span class="line">                        <span class="hljs-keyword">else</span></span><br><span class="line">                            f[i + <span class="hljs-number">1</span>][k ^ <span class="hljs-number">1</span>][<span class="hljs-number">1</span>][y] =</span><br><span class="line">                                (f[i + <span class="hljs-number">1</span>][k ^ <span class="hljs-number">1</span>][<span class="hljs-number">1</span>][y] + <span class="hljs-number">1l</span>l * pow2[i - <span class="hljs-number">1</span>] * cur) % MOD,</span><br><span class="line">                            f[i + <span class="hljs-number">1</span>][k][x][y] =</span><br><span class="line">                                (f[i + <span class="hljs-number">1</span>][k][x][y] + <span class="hljs-number">1l</span>l * pow2[i - <span class="hljs-number">1</span>] * cur) % MOD;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d"</span>, (f[n][p][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] + f[n][p][<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] + f[n][p][<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] + f[n][p][<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]) % MOD);</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://loj.ac/problem/6497&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;#6497. 「雅礼集训 2018 Day1」图&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h3&gt;&lt;p&gt;题目概括征集中~&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
    
      <category term="动态规划" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="数学" scheme="https://tth37.cn/tags/%E6%95%B0%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>Sometimes Naive</title>
    <link href="https://tth37.cn/2019/10/28/solution-jsk-4594C/"/>
    <id>https://tth37.cn/2019/10/28/solution-jsk-4594C/</id>
    <published>2019-10-28T14:33:25.000Z</published>
    <updated>2019-11-25T16:00:22.685Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://nanti.jisuanke.com/t/41979" target="_blank" rel="noopener">4594C Sometimes Naive</a></p><h3 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h3><p>题目概括征集中~</p><a id="more"></a><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>神 仙 题</p><p>虽然做完后想想不是很难……但哪道题不是如此呢TAT</p><p>易得每次询问中 $c$ 个人的集合点为 $\text{lca}(v_1,v_2,..,v_c)$ 。每个人到集合点的路径上所经过的特产看作一个集合。可以采用倍增和 <code>bitset</code> 优化求出所有的集合，由于本题卡空间，倍增需要使用滚动数组。代码实现非常致郁。</p><p>在预处理出集合信息后，考虑如何回答询问。不妨二分答案 $ans$，构造二分图 $G$：二分图左侧有 $c\times ans$ 个节点，表示共 $c$ 个人，每人购买 $ans$ 个物品；右侧有 $m$ 个节点，表示所有特产。如果某个人可以购买特产 $k$ （即 $k$ 在此人到集合点的路径上），则在对应节点间连边。不难发现，如果存在使左侧节点全部匹配的<strong>完备匹配</strong>，则 $ans$ 合法。</p><p>考虑优化。</p><blockquote><p>Hall 定理：</p><p>记 $M(X)$ 表示与点集 $X$ 直接相连的点集。</p><p>如果二分图 $G$ 中，$\forall X\in U,|X|\le |M(X)|$  则二分图 $G$ 存在完备匹配。</p></blockquote><p>因此我们只需枚举二分图点集中的所有子集，即可判断 $ans$ 是否合法。</p><p>进一步观察可以发现，$M(U)$ 与二分出的 $ans$ 无关，而 $|X|=|U|\times ans$。也就是说，我们需要找到一个最大的 $ans$，使得 $|U|\times ans\le |M(U)|$ 恒成立。因此不必二分答案，直接求解 $ans=\min\lbrace|M(U)|/|U|\rbrace$ 即可。</p><p>代码虽不长却极端致郁。</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">300005</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXQ = <span class="hljs-number">50005</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> INF = <span class="hljs-number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> n, m, q;</span><br><span class="line"><span class="hljs-keyword">int</span> f[MAXN][<span class="hljs-number">21</span>], dep[MAXN];</span><br><span class="line"><span class="hljs-keyword">int</span> h[MAXQ][<span class="hljs-number">6</span>], c[MAXN], a[MAXQ][<span class="hljs-number">6</span>], t[MAXN][<span class="hljs-number">21</span>];</span><br><span class="line"><span class="hljs-built_in">bitset</span>&lt;1005&gt; g[MAXN]; </span><br><span class="line"><span class="hljs-built_in">bitset</span>&lt;1005&gt; s[MAXQ][<span class="hljs-number">6</span>]; </span><br><span class="line"><span class="hljs-built_in">bitset</span>&lt;1005&gt; x[<span class="hljs-number">35</span>]; </span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">Lca</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (dep[u] &lt; dep[v]) swap(u, v);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">19</span>; i &gt;= <span class="hljs-number">0</span>; --i)</span><br><span class="line">        <span class="hljs-keyword">if</span> (dep[f[u][i]] &gt;= dep[v]) u = f[u][i];</span><br><span class="line">    <span class="hljs-keyword">if</span> (u == v) <span class="hljs-keyword">return</span> u;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">19</span>; i &gt;= <span class="hljs-number">0</span>; --i)</span><br><span class="line">        <span class="hljs-keyword">if</span> (f[u][i] != f[v][i]) u = f[u][i], v = f[v][i];</span><br><span class="line">    <span class="hljs-keyword">return</span> f[u][<span class="hljs-number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d"</span>, &amp;n, &amp;m, &amp;q);</span><br><span class="line">    dep[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;f[i][<span class="hljs-number">0</span>]), dep[i] = dep[f[i][<span class="hljs-number">0</span>]] + <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= <span class="hljs-number">19</span>; ++j)</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            f[i][j] = f[f[i][j - <span class="hljs-number">1</span>]][j - <span class="hljs-number">1</span>];</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> tmp;</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;tmp);</span><br><span class="line">        g[i][tmp] = <span class="hljs-number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= q; ++i) &#123;</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;c[i]);</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= c[i]; ++j) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;a[i][j]), s[i][j] = g[a[i][j]];</span><br><span class="line">        <span class="hljs-keyword">int</span> lca = a[i][<span class="hljs-number">1</span>];</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">2</span>; j &lt;= c[i]; ++j) lca = Lca(lca, a[i][j]);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= c[i]; ++j) h[i][j] = dep[a[i][j]] - dep[lca];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n; i &gt;= <span class="hljs-number">1</span>; --i) g[i] |= g[f[i][<span class="hljs-number">0</span>]];</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">19</span>; ++j) &#123;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= q; ++i) </span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= c[i]; ++k)</span><br><span class="line">                <span class="hljs-keyword">if</span> (h[i][k] &amp; (<span class="hljs-number">1</span> &lt;&lt; j)) s[i][k] |= g[a[i][k]], a[i][k] = f[a[i][k]][j];</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n; i &gt;= <span class="hljs-number">1</span>; --i) g[i] = (g[i] | g[f[i][j]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= q; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> ans = INF;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt; (<span class="hljs-number">1</span> &lt;&lt; c[i]); ++k) &#123;</span><br><span class="line">            x[k].reset();</span><br><span class="line">            <span class="hljs-keyword">int</span> tmp = <span class="hljs-number">0</span>;</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= c[i]; ++j) </span><br><span class="line">                <span class="hljs-keyword">if</span> (k &amp; (<span class="hljs-number">1</span> &lt;&lt; (j - <span class="hljs-number">1</span>))) </span><br><span class="line">                    tmp++, x[k] |= s[i][j];</span><br><span class="line">            ans = min(ans, (<span class="hljs-keyword">int</span>)x[k].count() / tmp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, ans * c[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://nanti.jisuanke.com/t/41979&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;4594C Sometimes Naive&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h3&gt;&lt;p&gt;题目概括征集中~&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="计蒜客" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/%E8%AE%A1%E8%92%9C%E5%AE%A2/"/>
    
    
      <category term="最近公共祖先" scheme="https://tth37.cn/tags/%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88/"/>
    
      <category term="二分图匹配" scheme="https://tth37.cn/tags/%E4%BA%8C%E5%88%86%E5%9B%BE%E5%8C%B9%E9%85%8D/"/>
    
  </entry>
  
  <entry>
    <title>题解-计蒜客-4594B Too Simple</title>
    <link href="https://tth37.cn/2019/10/28/solution-jsk-4594B/"/>
    <id>https://tth37.cn/2019/10/28/solution-jsk-4594B/</id>
    <published>2019-10-28T14:33:19.000Z</published>
    <updated>2019-10-28T15:08:09.089Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here.">    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="4b6df047e871e4a391f20ec2c524044e37de00782d01b49a1b67b8bfa7604d86">c03f3060c9f1ae8757f4c8372012c368774e30d6fe06dac815065efdcaee0a7aa0a4588fa8d267641961ae1523b6e9a24447a40288df714d1def8bc0029614f97cc352528f082061e01922a0af014d0554ea2c0c1d77bd935c11400f9d7721c7314ee735935fd0bafc40575a0c294ef1e5b59463948084333c5a6598e621c5ab9fe7957ec79acb5a17206081cfa8161f0e1015a22769032993866d7439707fa33d8c0927c4561146950cdedce84358861db382f8ad8d14977a4b9b26ba058a04fa48e5addae1425ff0d1fa4862a75cbc06477926292e89a88f94ad1def1e757b616647855632a2f002c0f19427e8f11a146e94eeafe6bc73eac0e62c0f560e179e3c909d065b6ad82fbd057eb110e7ea6dc94f4ebbf1cc7308e6a12f84fd36367555ec17d04e73b9ff9fd250124f07cfe6611ab64df45beb09e1d89156d2691e6959b3493e57e743e3f63551fec7566b1b3b843c22a8aeb80c923481bd8225e5d3f9d04b617b6a7b56a8c53a6c943316adf5eea383494ac6158e21cccaa2fd160d598d79abe86d680b9c20d2c567bcf8f372eab6f2d26c85aa7c39b42f108f36182ef946bad697f04209716da8e679ad8b76590ffdd5370561155865318dc195581cd7174633d15a07a4f5d1046934f9a159053b693e43dcba77832d86277928a9a85d8184a5798fb408d70d189065df44c32101cf0f634fef5000663d2415ab31ea76931dc6278cb0f15c0b9cbcc68e40be3a2f85b0b83e085684ae59fbfb33e6b1cc96e6f615ecef2852fc7d84cb1c9fed3824ce1c28b45e370e8e400fbb22ef90d7c605d9be0286a7572cc220d3760b26c80f4f68704a0e87075fb9afd313a93c404fe3a3459fc19521fb74f42950538351ffe1e00ed6a3aa2c64e72613fbbc799ef48302d8c67f5eebe79a6261570cba512116b776ec841bcfc43702900c926bf9de1bb8470b18a2fc9c85ec92f04fd8e839a8b7ebd591030eeb828c215e8d80e52636b239128644dd6fc836171ea51d30c6ac81dfd0bd223c2553130a1772b2764cf41be9a7b9f01231c84dc249c70ca385ed171497c03c7b88b31723cdc62d6a6d257463dcf7d5bf404dba207e8050e54c7979c3bf9ac89e7ee890b134388bd2216be935695261945e31c8fc66b0f8c7f68ff685dbd02d19365bd1a8645bcfe51f41a5c28687ad85c2705c6934f6a3a4680a56b7df75a20e3adc2cb08bce7dad114291365c95aa972293c89f60dcc968fce94de144034f7f8152cd7db32a26685c376ee9373fa70e96bc65148d611afd86b80cdb08e3002d340e68c2653b182204e2663b75f24a45b01bffcb4d4ea88f7b86415184b0456b4dcd066a5272eab5c2613211d4bb3362fd89031fbafdcd1c737f9da841850bd0087b09d75925b3ba686471b44b2638cb14feeba43fddc3890c4a9267bf6d2365d45d27d991630e55ed1e6ea75581d1362a9eae2130f86af801dbc9d416c0fdc3fd7db50886684c4b7d05e64a03982538489a70e1af0a3ee7417973c7878b8549663fc02b013ec81b3b8adc28b9f3573190de50f965a2e433834c60bb4ab89d5533087d3a87e117e8fccbe35f618ce9f8e4cf04a1d8ed54d14af40eaeae7d2ef3f7b9fa89cbb1205a2d8db8251fd7d0e977e31c4d825a2126f07125d3b2e0be89bb13bc002c9c50a8c45d7e5be957fd2fec14f9f8b5c17255053059225079e7397bc4385f6a1ab8534a389debb1c38e349eee38fa7d06df725e1ff839a392b4fe5328dac335bbaa1d74394bf8dd6e280149abfa6b2d436236a210382b244ba98e7c21c8596e00d197debbd12f82771adff56d22303a520995e9a13f08cabe3e780cc28ebf49dda4eb1f3b61aa98aae231befea1097a47bb6081e76d6a67ab59c31985294b5d4ce26b0733de4dcebeda5bec55b2f945f357840f61937868668760f5341a81168aef52d6ff5609be9ef46cf408812d95770e1cb49d36670c13fe7c321fc0af2c61fb8857a36ca0fc81180796f64e90446bb5eb2de5612189b80c7fd3ca18155aad49188ad36342b62329a5cd7938c90d8e1ad245516520c901d1dc702061c38430019db92cfc11dc698c9f6f370d2f931179727454198cc72262f7dc4026ae58f9346ce30a0f526e3e0a8b256249ca8c6c0bc702cdfa6aea12129de76051a2d8aa6312657dbd9dd4f9d77e3c5c5f7b9c250e619e58d99059ce06b2f6b2d636d1eebcf5aef5f6558be14e3f73c76f9ba5a1d59f50027f669a49cbae0fe3d834acd837a7f2d4da72e480d1666d70dce8269fe12292117b1c6c7ba7f420687402050fa308d0c0dbefa27caf90d817411301d249a51398fe4ec3e0b5e0d51cbaed3246741e7d08efdd03c4bd2cb816cce45df9e0f4aab79499c1af6d9d55ff543b6745c045679b0b38aa1989a64e647685f2aa1fdae4b750e42e5890d37e8ddc8869c1881ee4cff5685dada13ab77fed72e5fc574a827e396f5a35624429c5d59b163fff4b6d97f8be61b636ac363af2e491c2889237fb0b0bc94022acdad1c282484792027129c3c00615d9ea465dd32654a0b446d9682dedbb7a739b1e672d66ba6101e9f8678db33afef16efe636ddadd5d31b1089b9bedcb1d51b5f34e9274946cb139bfbc2bcd18d41561220826da5f8267f462b717ee407c0fc3eb71229bbe9b63265d5efc69fed921e3ce6fa3c286b974dde4007ea02bdf2b4b37607e09c47266bfa139ea9bfd800c63a89bd7e7dee8a388209ce4611c8d57e9608d860d2af23102277182df34a7cff528d6606166088ba1123cc0e1c79eb5cff4a1bd1f3237db07be8da4492943247fa9ab2b111b7f9e6c262fabd813e7f8be058d2f7ba0ee252dd152942a21de99cc2e05389e1cf18628259d9198bb471a4fceeb8954781dfca3562debf5e79c601ad9f2b8fab747dfeb5c5b00a17dc6bd90d6591172e141bcb55c5f70538f047588e78eada039a645e7ad54d443ebddc2d9f4c4009a3b9ba023efa9b24bc75a4ee7f28405e569dd52267ac5ae2d6a251e4b15e6a873e1e357cfc22d870fe709d742a0214f5c32063fdc85d3fd9d553cc4b1d9fbcf68672087e5de02874c5e87fec32d9697c9f6a6c9197a8da2e5ae0e7e5034572343b7463cb62a18fa065caba38dd0edb42cb3958843e4e7b13c4412e83fe30c0e385cfdb391b34ef24e6df2c07c9cd735f61bbb23705d0df130d4ec76be7c1c194e2196ba99af52921a88bb7dd5fd660cd6135c5dc1516ffbbc0e9d71241d4ac5f00acb3efb5053c73f024e09d7adadb06ed2978e9023e9f43e79b53bb6732eb043e5c4075fa4fefa2a27558a49569148c43c71cc35adcebc63380999517c358fa9e68a840d15913ec4a138cfac306ff58e09057b8f172101d3b300cdbd1f05bf66f66c1f8ae27b249ff092328e8e0c028998a7640cfb62ed5c919f65f451c3a3bfca721cf448b872ae2aa03631d1f67905a09516f18370a292a0effac441115bdb326fc804b5334b25e0fe62c8ca930d287e01a05848fe9f15ff41f59a375a8806ef163e162c224a86290c3f25c5b76cbce13f17656974e1035cdf3581520be9e8f5a515dc35c6318fdcfb4a3956ce6a42e01cd479e80cdefa5381d4e3479c48fe6a6e4c8aca1f127c5b8b80b9e5cbb5085eb7d501b83fa5827e54236ba957911605990e559c84aa9f39693da149109e7482f48e1ef6c3bdbdce32d373f5148fff3051a1a1a1ed23120b6e67b9148a7d2d815247c49004e517db186bdbe1e2334d5dab13c3e71310544ff254e094562f1bf5a2200d35a654e06c82fb341a00bb779dd7fb1c8172c629559d34c5f49efe3f8cfdacddb4afdf66f6828fc48e3c3336088d0424a1420da22b058b492448e1192881288e9b2ca6ac4e427ceaf70df1e626829435289b598127a0d2b82d9173ef15b4ed78b6597b687bb9c8bec2e603145d85fbb08f6fe4129c8964bb9ff0f876a55633b0ccf778bd3489142609a4298ebf059c503c68b94d2cde04897cff873958387e33ec501813feec755ec327b49d47f93eceb55abbb0aeecb29e409ee94e85db1c4fbcd441a379cb80e0acbf79a2ff278f99f7bbabb73c08104ce33ebae8f5adb647e713e41b6bb2be3a6f47e4cd7abcc1922f695ec2baf4c4a756ebd7aee6522b10c8e58c54d00d69cffc887a4f6131e4fea559204470bcc03a856cba94d3a89c2ae77a1eb76ae5882592f13f0cf7e34ff3572e00ec475aae8d333cd2baf07d02eb7fe0fa9fa21024ef63d17a15990beea0ce61a67efbc7f2361e81bd03d3099130069940ee8073b5ffad6347404dade0898c6c063f99dbe99a29c6ba61a10d5b18b7415530a044be9b3861724f129bc6608b955e6a60529b247727ddbe7469fdaf63c37a2a7c0314c325c640f435e6c98e7866388e2700195bf933bbb5704730bde4ed1fee640a08e2c1c4b8b71c75e906ed6aa78f8a0717ace53602e612c0a9756e6dafc956e23e4c2b98ca4d4dfe6028b659b329e10b40239441ec8808062b56ca85630aa9e3b3a8ba20deb637e6cc7d0061a00882f4641cfaa5d89ff90ac0e98aaacc4fce62f624e4fe740addbf122e57e36e533ac681c21b1fa29b5a2fac4c241e51b9410be3cea80a3591ceb708c02574af28def99ac08d2a96b246ae8b715fbd7b61f799665293288beb6d50fd0d880cfc483a7ccd261ed577641d5e27958d7dd1ea61664e93edcac4a5e68aaa5d3ca84c1a600b5f49f2851a519ba056d9b14feabd40f9c7ab5e4010a6983cf3bd2ba7d10dfafae81210f8e3a1486c7558c3cbf70712b23ec846ed713d3ad4201594f2eebb3370680e863e6210a07eabfb2e764f9314e72a90f78ccbff5b3782f03d1f79cd8bdcf18fefb87ee07f191e9bb0129f070bcfb760d1edfa1a1b660b35e957356cd8fe595416410868879569967d6845aad46ddfee1b0bd3c111c1a3a524f24f9ab72d4116c4d7ce3ef14f1d4adca1af718d7dcaa36796805313490ab4d235b0aff6e42c94d4795e73c9d72dd1186996b0508b38dcc848279a059cb7fd27055e218b859674b0d813fc8be5f0418cc479f094159778bd9e97d2c7f51959d98c540e21aecbf7f9db7448c440a02a4fe203b7678362a1c42e1d03f3a03273f986be1c60652624ccc66080d122b1b4ad4200d11c762b932fb48dcade58dee15baf23cad9396048684539a9f876ee29f18dc1a39c646367fc3d3fc32fd1884299844fe0602f16f8041892c25025c61bd5bbca8df8f0b74ae4cabc0276027fcb037cd1870eea4c2cf88aad0fab93438ae7c74458d5b0fc5d750a454f41ab8c905349169c610a0f54bb7359de129402acfdf7ce99a051526fa52954d20457f3325f4c03ca33b69db245abf6ce1e507b94ae9dfa5b6c36134b11b34c1a1bd77e2b3d13fda8af1e503a272a942b5bd789e931c8e6455d832ee6960fc9a1595983b21f88af40d367be2900a1fffe16c0f198a78dc08cb25a6aa5b79135673f00d0249ae2211b8d74c8651aced0ba257f30cd9f87f95e5a9721ed0032ad1bca26fac7009c70ed2e0050fba8bd0a039213a1e5602d25239b407a252d70b83e1d83c1272bea288759ee75a6c33b953fc5b9ea0bc560f1fadba118862e4071bd011ddcb7090fc192153e9f260109d374b1476a1390cc1da8e90ab53d45ea3aa36d4ef5b315499d86475ce612b473e7fa237a0a7c13b23c2718091dee783eda01b36ce6b505e22f71cd8744e34ae539ccc6a1b17a1f52522a58adb79d6e374f8569d913af775b98c1473b5a31d7edfa271f2bb2f9248e4bc6b0d97436467a54450fb37cceaddc66f1d0d3f33fa562c10af27219d1e8dc474cefea3bb81cd236ae587ff25510f340cae57cdd705d2ef104a39bae6f5b9233ca52d6758bf05ddf7f0ef66c08992a6d18823904bd640b37edc43eb4075958f3eed16fe9c90ec5e25ea21778a4127a6aef94b93b587ec7c728604412c4d0bb632eeff0e3f7996a44f99bfd88b3922253a932e53a03d14ab26be2a2d30851329e2583b9f0dcbf12cb7750124681598781bf1146a886784bb7e50f51dd4aac45cb790a9225bd0f1b0a5d109971c1d66842710476413ce87341ca035c7f78cb6740baaa3c8065a5b5ae100c5f02cb0a4e0040f937b04451fc822a818f09f9bf40edb1202d9e35b9f8e3ea019570c82a7fe002d5d5b608294a1248c8683bf0df946b33c427654795f3b4c526c734072b8938aeb93a1641e04eab4b49da120e3b184b1936daaf2bffc9238b8a87d186cdb8f588c8c630839bcbed2ceb0f85df9988c37ed1dbdde5f7bd71484e4eb89b32a863521967bf4ef16c87f8a5ef87d2a1c7bfc7e0855632240538627511fa5e531d84b9de91f8df93f1d5ca38df7e8e9186490a3bb884d7b9505f6e953d437efc5a312742cfac5a5be93a7e57a70b2577e2cb1254c27ac394bf30a888f6f5b72f2528a0a2a35351e130193858eb61c5204f78edfc74f854ab0d2f91c47c063440d66c0d65da947a5a6198ad28ae5354908ad27ed6333e091943dcace9f15adadaea5abe3e4b800604abcfc4b035cb80a4013207ad80eece2d131900d25d25065705c8a9219854de736cef566a215218f6c328f9d789160f58bd3a594cb3154c113f7bcd6f21959b3bd7ec0c627d9aa6148f40dd2a53f4b34d2b97d12f9d61080dd65e63b726a79c8f1c33f499ee2f3a50d8b90d81ace202be8d79e619ca71d206fdd826f107b582fa60ce5bd9664f5a1ff52f2f32bb7f3fe1ca92697b65f708e35fbe100a2752f12a49fc2c151d4a4a805352d0042e9750b9ed7192f16f9d889a8532bcc80f9b3111808ae7a677bc389a23566eaf87326b40082c45ba094c2455e8018b665f8fdb5aec997f5b34e8f31720a69ab96fcf846aba88b227a4d072f34508d1321524ef1c2b6267450658dee536abb393cb154ce8760dd2554b62db6b697aae2b24874e7aef25b61aacf28132471fd32edf7416730d889c8e5fbaf466ef8f305c2cafb9c2a14399da00172c844f37752275da45d45c0ae8c27b161f886934b7cdb89a059b50bf0e3224df70b1366222d646df76989822083cd0823c9b8ca6a8df494d626a44b54d4213de2153612d7ad2eb6699265a5483f873af67c2d46ed2a66b16ed26296934ab26fcf0c14ea9fe60fcf7e94cf522c702eed788f1b20fb7ff4d1516a400b24a58909a359bbf86f8daf8366ca276cbf3fb8de7a4b3258910f995b7b448ef451ba4e5516faabe369c9176c6d8b52fcc966e6b9fc59ba06a5a7bee73bc6b52d2884ce83d2b68106b53a6f0e93924e9f9a125ad9712960fa2b11d4d8a3a939e0e4c2aabad1e1fb528dd4e7ecf879a2c0f98c6c996714d535f48ee0042416ae19bb9262f418cdbf85f0d0bbab14cf67f23606faa39b7e56198182849caa1e5bfcf02dacbbd2efbd7f7d85c667201d6b8d96c5cb18d977cab232ee7f0ffbff4672b45fa4c14f1150bf5c3e84e6ba5aafcca3006288ff0f0343197bfe77c65eeee449f3147dbc9e8eef49aeabc9ef418179543958065d67cd36709fab3d8a904452907ae77ace4e83bd5495e5ba1655cad6066d482d68f234657448997ffb60f1ac037f29e366d02e11f1da3be400f62c40d9b869e082cc750dd517b0d5c1a4865c85d3ebc96fc1293b9037ef74779cb1048a8d670089671c446cdbfaef1103cb1fb0fff5943614a63ef474407b2d0e1f2c7612f05421d8edd6f862ea029d5b36553429f4d612365c2a04460d1ee6ad3efc9fdb4c2e8d0ea17499e6895528217652c63968df8e0da2b77f77020c7eecee0f87c31e890f6fbb811493f1fe5300e3eb3a26065450245d538da4738d868381ae0ce90fd5661829faa0ffd86a6abe807ac4873627ed2acf9ea7b80fbb59083c78cafea0ddacbb973209cec4816c7db06162bf6d248af9916eb0c24327ed6cb85e2fa04c7dfbf65c0717292cbe9d7529b5c867d08ac333d130a057bcd6f562408f6f28c391603d6bb4865899a6e4c027ca3e4d6d2e9b330f94a49d48ac9587cdc88fba964b8f1dbc8f821751e5afde644619e7cede63a9d12dd4212ddf65fb6848cd7d81da37bff99ec2ef54ba75ba204d953bd6d73adaf9e0853d138b78647774501199ea19221a47ed3164a865729c4f1b0602391c8bd845d366d1fa7b3acd0c1b43f5e96d51146d9156413d5fe3f7d4f4bbbb25689d1cb3ad1bc484bcd11236079c30772c23cd4a4dab8cc5a22aa65232e01c4dad06d212e6d24dbbc7ba3fc7aa0cbe359a98ce4400357d3326c76f4cb35ca3d9d178746df2bc20b7c5386eefa1e0c9999ce645bf6c47569c89d0d405feef9e0cb6aaba9e8cbd0ed38fc277f70914fe0a6d939db064ab619b80920219291c076c6f5f98e87e28690a9d2f04aa983db061d632807ba178a41c565f6a46b64be589ef855d3da3f4f4be0fc8692408779649102a23b33604c5b38a42e6dfdafba345206351150fc4f2494dbc6bb6504fc5bbf779cffe3b2e626e0c22193134ca79c63042b284b2f33e26988f5ad27cea5b6c2cfcbc560137b619abfee8b9401f3f4dfdd6d32fe1f8959ceac9f215235a66711423b905279a119083bbdbb9cc2011fb3165bcf83d2cfecddfb43b9ca864aa0491a5e8431a4fe58e726076b8fa2d8227a4904a2d735add1887197c608484062483731edd9e0c8fbf6347641b01dca5321b087112e49ae098b9335b841db277eae21d60b3bd43a04f9d161d9629d564913186c168cb6969031444974cc8bcdf9369cfde32898259de6f695f618bcf1c739227a6fe4474952dd90211eabc3aac48aa2185366486a74b95f7bb150954cdef120b56b3051f1c395bad93e2be77a054be4211d506df5e777f5f92e69eebb52a040be05b78c124246afca7ac5f8ff6c66c8abf84c908632a1d4a350d7a9ce0bdaabeac81e2a160c935627b0461f5c6b29c2008973961632a3fe16e800d62690094b552e5854196b491ea46b7f3ee23f1f12d32728fccd7ab7c4c0fc268ffeb85adf15279303db4412d8efc614743286a314737c19ad1c836c6925b5368e72ecdd66b183c4799100dd8067f2ab3745ce4c8383dfdf54cab3456d7241a98f71ca4dd33b25e2a49cfc8f8433eddd00af3b0cea3d329f74e49f2f2cf599607a91b928657e203d4c211ce20f8dd0e2101bb2877e945b1253388f768c6a47fb1e42ff279af80ba4e4682450824777dd4a37956b3063e3e96413b64901ef089f19a665ed8a32e48e4caacc6c75c042d0000252d018c47ead7569b3200dc5e2d3f7ddf7a8555ae53ad0fa94eaec987abe1fbd2852d873fd64368787b103c25a535c41bfe951049ec0c7f2a5838bc04eb1913eaa630bb7af60c887389d735a7e28724d86e4fbb7a2d90a8dbb23d15839b1f3dcb9311d2e9cceb8ca7ca0cf59745f5272229afe9acc35d8f6fdcf20b730cd01dfd3ccff18289c30b7f309d6fdb320f04271eec018fd85c0a69429046c673a015b0582b414c089acf5f91694fbac89f162bfeef95ef0e1b19968e23542980cccdca34aaa6c27029a079d02a1d381dace94b439fbac1a66f028b23657439f38a4a0</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      暂不公开
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="数学" scheme="https://tth37.cn/tags/%E6%95%B0%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>题解-计蒜客-4594A Too Young</title>
    <link href="https://tth37.cn/2019/10/28/solution-jsk-4594A/"/>
    <id>https://tth37.cn/2019/10/28/solution-jsk-4594A/</id>
    <published>2019-10-28T14:33:11.000Z</published>
    <updated>2019-10-28T14:45:14.828Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here.">    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="6410c6a2a37bfcf0aeacc401e5a47118ea64f610aef5d58b3498e64cec901bc0">c03f3060c9f1ae8757f4c8372012c368774e30d6fe06dac815065efdcaee0a7aa0a4588fa8d267641961ae1523b6e9a24447a40288df714d1def8bc0029614f91c73da50c019c28980acbe2c606c9bee741dface7794a4f2e9b74ad92591440cef739e0ee856985a0dedbfebd07c4bdaebf77d959a025af221d18d729294b6251438a7572888c58882cce47a97625c3e4330ba068031a30a9ff05ac61e0cf033fb5b9582161cdce3fbb381c80fe5ed8a6a50000d93c75be8760af50a7be15815486d6718838a200bb15a5d6c0990f6f0d5d758b8fa2019dd74b644a4c9978d93eba98e206ca97da9d253ce7cd471383a0fc29e2aa0d214e5cbe62883df78dee9d566034d821e51ce919497373588208fb6496c0d9af776aec79bc9fabee95e7f4a976f5d2ae1adf001f624c67e70955a270b29cb297714ab90381817c06cefbcfa5229543b68483819153bbbbe675120305f3eb9c6a5cb2fefb0dbadd04da9723aa318eda1f78f1045cbb61e6222092b4459bf69a8247781d333bfc4f3a935f7eaa6e93f456c277a0b0da598a2a5dc9ebe6896680b7ee6daac80c6f43f761314bb5dc0f281ddb194776fe5afd001afacffdb788323d7c6bdd816bd78d14f3c159b5f6c880de1b70c2ac4417270c7ba652ca52e5891b24fb14b334a5b6d10d5831ed689bcf933d1aacc967be043807d9450b01abd613d08d125ed6b0f70d46ab31b2d81300f80fa44abab56ebb5ccbf6b1a7be6caf9e73af8cfcc9acfa2f0a7dabeb45a1d82c9acc985db33872baca90b1e7eb17b774e79222ccab9520df184a316043b1dfc576eb413efa340db2b8465314fdfc3832f387db0ed1ad67020545a8e53d81eacb185061ad42ad8d6e6702944801872aaf6f6be6ca7b3fa7402982440e57cc2a059614af36db2f9a60ad793abff27490b4112d53f24cb0af1b81d7141fb7a142b83ea2566d8d55ae68fabd117ddc6dfee239c6a638ed70bedcbb297147d82194973b266fb2026fc594cfac38653d8c304840de5ee3cbcadfed6bca5d0f0d29c1715c4c833892823d0feb5929bf14423d7aa6442e6fd68b874cbf26d60d003c5bdce4672de64494d93b372f524958685211c68b0c054eaf0967a2ccb672b7368b8d0b2acd17eefa236b121f44219a4a94bd5db05eccf23051bc01b0d0f344974b6e097c6d30057c2e062f155fbd1a9fde93ec0231597e2132a7485f64d4b3610549f6eb19856f24ed3835d3c7f7786e4c4f4fd44ab683e895ba17ee80d34e227f409f872ac0d2c60ac63ab3dcbb2923d5072af0bdcff965822c02896ce6162b15c3093c832b0d5e463eb659e044d82167d9d4f9e5ca42d864f96d993090407bc6cb95307a5f692675aa1ea4073942c02836037ee6a57d1bdc6c16efb195eac3617bacac07db718a2f8c0f8c5ef97e63f5db7b23b77d3119d2c00547af4e1a1ee3eab9f098da61ce6ba9f3e14efcb36366e3c6b9f89de0633698c9a0a702e9ad9ae036dbe4557748968a11a705d749a335559323cfb77c7f35c72fcbe175f7c4a686318236f479d2a74fd5ea20b096ae3ff122909214706967f31de912c6b4a76510875a8c949635e0577ca5e217a7442fc249cb1db0404e861e4f0646e25e5901d2eb9119318dfaa3094fae4cc603376a3abada8fef44d63512fd1394c036a96313d580b172c77ca60ba343d37c0ede21c27a7e1e25cb2f1ff25fac3ea6a1e5eb2a5a93aa2f94faf68039211a94fd7955f70ddb6a7cdfb1e1c3f357c3c3f66d9f0cc42ce61801fd96ebd73fd077246ce691e8494c69b05a351c1be94af9dcbd5a39dc06718adcbe4c9f958546e92f67315bb81ab70b50a6fb1a51ffb0ffb5ceaed45342a5334dc4c383b41b5f2826044f7255e7e2d71d990af83c2e0504bb2eb6496ca98a02b1b51b7e686494231dc62c627b5c209bf0b877c3334516c5ef9288ca11fcb5e7e368cd899cc88ee684b7de2e00301d83d94fdd7819718664bbf2697377add21c06916d7058a676b2e48254f8c9f0617c2e64d0c47fd220fad23aca473ee40801aa33a7c648bcc660f47983f5b054dbbb162313e4c2c9f6f5a663f6e2b5743b22fe9724405fae2ab494dd9120d686529bc1f22ce4380c54f4e06519a6dff91bd5d590fcf8dc35c4dbfc276c33f39f1dd23b19c7eebf25b5c60c9b2f4a44f71320d6ad1e4f8b7a27f774f4889e491d4efb8284088933cbcb942b5ceeefce34cededfdc25825a331201fcedf3c152616e07c3579d4a14c18d5741d78327d04d3e24b3a35e19f8df493a4900dc6dd481c6d55b0213fa4de331af502a20c136f1f7a70d87ef70389a3be3b25f855ec089b56ac1b5a254563e1c0c05ef007244921c645491c062d79925f91e57312e9a01524246177006ce55d0c1b68c1ac6eccf71eb33144d8cb2b9ee3ed8fa015facbdad2fd907762862275fbf07eac4b32fd2af06a72f52b26e1828c1fc0b56329ed1dc2e8c8a684d2b0c2fce6db00e35bfd512631e39f890e7edba29d780562d742bdb2df5623c2ffd9276ac0c14ca86fb4a8f3d59e36b98f8aea0951bbde68cb903c9355e5ddef5f85889e490346e4bc6ce5010b574beaf678738b87eef87a61099e1069985b708f527291d709c12c04683be367e5e920b5d3bd0ab2ff8be2b008aa25a1541e3c5ed1010faae6480bd57f666bfb052e91386c3122e6c7d14e3ec1531fe37192fcdd54777a32dcbe706a70d8dd833aa7d006bb72ac3f2fe1493ad80aeffcc047295cc3d4b6c56715c58c40fb4359156092373a4c9a11a4fa081f0eb877f893d5b306f2b742438e0b1dbcf218a1ae82235b6b034a10de5b7c45d951a2a3d0e1c2d447e079c529514930bb191873ff64b073cc4c1b75b97cff8c3beaebf60797f4da29197de33e460d7bdd0ba91d933aefaeeec1f002a2718e4107c8bea4f61a6f5af0a761a3aa61f76fdcb722bbd73ea405f9d26acc44d117d626f1025545f8214ccfc8addb813cce506bcd79ef1cf12142fcaaedc966b81ab26880cd6137ac1cafc6230e336ddcd00f58f9e262fece9f86b9377a1ee585b77ffcc00750bac15b1d18162218ea57408118318646bccd02738f9717ef1c65763b960dab1db7378fe408a36c0aca461377ee853ecaeb2b146ba7dbc0a740cfdc9b05cea03665bd63ae20c148c3cda78d5251d0a780f88517ca0da437094ea737ea16032b879c5fef521afbab4e9cb6f577b2c4d4399310eb0d4964ef1fae0491b6a4c4b88963bfb1e493eca006fe8807811d2c09bab5f43d0f6e6662139fdd9198f8586e148e8d1f8ba564135e399f05442b332cad259d311caa582230a9e6e78dee82bbf663a9f2ca51bd8875d621c040fbe48a79b450f5ee4c87003f24181a27aef0e6438167e44acef40f042ce3e14dd80c20f1e84539b658c49cf7d23bfca7c9505744be0eeda488ae651841351583fb0712b64c00b7ea38d311410682a8479bc144afcd2d3c84e97dddedbc32e34de17213815793ab481a2fe9e011f3ead2f002dab1db73731d111bc6a219d63d816c0f8e5cdf98e2122e203be3be11390a4b9e9dd968ea29544104dac5af586c965c66a2b393b290719e033ffbf5deae0a863b663cd1164dafd5644524d1402e367117fea71273dac64fe2f089404918146b0692771baf66b53448e74ed9705cbbce88aba4fc99742d1f7e1765e27c642d3655cff1ab485b4992248053ae7c26890af1dc58142dbc013659e922e0e7d91c57272063bd2fbe0775c27200109bad31fc931412c1cb9fb11e944d4d1832d957b68efe6ddb308d150ea161815fea1fab736de0b776f5ae01c673d9e8b5d975ad0b1ab9494d0fd415442bd6fd77c3e3389a63530605d0a09cc454fff366cec1b3700aa953b096ee19d5907147f8452ff0340efe35615eb95e4ef1838d426514d829a98677af27f828d2db485e2218d741cb0c428df12987515e8ea2cab0f25a3157124d92ac05ded6eb0960859db087c0ed0475def59dfca4eaf4090411ef031bde44eb95ba178069de5e3ca4e7bf539981758dc5e3a8279d4dc0a2428ace31295ca9bdab345778d21fe2db87dc2e8391fa347f28bdd9856c0fe646dc3c078d6c4ac76d487c5e1a08992b5f4faf2c5414b2716877fd507d36ee578dc40ae13f1e8a094a607065fa84d74a34b52ff661dd3519353636cd7aba555d75495f0b27bca0b16f1282a434afb60f2485780710b5eef0e902eb1e0556bcdecfd9a7621f717a89f31425190704420f8be1ab9d0ee5adf676f40262b2b87c60c17ef28c66ff9c393ea45332b88a000733b332a2b778ba5d465700bd9d43db4b1056092edfc29f60db98c0af10d1a1f3d6bfe9b4b51947d401ba04896901d90d039bdeff301227981d3b73213c06bf6e25f520b4b6e0fa912ae5bcc4b57d4841c9b3e7e3e05f3da308b0756f6b5c47c9a9858813e332282baae4b000ed2d70de67b349ad08b686cd3f1f115ef08d9bfb39eaba1fb11c788481945700e31e16aaacf15076cf1bd6b82227b9721ae09ccaecf62ab8ee0ecb9c522b576a20ff33a68ac5962c99d70aa466bd20baabc7056ad203d9c15925181d81604de2219beb3c3f013d0bc8d129ac21ed2663604c389cadded7ccf1dc91e2285c84971b6a98acbc7191f9532b110f71018b74871f5bd28e2d344d12d2d713311d4b69447fd79431f8269160640836ed8fd73d0292fdd722389437d2c9a71547f4c4eda89b4b01e265b10e5ba0b1c4897d576203573249e75d48ab35491886a3e1eb2542395bdc50bd7dc81858fcfd752363b26230fa9f4000590a0ee005a936f7e2af453b74e1ae93e5344fadd118b7542a7d8d77b648f22997f64924850eb136a80d92fc8ab526f31c267da8a4bbb6df87d8d81b77395166dfed5cf87f1f31c6ed87134ebdd28b2e11515fe7144a69a9a115b5d4a87264c7355c471a07865969e54330c2ae94f9493e0db0fd9fb6bc99ce684f0bd8ac62f59cdb3745e127a147767688124f9466ae581a9abcb35bcf3d716fb6bfdd57e4b276975ca14741c21a2395e668cf3c1939d177440e62d8d0c87ab981612a47bf6dc8887b09e49b51ba0260e559746cba2fcb3fc0c2f9ba1f9280cd33da74d2a373a8ce048e4258dbe2054dc38095eb4870d2f495fed4c0c5b9e0ae56a7820b8e47cc9dbb4fec3e060287922b4bdeaa7b38df637e60fdf1434aaaaf55f1bb4687bf2fcdc280e6ac2c2936924de2f62065673f0709a49b5679fdd9e95cdbc18c9f0c9dc7b659d2ed80c230d88ac78a1a37ef1ff4ff08ad90e5259ddcc704dba0f34ddea6276ee1e23ac71a02e9aa9be9c6c79bc393e3c7549990c3567119e781ab72954c4da0a472ab64dab85c6cf68f08db219afdf3d8932be98dc1f8e2b96c6f09a263d98d3d1b20e09ccf307d969d4e37924cc3e1a1a28863290ce643af587e65f81ed428a88ac809f8a1e222d65a28931744e2dfd2b97d0aa080a79125b9fbab5f8ca9ecfe35dbfd157cd81cfbcd2a57e9c924ae4494730dc552038167f2d2a3a8e09355b88c7c0c180a910d92fabeaf32b63752e83aac2f783c78ae0e7b6ecf171bd93fc739f8d403b994c842f852c09fdf2470208ae4a8ae9465173a6196c6dfdbaa7b8b080c5978d3de2de86d4b18b828b13c8ace460a1a2df5342e9be829c021af2ba53e0b120a3cb5f253f86f46322123c2d4c81fa5d5eb7bdb08fd16d10f8976752970062d86cbef9f7b152af51427babcbc5302086b7afa841c68b98b8281d9b07a414cd6e9bad78e99bbec7dd10373dbcb71e8c88a10db569ffc0a220eb88ceeba2cc2977191fa228a40969446eab27812f451fe75c8490be208b138bd4a98ea45e792c4b373e1bb03a27841ffdc0424b8b0741f2382776f444120cea1be472f4ba8d0f721540748d2b8e836f442d3369ffa1afc577e1fb09924aacf99eb8cc505f19f51eb6f6835fafa69e20320e230158da4b78c06252f119a3e4f2e713ee555b9698ed9225349848ee5f770149a8f5e3a2da0fa194a2a216d4657ac201bfaa032b8cba3f20fde17e4ebc0b8e7aa9639d8710f2df7b58fc679b966ddc665a5ad7b038ba84e45165501037569057fdc9d9a8b9c420f2ca00587a6696c1bb8f0e3314b1c06bbf436a5941366c2f1c2c50a246f744a37cd584dd34fc384b06bc8a782dee2c8fb80a16ba8c35629f2d43cd2bf4059965b388728fb47ffadafc732e859cb499c695ec1f66ca0af8cf6fec9a883749aa913c0ffc1102baf67d3c6d117703fd1b00e0eeac4de6956ac4afa96930b67a78bbddaa2416d3eb39dca7d9a770f0312c01715c663719279b0fcae554b1c37b49df093940bf6e28b0b82739ba44a68c85bcfa58a60585d48032ff6a1fe341abd5dbf07ae46d1adec431160df03dc96dd877d4b144a767cdc6fdc593ecf6fc90fe325076fbec859e46e69b95605ee434604d02dcbc8cd27c1550f9b5b4aea71bf418383027eefb402b44f9ec215e708d4d30f56ac563da7040955bf8212451fb672062144cb973fcfd6ef6618d78ddcecce766f6d86542ff2c5143f47eaa3e6e84df4465100d64c2cdce110e36a4df596c9378e4f47999afbb6964288c79f61aeea8c8a29fbd02641715e6bc2f72e77695779d4e3e0752d4b9cb3f2e86293a04e3423a25bd470291098ca1f8a3d9ed12630f008e617b40a744d4fa6ef830e12ac90f3a37c7c0b4fdf370c431c6ef14ba1941f4aa3835f65b99524e227159350f007a1974d8779712b3358c5fa9774960a184b6e0f5c42caf49ad74c6798387fed2082322e83ff5038446429dba55c618cc29e0952f707e17eca72ed4c3b01795ae23972217cf4c9dfcfee4fe54d6abad004d3d6bab897a1965e64ce91e187919410e5cdb329154a34b89425182e8141c43e69ef7af1dfd483a802fad1e7325ece096f584ae0c8c6266be0fb19ea387e0ed97ff075c4bd1083430cc45bbb1a245d96656ebb02ba8e76d57a7ca0593194196cb0c401959004ccd9bcb4a05393518b2861ce3fc9edc9b9815a1760779cf6619ed2c8b1db5b010144d2885ae98288028beb173d9560627ac23954994672d8bb6a9b6e36efee4266fee93e31203ea66a89ee61fcaf8081c90c2ec32c1223cef0b8f337350607c9f72cf716e02b46a053146b5bc023dd4eaefb47638c64cb236e2fecb74cfa49f64a43d104eeef965dce80fbbcb1c099f34de170536f20552f5d1dd4e85f62ee1ca46c7e67662f433927cae8973f0ba71aff180c9e29827ba5e7f07b1ba6e593b4d24cc20aa6d75ef7f800998b77f4654e0bd640f07adc63308638be47a1fd481874190165df9bc9cc12bb44a3467f780fa7bcbb5795e90dacf2c087587c42fa690fa69cdefc1718685694120a8e9aca4f642dcbf8b0fc7bc7115bb3a84457bcc92094ba66369c8b5c0f8884b8d4eca5dd7008139fd16845f685e2df19574f94d1d56b1bc4f7aea41fe320bf6077ff670b80ca61d83e26801ccfddba7b7f90433c537bf88743817ba7c0499af17edfd4ac1c09a2c4e60cc69721569e6f6f0e333efd310e6c05fd165d6b78b4a73eb62e389c5af921bd1cb1a82aadb4d3b0fc690e9e11f63ff8ca0d39552a29f25108a11e96c2ca21d43c1ba1cc62034290406d62abb141a1e9caa9f9a075127c1e0b1a5de28ed086c74d2f49dcc125832d50ce472ce4db5705efbc333c259620d8367c2291bccc6f6b33b698f8830598b4cb6c5b3b33a14c47af166edc82f60fe8af94840a5f0447db6f9ecdc705a65e2416e377157265a98ca59ae39206f070a46be9f5e879793d8e4e3c59176b814a086e253951e34cc707bbfbfa07287899a11165807c88d4b8117fc6cf19127a2b6d5b9b91915575cfd8f135b82e0cfd89377dc2ad7d936a299d299d5325680c578990b2a961c52e3e7567153726981b5384474656d552c9e1b7f47f8d962e1b6a113162d9c15c454d5c360da2ea8b15ebd380baf67cbc6d2327b8773bf047b3bf0da7177220dd64b0ee322602a93b796ae928e031</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      暂不公开
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="动态规划" scheme="https://tth37.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="背包" scheme="https://tth37.cn/tags/%E8%83%8C%E5%8C%85/"/>
    
  </entry>
  
  <entry>
    <title>题解-计蒜客-4593C会和</title>
    <link href="https://tth37.cn/2019/10/27/solution-jsk-4593C/"/>
    <id>https://tth37.cn/2019/10/27/solution-jsk-4593C/</id>
    <published>2019-10-26T16:06:17.000Z</published>
    <updated>2019-10-26T16:16:59.282Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here.">    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="25cfa6ff425737773560d264f648e882c613abcfdf3f1c6652cc5c2c7890c086">c03f3060c9f1ae8757f4c8372012c368774e30d6fe06dac815065efdcaee0a7aa0a4588fa8d267641961ae1523b6e9a24447a40288df714d1def8bc0029614f9ff306467dbeeb790c4eb6ad49a9af9ad6d37a528dcdea544b2beb068c185adb5f448d2a7a0f83d92576a208f74bfeac7c537ddf7e8d72b4b551efee70bfe3592b10e87c7d4867c88463a3383836349c6b6394f8802ff883089c18134f8a68d40f702c766291f184b2f082e2318047b2457e1ee086d48b9fec45d324eba85c0adba9336c4936a4419bf8d59b7afb6013d3440aac6d4b9c2a03d86beb5e500ceea6cfb9ae0fa87b4c7eb6f434bc876b26520bee722f7eef194867bd482bed66af9c8b7151ae46a30849c923bc8002a6d4d89e78ed7ca36ce79efe9e33dfd537457a3856290677f58c2868822779cd5db975c48f91b72a2bf7e1cf08d6b78f5a7a43eb3f497beb6f142dd38e6c255e40a8d663533cdf9727a38fce673a458bc147e8cf1b8cd8d851010dc137e3ceeea87ed83c41dd457d0f5d3356495c393dbb8fef49425f2389d14cc3afb5449942c405e084637ce4d64908513918940041d55c2c8077337af85111ed4d06877bb3239622777bc4cc0abf4471d11a456227644996bea5171b31f5f99d83a4c7c59376400109d8f88166650d138114df61077f72ae50775fd79445b2ca2db53d1163ddfb1544d1e77301b4f7eace3def24ae0b71ee9bd5f7dbfd5737df4d9ec5dfedf9dce2c431d6a1bd7c520fd0a4cfcd3feac5cdd7dfab73f1e924c92e86b3d924667b13d37acc459e6aa76dc535a2c84a361eb26e8a25d09b92274dee590db4d4ad66a88ead2b48760f73cc2e56708d6cfbf5d2d9fb39c0f929cab135751a9235a99f163bc934862d8b0e33eaf3891d5f2b5f0f34765f11685eafd4a64ae7ed4c219c59ce4d04a7cd7fb9dc1dd22a2574d0987a3590c8f5998d53f42b133fb3dd08fbd381d2886bbaf6a7acaf147a2c22c40a899681df2e7f23526be19973c6779c90df0a5d9acb96ad95ef71539a0d16b2e0e63b7a62fecf2e846fd53bc9b97e38e58cc62d5aaa93b49973720bbc4f263db0af7177d51f348a288c9b0b850932501bf9128a5b6fc27ef6bf840335678879d54788d6d842bf4462af33d4b2a841d568b7583cbea3e606537f1ab986302e5a7e096d804269afa5c5374070d26dc186721f1d1b0e41126306b9bfb9cec527b929451bb873c1a23b1fe72175076608c922ac2ee1fb9d0b9ea2d7c27c56dbec4ef96a50a424d6fe726b483a647e7627b1c890e264b8894567453b91f5dd3cfd05426b91864d1dfec8f8113b640d3537168f6d4d9d9c78aa73bd8c8ca6399c4b349bb3f3b7ef3c0d2fee1ac8f67165f9b680e1a313b72fb5925332839fb8c0df5795a85bdfd7202f85eed640dddc864e125e936a83b989234d7a32b4544167bc8f70809122c7e5d28a4beaf8cf47207a4aaf5696d9373bdb568cc0e409f82561621bb78c79f4c40e99ba0e4300b2f5b5072b3ba540555a3dd5dad5ea14b841956c7d7ff579cffe64697e59b5bd02b46d4c430bada2b00eb82c195bcd3433b478c41630928645edf300e00ab314d4bdf0a4bff2f760b6e46b76ce2998be04e48628d4fcc422d3d9e8af0d01711d527167cc166d38cc735501af25e3af4b8c230064019663418a8bdc255a60016ed0c636d681902fec1da3ca8c8a0d023c61b90e2c9c65c43ab87ac8b2fe927ec593a8032c556cb2361ecbbffbddd14645432ff684619b40caa79499f08d856ff2c9406f561b1f1673d556bac18d1e9ebb9611bcb8869c3a53e3f302c1a7bcdd2afecd45e27b127b00ab7955d890f363758f94aed5b3aa943e50f4ee5af4dd38e144dedd10ede1c948813374337e5895cb5a2136cdcde62ab2ae2f1785df9838cc2f0758429e2adeabe48e6e772a9cb974522f1f22611a6c0211818a6f894642fe2788df8ebcd1d3861657d7ee99d3283f1adcdc1e9ee5868c75820719bd2630e199554771e00e211d5fcf1534c235266f6e1b4df659031c6b2725dbabb53c2751406e131456b69a29b877b8e90600065298975da6778687cafb9e8c5577ef615b6ac8fd9c8caea6491caed0ef64672133b4742bcd3ee1a75058c78a251f0ee209b675e45faa7bca55d6d8ef77f8f4ae572a83697e80610c69253e51a2f32c48175321f0c273a421cbde39f6f0d8abc1f3afb8a1ce7d027f7d28b5126b926ff4042a7ff3bc704e8baa1e66100c23432fd01cb7a74188810e06fcacd57f7060e56a8d9daf7fc1caf598bbe9b34895e4a568891788edd7d2c45ebf8f803585835383491dcc4d31874f2b6f2cca17b404693f6e8d66573f6ba4f9f509f7f161f4352776be203fcdf89657e7081a47f47d0507ac678d086c2cfb371d88006ea8ec03ecda080b47a0c1400eb443387e00b199361ace20811cc035bcb9da7fff344ecbb40c7e57ccecb0d7d416cbaf6a64c2687b9caee312b4de774d003131c6ae2501da2898d89e6ff63a964c46ec76d5bfdaf2a328dd476b559157475d1e11bb98843b7c8e7466d4bdfe9f13b8f552769e026ea0449467d7431f4cdace783c58b02a9f78aa9901aafbce52446899ad1fce45ddce7e1cfa8170e936f4816a7a26165faecbeab783241a96dfc8a44caf1951ef4e9f235ad28ac49fd2343cfe9d22c279e5588346054598d9cea8715ed5ca4b2b2d9291769495b71f16277e8e8f7da40b96825332461d6e4310e99ac6f61915e528731d24807fabddfa26e55ecc95a09b159d446f334d5290cbf94483b0cd9ab7bec318ca299733bad545bc2f04d82fb7039d898c5a4c81c39971fae1eb4c3f01c2f9646482774fbf74bde502cb0d32fb222ada02bdf9b3d9d0ab3c8d1c9360e27c40871f71304ee38e81a85f56e2900d4823fb068e7c1c7e711720217c734428257297f1b9949841606dc81b661a752a9bd24d351028dfc68aab4611f67fc0173c60b17276120d2e85b23d0323ad33f06c748eed4e42b93d20242223739da71358003b93db6170644a0f89c4f655092a015223ab80e986179a29e10552e7c2befee93c81113cd2332c036302ea76e2475bdb46226c5b065dcc6cfebebed9d02ec69530f2d03ae4fe8fb1c7e7b25e1e4f943597a54e778a8791c52e08e2f5b0f569c6fd72b339feb7a68561e1033506cc5dee577734958c4c32a6014e4558cbc9a8c000e638428e9b85e434f2c24ac5aee3fddafacb7bcb6089f11ad947740b46a1d5da4149c6fb95d51d66c5b2625dc4401809499e35158d3fb7309fbd81cfd714c6263d16869ff0bf94f31d901fcdb72c557fa59cab5521e0e54ac01ff9abd042fed5169190ba5272a7122ae478a895016fdcec5e154bf96b9568cbc603811036455edee1d3106e63c2fa8ae160b6b9dacfd497e72122fb1a2f2ecf2261a642e9f33c9bcdd0f3e9f6c02ae2293c6e5246ea33e40beb902425c1fb9deba7f1c260277994e249e0e18df62380ffff12566fc6c52700cfccca6ea958f2e87147bbbd0d2f9ef9f15aa2db9e17a9e09ba20fc641713a4e2a67fedf2548ca517e8927dcf23d1e4255f0fd8a52cd4865119d27099720fa1f602d6eae61d3a8ce415a3b7453315c8cd5e941c35b4cbef1c834164f31190f4598cdcd51279a769196043af39b2c5fdb576c5ba2bba1e3bd46598f7eeb496b681d79ddbe44758ee5f10cbcdb66a5727a1b10702f9f005b207edecb911009174d284b21223de80bfa373917edc9ff1bac6249678ba4b1b61f566f9692baa019810a023695d8dac1f17920aa38ab5d00e7d2ec0f48787c479ec69a23a8d24f135d11d9bef38a671bbdcdc2109246ab8d9e313466f3d22f5458958458d4ea4b7a4e972202bdca17494a318ddd7ff2c9be56e24769caac624d2d16ae333790cbbdc524fe113b69323bfb5babb9e744ad8ab1a3f10c1b779d82f7435a0186010fda4b317ba4eb2219feee46f3ce93f053116c39e103838e3a0a2c776489dee5222bd6d52ce9030c39221b0d0193f02b138548e675f380e4995b696ad0a75d66c6077710bf8e033cfc6a3ced7e184f9a2f3d25ec27fcaf48815bd1572f4a7c558233c1877e701ed39aec62197d9e9144c4fabefff0b1886f5cefab05e262a501e60f748a24b99079bb765b22e54390e3a77313a3b854a49a9abcd470d5f2c451843c26ee939a1ccf91b10ed242ac30481c4ea518f5c4d758afbf4f983a5d9c9bd442c64f99af831c38614bbdd3dc75b8e51494faac235c1c1e83299013f59a817804258aff279fbcec5a344c795cae564c97b9bebd8bdb6231d82a396d5bfc589687f7717afde5c466500b2079c4c621e0b705d28595c3fc567f333c2492e742a3e0e19af72d4e9d643d1529879fbef63966923ec795025c8a8536a97af6916985a254bcb2c63559afe8865a0cbb2e59c84a630510a6094afba406f3f84a64aaf3727e75ecc52f564d4138f6577336c8697149c550d632881a0e1bd4a5a18120cf134cfbbae05b8e8e3e786c20ef396929a96efda1a86ea1c03adc3e3ce6a081c6a2ca492c3e3b7fa79cf97f036cf7303157d22bf5f954527105620231d05087a31557f205dfbdb01a86e4366707dd2a04bb8827d971dc4d311f559e522d13f02774474a2f6ae24f71e26168d74ed893e1f00774a5fb530b4f2a007bd736a066a1ed231d68018bf6d9c24067707b8d39688f52cf0135c3db627b438c94570e9f74c6c5d4fc7e2e7099c853dc5bf8251eae96b1f7febff55f2e75c28773051a099d5dc2ab94749afb9ec92e0c82b0b328cf05119f7c6aa927aba18e95028e6f7c4183ac48609c7e6adc34427655f318b0a48b231990093b46a2a9dcd5779d54fb93c86b98a37f3903184f8f098d58e27bcc82c266325a74f6fd4b2c80d69fa9b1d8db3913ec367c136344e220f33214648755e1f0c01791c9313de9aae345d79e7a1ca94d36c4fe5da0cee941119ca109d30b8869fa1e89d991a1501a02606985540535b4c5828b96db9b70299644c13c01e90ca778c669d9a5f6d9602af34544b59455b4fd865fc14cda6cac44fb34eab60ebc836d460ad0384354663724cb225f75559a342a08c4f41f35327394cf03ee98675f1506236af10cd3852f276df1184f0127d6d02b386f698d7a0f7dbbc7f0e97fbf39be348542ccd5de06d05a94621061869099a1dfc3277ae6a73b2b8db47720ff618a88e5ae297691b37313888e111a4274e83ec619129e7de00b94ea43d20eee875cedf6e462f95a63ce8a6d412ec759449914d1449b2ac8cc03ecc6e4a5d94cad3459a3eefbab21d6f6bde9a28bf1f3dfaeee3737b6d15c7a4a6cbe12f3f6eb96c5ea71cf21b231d1a3e9c42caf80ebb8ebe6d9b5212025d7dc9871af9b7a60324ebce04fc87f5681d3616a34f1d2c2860f5a7ae9b55c3bbe6cee5fe27d2be2683fdeb5a815c48322502c7b9d258d9c779168ab52dddea0d03981cf83d7c0db2fc6a46b7642769b75b8d56b1b9214bd60270f42b2235435883c9385b3b768574f6530563dfd29eb87efe644a856bef7b52e8767496904c8b8278b7b552c032324cacf6f6fcd84faba7b3c22af3be38217ea28b7fab4d52bcc5ba4dcd0582e308297f86c9e464dc9c92b35e8d145bb74a9fe517d9173376d726b9ab0ad0d99777c637b57bf548e392f872f2ee40b66420bdb1bc1c0d4a3c76c6ea3ab57559321761d82370155b85caad195131249c04262ef298fc97da584a0fc26dcb1e2031084fc3f4fffb1018ed3faf7c592d5c351811beee1b24ed97b04d6e444f8706e1f7b3b69f27870c612d07b67575dcc252e0bf6cd423f73668377126c68e5813aa6745bf395dbd12385a22b1413fd2860f7c369244d3d28584e299d04c2058fdb18ede646b119917249098d7d4c63e3f6de32f41e13a863d2a53f23343c0b060fcf42ffb508cb428d2e565aefabf6dec01ab71c24376055bd16e0e7454d3248a334f91a4aee383328dbb631c6000291d6e877fc9cebb5b6552524ff4c9f201b5bc1fd5164803c556dcbe959072cfd5d3b88eea5ed52403f02ce3dc74a515b97eec837ec554bd6c97c5d1335ae4f6d642f41ec6d3422527e9b3cf3be84efa2a3d38fa6984c42b5f6d24ef03a949122f5b1290365bd1230e069ee36f709dac118e6b7a5004dd5db361f1a7a2bfe78a4f8ba811933d63563f5c8df73e6c3c48a5e1287cbbc188bbd47d2ba1695b0802c8cc031ac3f83950a90ed588da9e990b326b164afbcaac7529216da24c3ba4316a83e458c770ff4f079551790b071a21d4ab350d4f923e1fcb839a2521a826a5dfc3b64477fec80f23fd51f4a1d7971ff15a33f75801c34e0be39d8a98b137fd23b3452f14cc7d5f6be553dc54d64d76c7f9ced2705cad7da1fd94b5c796686e0639c1b19bde9b311b32074e74b21be3a3ad7867084098443a3e58d7a4a3b880b71279cbd94277f7a9d428c6e4f08864670b38072335c4f791d740d9cde75930db7cf9e83890fdf1e699f82ac29e0fdccbe84e5499d13bbe28d3a1c404cd657dd5dc9b9ee452de52de7ae24bd2481c8e661c6518d173c29963be38f3b16689f19de82682f303775d6bb947b8009ba6515f7e0cf40e543eaaa0fbe68995e79ab3c9db4301c9cfe0ca2ceef9b1f38f5420d669fe7befdc7498de4edee9211b2ad249464a6c1463788bd04529ca5fcc43824509afc827c9edb2415c0c462df74c6f29554a3f0a06fe9f629bdcc794b73d6bdccf3cac4f81887c6716a4d0ad185fa53966d665dbd90335176a77319c2f54366e9848db4889f2a9d3952ccd3ede7d8ff1a1ee565c97856cc773362eb44db832cd49707701ea2dbe5ad49afbec62ca0acb58f734681a508e6d137ccec93ef87e1e5e681ac7c48f3df43fa38e160660740f6f8451611615150e6c8f3782696522ba63801879f47a50b6122a2d33ba065ec415f281e4a54f96b6b77532a3731c7f3191e236793bd5ac92d1063c3cc12e5cc03f500b7ebebf26accdb6dcf3445156f37a84bf31ddfb8ddbc26fe5b35cff4a68e86a30ff0e8f7671991e3c328d0cf58df2a72116a7f3b43786cc13efcc5e327219da2a1c3d0326e75613c113a91a93f10ef7a5500fabda123d7bcd0817643de410239ac9ecf66cccbb6366326c6a7c0d47a6803210d03181c7b42134ff12cfde410144c979b5b4328b801e3982810f3c1cf120d408e8e98984081f477e9cbb71c73826a4a16c54f40228225b563171f5611f26f09084ff9c15db3f0538ee21871ebad389bc89b565b88a56e055143743be9456c562a2aa29b73912246f074ea8ef1ee8edda8ae981dc339452226ce1392ac360cec822a9de1923e7e781f985e7b78c4b7cd4c051ddc597830f40c075bfa62d8bf428b04b85e8e00c0f2e0f3ff616b438f1659240358ffb503e692376acec514ef035f2a1959eda4c0718240dd4e0bf921fe339e5fd687f5c5db0f1bc8249505ec04020becaffad52540d31861fb9090711d9a780e7c8c2b01ccfc4a8d3d6113e1303579d9a070d59e48e1651360d7ce329da244c4f0b7c074f95dd6477691df7cdfd41cc455a347dca1340e468d754e7cc126d74bcb742b5ad4431b22c4aff589a84fea1e3580d7ddacbf60110bf76ac0d66d4b7b420a213bfda597a13a1857aa37764098c2b335d656d1c892b7e9745265eb787ddb62ca90e494b621c5b2af83979a06aeddf7e4a14d86660166947e061551637dc17589fd8a157750498755a088b971e023307de47d679cd19e643a023baaeb1c74c87dd98044a5e0fa5f5feb2296fdad0bf8a0fb863029e21af808beda17b48b6dcbb512e38df7cc24003218e59948ee932ae6d4dfb6365eb038b9d711eb2d21e6d70aae1790b55b57b2b6e11f7b1018eb44b7daacb990dd72b216942d53349d52a767c5f5096ae22b0d01da27a069b918911aa33cc8de5d1c1ca22415f1b41be1699f04bd011ba5b8ca2f0da8d37da8ec6504d4eb2099830b3691a7a7566c8f8d1ef7864edfe1b8d1cfe688e2d3f0d0eab756fb1f4e042edaf14a4baa4d2274e56082bc723c08c11d8b590b22db0503a6f19c9e787a48b987f5ec552bb3bc4984afc3940ba9c3806c4b43a10eb4115a51e2b37d746eeb15730ae67c58771ed4d81e67b699a5f3508bc56acd4a4f307403372a77fee33dd22765ec1af322a7b7576261e50647189203eaafb5a0fbfe21e9d63badadedcd7ed764dd090d437a9e829ca82c0894c5d0854da1cbdb14a27ef0f904ee9213dba54876211729d3cd65cc8f893d503144ebb91e580f21bb4892909093cdfc1ef782644f5b0980658d10d359e3c33c7e0d783db453fe0e375f3ebbfcd87ff93dbd7b260928263e311de15cc01c12272b3da080c6fa68e67984a4dd1d2ee4026ed64aa96a98432d3497532d1a9e1e6a9ba775b848fa4478bf067616a28f298a2fecffb5d844a50e8c1b4b3e44571fb5ede556942e4ddb4e3ba8aec7f6eeef8f0b5b15d9728de9f9ce2b61079d8e0ed194cf5bd17ffb4d67193a18b72366a893cd679df0740bf7d869a7ab9a6c388bd5aeac698cda771cd31b28db331a8bf55f805e1bb04710ca741f5e69e5f052a8710a39a2abd667d91c618630f909e64ee256a747664d9c5de47d3ab486976111547fa89b44317feb0aa29e486f2f6f5e0ba3733f16296d916401eae3777f9d61f7455ee8d6e044e78e89328bc9013ba69eadcaa1a3a1d50a09bef62ea48224ffcbeed68be77994bfdad64d2cf48ea964737a5e5287803baeab2e98d953e3a30a5a3ed88ad637e9120da704b0463c70458b04d8543363fac205e8ab829ad18ee6160fba55c0d2ef4bc3487c1ff02eb8d1ec34a290bad8451d819edfae97c2f79db5f5346f9fb07b7cf3796a5ca0ab5fea514f3b3ea3ed8c69d6141a446fce13d05cebb76492267e67bb3a455c853c8ff0f7cc0309b493b1b0248c82da054aa932d48a42f01f12b3fdb156acc5d5aafbc86642245b17717e33c703b4747408e89b5d1188780350d707649ff5e39736ad194dd4037b167e610fe3629dc00530046a6e38ee3459e7873204d204e1f07d69f24a5a56599121e72ca31ad42fcca54cd3b36d0dbf7fbb40376ae4cb0d1a0f05805848d4f2769b65c08dac581b4453c46ae1fba5f3dd1050f987d5358037e8a66cbcfdbae4aee943f24c527fc460ea3cfbad71cb6ca62a90dc8455add096ecf8f22b22c456e4d75c0ae09aeb1d0852afd47ff7646437e652236fcbd2aa7a82002e55d2cefd4a4e9e5cfeee368265c30f2bbd276b4b6d8898f6bbc6174ff1aec3d75b804ef55d4d07bd8469bd90fc38fb3888a304ccc719859f4ec5cc4ab1e2bc1bac9ca8a25d8f101ee83c24a7d89beb3fd6853269f81953089957f9747c37dbbcb2d09b36ab90e485f518a0e090d9ec7352b0c5bad62e2ee7dc07311f5741d9b7e1568be02d6070eb50e3b312a6a13ac2d4bb187b111d68ba576023f087b9cccafd740842d3ece9b720872acf97716dad1bab40c8e25168ff2de5facbb12c1f9dd8ab7bcddeb32d6e35ff6097382d013da52ac25416c2ed6e45362ab19d3e0503f8cdf1e74b5e9ce8130bd9adb237dd8bb89173c0e7ce675f85d630c3e0fea6667ef9d417295ed6a063d6390cf4622b0fb90969e41c9a1cd5ddcd0d319d694574712d1f047a920a98789e7d92ff7ea414c17504ffac410e826077576e8340f480901f1c091dfa8b0598c9b766cc5d44379a9bddff292f7d7af8c947e252464c3a7fc0a9aacb397be2e9570dc284d4140f4e4ca1ef5a97923410eed269eb96fcc820808aca4fcfffbae0315b03d6ba47c704241ca33b37b06b5ce6d6f21000f99d478ce4717db13a891abca13d97793f045488ba4ab6bbac17413f02aec572849d001eb2273b9b682be8b5066617daf5fe62acf597f7c3941cab9c5354c3aee9498abb69856868c885786bb08a61695fcfeac13bdc5c5cbbc9672368569a5a05014191bcd3e1dde244ecc222b43d99440a81e5e03cd4ee9f0b250f3654a3ab7900e8fa2f2c397d343a141808a108b78b33cd5dd045b0bb3468900f6f592f8e3564e16c5cc1b383ce5a03baef0db0192a3da161711917eeceefb28b5316f82b9e24eec167c5ff99cd099ac8aa004631f5cd71f26a8d51d330046bf3a58dcf4e5a3aded6355d82720704c6f6c3f2df37b975364f2c1ebfdcc8f54c6ed136fc726c16eed6cf349cec2d3ba6307408ebc3b0627c7543e449292d06dc102ccd7a02790bdc94d2fb067818be6ec75179089c1cd9ccd1dae2ebb07438f45a383027ed2e7a5f85f64da17a88c053c1a9618bcb7824f400999f738330f8b88202e93627a21fc3c57ce33ad5dd02dd4e4945ab49183ba92dacae7505b96b9ac05124b98fa09a64747123de59984c8f0a7365ccdc33bc929c6c21d6cffd9d877e8ff2b189b581ae47c2f363b609c3c4633922608e93b14fc40f3948ab1666427e4551acd8241e54bd14c6a2de8d735f3506fe248190223d9fbace973bb1b2662d53749b20cfae1e4e9f4b7bf43ec0abdf21f28115fc8373276815ceb5f008d5b1b48958cb1bccba33fc9cd76089b0d53092cc1d8bc7c14182c09a9a5788da5284682c4265a282957255834f80aeb1f13b8150812f30e3019fb6c3cc2580cbdce367c942452d2c9f54207d8909b6ed686367a3e41911690e90740d871a2e1ffe921f532eb85ed8959717c3d5e3d58cf0d294a2d861cebd20711b6a040e93a9cfe35d350a3949be039686ad5040cb62bf7811bdfe9e1cc0653da4cde0c227c85a46c4f0c9b14d059c83a8f841e217f5b26acbfbb11e306a920d78effd6d6dcce471ccd294958e7707229d7a76596708f54210b27cc1c78db9fa052b2abb1d2442cb1263fac68e6fa13d1ef00438144768e688e00aae023cb17e6137c69a1781d671065db3eaa0a2a6591dcaaefa50d9eef8ec58cc241b3fa437dd034d00305697634627b91584bec219de4286ae4d6f0d6cbe3c229584908f1bf4badb4f324aa221a242fa6ddc99a65813351e1aebc919f85a534f817b002a9997cad1967db2477a2f098bc84a28e28dddabc28a8d62677aa3bca91a193d831a92906576628f961471743e09c1720f3076bcec12fca363be1f68ea76a03a0116bb105574202c512f2fa49f82e58f1075991c5b1394993ac0da0a11dd17a7c124cf4e9d269e8de84084df893e3081329de362bc81044f1e458761190cfe95938fb6c6f65ed8e732feace42a1df80bf19598cbf422a436764bfff85cf62b4399b02cb05ea14eaaff1e133ee5e5b899cf574484e8d991c12b9d1efef857ddf01df261c52b6d9d0fa5a108b16c54f844efd230ee13e9a3caa6de3b564c5b7b57aaa18093151bf458b6ba1971c2cff5578b4937e57af71d96440dffc0e2ed16e3a7b9ab3b58d6d36b66ae13e1b6d67d832f19246254fb523604c71d233c9a0ae48385c8d9b54fd36fd7d134b944abe1eed845f33ed7ea517a715660f048eaefe2c7fa722e895180ff98437a1f6837fd6f90650eed80aee5da1a348bc1844bf12a367ab5a77df28d66c4ba8ab877c00eb275ae7486823c50115da7be4734c474390b661bd322219e16405f63b907a6df0804e5d19a747074f06d9b142c6fd00d32bff2419251e2f67e037438f5e519b041917cc3b5efb896c7853fc0f139c64ca4cda1adc7ef75550688c225f02a5c7130c1fcd7f332b0fdd87b92ead46a113a23116be506ff713fcc3d06cc2a9d2041fae901d5fbc0aac47d06782b793e60294588ac418436ecf558782f5d0ed77f6a73ace70f820b2af4ac831be3ee6d2155680d198cbcd6a3ed7199828082c73b659be843b6ba48812d5de9b6af99efb93108979cf40f1ca85e603180ab0eb115c023f87760002bdfc4a46783830149456b52b978e51bc09d1d9b19f8004093b8d84ba4b39d954fd6a96827021dc10e8ed305afd137ecee3c1947f4baafad475100a2dbfaf001aff253b7bf698a44b5a2feb9cac442632a7edbbb5fe95281c3a601f0fe88db02688dadf50c4d0000416b248f7ffc452bf239483aa52034e1d8e617e9931d3017835e3255ce211a91550229583863182d6fc696c244c8fa3c016ba7e792b3a2517d487f3d09b58edb9f7bd6fc733fdeca3673909215790aff127b8e4bd5a6e855f6ebb2dfe0529e67f1fb1eda6caeeb0d06073ebe23251eaae72a3297ff37f2e7b3d9d73f712ad44d9d86c5b1eed184fa32a7ec8604a697647b9e94d19b690ce1176f8e8649487f9c7fac0c4242b9e452f53c42997457166a0e6a4658d2fd3851ad3707e6c2ee175f6dcf57b982d08793812634de06b3cf9e8d740376560f34cfbffa30158a1b97ab7d0e6de4e7a2b4fd1df114688cc242bb77d9999ce60eecd827431a2dbecdbcdf938bce36703826712d59d85d05726e92eaa85eeec998147b97d498e36911c817da3a28160ca5e5124d24e8df4bc0de26a8bdd0ea7b97d750187d3644abeff99c1c9fd2cdc2515335335f70e4f726ee325d10a9f5f99cf970f106cc808d0733fa12c36b0e0a072e26d7a40102564036cf91dcb3fd78875df200a7ecd4a71c5dfd440c31cb17620912088a1215706ec1b3624d768c3035b3fc9635c473d687c5520f177bca7af674439b6168a54b0fd06d8dcf0bfcaf82312a3f0bb986583354cf9823a256cca34d7d4d38732bc6db331999e4e64fe606cdedba16ed8d6bd0f7426849f4c4b32742a2906b6577e5808670acfb2cee5b95cf1f7f6d8ce31e008419c83f1b924fcd674bd12499fb0a74cf43d7ae2adba3c114ed181f064f87837bdc8666b072c6345f889514041592f12995b38f1a04fea8c02bac7c966947ec04c0940109eb4180c6fcde62769d35f4bccbbf8bc318d38b27ab0939b156c9fe2a23a7dc460bc6edc4a0feaa20c9d0ee9dbb044faffd906aed24ea4bd77ff50b7f83aabb7e0db97052450afee949f4057385fb94f9ac6a492ec74976c4d00c85ff4885c5c8815cba6eb0f55b2c73be03e33d01afc8d70b4ff4b729539f2ed554cf8ac6ca54e4b6a6ce7d1cf67f549d613f7b90dab1e7e47c7a2896971bbfd81bb0217624f2ca05b42cb1f5f9036d08093c470b96af12dee80fb646db8c8d8bf9c2f09172d63e188c9f1645ab0f38b4007949930a9d29c9144315c654fae6b981fc13b8f7827c669f10ebf53903292e076d8b7f66de2980c47b13b0f689c7062f7ba83bc74a27d0489a39fa74e50abbb668f6b28b2036f3cd257b18efa2fcc6daf439ed3f6b70b03c32e25e950a83144a569aad089f123e332e2e55e875c58fa88f29883a1d7f079043473c0e9b6f704185b686303ae06026890ec2a529c973c871e2eb6e3b33acf8b8b7b0f4188cdff97dd459eefa9eed7c2e1bf7a5770a7439b8705c5a55fc0407a95e544a2e427475c36d04f65d2092bc32e7ca714d4cd034bb62d7aba6ffb27f500ccf1a6862552b52b3593f75a1f5378b24974ef0b155e7d704023419d0ecc4a1d68fb5643d6c0460ceb767b1e3259627ceca860c5df2dd58312b959f35aabf93314e7b9b1f7216d917d933655de7151a1a30e74697bc7e1d1cbce87531677cda2c081c6a8d4b3172ea4b7f625c0bc001b545baadebb4713b6e418e3cdc219c3e648a0ff4fdd80fb4ae7197ad6183d7d5ba9b94357b66bc691c5edfd0b5c636048b7b00cd557c5cea66ef351793f792050da4d19ea286916c5eeddfef9443055929738f65c6e60f90962bcd753930a9af0e01bd3d6ee5ab1d778fc3393b22cd256f6e69e4ed84b660c1e96e02ee4af435c2cefda060237b073ae3523dafa4dee215f73819e6207bc69647ab0b8f4198ae78d73a127feb8dd1f6c4032eb000d5c386e7e982afeeb331a40cfe97a8187a72e4e40929bd0b22dc3faa5f26c3b31232c93ec7d10d1d0b826176aaa2d3aee477c323cc999643091b8c29e714d434d68fc249b2b96ab7301e65355fe161758ac7543efaf98a4253a9e2704ea0c7a4e2bf380338065b57a849a7b1fbc9c2deacb8bb04321b6eef4f2fe53d7783a3e3602af995d0d1ba6da410cd53a0cfb0c36c1e45c1543b0e0f98baf5e18d703017c594b727ce884ad9a322bbe847fee2e6e4d44c7b58adb3633b1fdafd76aca77c5f1c420fe644153b05486ea86e4e8fb1618a1abfaba375a6432d79e514ebbb5aa6d7c7f725703b574be3ac79d580d7f55363e39a78a17c79434d9c11b2bbfeb35c736120bec4fbdca90e33fd6bcde7a8926e4eefdbd5141bc3190c5c1e64a6411f26e1d27bc6010d1aac5562649c0afb694fe5de07fa730c6012402d588de9a953aa3d34505d2a85243233a00fe14af23e3359d57136c1a14e5231a791a98d6d93bfc576e8319904a22f21557f47d038050a734cf41722576ca3ccb75a65013faec7a61cec081628b4940df879a6850a13089d74cf2502e64c7fc3c37d4d4f6b480cb9cb9e04b9ba72d2f9a5fd5f0dcfdf139c294b7c0972d5e6b25faddaec2dd8fdbff6f5cf614111095daba47127aa92744013c41991d237294ea19c16291d5bd5a5229047a97e0eb56e9b77987173d67b1e81212630284c78473a76e6bd48946e8564141f42ebc1a68f9c5a392ef07bfaf484576a5dee5e045a38fcc8e59bf5a14164a02c76007897d859544c3f770570cc2b71d4a400d3439102b2b1630146a4882c8d9bc042b5764c32ab84c533545c04bf65d16562ee839909c2736cf9b0ddddd0eb2acbe0878ecbccff6f1abf74e30b162a3b8ef09a7d8f92ae2da316668cbeb4b9df6a191969e363304041531d52168c5f3d01bb51963a047516342ff7b59ee4be1b472a725449d7d9bc8875b043b51439bcb1fa8c014ad729ff66a4a9eb7202cde466ea061274f71ebeeb38865bdafc08e762a0323a3ff370544458582edb9e95143ca3d4895778baefb82abe84bf1c4abd3910c77c52f761cf3d5fc1b7d972f96251c0f8e7d7443711c14ee3066d84747d5e3ba7721e655660daa1eda5d86111236793ae51f1ef7798bdbca8cb766e30f667e1b08b0d4d36acc299f721defe30cd31448189250d84aa0a156cfd54b69a0978a3fc53875c151622b4db1bd84641653bceb3ffbd7000cc36e4e69b610b25f4cc78dc4b099dee7f395ab7563f73da8b362d59ce72fca5276d0ddf9d2f70b242f56fa0e4597e8461a60024f003f59c92790ea45e3793373221410b126d9d0793ee813830868028f3d0430a4133f730db47e70fbd1acad9542899ca6f87dbc206d21e8d35248a711f81059837dd22080e9ac7984782d755071067957f9f68e054302b2c77fadf774dea150a97672d443e551aead2ee6032fe250c09b2650f3a009025ad6656414c722286f5ec1ef87b6998751fff1ccc8c96d363cf930e6b7b36daa70974bbb3fdd520aa2dda234162232e17c081667aad218196c5841a04e899e9997d99451c74fbd8152591179c1ffed8715f0bcb7dc9f4d9504c29a25026425554472a2cf7903037841f6025a0763850989522705f9c58537f96ede8dd8e42c8c370c855ec3a4a70345dd267f3207918e9d938dff8d1a92fa365317f0e2c92c07c153ffec302fe15a5778beb488626f5f8cb8114fab8909b630ff37e051c7f1b395c5997f29b7ca6e415260d76b0498a4acb57ee815c32856060ad397b9abef8556286b6148b81a7663252497ec118cb93ccdab6c3891f822ed1acdaf2f13dcab19a136620bacb5666d9c72ee1647dff182974422e359a39c0e116363ad98613a35ad13f05f68dd162be9b1c8ecfc7dcf97fac8251ae20ec55887b6dfb0c90084e2339cf8f316ba7aca93c21ea653d3cfc2ccff86f2bd5eadc8246daa2f44fcf686595bb937e45876aa3c628148700fa79fd41877e49055d1ac55749af34f0848bcadfcd38f595c39f3a3ea6cfb2f4a23de629e7ef6c78ee7342e742b8d8a8da0761e302840ac309ab21233faf8df39c6fabce801a8899da76a5265b56a9923d2702b49eac5dd0d84277f447d58095779340c7253194ed4f6455aa3d24674f22d6b6fd1f1390bc90c0425752fd4c2e2903182008dcec91b0055309d73451c1dfb65103139401ecfee5da8fda04ec7c1d0bdb1657f0b13853f76743884bd656e29c13a5c33bc4dbc7e3b4ee701866c5d4994dfb512d22ea1babec2cea2f50e3e087c03f4ab7b0564182b1a5582df4b3a842aceaa13fd6baa903c943724b1607233bca7acc7506a0e657e0e4be72913900d34b30b4565df602ce4b2f3a3d5ebd2506904b36c58e14f7233cbd232a1344dcfea9258a7f5ef3b88536c1b983987cde153f6276f2475a547d8537a55a6d4bf8ff825ae145616e9a535ea1fc933982bc5cc36fe4c63f632b1a9525f1a3d98e6847530369946fd6158c9e9c1027d5fd0c58cfc6ed7982821c5dbb0495d06fc34d47dafc26e6371870b5da5733625f001d91a1cb7c10287a2f0c31b23ce903b5b6dc0d33beceb022a93e3037fea35456fc097834ad0c773bc83799decd13b0f0e84c726a5212956dbe763036eb28d78de482ca15771f68fc236713f33d32e9a8f3ff05ab529388a1a74a964c40d64077c930b96798b9268cb18aaac2af3b35f06a358e0905e89b4db2c3957fd8258e55fef53e79023619ade48df5959af5fd61b4c959af333bd67db276b6a00f06e3954c3c150b3a325a6410b197b9d523d5be68b23423d09dcde162d617ae48d94f9c05e8f953a85caec243605f7b40c1c4bb93e1131ab1bc4afdc818fcff86b9623c7a776224d41bbbdfa4933df7f1f08d951946f38c7644d4dca11af6bc07fa0b28865d2b871392b239e7af83493992dca4acb944ce4fb06f3ce55e8913b161fe6f8e385a470b2d047d6603dd4be359bbc22e70484acab08d555c7987e9916e9ff3706503d2fa185b8dff0de0260cc83f9a2646838960efff6a641193baabc0e4aa7c077bdf400d358214e7746a26a6333913af2034cfd4492e99e730cb9f9bd5397c6c979527d5da23972a4c3ab63d5e0a6061a189a4ad063823c479aefd6606e3a6aa85fe63239c0ac218d11331a318aac2b0dab51340aaa918aae2c2cbbf2ad7370a5dfe68fee0e1906f88f1e46a675ee97595a814d88898befa66a2e4a1d396ca04fb7b3fd02b73684a32cf54d1b307f1b734d7cd332fe502dcb70613570ad40125165d5fb3b93539dcb0afe35f7b0fc71c1e667f97b39269c29a642895bebf73973404133db6dfb4118b5acf09ff0a104ecdb665fdbbbe3871ddfaa8b3c4cbde6307452390e190bbfa5d05682a97f79e92c17f0901bd0ebcf64df094a1f88c3a8be2d79e11a20e8651ea03a5eb3be410d437dc0aa485dc97af4ca6d727a38886a8eeca4e5a169edb6220e180275915038a4770f365397c6aefbf23be87a1f5e5d78a2934d4a23a5841e76a3c5170f80ac22e5fd8f7efaed88cf868949212a2af676167aa6a99d6c734c3f18e1dfca03c981fe1961f445f05e4c5f2e473fdca79c6e3fe36e6766a95e9b632bd0872aa21e20a85da5e77723b0e0d6e4ce1e0567129a98035ca5acf526afcb93e4a66a75a548fa4eeef620cdac0a523512a31a36dd0c617a09580b57b341928ff2383e3dcb63953dcfa57f59a3a76910d736e2ef16ab0c435ad3ba87f1edb81e8555b01c51ea085d86521938506ff74db779f5928cdd04eff26df8249f4febc0a6fdd6380d3413e80c46910ce0e3d824a963a5f8aabcda54000f8761c596abc9ce90626283dfe0de5755c9388fe906c84e494cc1bca214cc7749367ea23298d0ebf7ff46a77362053fe96ff401510d62409102f62648aefeb6bf271dd67d0b48b3ff7aeead09e783a3bcbf3513905fc1135c538a592022b6261172fbe8f1caae53d50b7c7fb424c3f7b3561de462245d4b22199f010ee215bab88842cd3deeec983e1a54f0ccd1c522557635a325ee4bc5c0533fcb215d957966959d11e9efbc51261bd79721d497cac16f28574726b7f4c2c811782872d9183ba053f5d14a48038483210b9e6357500a5b3b21dc430d235a6d2b33a56882543223b1b379679d972e69eaac92beb3d0988c4e13868a16c4f9eb854af9554636688732702083da109ee938f439283f3c8be5b0276d823608046e7ac0982cfb2abe2b64be2dec6ec9d73ae4b4c914cd956f1792d079f06525d1affa</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      暂不公开
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="主席树" scheme="https://tth37.cn/tags/%E4%B8%BB%E5%B8%AD%E6%A0%91/"/>
    
      <category term="dfs序" scheme="https://tth37.cn/tags/dfs%E5%BA%8F/"/>
    
      <category term="最近公共祖先" scheme="https://tth37.cn/tags/%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88/"/>
    
      <category term="栈" scheme="https://tth37.cn/tags/%E6%A0%88/"/>
    
  </entry>
  
  <entry>
    <title>题解-LibreOJ-6033「雅礼集训 2017 Day2」棋盘游戏</title>
    <link href="https://tth37.cn/2019/10/25/solution-loj-6033/"/>
    <id>https://tth37.cn/2019/10/25/solution-loj-6033/</id>
    <published>2019-10-24T16:26:37.000Z</published>
    <updated>2019-11-24T15:50:27.702Z</updated>
    
    <content type="html"><![CDATA[<div class="note info"><p><a href="https://loj.ac/problem/6033" target="_blank" rel="noopener">题目链接(LibreOJ)</a></p></div><blockquote><p>弱弱的征集题目概括</p></blockquote><a id="more"></a><p>二分图博弈。首先是个人都能看出来将棋盘黑白染色、建二分图。</p><p>假设二分图存在完美匹配，则无论起点在哪，Bob 必胜。显然 Bob 可以一直沿匹配边走，Alice 只能走非匹配边直到无路可走。</p><p>假设二分图不存在完美匹配，则如果起点为<strong>二分图最大匹配的必配点</strong>，则 Bob 必胜；反之 Alice 必胜。</p><p><div class="note danger"><p> 证明？</p></div></p><p>如何求解某个点是否为二分图最大匹配的必配点？</p><p>考虑找到二分图上所有<strong>非必配点</strong>。先求解出一个二分图最大匹配。显然，不在该最大匹配中的点均为非必配点。</p><p>对于该最大匹配中的点，考虑如果能以之为起点、找到以非匹配点为终点的交错轨，则该点为非必配点。</p><p>根据 <a href="https://www.cnblogs.com/zwfymqz/p/10538538.html" target="_blank" rel="noopener">这篇博客</a> 中的思路，可以将不在最大匹配中的点作为起点，找到的所有交错轨上的点均为非必配点。</p><p>将非必配点输出即可。</p><p><div class="note warning"><p> 建图很关键，不要犯傻；否则调都调不出来</p></div></p><p>代码如下：</p><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> nx[] = &#123;<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;;</span><br><span class="line"><span class="hljs-keyword">int</span> ny[] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> N, M;</span><br><span class="line"><span class="hljs-keyword">int</span> a[<span class="hljs-number">105</span>][<span class="hljs-number">105</span>];</span><br><span class="line"><span class="hljs-keyword">int</span> c[<span class="hljs-number">105</span>][<span class="hljs-number">105</span>];</span><br><span class="line"><span class="hljs-keyword">int</span> cnt1, cnt2;</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; G[<span class="hljs-number">20005</span>];</span><br><span class="line"><span class="hljs-keyword">bool</span> vis[<span class="hljs-number">20005</span>];</span><br><span class="line"><span class="hljs-keyword">int</span> m[<span class="hljs-number">20005</span>];</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">bool</span> tag[<span class="hljs-number">20005</span>];</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">vector</span>&lt;pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt; &gt; Out;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (vis[u]) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">    vis[u] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> v = *it;</span><br><span class="line">        <span class="hljs-keyword">if</span> (m[v] == <span class="hljs-number">0</span> || find(m[v])) &#123;</span><br><span class="line">            m[u] = v, m[v] = u;</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (vis[u]) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">    vis[u] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">if</span> (m[u] == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;::iterator it = G[m[u]].begin(); it != G[m[u]].end(); it++) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> v = *it;</span><br><span class="line">        <span class="hljs-keyword">if</span> (dfs(v)) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">cin</span> &gt;&gt; N &gt;&gt; M;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= M; ++j) &#123;</span><br><span class="line">            <span class="hljs-keyword">char</span> ch;</span><br><span class="line">            <span class="hljs-built_in">cin</span> &gt;&gt; ch;</span><br><span class="line">            <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">'#'</span>) <span class="hljs-keyword">continue</span>;</span><br><span class="line">            <span class="hljs-keyword">if</span> ((i + j) &amp; <span class="hljs-number">1</span>) c[i][j] = ++cnt1;</span><br><span class="line">            <span class="hljs-keyword">else</span> c[i][j] = ++cnt2 + <span class="hljs-number">10000</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= M; ++j) &#123;</span><br><span class="line">            <span class="hljs-keyword">if</span> (c[i][j] == <span class="hljs-number">0</span>) <span class="hljs-keyword">continue</span>;</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">4</span>; ++k) &#123;</span><br><span class="line">                <span class="hljs-keyword">int</span> ti = i + nx[k], tj = j + ny[k];</span><br><span class="line">                <span class="hljs-keyword">if</span> (ti &gt;= <span class="hljs-number">1</span> &amp;&amp; ti &lt;= N &amp;&amp; tj &gt;= <span class="hljs-number">1</span> &amp;&amp; tj &lt;= M) &#123;</span><br><span class="line">                    <span class="hljs-keyword">if</span> (c[ti][tj]) G[c[i][j]].push_back(c[ti][tj]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= cnt1; ++i) &#123;</span><br><span class="line">        <span class="hljs-built_in">memset</span>(vis, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(vis));</span><br><span class="line">        find(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= M; ++j) &#123;</span><br><span class="line">            <span class="hljs-keyword">if</span> (c[i][j] == <span class="hljs-number">0</span>) <span class="hljs-keyword">continue</span>;</span><br><span class="line">            <span class="hljs-built_in">memset</span>(vis, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(vis));</span><br><span class="line">            <span class="hljs-keyword">if</span> (dfs(c[i][j])) &#123;</span><br><span class="line">                Out.push_back(make_pair(i, j));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, Out.size());</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; (<span class="hljs-keyword">int</span>)Out.size(); ++i)</span><br><span class="line">        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d %d\n"</span>, Out[i].first, Out[i].second);</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;note info&quot;&gt;&lt;p&gt;
&lt;a href=&quot;https://loj.ac/problem/6033&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;题目链接(LibreOJ)&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;弱弱的征集题目概括&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
    
      <category term="二分图匹配" scheme="https://tth37.cn/tags/%E4%BA%8C%E5%88%86%E5%9B%BE%E5%8C%B9%E9%85%8D/"/>
    
      <category term="博弈论" scheme="https://tth37.cn/tags/%E5%8D%9A%E5%BC%88%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title>题解-LibreOJ-2255炸弹</title>
    <link href="https://tth37.cn/2019/10/22/solution-loj-2255/"/>
    <id>https://tth37.cn/2019/10/22/solution-loj-2255/</id>
    <published>2019-10-22T15:00:21.000Z</published>
    <updated>2019-10-22T15:15:32.984Z</updated>
    
    <content type="html"><![CDATA[<div class="note info"><p><a href="https://www.luogu.org/problem/P5025" target="_blank" rel="noopener">题目链接(Luogu)</a><br><a href="https://loj.ac/problem/2255" target="_blank" rel="noopener">题目链接(LibreOJ)</a></p></div><blockquote><p>在一条直线上有 $n$ 个炸弹，每个炸弹给定其坐标和爆炸半径；求出引爆每个炸弹时，共有多少炸弹被连锁引爆。</p><p>$n\le 500000$</p><p>我感谢我自己</p></blockquote><a id="more"></a><p>很巧妙的建模方法，是作者在学校 yy 出来的。</p><p>考虑朴素做法。将每个炸弹向其能引爆的炸弹连边，求出强连通分量后缩点，在 DAG 上乱搞得到答案。</p><p>然而这种解法的边数在 $n^2$ 级别。考虑优化。</p><p>注意到一个性质：每个炸弹能引爆的所有炸弹必然属于属于一段<strong>连续区间</strong>。</p><p>在原炸弹序列上建一棵<strong>线段树</strong>，线段树上的所有父节点向儿子连边。对于一个节点向一段区间内节点的连边操作，我们可以将这些边连到区间的父节点上（好比线段树的区间操作）。边数被控制在 $n\log n$ 级别。</p><p>缩点并得到 DAG 后，发现不能简单地进行答案统计；因为会产生<strong>重复</strong>的状态转移。</p><p>观察到本题的一个特殊性质：被连锁反应引爆的范围一定仍然是一段<strong>连续区间</strong>。我们只需维护区间的<strong>最小值和最大值</strong>，并以此进行状态转移即可。</p><p><div class="note danger"><p> 是否存在此类问题通解？</p></div></p><p><div class="note danger"><p> 是否存在不用建图的解法？</p></div></p><p><div class="note warning"><p> ge(x) 表示大于等于 x 的最小坐标，le(x) 表示小于等于 x 的最大坐标</p></div></p><p>实现极为简单。代码如下：</p><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> lson(u) node[u].l</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> rson(u) node[u].r</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ge(x) (lower_bound(a + 1, a + N + 1, x) - a)</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> le(x) (upper_bound(a + 1, a + N + 1, x) - a - 1)</span></span><br><span class="line"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> maxn = <span class="hljs-number">1000005</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> mod = <span class="hljs-number">1000000007</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> inf = <span class="hljs-number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Node</span> &#123;</span></span><br><span class="line">    <span class="hljs-keyword">int</span> l, r;</span><br><span class="line">&#125;node[maxn &lt;&lt; <span class="hljs-number">1</span>];</span><br><span class="line"><span class="hljs-keyword">int</span> cnt;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> N, R, ans;</span><br><span class="line">ll a[maxn], r[maxn];</span><br><span class="line"><span class="hljs-keyword">int</span> num[maxn], range[maxn][<span class="hljs-number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; G[maxn], SCC[maxn];</span><br><span class="line"><span class="hljs-keyword">int</span> w[maxn], dfn[maxn], low[maxn], dfn_idx;</span><br><span class="line"><span class="hljs-keyword">int</span> scc[maxn], scc_cnt;</span><br><span class="line"><span class="hljs-keyword">bool</span> ins[maxn];</span><br><span class="line"><span class="hljs-built_in">stack</span>&lt;<span class="hljs-keyword">int</span>&gt; s;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> f[maxn][<span class="hljs-number">2</span>];</span><br><span class="line"><span class="hljs-keyword">bool</span> vis[maxn];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">build</span><span class="hljs-params">(<span class="hljs-keyword">int</span>&amp; u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    u = ++cnt;</span><br><span class="line">    range[u][<span class="hljs-number">0</span>] = l, range[u][<span class="hljs-number">1</span>] = r;</span><br><span class="line">    <span class="hljs-keyword">if</span> (l == r) &#123;</span><br><span class="line">        num[l] = u;</span><br><span class="line">        w[u] = <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">    build(lson(u), l, mid), build(rson(u), mid + <span class="hljs-number">1</span>, r);</span><br><span class="line">    G[u].push_back(lson(u)), G[u].push_back(rson(u));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add_edge_range</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r, <span class="hljs-keyword">int</span> qu, <span class="hljs-keyword">int</span> ql, <span class="hljs-keyword">int</span> qr)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) &#123;</span><br><span class="line">        G[qu].push_back(u);</span><br><span class="line">        <span class="hljs-keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= mid) add_edge_range(lson(u), l, mid, qu, ql, qr);</span><br><span class="line">    <span class="hljs-keyword">if</span> (mid &lt; qr) add_edge_range(rson(u), mid + <span class="hljs-number">1</span>, r, qu, ql, qr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">tarjan</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    low[u] = dfn[u] = ++dfn_idx;</span><br><span class="line">    ins[u] = <span class="hljs-number">1</span>;</span><br><span class="line">    s.push(u);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> v = *it;</span><br><span class="line">        <span class="hljs-keyword">if</span> (dfn[v] == <span class="hljs-number">0</span>) &#123;</span><br><span class="line">            tarjan(v);</span><br><span class="line">            low[u] = min(low[u], low[v]);</span><br><span class="line">        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ins[v]) &#123;</span><br><span class="line">            low[u] = min(low[u], dfn[v]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">if</span> (low[u] == dfn[u]) &#123;</span><br><span class="line">        scc_cnt++;</span><br><span class="line">        f[scc_cnt][<span class="hljs-number">0</span>] = inf, f[scc_cnt][<span class="hljs-number">1</span>] = -inf;</span><br><span class="line">        <span class="hljs-keyword">while</span> (ins[u]) &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> t = s.top();</span><br><span class="line">            s.pop();</span><br><span class="line">            ins[t] = <span class="hljs-number">0</span>;</span><br><span class="line">            scc[t] = scc_cnt;</span><br><span class="line">            f[scc_cnt][<span class="hljs-number">0</span>] = min(f[scc_cnt][<span class="hljs-number">0</span>], range[t][<span class="hljs-number">0</span>]);</span><br><span class="line">            f[scc_cnt][<span class="hljs-number">1</span>] = max(f[scc_cnt][<span class="hljs-number">1</span>], range[t][<span class="hljs-number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dp</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (vis[u]) <span class="hljs-keyword">return</span>;</span><br><span class="line">    vis[u] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;::iterator it = SCC[u].begin(); it != SCC[u].end(); it++) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> v = *it;</span><br><span class="line">        dp(v);</span><br><span class="line">        f[u][<span class="hljs-number">0</span>] = min(f[u][<span class="hljs-number">0</span>], f[v][<span class="hljs-number">0</span>]);</span><br><span class="line">        f[u][<span class="hljs-number">1</span>] = max(f[u][<span class="hljs-number">1</span>], f[v][<span class="hljs-number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;N);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= N; ++i)</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%lld%lld"</span>, &amp;a[i], &amp;r[i]);</span><br><span class="line">    build(R, <span class="hljs-number">1</span>, N);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= N; ++i)</span><br><span class="line">        add_edge_range(R, <span class="hljs-number">1</span>, N, num[i], ge(a[i] - r[i]), le(a[i] + r[i]));</span><br><span class="line">    tarjan(<span class="hljs-number">1</span>);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> u = <span class="hljs-number">1</span>; u &lt;= N; ++u) &#123;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;::iterator it = G[u].begin(); it != G[u].end(); it++) &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> v = *it;</span><br><span class="line">            <span class="hljs-keyword">if</span> (scc[u] != scc[v])</span><br><span class="line">                SCC[scc[u]].push_back(scc[v]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= scc_cnt; ++i)</span><br><span class="line">        dp(i);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">        ans = (ans + <span class="hljs-number">1l</span>l * i * (f[scc[num[i]]][<span class="hljs-number">1</span>] - f[scc[num[i]]][<span class="hljs-number">0</span>] + <span class="hljs-number">1</span>)) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d"</span>, ans);</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;note info&quot;&gt;&lt;p&gt;
&lt;a href=&quot;https://www.luogu.org/problem/P5025&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;题目链接(Luogu)&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;https://loj.ac/problem/2255&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;题目链接(LibreOJ)&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;在一条直线上有 $n$ 个炸弹，每个炸弹给定其坐标和爆炸半径；求出引爆每个炸弹时，共有多少炸弹被连锁引爆。&lt;/p&gt;
&lt;p&gt;$n\le 500000$&lt;/p&gt;
&lt;p&gt;我感谢我自己&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="线段树" scheme="https://tth37.cn/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
      <category term="强连通分量" scheme="https://tth37.cn/tags/%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/"/>
    
  </entry>
  
  <entry>
    <title>题解-LibreOJ-6029「雅礼集训 2017 Day1」市场</title>
    <link href="https://tth37.cn/2019/10/21/solution-loj-6029/"/>
    <id>https://tth37.cn/2019/10/21/solution-loj-6029/</id>
    <published>2019-10-21T15:49:35.000Z</published>
    <updated>2019-11-24T15:50:35.133Z</updated>
    
    <content type="html"><![CDATA[<div class="note info"><p><a href="https://loj.ac/problem/6029" target="_blank" rel="noopener">题目链接(LibreOJ)</a></p></div><blockquote><p>维护一个数据结构，支持区间加减、区间除法（下取整）、区间查询最值、区间查询总和操作。</p><p>$n \le 100000, q \le 100000$</p></blockquote><a id="more"></a><p>线段树区间除法模板题。可以玄学分析复杂度。</p><p>观察到对某个区间进行除法操作后，其区间内的权值<strong>整体减小某个值</strong>，当且仅当该区间的<strong>最大元素与最小元素减小的值相等</strong>。因此区间除法可以转化为区间减法，只需判断是否满足区间减的条件即可。</p><p><div class="note warning"><p>注意 '/' 运算符对数字进行向零取整，并不是向下取整</p></div></p><p>实现非常简单。代码如下：</p><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;</span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> lson(u) node[u].l</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> rson(u) node[u].r</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> tag(u) node[u].tag</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> maxx(u) node[u].maxx</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> minn(u) node[u].minn</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> sum(u) node[u].sum</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> maxn = <span class="hljs-number">100005</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> inf = <span class="hljs-number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Node</span> &#123;</span></span><br><span class="line">    <span class="hljs-keyword">int</span> l, r, tag, minn, maxx;</span><br><span class="line">    ll sum;</span><br><span class="line">&#125;node[maxn &lt;&lt; <span class="hljs-number">1</span>];</span><br><span class="line"><span class="hljs-keyword">int</span> cnt;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> N, Q, R;</span><br><span class="line"><span class="hljs-keyword">int</span> a[maxn];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pushdown</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (tag(u)) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">int</span> llen = mid - l + <span class="hljs-number">1</span>, rlen = r - mid;</span><br><span class="line">        sum(lson(u)) += <span class="hljs-number">1l</span>l * tag(u) * llen, sum(rson(u)) += <span class="hljs-number">1l</span>l * tag(u) * rlen;</span><br><span class="line">        minn(lson(u)) += tag(u), minn(rson(u)) += tag(u);</span><br><span class="line">        maxx(lson(u)) += tag(u), maxx(rson(u)) += tag(u);</span><br><span class="line">        tag(lson(u)) += tag(u), tag(rson(u)) += tag(u);</span><br><span class="line">        tag(u) = <span class="hljs-number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pushup</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    sum(u) = sum(lson(u)) + sum(rson(u));</span><br><span class="line">    minn(u) = min(minn(lson(u)), minn(rson(u)));</span><br><span class="line">    maxx(u) = max(maxx(lson(u)), maxx(rson(u)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">build</span><span class="hljs-params">(<span class="hljs-keyword">int</span>&amp; u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    u = ++cnt;</span><br><span class="line">    sum(u) = <span class="hljs-number">0</span>, minn(u) = inf, maxx(u) = -inf;</span><br><span class="line">    <span class="hljs-keyword">if</span> (l == r) &#123;</span><br><span class="line">        sum(u) = minn(u) = maxx(u) = a[l];</span><br><span class="line">        <span class="hljs-keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">    build(lson(u), l, mid), build(rson(u), mid + <span class="hljs-number">1</span>, r);</span><br><span class="line">    pushup(u);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">modify_range_add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r, <span class="hljs-keyword">int</span> ql, <span class="hljs-keyword">int</span> qr, <span class="hljs-keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) &#123;</span><br><span class="line">        tag(u) += val;</span><br><span class="line">        sum(u) += <span class="hljs-number">1l</span>l * val * (r - l + <span class="hljs-number">1</span>);</span><br><span class="line">        minn(u) += val;</span><br><span class="line">        maxx(u) += val;</span><br><span class="line">        <span class="hljs-keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(u, l, r);</span><br><span class="line">    <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= mid) modify_range_add(lson(u), l, mid, ql, qr, val);</span><br><span class="line">    <span class="hljs-keyword">if</span> (mid &lt; qr) modify_range_add(rson(u), mid + <span class="hljs-number">1</span>, r, ql, qr, val);</span><br><span class="line">    pushup(u);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">modify_range_divide</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r, <span class="hljs-keyword">int</span> ql, <span class="hljs-keyword">int</span> qr, <span class="hljs-keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> dmin = minn(u) - <span class="hljs-built_in">floor</span>(<span class="hljs-number">1.0</span> * minn(u) / val), dmax = maxx(u) - <span class="hljs-built_in">floor</span>(<span class="hljs-number">1.0</span> * maxx(u) / val);</span><br><span class="line">        <span class="hljs-keyword">if</span> (dmin == dmax) &#123;</span><br><span class="line">            tag(u) -= dmin;</span><br><span class="line">            sum(u) -= <span class="hljs-number">1l</span>l * dmin * (r - l + <span class="hljs-number">1</span>);</span><br><span class="line">            minn(u) -= dmin;</span><br><span class="line">            maxx(u) -= dmin;</span><br><span class="line">            <span class="hljs-keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(u, l, r);</span><br><span class="line">    <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= mid) modify_range_divide(lson(u), l, mid, ql, qr, val);</span><br><span class="line">    <span class="hljs-keyword">if</span> (mid &lt; qr) modify_range_divide(rson(u), mid + <span class="hljs-number">1</span>, r, ql, qr, val);</span><br><span class="line">    pushup(u);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">query_range_min</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r, <span class="hljs-keyword">int</span> ql, <span class="hljs-keyword">int</span> qr)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) <span class="hljs-keyword">return</span> minn(u);</span><br><span class="line">    pushdown(u, l, r);</span><br><span class="line">    <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>, ret = inf;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= mid) ret = min(ret, query_range_min(lson(u), l, mid, ql, qr));</span><br><span class="line">    <span class="hljs-keyword">if</span> (mid &lt; qr) ret = min(ret, query_range_min(rson(u), mid + <span class="hljs-number">1</span>, r, ql, qr));</span><br><span class="line">    <span class="hljs-keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function">ll <span class="hljs-title">query_range_sum</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r, <span class="hljs-keyword">int</span> ql, <span class="hljs-keyword">int</span> qr)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) <span class="hljs-keyword">return</span> sum(u);</span><br><span class="line">    pushdown(u, l, r);</span><br><span class="line">    <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>; ll ret = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">if</span> (ql &lt;= mid) ret += query_range_sum(lson(u), l, mid, ql, qr);</span><br><span class="line">    <span class="hljs-keyword">if</span> (mid &lt; qr) ret += query_range_sum(rson(u), mid + <span class="hljs-number">1</span>, r, ql, qr);</span><br><span class="line">    <span class="hljs-keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d"</span>, &amp;N, &amp;Q);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; N; ++i) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;a[i]);</span><br><span class="line">    build(R, <span class="hljs-number">0</span>, N - <span class="hljs-number">1</span>);</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= Q; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> op, l, r, x;</span><br><span class="line">        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d"</span>, &amp;op, &amp;l, &amp;r);</span><br><span class="line">        <span class="hljs-keyword">if</span> (op == <span class="hljs-number">1</span>) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;x), modify_range_add(R, <span class="hljs-number">0</span>, N - <span class="hljs-number">1</span>, l, r, x);</span><br><span class="line">        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-number">2</span>) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;x), modify_range_divide(R, <span class="hljs-number">0</span>, N - <span class="hljs-number">1</span>, l, r, x);</span><br><span class="line">        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-number">3</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, query_range_min(R, <span class="hljs-number">0</span>, N - <span class="hljs-number">1</span>, l, r));</span><br><span class="line">        <span class="hljs-keyword">else</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%lld\n"</span>, query_range_sum(R, <span class="hljs-number">0</span>, N - <span class="hljs-number">1</span>, l, r));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;note info&quot;&gt;&lt;p&gt;
&lt;a href=&quot;https://loj.ac/problem/6029&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;题目链接(LibreOJ)&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;维护一个数据结构，支持区间加减、区间除法（下取整）、区间查询最值、区间查询总和操作。&lt;/p&gt;
&lt;p&gt;$n \le 100000, q \le 100000$&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
    
      <category term="线段树" scheme="https://tth37.cn/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>2019CSP-S复习计划</title>
    <link href="https://tth37.cn/2019/10/21/schedule-2019-CSP/"/>
    <id>https://tth37.cn/2019/10/21/schedule-2019-CSP/</id>
    <published>2019-10-21T14:09:24.000Z</published>
    <updated>2019-11-20T15:41:14.973Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here.">    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="2042656f53679d4cc4678270bbe64c8f850361fa84148e4914ff8074c5150163">196ffd93c2eb511d907d1250bbad7b244cfc7e5f54de813a221544db5cee153c561665681fddcf94359c724b2dd5e524df2b3305c77d30d33f91cde1278a6fdb61014e146ae0aed0eb9e8c97dadd1ea40f990420163cf344460f9bd2176cfee5a112345d0c001d437253a962335d92b3ee6d39c1022d52c9ddb38fbdb05034efbd065ad1f133bb1b5d8e802c70c4be718dd8a1a78e47f6180790adc33b3cc3a771d89c8932b545ab5cddf481f9d9e540fa633772505e6fc289a46c127a6f277ba37d19d02427170d24542f1b1f1070ff35569b5c2af19ab9d894fcf24595d1fe15d79022dce34d4be963ba7f69945b34b07d62fc9d0a6bb7b112e09eca28c182907c78475a7c031e8c588bd609159b23b56ec7f05f88fc6cc0a7e52891a013e5c3e932622c0c9c56b086631b901df017884623defc9c97f20f12d28d3ca4ea894198e8eccbad168b2111ae48efd1f419f9d2bb334b509b46c10008ac3d4d3035c1346f07119c1840a9baf0671504108bdd067679bca4c98009bf678fb1e3083a5ded9c6b09f98de91130a3a99037c93a6f5670fa2ecec5c5ff12f526b31396a69e6d1e085eaa7f662d8fb6f74ed9b0bfadfd31fd8be763f2a073945105206119a5b459ed969298f475c7e8274dad5ba4c2e9760f84d77767c6ba5b6e8bdb06fdc593b17e7d3a368882798b9443e57ff3dd32be3ef170809a15efd30e43f9799f8298dd8aa211fd6139508a46a8a2ffc15900c4106761ea3064aecdce353f325d1565510d1c16e0b26d876c795ff4bb64da26e6725eb941b2a9a1d7644ee5576d0ac6c22dbaee67e97899515e7ca4dd1032b56d5d6ac31c9c81a2b08deff2f54b03777d526bf1d4f3501dcbd7893f2c50ea538a9e288870d7bbaeed3afae44f061f968be0ca856c262a10c46d1aad0878ce5c97be314940d06a3b671dffa241b1cc428e55299fb56d4015d19eedd98506f79b0192e1f1ec20d3d701a52e476001f2b222e02fae8ecd6ecb7dbbccb9910cd009ed36272fde468efc2663c4f841c9c0b187a73cbcd876ddcd5f0ccc66c01df6ecd3ead3ab5cb58ec1d4d1de7b2fcabb747749a5cefeeee6742a535f4357733c69402373920ba3bf684d045f43171d8afd01287193cc7606c171e59aeb7aa2f3bee2564a2c75f9ba91b1a895e974ee77d58bba0fe0262d381ff9f0979847a87c3a5ad1946c7d1358ceb9d2cb0e7e57208154829dc64496ab1c68ed0a528d98912f011d5dba4c7fb837517a819c9dc44ebf83d3c4c22a41ea1e807c6510592b39f90a9e141caba8c191482b0a253788e2bd0c7d51672015123c60466c9e056232685aa9ca7c3639c0e3b089969a861035ca275364ed1ede5ee5df17478ab2b935c685a607e13143e35502a645f2ec48bdc38aea1ddede33a7c2f8f4a86653daccd7559c16c994b2a357dcfba27738ff22500a996c0ec1e3c0afda0dee043ef817fb89166a9dc4297be92b8d0d2ca5757d5f0eb0ad4b8c5fe5b2a1603fbb74db7593099d5728de4e32a40377ad49d76b75833b4d4719e9a422ffb7888da8a0c15d02a0eb21508dc15c5ad031b01b18c927aa42ebb647d14d26b44b2d93f2c6645ade5a68755cf4d261dcb4943bb2b70240fd39f5fee01def75f5fb0da4404ea28c8450a837552fe19834107e573aaf6e2bd227697d8746d2ba48ef19729f214b868f7f442119c68ce2ca8cc5bc42db600700005f05db65c7ba666e27e5bc8b0e4c52854af0aeaa60846713093398e92e7be1c634621fed3a0dd9a4bc61ab3703722efa983a8e05b25cb9d1dccac9c72c0f3f23f50c7b21931c90c7e1b6dbcf4f8c6056a07ea8ff8064c34d2b03b61eb25b378a71618dcbed1d938f092ea146fa7b40d499e95e7ab126f0d031a17b8bc5f6fef71d7ab0c4f3bdc2aae3fd8d0df0da77259fd3db729861e3df59097695c0af5d42d678b8de56014a1cf2c4d5b08483004d1090900bb5b231bdd537671f172723b5453429d8b3d2fe1ff5bcf47453925319a546f43898b929fd235b7b0d67fabf6461b9f7fb781ad91e50aa332fb551f6ef5440b5f3ffdb68f25b703cb0a7b821da6f1f67e8f593cd1d92608c065f292c67773c62f7ef60269e795561a2ec47e47e7c2763974246f2eedb883fc8759162bcaaebe495e638133a2f88eab6fd9bc6715e32e6730a9416fd1a7cd4dcad365c9e3783f530b5fac872e39736ff05031df68a1e362b7d5edb46532ad0e476bd5a64e0f8db3d0ddc839fc3a82020fff928e76fa86d12acf365432cc7cac3b1fb17b5909d4c33d09ec2337d2d79093f4c03bda42cf63a78ac10159cf1aadb739bc5be703c312895c155bd70adda906ea2e022f89498808c06a26d77c2229abdd00d223b3cff87b1cf169a424d2150a62bc0d4d38eb275af666797c4253ca54b623873665c2b2ed4beb9c1957249dd64d3e7fa2fa3df89ef5c4c63df2a2bed70982ba8f61db2010df1e9b5fbebc0782555ef1588f0d3b306258f924db7b8a516f7bd99f49c0429e0c6df33985d8a38bdacf5f8837052e91e7637d4b3d524bfe253fba451f5e4bb5e52cffc2ba921506c7daaf0fa1492743a5af6881f9e46b8183037024140f712454fba13c2977d65d1d4c1ca7c017aa93523742f361ef2c17fee6dcedda95637841202b7557e54dfdb699526f9af3931b33821194acab05c2d932d4e5db02fa1fa82b6259d8f4dc5880b6272ebb74ee79c22da7c5aceb115dde508aae33807c761540ae18d2071ef6e90de52d2a57df673f00a5905e221741efa71297955ef00129324203d84be7dd48f17f789215ac8efc32aa662deb3e36bfb1345cc331d080c805841dea6c95ae8bd7b69dda09db179c786accf007607556bceab2a5faeb6489bda2a1f761f2ce3d631ab619c29acff89566f7b29ed663175ef541b3fda15894f7f1e36123e91a19abb404af600702f1664b2672cd69b20598465cdbdbae3c296d87ea0d1275f80f76ab1ae84b6c1c39ca3a3c3ae39fd016d3f43b188accf363d5d8bbe99de737ed9b3876219254d3fe13ff23916798eb51e15499c8a3331631f9e3b1b895108292646f0eb66b69c8a934853935968d70cb0732690d9be289e2197b98b148cfc79fc5232ce446f7df75e57c9cf39276f6c374eb88aa8cce20d17ca6cd57bd3d752388d0863ddba5d12cc45d56abee82bf424eabfc172e83114eb9039ef22ec068a20b058c21781f004331ee4eab0c59b02d1fd47539f0ec21b8ebf420182b31090e90c86dcd8de90c72659dda6c0e93eb7567e77404d5b1860814cf5a3770efac20ca4d6d725dea6e269180f0327af1ea602451b114a16df5deba0714d7c6eddea9eaa7c5a1720bba420259e949fe56121e6b5c8a3bca27f8994947c10ed2281e638651ad0cddbf094a5e705f4330362e475efc3a346c0ac9ef84b730b499c0f911522e8fa41a9d7b88f700e8e3d2037212939d52883035dc2bb1b114fe8ef0ff8607e4d7a77c229ccf9662969121032d54d4e07196ef0a22c4a7c8ff82e6cf693d8a51f89f7b14528f7f07b81ecac5e419b4e647a5726d49b06818d3626fabcc7bd48507612eec2f6e333d978a07d8dbe61abac57d7ffe469e98defe21a5b9278270106b31870bd23a0a5406b9568cc682691a5f4b98d1e9f0d1113d68e1bd2dfa8afbe9cf65f9d302fe487d5c2635fad050631baf6ad6bf7f11c25737da6954b4efa53c7ad194108b3fcc6d470166ed3a597c85865e357b733e7113885b1775cca04aea737e04957b70d0cb97ee97ac382e26f2c80df2aefa45708ab0fab6606fc237e8510e3c000f8cd18332844823592866970177880b2e849fbadcc6091239853c49721da523830d20ec48e427c2bba9655f18704c8371bef184725340230597a9b1cbb40e0ad7a170fcf8514fc45ab44e3f7ff73952d24c91015ed36cf52313f929b40cc0c283b9a71521c6a2654b8a98dafb0921f12707e72a644171a0533e80eae56197803713dcecb81e4b7c18f54d3f07923a5a8de50ffc448328a55e93e3dfdf8ffc4479837e2e5231ce52c4ab164a1cf8d0503b856370e90a2e7240e96982f33b066f1efbcc00971e50864bcb65f929e407929bfbd53ea8b640609</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      复习计划！自用
    
    </summary>
    
      <category term="计划" scheme="https://tth37.cn/categories/%E8%AE%A1%E5%88%92/"/>
    
    
  </entry>
  
  <entry>
    <title>题解-LibreOJ-6495「雅礼集训 2018 Day1」树</title>
    <link href="https://tth37.cn/2019/10/19/solution-loj-6495/"/>
    <id>https://tth37.cn/2019/10/19/solution-loj-6495/</id>
    <published>2019-10-19T14:21:29.000Z</published>
    <updated>2019-11-24T15:50:43.724Z</updated>
    
    <content type="html"><![CDATA[<div class="note info"><p><a href="https://loj.ac/problem/6495" target="_blank" rel="noopener">题目链接(LibreOJ)</a></p></div><blockquote><p>题目概括征集中~</p><p><strong>重金（5 RMB）征集状压 dp 解法~</strong> <a href>@所有人</a></p></blockquote><p><div class="note default"><p>这题也太巧妙了叭！ ——Mr.G</p></div></p><a id="more"></a><h4 id="Solution-1-O-n-4"><a href="#Solution-1-O-n-4" class="headerlink" title="Solution 1 : $O(n^4)$"></a>Solution 1 : $O(n^4)$</h4><p>注意到节点 2 的父节点一定为 1；因此可以将以 2 为根的子树与剩余部分分开讨论。</p><p>定义状态 $f[i][j]$ 表示有 $i$ 个节点，深度为 $j$ 的方案数。</p><p>设以 2 为根的子树中共有 $x$ 个节点。情况一：子树 2 的深度恰好为 $j-1$，剩余部分的深度任意；情况二：子树 2 的深度任意，剩余部分的深度恰好为 $j$。</p><p>由于两棵子树的节点编号为 $3…i$ 间的任意整数，所以求出方案数之后需乘上标号的方案数。</p><script type="math/tex; mode=display">f[i][j]=\sum_{x=1}^{i-1}[\sum_{k=1}^{j}f[x][j-1]\times f[i-x][k]\times {i-2\choose x-1}+\sum_{k=1}^{j-2}f[x][k]\times f[i-x][j]\times{i-2\choose x-1}]</script><p>对于期望，只需将 $\sum_{i=1}^n f[n][i]\times i$ 除以 $(n-1)!$ 即可。</p><p>对于四舍五入，可打表。（正经）</p><p>代码如下：</p><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> maxn = <span class="hljs-number">30</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> tb[] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>&#125;;</span><br><span class="line"></span><br><span class="line">ll n, p;</span><br><span class="line">ll fac[maxn], inv[maxn], facinv[maxn];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">C</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n, <span class="hljs-keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> fac[n] * facinv[n - m] % p * facinv[m] % p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll f[maxn][maxn];</span><br><span class="line">ll ans = <span class="hljs-number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; p;</span><br><span class="line">    fac[<span class="hljs-number">0</span>] = fac[<span class="hljs-number">1</span>] = inv[<span class="hljs-number">1</span>] = facinv[<span class="hljs-number">0</span>] = facinv[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        inv[i] = (p - p / i) * inv[p % i] % p;</span><br><span class="line">        fac[i] = fac[i - <span class="hljs-number">1</span>] * i % p;</span><br><span class="line">        facinv[i] = facinv[i - <span class="hljs-number">1</span>] * inv[i] % p;</span><br><span class="line">    &#125;</span><br><span class="line">    f[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>, f[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">3</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> x = <span class="hljs-number">1</span>; x &lt;= i - <span class="hljs-number">1</span>; ++x) &#123;</span><br><span class="line">                <span class="hljs-keyword">int</span> t1 = <span class="hljs-number">0</span>, t2 = <span class="hljs-number">0</span>;</span><br><span class="line">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= j; ++k)</span><br><span class="line">                    t1 = (t1 + f[x][j - <span class="hljs-number">1</span>] * f[i - x][k] % p * C(i - <span class="hljs-number">2</span>, x - <span class="hljs-number">1</span>) % p) % p;</span><br><span class="line">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= j - <span class="hljs-number">2</span>; ++k)</span><br><span class="line">                    t2 = (t2 + f[x][k] * f[i - x][j] % p * C(i - <span class="hljs-number">2</span>, x - <span class="hljs-number">1</span>) % p) % p;</span><br><span class="line">                f[i][j] = (f[i][j] + t1 + t2) % p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        ans = (ans + f[n][i] * i) % p;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n - <span class="hljs-number">1</span>; ++i)</span><br><span class="line">        ans = (ans * inv[i]) % p;</span><br><span class="line">    <span class="hljs-built_in">cout</span> &lt;&lt; tb[n] &lt;&lt; <span class="hljs-built_in">endl</span> &lt;&lt; ans;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Solution-2-O-2-n-n-2"><a href="#Solution-2-O-2-n-n-2" class="headerlink" title="Solution 2 : $O(2^n*n^2)$"></a>Solution 2 : $O(2^n*n^2)$</h4><p><div class="note primary"><p>状压 dp 解法 </p></div></p>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;note info&quot;&gt;&lt;p&gt;
&lt;a href=&quot;https://loj.ac/problem/6495&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;题目链接(LibreOJ)&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;题目概括征集中~&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;重金（5 RMB）征集状压 dp 解法~&lt;/strong&gt; &lt;a href&gt;@所有人&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;div class=&quot;note default&quot;&gt;&lt;p&gt;这题也太巧妙了叭！ ——Mr.G&lt;/p&gt;&lt;/div&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
    
      <category term="数学" scheme="https://tth37.cn/tags/%E6%95%B0%E5%AD%A6/"/>
    
      <category term="计数dp" scheme="https://tth37.cn/tags/%E8%AE%A1%E6%95%B0dp/"/>
    
      <category term="数学期望" scheme="https://tth37.cn/tags/%E6%95%B0%E5%AD%A6%E6%9C%9F%E6%9C%9B/"/>
    
  </entry>
  
  <entry>
    <title>题解-LibreOJ-6513「雅礼集训 2018 Day10」足球大战</title>
    <link href="https://tth37.cn/2019/10/19/solution-loj-6513/"/>
    <id>https://tth37.cn/2019/10/19/solution-loj-6513/</id>
    <published>2019-10-19T14:02:45.000Z</published>
    <updated>2019-11-24T15:50:53.560Z</updated>
    
    <content type="html"><![CDATA[<div class="note info"><p><a href="https://loj.ac/problem/6513" target="_blank" rel="noopener">题目链接(LibreOJ)</a></p></div><blockquote><p>足球比赛共 $n$ 秒中，主队每秒进球概率为 $p$，客队每秒进球概率为 $q$，求主队获胜概率。</p><p>$n \le 10000000$</p></blockquote><a id="more"></a><p>记 $f(i,j)$ 表示 $n$ 秒种后，主队进 $i$ 个球，客队进 $j$ 个球的概率。则有：</p><script type="math/tex; mode=display">f(i,j)={n \choose i}\times p^i\times (1-p)^{n-i} \times {n\choose j}\times q^j \times (1-q)^{n-j}</script><p>要使得 $i&gt;j$ ，即求：</p><script type="math/tex; mode=display">\sum_{i=1}^n\sum_{j=0}^{i-1}{n\choose i}\times p^i\times (1-p)^{n-i}\times {n\choose j}\times q^j \times (1-q)^{n-j}</script><p>化简，得：</p><script type="math/tex; mode=display">\sum_{i=1}^n {n\choose i}\times p^i\times (1-p)^{n-i}\times(\sum_{j=0}^{i-1}{n\choose j}\times q^j \times (1-q)^{n-j})</script><p>$O(n)$ 预处理逆元与 $p$、$q$ 的 $n$ 次方即可。组合数可以递推计算以卡常。</p><p>注意实现细节，本题还是挺水的。</p><p>代码如下：</p><figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> maxn = <span class="hljs-number">10000005</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">qpow</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;</span><br><span class="line"><span class="hljs-keyword">int</span> ret = <span class="hljs-number">1</span>;</span><br><span class="line"><span class="hljs-keyword">while</span> (b) &#123;</span><br><span class="line"><span class="hljs-keyword">if</span> (b &amp; <span class="hljs-number">1</span>) ret = <span class="hljs-number">1l</span>l * ret * a % mod;</span><br><span class="line">a = <span class="hljs-number">1l</span>l * a * a % mod;</span><br><span class="line">b &gt;&gt;= <span class="hljs-number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">int</span> inv[maxn];</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> n, ans;</span><br><span class="line"><span class="hljs-keyword">int</span> p, q, p2, q2;</span><br><span class="line"><span class="hljs-keyword">int</span> invp2, invq2;</span><br><span class="line"><span class="hljs-keyword">int</span> pa, pb, qa, qb;</span><br><span class="line"><span class="hljs-keyword">int</span> powp, powq;</span><br><span class="line"><span class="hljs-keyword">int</span> powp2, powq2;</span><br><span class="line"><span class="hljs-keyword">int</span> sq;</span><br><span class="line"><span class="hljs-keyword">int</span> C;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line"><span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;n);</span><br><span class="line"><span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d"</span>, &amp;pa, &amp;pb);</span><br><span class="line">p = <span class="hljs-number">1l</span>l * pa * qpow(pb, mod - <span class="hljs-number">2</span>) % mod;</span><br><span class="line">p2 = (<span class="hljs-number">1</span> - p + mod) % mod;</span><br><span class="line">    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d"</span>, &amp;qa, &amp;qb);</span><br><span class="line">q = <span class="hljs-number">1l</span>l * qa * qpow(qb, mod - <span class="hljs-number">2</span>) % mod;</span><br><span class="line">q2 = (<span class="hljs-number">1</span> - q + mod) % mod;</span><br><span class="line"><span class="hljs-keyword">if</span> (p == <span class="hljs-number">1</span>)</span><br><span class="line"><span class="hljs-keyword">return</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d"</span>, (<span class="hljs-number">1</span> - qpow(q, n) + mod) % mod), <span class="hljs-number">0</span>;</span><br><span class="line">    inv[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        inv[i] = <span class="hljs-number">1l</span>l * (mod - mod / i) * inv[mod % i] % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    C = <span class="hljs-number">1</span>;</span><br><span class="line">    powp = <span class="hljs-number">1</span>, powq = <span class="hljs-number">1</span>;</span><br><span class="line">    powp2 = qpow(p2, n), powq2 = qpow(q2, n);</span><br><span class="line">    invp2 = qpow(p2, mod - <span class="hljs-number">2</span>), invq2 = qpow(q2, mod - <span class="hljs-number">2</span>);</span><br><span class="line">    <span class="hljs-keyword">int</span> tp = <span class="hljs-number">1l</span>l * powp * powp2 % mod, tq = <span class="hljs-number">1l</span>l * powq * powq2 % mod;</span><br><span class="line">    <span class="hljs-keyword">int</span> mp = <span class="hljs-number">1l</span>l * p * invp2 % mod, mq = <span class="hljs-number">1l</span>l * q * invq2 % mod;</span><br><span class="line">sq = powq2;</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">C = <span class="hljs-number">1l</span>l * C * (n - i + <span class="hljs-number">1</span>) % mod * inv[i] % mod;</span><br><span class="line">        tp = <span class="hljs-number">1l</span>l * tp * mp % mod;</span><br><span class="line">        tq = <span class="hljs-number">1l</span>l * tq * mq % mod;</span><br><span class="line">        ans = (ans + <span class="hljs-number">1l</span>l * tp % mod * sq % mod * C) % mod;</span><br><span class="line">sq = (sq + <span class="hljs-number">1l</span>l * tq % mod * C) % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d"</span>, ans);</span><br><span class="line"><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;note info&quot;&gt;&lt;p&gt;
&lt;a href=&quot;https://loj.ac/problem/6513&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;题目链接(LibreOJ)&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;足球比赛共 $n$ 秒中，主队每秒进球概率为 $p$，客队每秒进球概率为 $q$，求主队获胜概率。&lt;/p&gt;
&lt;p&gt;$n \le 10000000$&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="题解" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LibreOJ" scheme="https://tth37.cn/categories/%E9%A2%98%E8%A7%A3/LibreOJ/"/>
    
    
      <category term="数学" scheme="https://tth37.cn/tags/%E6%95%B0%E5%AD%A6/"/>
    
      <category term="概率" scheme="https://tth37.cn/tags/%E6%A6%82%E7%8E%87/"/>
    
  </entry>
  
</feed>
